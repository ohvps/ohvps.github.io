<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>3. Temel Prensipler -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 -&gt; v1.1.0 | (ÖHVPS) API İLKE VE KURALLARI</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.1aca20b5.css" as="style"><link rel="preload" href="/assets/js/app.93076482.js" as="script"><link rel="preload" href="/assets/js/8.7b64f4e3.js" as="script"><link rel="preload" href="/assets/js/5.84780e47.js" as="script"><link rel="preload" href="/assets/js/4.1766b0b6.js" as="script"><link rel="preload" href="/assets/js/80.33d749d2.js" as="script"><link rel="prefetch" href="/assets/js/1.6b17d2a6.js"><link rel="prefetch" href="/assets/js/10.61fb8c6a.js"><link rel="prefetch" href="/assets/js/11.b37b85af.js"><link rel="prefetch" href="/assets/js/12.0b38e123.js"><link rel="prefetch" href="/assets/js/15.4060773c.js"><link rel="prefetch" href="/assets/js/16.67379bb4.js"><link rel="prefetch" href="/assets/js/17.99537319.js"><link rel="prefetch" href="/assets/js/18.f0fe7e1b.js"><link rel="prefetch" href="/assets/js/19.06aec1d2.js"><link rel="prefetch" href="/assets/js/2.c8d641d2.js"><link rel="prefetch" href="/assets/js/20.7eb8d2c4.js"><link rel="prefetch" href="/assets/js/21.91f2ccb0.js"><link rel="prefetch" href="/assets/js/22.d9e6737f.js"><link rel="prefetch" href="/assets/js/23.50b3d8db.js"><link rel="prefetch" href="/assets/js/24.04fbb3fd.js"><link rel="prefetch" href="/assets/js/25.949ca68e.js"><link rel="prefetch" href="/assets/js/26.062bc404.js"><link rel="prefetch" href="/assets/js/27.cb91be27.js"><link rel="prefetch" href="/assets/js/28.d258e352.js"><link rel="prefetch" href="/assets/js/29.96ed3f1b.js"><link rel="prefetch" href="/assets/js/3.ff672b5c.js"><link rel="prefetch" href="/assets/js/30.0be8295d.js"><link rel="prefetch" href="/assets/js/31.948c20cc.js"><link rel="prefetch" href="/assets/js/32.24e340ae.js"><link rel="prefetch" href="/assets/js/33.2b5eda4e.js"><link rel="prefetch" href="/assets/js/34.85a50388.js"><link rel="prefetch" href="/assets/js/35.8511d0c6.js"><link rel="prefetch" href="/assets/js/36.2a4e0383.js"><link rel="prefetch" href="/assets/js/37.315c72fc.js"><link rel="prefetch" href="/assets/js/38.2488afda.js"><link rel="prefetch" href="/assets/js/39.7cf0edcf.js"><link rel="prefetch" href="/assets/js/40.3a23d959.js"><link rel="prefetch" href="/assets/js/41.8fd7fa01.js"><link rel="prefetch" href="/assets/js/42.9962bd55.js"><link rel="prefetch" href="/assets/js/43.5ea393b6.js"><link rel="prefetch" href="/assets/js/44.717ee2b5.js"><link rel="prefetch" href="/assets/js/45.4a949f59.js"><link rel="prefetch" href="/assets/js/46.bbed8e6a.js"><link rel="prefetch" href="/assets/js/47.e7f746c3.js"><link rel="prefetch" href="/assets/js/48.c5c3409f.js"><link rel="prefetch" href="/assets/js/49.1312d83e.js"><link rel="prefetch" href="/assets/js/50.24e98922.js"><link rel="prefetch" href="/assets/js/51.26ee4fb0.js"><link rel="prefetch" href="/assets/js/52.ae39195f.js"><link rel="prefetch" href="/assets/js/53.76982f19.js"><link rel="prefetch" href="/assets/js/54.d726fb02.js"><link rel="prefetch" href="/assets/js/55.9e9b007b.js"><link rel="prefetch" href="/assets/js/56.8904aebe.js"><link rel="prefetch" href="/assets/js/57.e28085fb.js"><link rel="prefetch" href="/assets/js/58.c872a125.js"><link rel="prefetch" href="/assets/js/59.01c3719d.js"><link rel="prefetch" href="/assets/js/6.9fa1c45f.js"><link rel="prefetch" href="/assets/js/60.89df804c.js"><link rel="prefetch" href="/assets/js/61.3d809330.js"><link rel="prefetch" href="/assets/js/62.ea4500e7.js"><link rel="prefetch" href="/assets/js/63.245044e5.js"><link rel="prefetch" href="/assets/js/64.4379610d.js"><link rel="prefetch" href="/assets/js/65.a19aecf5.js"><link rel="prefetch" href="/assets/js/66.fcfc6132.js"><link rel="prefetch" href="/assets/js/67.149ffcbd.js"><link rel="prefetch" href="/assets/js/68.b9e21411.js"><link rel="prefetch" href="/assets/js/69.8c3bf5ab.js"><link rel="prefetch" href="/assets/js/7.deb19429.js"><link rel="prefetch" href="/assets/js/70.d40cd8ec.js"><link rel="prefetch" href="/assets/js/71.78b6ac6e.js"><link rel="prefetch" href="/assets/js/72.83c0af85.js"><link rel="prefetch" href="/assets/js/73.f9aba29e.js"><link rel="prefetch" href="/assets/js/74.6fce7015.js"><link rel="prefetch" href="/assets/js/75.ce14d49d.js"><link rel="prefetch" href="/assets/js/76.41ba6514.js"><link rel="prefetch" href="/assets/js/77.ee9703b0.js"><link rel="prefetch" href="/assets/js/78.47131dc4.js"><link rel="prefetch" href="/assets/js/79.e7e1f94a.js"><link rel="prefetch" href="/assets/js/81.a39968b6.js"><link rel="prefetch" href="/assets/js/82.0369cd98.js"><link rel="prefetch" href="/assets/js/83.e32a508f.js"><link rel="prefetch" href="/assets/js/84.4cb29108.js"><link rel="prefetch" href="/assets/js/85.bc509a47.js"><link rel="prefetch" href="/assets/js/86.cc00737a.js"><link rel="prefetch" href="/assets/js/9.2dbb112c.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.288f53b8.js">
    <link rel="stylesheet" href="/assets/css/0.styles.1aca20b5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/TCMB_logo.svg.png" alt="(ÖHVPS) API İLKE VE KURALLARI" class="logo"> <span class="site-name can-hide">(ÖHVPS) API İLKE VE KURALLARI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/v1.1.0/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable open"><span>SÜRÜM 1.1.0 - Aktif Sürüm</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/v1.1.0/contents/tanim-ve-kisitlamalar.html" class="sidebar-link">1. Tanımlar ve Kısıtlamalar</a></li><li><a href="/v1.1.0/contents/kapsam-ve-dayanak.html" class="sidebar-link">2. Kapsam ve Dayanak</a></li><li><a href="/v1.1.0/contents/temel-prensipler.html" aria-current="page" class="active sidebar-link">3. Temel Prensipler</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-1-genel" class="sidebar-link">3.1 Genel</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-2-istem-cagrı-ve-oturum" class="sidebar-link">3.2.	İstem (Çağrı) ve Oturum</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-3-restful-api" class="sidebar-link">3.3.	RESTful API</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-4-surum-yonetimi" class="sidebar-link">3.4.	Sürüm Yönetimi</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-5-kaynak-uri-yol-yapısı" class="sidebar-link">3.5.	Kaynak URI Yol Yapısı</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-6-karakter-kodlama" class="sidebar-link">3.6.	Karakter Kodlama</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-7-veri-formatı" class="sidebar-link">3.7.	Veri Formatı</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-8-istemci-sertifika-yonetimi" class="sidebar-link">3.8.	İstemci Sertifika Yönetimi</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-9-yetkilendirme-turleri" class="sidebar-link">3.9.	Yetkilendirme Türleri</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-10-istek-cevap-mesajlarında-kullanılan-nesne-yapıları" class="sidebar-link">3.10. İstek/Cevap Mesajlarında Kullanılan Nesne Yapıları</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-11-sayfalandırma-ve-filtreleme" class="sidebar-link">3.11. Sayfalandırma ve Filtreleme</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-12-mesaj-imzalama" class="sidebar-link">3.12. Mesaj İmzalama</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-13-durum-kodu" class="sidebar-link">3.13. Durum Kodu</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-14-gereksinimlerinin-sınıflandırılması" class="sidebar-link">3.14. Gereksinimlerinin Sınıflandırılması</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-15-istek-baslıgı" class="sidebar-link">3.15. İstek Başlığı</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-16-yanıt-baslıgı" class="sidebar-link">3.16. Yanıt Başlığı</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-17-idempotency-kuralları" class="sidebar-link">3.17. Idempotency Kuralları</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-18-http-durum-kodları" class="sidebar-link">3.18. HTTP Durum Kodları</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-19-maskeleme-kuralları" class="sidebar-link">3.19. Maskeleme Kuralları</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-20-fonksiyonel-olmayan-gereksinimler" class="sidebar-link">3.20. Fonksiyonel Olmayan Gereksinimler</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/temel-prensipler.html#_3-21-otomatik-sorgular" class="sidebar-link">3.21. Otomatik Sorgular</a></li></ul></li><li><a href="/v1.1.0/contents/riza-durumlari.html" class="sidebar-link">4. Rıza Durumları</a></li><li><a href="/v1.1.0/contents/gkd.html" class="sidebar-link">5. Güçlü Kimlik Doğrulama</a></li><li><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html" class="sidebar-link">6. Ödeme Emri Başlatma Hizmeti</a></li><li><a href="/v1.1.0/contents/hesap-bilgisi-hizmeti.html" class="sidebar-link">7. Hesap Bilgisi Hizmeti</a></li><li><a href="/v1.1.0/contents/hhs-yos-api.html" class="sidebar-link">8. HHS ve YÖS API</a></li><li><a href="/v1.1.0/contents/erisim-belirteci.html" class="sidebar-link">9. Güçlü Kimlik Doğrulama API</a></li><li><a href="/v1.1.0/contents/olay-bildirim.html" class="sidebar-link">10. Olay Bildirim</a></li><li><a href="/v1.1.0/contents/ekler.html" class="sidebar-link">11. Ekler</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/v1.1.0/deneyalani/genel-bilgiler" class="sidebar-heading clickable"><span>12. Deney Alanı</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><a href="/dijital-cuzdan.html" class="sidebar-link">Dijital Cüzdanlardan TR Karekod ile Ödeme</a></li><li><a href="/surum-yonetimi.html" class="sidebar-link">Sürüm Yönetimi</a></li><li><a href="/uyum-tarihleri.html" class="sidebar-link">ÖHVPS Uyum Tarihleri</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.1/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.1</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.2/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.2</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_3-temel-prensipler"><a href="#_3-temel-prensipler" class="header-anchor">#</a> 3. Temel Prensipler </h1> <p>Bu bölümde Ödeme Hizmetleri Veri Paylaşım Servisleri (Hesap Bilgisi Hizmeti, Ödeme Emri Başlatma Hizmeti) için tanımlanan temel prensipler açıklanmaktadır.</p> <h2 id="_3-1-genel"><a href="#_3-1-genel" class="header-anchor">#</a> 3.1 Genel</h2> <ul><li><p>HHS’ler Yönetmeliğin 59. maddesinin beşinci fıkrası ve Ödeme ve Elektronik Para Kuruluşlarının Bilgi Sistemleri ile Ödeme Hizmeti Sağlayıcılarının Ödeme Hizmetleri Alanındaki Veri Paylaşım Servislerine İlişkin Tebliğin (Tebliğ) 23. maddesinin birinci fıkrası uyarınca, ödeme hizmetleri veri paylaşım servislerini GEÇİT aracılığıyla HBHS ve ÖBHS’ye sunmakla yükümlüdür.</p></li> <li><p>Tebliğin 23. maddesinin ikinci fıkrası uyarınca ödeme emri başlatma hizmetinde açık iletişim servisinin tarafları ÖBHS ile HHS’dir.</p></li> <li><p>Tebliğin 23. maddesinin üçüncü fıkrası uyarınca hesap bilgisi hizmetinde açık iletişim servisinin tarafları HBHS ile HHS’dir.</p></li> <li><p>Yönetmeliğin 60. maddesinin birinci fıkrası uyarınca müşteri, ödeme emri başlatma hizmetini <strong>ödeme hesabının çevrim içi olarak erişilebilir olduğu durumlarda</strong>, kullanmayı tercih edebilir.</p></li> <li><p>Yönetmeliğin 61. maddesinin birinci fıkrası uyarınca müşteri, hesap bilgisi hizmetini <strong>ödeme hesabının çevrim içi olarak erişilebilir olduğu durumlarda</strong>, kullanmayı tercih edebilir.</p></li> <li><p>Tebliğin 25. maddesi uyarınca HHS ve YÖS (ÖBHS ve HBHS) arasında bağlantı uçtan uca güvenli bir şekilde sağlanır. Bu amaçla iletim katmanında TLS (asgari 1.2 sürümü) ile şifreli iletişim sağlanır.</p></li> <li><p>Tebliğin 23. maddesinin dördüncü fıkrası uyarınca HHS tarafından sunulan ödeme hizmetleri veri paylaşım servislerini kullanan yetkilendirilmiş ödeme hizmeti sağlayıcılarının TCMB tarafından ilgili ödeme hizmeti için yetkilendirilmiş olduğu kontrol edilir.</p></li> <li><p>Tebliğin 25. maddesinin beşinci fıkrası uyarınca zaman damgası, 15/1/2004 tarihli 5070 sayılı Elektronik İmza Kanunu kapsamında tanımlanan zaman damgasına dayanır.</p></li> <li><p>API alan isimleri Türkçe olarak tanımlanmıştır. Ancak API başlığı (header) alanındaki alan isimleri özelinde, API Geçitleri tarafından otomatik olarak tanınabilmesi gözetilerek, İngilizce isimlendirme tercih edilmiştir.</p></li> <li><p>ÖHK halihazırda ödeme hesaplarına, çevrim içi (mobil bankacılık, internet bankacılığı vb.) erişebilir durumda ise, HHS'nin varsa Açık Bankacılık kanal veya yetki tanımını varsayılan değeri AÇIK olacak şekilde sunması gerekmektedir. HHS’nin, Bireysel/Kurumsal/Ticari müşteri ayrımı yapmaksızın tüm müşterileri için, çevrim içi kanallarda hesap hareketlerine erişim ve ödeme yapabilme yetkisi bulunması durumunda, yine aynı şekilde Açık Bankacılık kanal veya yetki tanımını da varsayılan değeri AÇIK olacak şekilde sunması gerekmektedir.</p></li> <li><p>5411 Sayılı Kanun kapsamındaki bankalar, HHS API içerisinde Aktif durumda listelenmemişken, YÖS API içerisinde listelenemezler.</p></li></ul> <h2 id="_3-2-istem-cagrı-ve-oturum"><a href="#_3-2-istem-cagrı-ve-oturum" class="header-anchor">#</a> 3.2.	İstem (Çağrı) ve Oturum</h2> <ul><li><p>Her istek tekil istek numarası ve ÖHK’lı işlemler için zaman damgası (PSU-Timestamp) içerir. Birden fazla istek içeren işlem YÖS tarafından belirlenen çağrıya özgü talep kimliği (istek numarası: X-Request-ID) ve rıza sürecine özgü talep kimliği (işlem grup numarası: X-Group-ID) değerleri kullanılmalıdır. Aynı rıza no’ya ait tüm isteklerde aynı X-Group-ID bilgisi değeri gönderilmelidir.</p></li> <li><p>Oturum takibi ise PSU-Session-ID ile yapılır. Oturum numarası (PSU-Session-ID) ÖHK’lı işlemler için zaman damgası (PSU-Timestamp) ile birlikte ilgili tüm işlem verilerini içerecek şekilde kayıt altına alınır.</p></li> <li><p>Örneğin, bir ödeme emri başlatma işlemi birden fazla istekten oluşur. Her istek yukarıda belirtildiği gibi biricik istek numarası ve ÖHK’lı işlemler için zaman damgası (PSU-Timestamp) içerir. Ancak işlemin oturum bütünlüğü PSU-Session-ID ile sağlanır.</p></li> <li><p>Taraflar açtıkları oturumu işlem bütünlüğünü sağlayacak süre içerisinde açık tutar ve işlem biter bitmez kapatır.</p></li></ul> <h2 id="_3-3-restful-api"><a href="#_3-3-restful-api" class="header-anchor">#</a> 3.3.	RESTful API</h2> <p>API’ler, dünya ölçeğinde yaygın bir şekilde kullanılan Temsili Durum Transferi (Representational State Transfer, REST) mimari tarzı ve JavaScript Nesne Notasyonu (JavaScript Object Notation, JSON) veri formatlarına uygun olarak geliştirilir. En üst seviye Veri Tanımlama Dili (Data Description Language) ve en iyi uygulama örnekleri için <a href="http://json-schema.org/" target="_blank" rel="noopener noreferrer">^JSON Şeması<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> temel alınır.</p> <p>İstek ve yanıt mesajlarında, isteğe bağlı veya koşullu bir alan, değer içermiyorsa, bu alan JSON payloadunda yer almamalıdır.</p> <p>Örnek kod bloğu.</p> <div class="language- extra-class"><pre class="language-text"><code>&quot;rzBlg&quot;:{
         &quot;rizaNo&quot;:&quot;aa9bd7e7-0ccd-4edc-9639-5a358dbf2335&quot;,
         &quot;olusZmn&quot;:&quot;2022-11-28T12:00:21+03:00&quot;,
         &quot;gnclZmn&quot;:null,    --&gt; hatalı
         &quot;rizaDrm&quot;:&quot;K&quot;,
         &quot;rizaIptDtyKod&quot;:&quot;&quot; --&gt; hatalı 
      },
</code></pre></div><p>Örnek kod bloğu:</p> <div class="language- extra-class"><pre class="language-text"><code>
         &quot;alc&quot;:{
            &quot;hspNo&quot;: &quot;TR800800004162387689546019&quot;,
            &quot;unv&quot;: &quot;AHMET YILMAZ&quot;, 
            &quot;kolas&quot;:{}  --&gt; nesne gönderimi hatalı
         },
</code></pre></div><h2 id="_3-4-surum-yonetimi"><a href="#_3-4-surum-yonetimi" class="header-anchor">#</a> 3.4.	Sürüm Yönetimi</h2> <p>API sonraki aşamalarda doğabilecek gereksinimleri ve daha karmaşık kullanım durumlarını karşılamak için sürümler halinde geliştirilir ve bu durum tasarım sırasında göz önünde bulundurulur.</p> <p>API v1.0.2 sürümünde ;</p> <ul><li>Kapsamdaki ödeme hesapları : Vadesiz TL, yabancı para hesapları (gerçek ve tüzel kişilere ait ödeme hesapları), Kredili Mevduat Hesabı</li> <li>Tekil ödeme (Virman/Havale/FAST/Müşterilerarası TL Aktarım Sistemi)
<ul><li>Virman ve havale işlemleri kapsamında yabancı para transferi yapılabilir.</li></ul></li> <li>Hesap bilgisi hizmetleri
<ul><li>Temel veya ayrıntılı hesap bilgisi</li> <li>Bakiye</li> <li>Gerçekleşen işlemler için Hesap hareketleri</li></ul></li> <li>Karekodlu ödemelerdeki 01, 02 ve 03 akış türleri
yer almaktadır.</li></ul> <p>API v1.1.0 sürümünde ;</p> <ul><li>API v1.0.2 sürümüne ek Olay Bildirim ve Ayrık GKD özellikleri eklenmiştir. Süreçlerin daha iyi işlemesi için çeşitli güncellemeler yapılmıştır.</li></ul> <p><strong>Her sürüm değişikliğinde bir önceki sürüm belirli bir süre desteklenecektir. Diğer bir ifadeyle, sadece belirli bir süre için mevcut ve bir önceki sürüm aynı anda erişilebilir olacaktır.</strong></p> <h2 id="_3-5-kaynak-uri-yol-yapısı"><a href="#_3-5-kaynak-uri-yol-yapısı" class="header-anchor">#</a> 3.5.	Kaynak URI Yol Yapısı</h2> <p>YÖS’lerin başlattığı çağrılarda URI yolu aşağıdaki yapıyı takip eder:</p> <p><strong>[hhs-yol-ön-eki]/ohvps/ [kaynak-grubu]/ [sürüm]/ [kaynak]/[kaynak-no]/[alt-kaynak]</strong></p> <p>Bu, aşağıdaki unsurlardan oluşur:</p> <ul><li>[hhs-yol-ön-eki]<br>
İsteğe bağlı, HHS'ye özgü yol ön ekini ifade eder.<br>
GEÇİT üzerinden yapılan çağrılarda BKM tarafından belirlenen sistem adı ve yol ön eki kullanılır.</li> <li>ohvps<br>
Sabit metin “ohvps” (Ödeme Hizmetleri Veri Paylaşım Servisleri kısaltması)</li> <li>[kaynak-grubu]<br>
Kaynak grubu, API’ye erişmek için kullanılan ödeme hizmetine (HBH, ÖBH) göre erişim adresi (end point) grubunu tanımlar (“hbh” veya “obh”).</li> <li>[sürüm]<br>
API sürümünü ifade eder (“/s[ana-sürüm].[alt-sürüm]/”).</li> <li>[kaynak]/[kaynak-no]<br>
Kaynak detaylarını ifade eder.</li> <li>[alt-kaynak]<br>
Alt kaynak detaylarını ifade eder.</li></ul> <p>HHS, tüm kaynakları için aynı katılımcı yolu ön ekini ve sistem adını kullanmalıdır.</p> <p>BKM API’lerine erişmek isteyen uygulamaların yetkilerine göre aşağıdaki API’lere abone olmaları gerekmektedir:</p> <p>OBH:<br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/obh/s1.1/odeme-emri-rizasi</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/obh/s1.1/odeme-emri</a><br>
HBH:<br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar/1234/islemler</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar/1234/bakiye</a><br>
GKD<br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/gkd/s1.1/erisim-belirteci</a><br>
HHS – YÖS API<br> <a href="">https://gecit.api-preprod.bkm.com.tr/hhs-api/s1.1/hhs</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/hhs-api/s1.1/hhs/1234</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/yos-api/s1.1/yos</a><br> <a href="">https://gecit.api-preprod.bkm.com.tr/yos-api/s1.1/yos/1234</a></p> <p>HHS’lerin sağlayacakları API’lerdeki URI çevrimi örnekleri aşağıdaki gibidir.</p> <ul><li><a href="">https://xbank.com.tr/api-portal/ohvps/obh/s1.1/odeme-emri</a></li> <li><a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/obh/s1.1/odeme-emri</a> (BKM API)</li> <li><a href="">https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesap-bilgisi-rizasi</a></li> <li><a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi</a> (BKM API)</li> <li><a href="">https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar</a></li> <li><a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar</a>  (BKM API)</li> <li><a href="">https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar/1234</a></li> <li><a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar/1234</a> (BKM API)</li></ul> <p>GEÇİT üzerinden yapılan çağrılarda, istek başlığında bulunan “x-aspsp-code” (isteğin iletildiği Hesap Hizmeti Sağlayıcısının kodu) değerine göre HHS API’de standart olarak tanımlanmış olan “basePath” bilgisine servis uzantısı eklenerek HHS’ye yönlendirme yapılır.</p> <p>Örneğin, istek başlığında <strong>xbank</strong>’ın kodu varsa, YÖS tarafından yapılan<br> <a href="">https://gecit.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi</a><br>
çağrısı GEÇİT tarafından karşılanarak<br> <a href="">https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesap-bilgisi-rizasi</a><br>
adresine yönlendirilir.</p> <p>Bu örnekte, <a href="">https://xbank.com.tr/api-portal</a> basePath bilgisi HHS tarafından HHS API’ye girilen değerdir.</p> <p><strong>ÖNEMLİ :</strong> URI Query parametreleri GET ile iletilirken değerlerde url-encode yapılmalıdır. Örnek bir API isteği;<br>
GET /ohvps/hbh/s1.1/hesaplar/xxx/islemler?hesapIslemBslTrh=2023-02-07T16:42:38%2B03:00&amp;hesapIslemBtsTrh=2023-02-07T17:09:18%2B03:00&amp;srlmKrtr=islGrckZaman&amp;srlmYon=Y&amp;syfKytSayi=10&amp;syfNo=1</p> <p>Burada '+' karakterinin boşluk olarak algılanmaması için %2B değeri ile iletilmiştir.</p> <h2 id="_3-6-karakter-kodlama"><a href="#_3-6-karakter-kodlama" class="header-anchor">#</a> 3.6.	Karakter Kodlama</h2> <p>API istekleri ve yanıtlarının <strong>Başlık</strong> parametrelerinde ISO-8859-1 standartında yer alan karakter kümesi kullanılmalıdır. <a href="#_3-15-istek-basl%C4%B1g%C4%B1">3.15. İstek Başlığı</a> bölümünde detaylandırılmıştır.</p> <p>API istekleri ve yanıtlarında <strong>Gövde</strong> parametrelerinde UTF-8 karakter kodlaması kullanılır. Bu, JSON için varsayılan karakter kodlamasıdır.</p> <p>Ancak, bir HHS'nin kendi uygulamaları ve ödeme başlattığı ödeme sistemi (Havale vb.) bazı UTF-8 karakterlerini kabul etmeyebilir. HHS, UTF-8 kodlaması içeren bir mesajı işleyemez ve reddederse, HTTP 400 (Hatalı İstek) durum kodu ile yanıt vermelidir.</p> <p>Gövde parametrelerinde desteklenen UTF-8 karakter kümesi aşağıda listelenmiştir.</p> <table><thead><tr><th>Karakter</th> <th>UTF 8 <br> Hex.</th> <th>Karakter</th> <th>UTF 8 <br> Hex.</th> <th>Karakter</th> <th>UTF 8 <br> Hex.</th> <th>Karakter</th> <th>UTF 8 <br> Hex.</th></tr></thead> <tbody><tr><td></td> <td>20</td> <td>=</td> <td>3d</td> <td>X</td> <td>58</td> <td>r</td> <td>72</td></tr> <tr><td>!</td> <td>21</td> <td>?</td> <td>3f</td> <td>Y</td> <td>59</td> <td>s</td> <td>73</td></tr> <tr><td>#</td> <td>23</td> <td>@</td> <td>40</td> <td>Z</td> <td>5a</td> <td>t</td> <td>74</td></tr> <tr><td>%</td> <td>25</td> <td>A</td> <td>41</td> <td>[</td> <td>5b</td> <td>u</td> <td>75</td></tr> <tr><td>&amp;</td> <td>26</td> <td>B</td> <td>42</td> <td>\</td> <td>5c</td> <td>v</td> <td>76</td></tr> <tr><td>'</td> <td>27</td> <td>C</td> <td>43</td> <td>]</td> <td>5d</td> <td>w</td> <td>77</td></tr> <tr><td>(</td> <td>28</td> <td>D</td> <td>44</td> <td>^</td> <td>5e</td> <td>x</td> <td>78</td></tr> <tr><td>)</td> <td>29</td> <td>E</td> <td>45</td> <td>_</td> <td>5f</td> <td>y</td> <td>79</td></tr> <tr><td>*</td> <td>2a</td> <td>F</td> <td>46</td> <td>a</td> <td>61</td> <td>z</td> <td>7a</td></tr> <tr><td>+</td> <td>2b</td> <td>G</td> <td>47</td> <td>b</td> <td>62</td> <td>{</td> <td>7b</td></tr> <tr><td>,</td> <td>2c</td> <td>H</td> <td>48</td> <td>c</td> <td>63</td> <td>}</td> <td>7d</td></tr> <tr><td>-</td> <td>2d</td> <td>I</td> <td>49</td> <td>d</td> <td>64</td> <td>Ç</td> <td>c3</td></tr> <tr><td>.</td> <td>2e</td> <td>J</td> <td>4a</td> <td>e</td> <td>65</td> <td>Ö</td> <td>c3</td></tr> <tr><td>/</td> <td>2f</td> <td>K</td> <td>4b</td> <td>f</td> <td>66</td> <td>Ü</td> <td>c3</td></tr> <tr><td>0</td> <td>30</td> <td>L</td> <td>4c</td> <td>g</td> <td>67</td> <td>ç</td> <td>c3</td></tr> <tr><td>1</td> <td>31</td> <td>M</td> <td>4d</td> <td>h</td> <td>68</td> <td>ö</td> <td>c3</td></tr> <tr><td>2</td> <td>32</td> <td>N</td> <td>4e</td> <td>i</td> <td>69</td> <td>ü</td> <td>c3</td></tr> <tr><td>3</td> <td>33</td> <td>O</td> <td>4f</td> <td>j</td> <td>6a</td> <td>Ğ</td> <td>c4</td></tr> <tr><td>4</td> <td>34</td> <td>P</td> <td>50</td> <td>k</td> <td>6b</td> <td>ğ</td> <td>c4</td></tr> <tr><td>5</td> <td>35</td> <td>Q</td> <td>51</td> <td>l</td> <td>6c</td> <td>İ</td> <td>c4</td></tr> <tr><td>6</td> <td>36</td> <td>R</td> <td>52</td> <td>m</td> <td>6d</td> <td>ı</td> <td>c4</td></tr> <tr><td>7</td> <td>37</td> <td>S</td> <td>53</td> <td>n</td> <td>6e</td> <td>Ş</td> <td>c5</td></tr> <tr><td>8</td> <td>38</td> <td>T</td> <td>54</td> <td>o</td> <td>6f</td> <td>ş</td> <td>c5</td></tr> <tr><td>9</td> <td>39</td> <td>U</td> <td>55</td> <td>p</td> <td>70</td> <td></td> <td></td></tr> <tr><td>:</td> <td>3a</td> <td>V</td> <td>56</td> <td>q</td> <td>71</td> <td></td> <td></td></tr> <tr><td>;</td> <td>3b</td> <td>W</td> <td>57</td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <p>Ancak <strong>Erişim belirteci, Yenileme belirteci ve Authorization</strong> parametreleri daha dar bir karakter kümesi ile doldurulmalıdır.</p> <p>Bearer HTTP Authorization Şeması RFC 6750'de tanımlanmıştır. <a href="https://www.rfc-editor.org/rfc/rfc6750#section-2.1" target="_blank" rel="noopener noreferrer">https://www.rfc-editor.org/rfc/rfc6750#section-2.1<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> bölümünde izin verilen karakterlerin gönderilmesi beklenmektedir. Buradaki standartın her 3 parametre için de uygulanmasına karar verilmiştir.</p> <p>RFC 6750 içerisinde bearer token formatı şu şekildedir : 1*( ALPHA / DIGIT / &quot;-&quot; / &quot;.&quot; / &quot;_&quot; / &quot;~&quot; / &quot;+&quot; / &quot;/&quot; ) *&quot;=&quot;<br>
Augmented BNF for Syntax Specifications (ABNF) ile ifade edilen bu formatta token en az 1 adet alfanumerik karakter veya özel karakter (&quot;-&quot;, &quot;.&quot; , &quot;_&quot; , &quot;~&quot; , &quot;+&quot; , &quot;/&quot;)  içermeli ve 0 ya da daha çok sayıda &quot;=&quot; karakteri ile bitmelidir.</p> <p>ALPHA = A-Z / a-z aralığındaki harflerdir.<br>
DIGIT = 0-9 aralığındaki rakamlardır.</p> <h2 id="_3-7-veri-formatı"><a href="#_3-7-veri-formatı" class="header-anchor">#</a> 3.7.	Veri Formatı</h2> <ul><li>Açık bankacılık kapsamındaki zaman damgası, ISO 8601 standartına uygun olarak yerel saat bilgisini ve timezone bilgisini de içerecek şekilde &quot; yyyy-MM-dd’T’HH:mm:ssXXX &quot; formattaki haliyle hazırlanmalıdır.</li></ul> <p>Örnek:  &quot;timestamp&quot;: &quot;2021-05-30T20:34:15+03:00&quot;<br>
yyyy : 4 hane yıl<br>
MM : Başa ‘0’ eklenmiş, toplam 2 hane ay<br>
dd    : Başa ‘0’ eklenmiş, toplam 2 hane gün<br>
HH    : Başa ‘0’ eklenmiş, toplam 2 hane saat (0-23 arası değer alabilir.)<br>
mm : Başa ‘0’ eklenmiş, toplam 2 hane dakika<br>
ss    : Başa ‘0’ eklenmiş, toplam 2 hane saniye<br>
XXX : ISO 8601 Time zone</p> <ul><li><p>Zaman damgası hesaplamalarında, yeni günün başlangıç saatinin 00:00:00 olduğu kabul edilmiştir.</p></li> <li><p>JWT veri paketlerinde kullanılan zaman damgaları, 1 Ocak 1970 Saat 00:00:00 (UTC) anından itibaren geçen saniye sayısı değerini (Unix Time) kullanmalıdır.</p></li> <li><p>Bir HHS, tarihi yanlış biçimlendirilmiş bir istek aldığında, 400 (Hatalı İstek) durum kodu ve ilgili hata kodu ile yanıt vermelidir.</p></li> <li><p>ISO 4217 Standartında para birimleri ve kaç basamak ondalık değer içerebilecekleri belirlenmiştir.<br> <a href="https://www.iso.org/iso-4217-currency-codes.html" target="_blank" rel="noopener noreferrer">https://www.iso.org/iso-4217-currency-codes.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  adresinden ücretsiz olarak listeye erişilebilir. <br>
API Standartlarında da para birimleri  ISO 4217’de tanımlanmış olan 3 harfli kodlarla iletilir. <br> Tüm tutar alanları ISO 4217'de tanımlanmış para birimlerinin ondalık basamak değerleri de göz önünde bulundurularak iletilmelidir. Tutar alanları artı ya da eksi değer alabileceği için API deseninde tanımlanmış regular expressionlar dikkate alınmalıdır.<br>
Örneğin; Bakiye API'sindeki &quot;Kredili Mevduat Hesabı Bakiyesi&quot; alanı &quot;-100.25&quot; ve &quot;Para Birimi&quot; alanı &quot;TRY&quot; olarak iletildiğinde 25 değerinin kuruş olduğu anlaşılmalıdır.<br>
Ödeme Emri Rızası API'sinde yer alan &quot;İşlem Tutarı&quot; alanı &quot;104.75&quot; TRY olarak iletildiğinde &quot;75&quot; değerinin kuruş olduğu anlaşılmalıdır.<br>
&quot;12000&quot; Japon Yeni için, ISO 4217’de JPY para biriminin ondalık kısmı olmadığından &quot;İşlem Tutarı&quot; alanında &quot;12000&quot; ve &quot;Para Birimi&quot; alanında &quot;JPY&quot; değeri  iletilmelidir.</p></li> <li><p>Altın para birimi özelinde ISO 4217’ye uygun olarak &quot;XAU&quot; cinsinde ve 2 basamak ondalık rakam içerecek şekilde iletilmelidir. Örneğin içerisinde &quot;13,50 gr&quot; altın olan hesap için bakiye &quot;13.50&quot;, para birimi &quot;XAU&quot; olarak gönderilmelidir.</p></li> <li><p>Diğer madenlerde ondalık basamak ISO 4217 standartında tanımlandığı gibi olmalıdır.</p></li> <li><p>Sıralı veri tipleri büyük küçük harfe duyarlı olmalıdır.</p></li></ul> <h2 id="_3-8-istemci-sertifika-yonetimi"><a href="#_3-8-istemci-sertifika-yonetimi" class="header-anchor">#</a> 3.8.	İstemci Sertifika Yönetimi</h2> <p>ÖHVPS kapsamında YÖS ve HHS’lerin güvenli bir şekilde tanımlanması amacıyla elektronik sertifikalar kullanılır.</p> <p>ÖHVPS kapsamında tarafların güvenli bir şekilde tanımlaması, uçtan uca güvenli iletişim, mesaj şifreleme ve mesaj imzalama işlevleri 15/1/2004 tarihli ve 5070 sayılı Elektronik İmza Kanunu’nda açıklanan elektronik sertifikalar kullanılarak sağlanır. Elektronik sertifikada Türkiye Cumhuriyet Merkez Bankası tarafından verilen kuruluş kodu ve kuruluşun türüne dair bilgiler bulunur.</p> <p>GEÇİT üzerinden yapılan erişimlerde YÖS ve HHS’lere önceden dağıtılmış olan istemci sertifikaları kullanılarak tarafların (sunucu) kimliklerinin doğrulanması sağlanacaktır. İstemci sertifikaları hem test hem de üretim ortamında kullanılacaktır. Sertifikaların işlevselliği ve geçerliliği sertifikasyon sürecinde de sınanacaktır. Söz konusu sertifikaların dağıtım prosedürleri ve kullanımlara yönelik açıklamalar EK-3’te yer verilmiştir.</p> <h2 id="_3-9-yetkilendirme-turleri"><a href="#_3-9-yetkilendirme-turleri" class="header-anchor">#</a> 3.9.	Yetkilendirme Türleri</h2> <p>GEÇİT üzerinden yapılan çağrılarda iki temel yetkilendirme türü kullanılır:</p> <p><strong>1.	İstemci Kimlik Bilgileri:</strong> Müşteri onayının gerekmediği, sadece YÖS’ün tanımlanıp doğrulandığı API çağrılarında kullanılır. YÖS’ün yetkilendirilmiş olduğu ve faaliyet izninin yaptığı hizmet çağrısına uygun olduğu kontrol edilir.  Bu amaçla, YÖS’lere clientId ve clientSecret tahsis edilecektir. YÖS’ler ilgili clientId ve clientSecret ile sadece yetkilendirilmiş oldukları servislere erişebileceklerdir. YÖS’ler kendilerine BKM tarafından sunulacak API’yi, kendi clientID ve clientSecret değerleri ile sorgulayarak “İstemci Kimlik Bilgileri” belirtecini (access token) elde edeceklerdir.
HHS’ler de GEÇİT üzerindeki YÖS API’sini sorgulama maksadı ile GEÇİT'e geldiklerinde, kendilerine atanmış olan clientID ve clientSecret bilgileri ile yetki kontrolleri yapılır.
HHS’ler kendilerinden alınacak username ve password değerleri kullanılarak oluşturulacak basic authentication metodu ile servislerini sunacaklardır.</p> <p><strong>2.	Yetkilendirme Kodu:</strong> YÖS’ün doğrulanmasının yanısıra müşterinin GKD ile doğrulanması gereken API çağrılarında kullanılır. Müşteri doğrulanarak yetkilendirme kodu oluşturulması HHS’nin yetkilendirme arayüzüne yönlendirilir. GKD’nin başarıyla tamamlanması sonrasında yetkilendirme kodu YÖS’e dönülür. YÖS daha sonra HHS’nin <strong>erişim belirteci</strong> (access token) erişim adresini (EK-3: POST /erisim-belirteci) çağırmak suretiyle yetkilendirme kodunu bir erişim belirteci (access token) ile değiştirerek ilgili kaynakları kullanabilir.</p> <p>Ödeme emri başlatma ve hesap bilgisi hizmetlerinde hangi yetkilendirme türlerinin kullanılacağı bilgisi, ilgili başlıklardaki erişim adresleri (endpoints) tablolarında yer almaktadır.</p> <p><strong>erisim-belirteci</strong> erisim noktasından elde edilen <strong>erisimBelirteci</strong> ilişkilendirildiği nesne veya işlem için gönderilen POST isteği başlığında <strong>x-access-token</strong> alanında iletilir.
Belirli bir süre için tanımlanan erişim belirteci (access token) değerinin yenileme belirteci (refresh token) ile yenilenmesi gerekir.</p> <p>Erişim adreslerinde kullanılan yetkilendirme türü ilgili erişim adresi tablolarında belirtilmiştir.</p> <h2 id="_3-10-istek-cevap-mesajlarında-kullanılan-nesne-yapıları"><a href="#_3-10-istek-cevap-mesajlarında-kullanılan-nesne-yapıları" class="header-anchor">#</a> 3.10. İstek/Cevap Mesajlarında Kullanılan Nesne Yapıları</h2> <p>İstek ve Cevap mesajlarında kullanılacak olan nesneler tüm elemanlarını kapsayacak şekilde Ek-1 de listelenmiştir. Tüm listelenen elemanlar açısından (Uç nokta mesaj yapılarının belirtildiği tablolarda belirtildiği üzere) alanın Zorunlu (z) veya İsteğe Bağlı (İ) olma durumlarına göre bazı alanlar gönderilebilir veya gönderilmeyebilir.</p> <h2 id="_3-11-sayfalandırma-ve-filtreleme"><a href="#_3-11-sayfalandırma-ve-filtreleme" class="header-anchor">#</a> 3.11. Sayfalandırma ve Filtreleme</h2> <p><strong>Sayfalandırma</strong></p> <p>Çağrıya dönülen kaynak nesnesi içerisindeki kayıtlar bir sayfalandırma yapısı ile çağrılacak şekilde istek oluşturulur.</p> <p>Oluşturulacak isteğin içerisinde parametreler ile filtreleme, sayfa başına gösterilecek kayıt sayısı ve hangi sayfanın önyüzde gösterileceği bilgileri erişim noktasına iletilir ve ilgili kayıtlar cevap olarak alınır.</p> <p><strong>Filtreleme</strong></p> <p>HHS, birden çok kayıt dönülmesi gereken GET çağrılarında sınırlı filtreleme desteği sağlamalıdır. Filtre parametreleri her zaman kaynak nesnesinin belirli alanlarına özgüdür ve nesne için tanımlanan kurallara uymalıdır.</p> <h2 id="_3-12-mesaj-imzalama"><a href="#_3-12-mesaj-imzalama" class="header-anchor">#</a> 3.12. Mesaj İmzalama</h2> <p>Elektronik imzalar, ÖHVPS API’de gerçekleştirilen işlemlerin ve taşınan verilerin bütünlük ve inkâr edilemezliğini destekler. İmzaların kaynak bazında hangi istek ve yanıtlara uygulandığı belirlidir.</p> <p>API yalnızca TLS'ye dayanırsa, dijital kayıtları ve inkâr edilemezlik kanıtlarını tutmak zor olur. Bu nedenle, TLS'ye dayanmayan bir inkâr edilemezlik çözümü olarak API isteğinin HTTP başlığında bir JWS kullanılarak sağlanabilir.</p> <p>HTTP isteğinin gövdesinin hash fonksiyonu (SHA256) ile özeti alınacaktır. Elde edilen özet, asimetrik anahtarları destekleyen bir algoritma kullanılarak imzalanacak ve JWS elde edilecektir.</p> <p>Bir istek, YÖS'nin özel anahtarı ile imzalanacak ve bu isteğe karşılık gelen yanıt, HHS'nin özel anahtarı tarafından imzalanacaktır.</p> <p>Tüm API istekleri ve yanıtları imzalanmaz. Mesaj imzalamanın zorunlu olup olmadığı, desteklenip desteklenmediği her API özelinde belirlenir.</p> <p><strong>Anahtar Deposu</strong></p> <p>HHS'ler ve YÖS'ler tarafından güvenilen bir Güven Otoritesi (Trust Anchor), taraflar için bir genel anahtar deposu sağlamaktan sorumludur.</p> <p>Güven Otoritesi, taraflardan herhangi birisinin oluşturduğu bir anahtar çiftinin açık bölümünü saklayan merkezi bir dizin (BKM tarafından tutulan merkezi kayıt sistemi vb.) olacaktır.</p> <p>Mesajları doğrulamak için tarafların genel anahtarlarının paylaşılması için BKM bir servis sağlayacaktır. HHS API olarak adlandırılımış olan bu servis ile HHS ve YÖS listelerine ulaşılabildiği gibi doğrulama işlemi için ihtiyaç duyulacak olan genel anahtarlara da bu servis üzerinden erişilebilinecektir.</p> <p>İlgili Mesaj şifreleme için genel akış, Ek-5 bölümünde detaylarıyla paylaşılmaktadır.</p> <h2 id="_3-13-durum-kodu"><a href="#_3-13-durum-kodu" class="header-anchor">#</a> 3.13. Durum Kodu</h2> <p>API’ler, iki farklı amaca hizmet eden iki durum kodu kullanır:</p> <ul><li>HTTP Durum Kodu, API çağrısının (kaynaktaki HTTP işlemi) sonucunu yansıtır.</li> <li>Bazı kaynak payload’larındaki Durum alanı, kaynakların durumunu yansıtır.</li></ul> <h2 id="_3-14-gereksinimlerinin-sınıflandırılması"><a href="#_3-14-gereksinimlerinin-sınıflandırılması" class="header-anchor">#</a> 3.14. Gereksinimlerinin Sınıflandırılması</h2> <p>Erişim adreslerinin ve alanların kullanımı Zorunlu(Z), İsteğe Bağlı(İ) veya Koşullu(K) olabilir. Kullanımlara ilişkin durumlar ve kullanımın (K) koşullu olduğu duruma ilişkin açıklamalar ilgili tablolarda belirtilmiştir.</p> <p>ÖHVPS API'lerinin (HBH,ÖBH,GKD) istek ve yanıtta kullanılacak başlık isimleri, ilgili RFC dokümanlarında ve aşağıdaki tabloda yer aldığı şekilde kullanılacaktır.  Uygulamaya özelleşmiş başlıklar &quot;X-&quot; ile başlayacaktır. Başlık isimlerinde yer alacak kısaltmalar (örn. PSU, ASPSP gibi) tamamı büyük harfle yazılacak şekilde tanımlanacaktır. Başlık isimleri büyük – küçük harfe duyarlı olmamalıdır. Örneğin x-request-id ya da X-Request-ID olarak gönderilmiş olan bir istek başlığı değişkeni, sunucu tarafında hata vermeyecek şekilde işlenebilmelidir.</p> <h2 id="_3-15-istek-baslıgı"><a href="#_3-15-istek-baslıgı" class="header-anchor">#</a> 3.15. İstek Başlığı</h2> <ul><li>&quot;Başlık isimleri&quot; yorumlanırken küçük büyük harfe duyarlı olmamalıdır. Örneğin &quot;x-ReQuEsT-Id&quot; geçerli bir başlık ismidir.</li> <li>&quot;Başlık değerleri&quot; yorumlanırken ise küçük büyük harf duyarlılığı olmalıdır. Örneğin &quot;xyz123&quot; ile &quot;XYZ123&quot; değerleri farklıdır.</li> <li>Başlık değerlerinde ISO-8859-1 standartında yer alan karakter kümesi kullanılmalıdır. Örneğin &quot;PSU-Device-Data&quot; değerinde &quot;İOS12&quot; yazmak, büyük &quot;İ&quot; harfinin ISO-8859-1 içerisinde yer almamasından dolayı, hataya yol açacaktır.</li> <li>İstek ve Yanıt başlığında yer alan alanların; POST GET DELETE methodlarında, OBH,HBH,GKD,OAS,ODS API'leri bazında Zorunlu/Koşullu/İsteğe Bağlı kullanım durumları aşağıdaki tabloda listelenmiştir.</li></ul> <p><strong>Tablo 2: İstek Başlığında Yer Alan Veriler</strong></p> <table><thead><tr><th>Başlık İsimleri</th> <th>Format</th> <th>Notlar</th> <th>POST</th> <th>GET</th> <th>DELETE</th> <th>POST</th> <th>GET</th> <th>DELETE</th></tr></thead> <tbody><tr><td></td> <td></td> <td></td> <td>OBH<br>HBH<br>GKD</td> <td>OBH<br>HBH<br>GKD</td> <td>OBH<br>HBH<br>GKD</td> <td>OAS<br>ODS</td> <td>OAS<br>ODS</td> <td>OAS<br>ODS</td></tr> <tr><td>X-Request-ID</td> <td>AN1..36</td> <td>İsteği başlatan YÖS tarafından belirlenen çağrıya özgü talep kimliği. İstek numarası. <br> Örnek: Ödeme emri başlatma iş akışının her adımda farklı “x-request-id” değeri kullanılır. <br> Çağrıların aynı yanıtı dönmesinin beklendiği durumlarda (idempotent işlemlerde) aynı değer ile çağrı yapılır.</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td></tr> <tr><td>X-Group-ID</td> <td>AN1..36</td> <td>İsteği başlatan YÖS tarafından belirlenen işlem akışına özgü talep kimliği. İşlem grup numarası.<br> Aynı rıza no’ya ait tüm isteklerde aynı x-group-id bilgisi değeri gönderilmelidir.<br>Örnek: Ödeme emri başlatma/hesap bilgisi iş akışının her adımında aynı “x-group-id” değeri kullanılır.</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>Content-Type</td> <td>AN1..20</td> <td>Standart HTTP Başlığı; Talepte sağlanan payload’ın biçimini temsil eder. Bu değerin application/json olarak gönderilmesi gerekmektedir. Hata durumlarında application/problem+json da iletilebilir.<br> (Başka bir değere ayarlanırsa, HHS, 415 Desteklenmeyen Ortam Türü (Unsupported Media Type) ile yanıt vermelidir)</td> <td>Z</td> <td>-</td> <td>-</td> <td>Z</td> <td>-</td> <td>-</td></tr> <tr><td>X-ASPSP-Code</td> <td>AN4</td> <td>Hesap Hizmeti Sağlayıcısının (HHS) kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td></tr> <tr><td>X-TPP-Code</td> <td>AN4</td> <td>Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td></tr> <tr><td>PSU-Auth-Date</td> <td>ISODateTime</td> <td>ÖHK’nın YÖS üzerinde en son oturum açtığı saat. [RFC7231] Örneğin:  auth-date: Tue, 11 Sep 2012 19:43:31 GMT</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-IP-Address</td> <td>AN7..15</td> <td>ÖHK YÖS üzerinde oturum açmışsa, işlemi başlattığı cihazın IP adresi.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-IP-Port</td> <td>AN1..5</td> <td>ÖHK YÖS üzerinde oturum açmışsa, işlemi başlattığı cihazın Port adresi.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-GEO-Location</td> <td>AN1..36</td> <td>ÖHK’nın işlemi başlattığı cihazın konum bilgisi. RFC2426 standartına uygun olarak paylaşılmalıdır. Örneğin  GEO:&quot;&lt;enlem &gt;, &lt;boylam&gt;GEO:52.506931,13.144558</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-User-Agent</td> <td>AN 1.. 255</td> <td>ÖHK’nın işlemi başlattığı cihazın sağladığı user-agent bilgisi. (Tarayıcı, versiyon, işletim sistemi bilgileri)</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Timestamp</td> <td>ISODateTime</td> <td>ÖHK’nın işlemi başlattığı cihazın tarih saat içeren zaman bilgisi.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Device-ID</td> <td>AN5..40</td> <td>ÖHK işlemi mobil uygulama aracılığıyla başlattıysa, kullanılan mobil uygulama ilk yüklendiğinde oluşturulan tekil cihaz veya uygulama belirteci. ÖHK cihazının UUID değeri kullanılabilir.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Device-Data</td> <td>AN1..1024</td> <td>ÖHK’nın işlemi başlattığı mobil cihaza ait veriler. <br>Örnek alanlar: <br> - Platform - (Android, iOS, Windows 10 Mobile)<br> - Device Model <br> - OS Name <br> - OS Version<br>- Locale<br>- Time zone</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Fraud-Check</td> <td>AN1..4096</td> <td>YÖS'lerin çeşitli güvenlik kontrollerini gerçekleştirerek, önemli görülen aşağıdaki bilgileri HHS'ler ile paylaşmaları gerekmektedir.<br>Bu bilgiler ışığında müşterinin profili oluşturulmasına katkı sağlanacaktır. <br> ÖHK’lı işlemlerde (PSU-Initiated = E gönderildiği durumlarda) gönderilmesi zorunludur.  Sistemsel yapılan API çağrımlarımda, Olay Bildirim Servis Çağrımlarında ve HHS-YÖS API çağrımlarında gönderilmesine gerek bulunmamaktadır.<br> Paylaşılacak bilgiler şu şekildedir.<br> <b>FirstLoginFlag</b> : ÖHK'nın, müşterilik ömründe ilgili YÖS sistemine (mobil ya da web uygulaması) ilk login olma süresini ifade eden değer. ÖHK'nın ilk yaptığı HBH ya da ÖBH işlemi değil, YÖS sisteminde kendini aktifleştirme tarih aralığı bilgisidir. <br> YÖS, kullanıcının ilk login bilgisini tutarak sonraki işlemlerinde bu bilgiyi belirlenen format ile HHS'ye aktaracaktır. Örneğin; YÖS'ün 7 aydır müşterisi olan bir kullanıcı için bu alan &quot;5&quot; olarak YÖS tarafından beslenecektir. Burada amaç; ilgili kullanıcının YÖS'ün eski bir müşterisi mi, yoksa yeni bir müşterisi mi olup olmadığını anlamaktır. <br> Gönderilmesi Zorunlu alandır.<br>TR.OHVPS.DataCode.ZmnAralik sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>DeviceFirstLoginFlag</b> : ÖHK'nın, müşterilik ömründe işlem anında kullandığı cihazla YÖS uygulamasına (web ya da uygulama tabanlı) ilk login olma süresini ifade eden değer. ÖHK cihaz değişikliği yaparsa FirstLoginFlag değeri sabit kalmalı  ancak DeviceFirstLoginFlag değeri değişmelidir. <br>FirstloginFlag değeri ile ÖHK’nın YÖS uygulamasına ilk login tarih bilgisi ile ilgili bilgi verilirken, DeviceFirstLoginFlag ile de ÖHK’nın YÖS uygulamasına farklı bir cihaz aracılığı ile ilk login tarihinin bilgisi verilmektedir.<br> Örneğin; ÖHK 7 aydır YÖS'ün müşterisi olabilir, böyle bir durumda FirstLoginFlag değeri &quot;5&quot; olacaktır. Ancak son işlemini daha önce hiç kullanmadığı bir cihazdan yapmıştır. Yeni cihazdaki login süre aralığı 0-2 saat aralığında  olduğu için DeviceFirstLoginFlag değeri &quot;1&quot; olacaktır.FirstLoginFlag değeri yine &quot;5&quot; olarak kalmaya devam edecektir.Bu bilgi ile YÖS, ilgili HHS'ye ilk kez geliyor olsa bile; HHS, müşterinin YÖS'ü uzun süredir kullandığını ama yeni bir cihazla işlemlerine devam ettiğini anlayabilecektir.<br>Bir ÖHK, farklı cihazlar veya platformlar üzerinden YÖS ile etkileşime girebilir.  Kullanıcı ve YÖS arasında bir oturum başlatılmış ise YÖS’ün tutarlı ve kalıcı bir kimlik (device id) ataması beklenmektedir. <br>Device ID: Web sitesi veya mobil uygulama kullanıcıları için üretilen, tarayıcı ya da mobil uygulama tabanlı benzersiz (tekil) tanımlayıcı değer. Mobil uygulamalar için ÖHK’nın ilk defa ilgili cihaza aktivasyon yaptığı tarih bilgisi alınmalıdır. <br> Device ID bilgileri YÖS uygulama ortamı (web ya da uygulama tabanlı) ve ÖHK cihazı bazında tutulmalıdır. YÖS’ten başlatılan işlem hangi uygulama ortamına ait ise ilgili ortamala ilişkili tutulan Device ID’nin ilk login tarihine bakılarak güncel flag değeri hesaplanmalıdır. <br>Gönderilmesi Zorunlu alandır. TR.OHVPS.DataCode.ZmnAralik sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>LastPasswordChangeFlag</b> : ÖHK'nın, YÖS (cihaz bağımsız)  uygulamasına login olduğu şifre bilgisinin en son değiştirildiği süreyi ifade eden değer. Müşterinin en son ne zaman şifre değişikliği yaptığını anlamak için kullanılan alandır. Yeni müşteri ve hiç şifre değişikliği yapmamış olabilir, böyle bir durumda ilgili alan &quot;0&quot; olarak beslenecektir. <br> Gönderilmesi Zorunlu alandır. TR.OHVPS.DataCode.ZmnAralik sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>BlacklistFlag</b> : ÖHK'nın herhangi bir sebeple YÖS'ün sakıncalı müşteriler listesinde bulunup bulunmadığını ifade eden değer. <br> Burada amaç herhangi bir sebeple YÖS tarafında yasaklı olarak kayıtlı olan ÖHK bilgisinin, dolandırıcılığı önceden tespit etmek amaçlı HHS'ye aktarılması olarak açıklanabilir. Örneğin, YÖS tarafından tespit edilen dolandırıcı kullancılara ait device id bilgisi, bu kara listede tutulur daha sonra aynı cihazla başka bir ÖHK işlem yapacak olsa bile bu alanda ilgili bilgi &quot;1&quot; değeri ile HHS'ye aktarılır. HHS'de olmayıp YÖS tarafında olan bu örnekteki sakıncalı müşteri/cihaz bilgisinin, dolaylı yoldan HHS'ye aktarılması amaçlanmaktadır.<br> Gönderilmesi Opsiyonel alandır. TR.OHVPS.DataCode.VarYok sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>MalwareFlag</b> : YÖS uygulamasının çalıştığı cihaz üzerindeki son 21 güne ait zararlı yazılım tespit bilgisini ifade eden değer.<br>Örneğin ÖHK'nın cihazında zararlı yazılım olduğu ayın 1'inde YÖS tarafından tespit edildi. Zararlı yazılım tespitinden 2 saat sonra YÖS üzerinden login olan ÖHK'nın durumu,  &quot;1&quot; olarak iletilecektir. Bir gün sonra ayın 2'sinde, yeni bir zararlı yazılım tespiti yok ancak mevcut zararlı yazılım aktifse alan &quot;2&quot; değeri ile iletilecektir. Süreler artarak 21 güne kadar TR.OHVPS.DataCode.ZmnAralik değerlerine göre iletilecektir.Son 21 gün içinde yeni bir tespit yoksa ayın 22'sinden itibaren ilgili alan  &quot;0&quot; değeri ile beslenecektir.<br>Not: Zararlı yazılım, bankacılık işlemlerinin yapıldığı uygulamalara girişte kullanılan bilgilerin (şifre, kullanıcı kodu gibi) ele geçirilmesi amacıyla kullanılan bir uygulama ya da kod parçacığı olabilir. Bu amaçlar dışında kullanılan (bankacılığa yönelik bir zararlı yazılım olmayan) yazılım tespitleri iletilmemelidir. YÖS kanallarına her bir loginde, kullanılan cihazda bir zararlı yazılım var mı yok mu kontrolü yapılmalıdır. <br> Gönderilmesi Opsiyonel alandır. TR.OHVPS.DataCode.ZmnAralik sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>AnomalyFlag</b> : Diğer şüpheli durumların varlığını ifade eden değer. Gönderilmesi Opsiyonel alandır. TR.OHVPS.DataCode.VarYok sıralı veri tipinin alabileceği değerleri alabilir.<br> <b>UnsafeAccountFlag</b>: HHS tarafından aktarılan bilgi ile son 21 gün içinde ÖHK'nın dolandırıcılık mağduru olması durumunu ifade eden değer.<br>Örneğin; HHS 1, ayın 1'inde süphe veya sahtekarlık nedeniyle bir ödeme işlemine izin vermediği durumda, bu bilgiyi rıza iptal detay kodu ile YÖS'e aktarmış olur. Bu bilgiyi tutan YÖS, ilgili müşterinin 15 dakika sonra HHS 2'de yaptığı işlem için ilgili alanı &quot;1&quot; değeri ile besler. Böylece HHS 2, ÖHK'nın farklı bir HHS'de son 15 dakika içinde şüpheli veya sahte bir işlemi olduğunu anlayabilecektir. Ayın 22'sinde yeni bir tespit/kayıt yoksa bu alan YÖS tarafından &quot;0&quot; olarak beslenecektir.<br>Gönderilmesi Opsiyonel alandır.TR.OHVPS.DataCode.ZmnAralik sıralı veri tipinin alabileceği değerleri alabilir. <br><br> <br> Flaglar JWT claims içine key value şeklinde eklenerek gönderilecektir. EK-5: Mesaj İmzalama Akışı'nda belirtilen yöntemle imzalanarak oluşturulan JWT PSU-Fraud-Check alanına konularak YÖS'ler tarafından HHS'ye iletilmelidir.</td> <td>K</td> <td>K</td> <td>Z</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Initiated</td> <td>AN1</td> <td>İşlemin ÖHK tarafından başlatılması durumunda E , sistem tarafından başlatıldığı durumda H değerini alması beklenir. <br>Olay bildirim servislerinin çağrımında O gönderilmelidir. <br> İşlemler servisinde yapılacak sistemsel sorgulardaki işlem limitlerini kontrol amacıyla kullanılır.</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>PSU-Session-ID</td> <td>AN1..100</td> <td>İsteği başlatan YÖS tarafından belirlenen oturuma özgü talep kimliği. ÖHK'nın YÖS uygulaması üzerinden kimlik doğrulama mekanizması ile bilgi sistemlerine dâhil olmalarından işlemlerini tamamlayıp sistemden ayrılmalarına kadar geçecek tüm süreci kapsayacak şekilde aynı değeri almalıdır. Tek seferlik ödeme gibi ÖHK’nın tanınmadan başlatıldığı işlemlerde bu değer boş olarak iletilmelidir.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>Authorization</td> <td>AN1..4096</td> <td>Katılımcı ile GEÇİT arasındaki otorizasyon için kullanılan token bilgisidir. <br>Yekilendirme türlerinden İstemci Kimlik Bilgileri’ni adresler. <br> <a href="#_3-6-karakter-kodlama">Bölüm 3.6 Karakter Kodlama</a> bölümünde açıklanan karakter formatında gönderilmesi beklenmektedir.</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td> <td>Z</td></tr> <tr><td>X-Access-Token</td> <td>AN1..4096</td> <td>ÖHK’nın GKD sürecinde doğrulanması sonrasında kullanılan erişim simgesi. Yetkilendirme türlerinden Yetkilendirme Kodu (GKD)’nu adresler. <br><a href="#_3-6-karakter-kodlama">Bölüm 3.6 Karakter Kodlama</a> bölümünde açıklanan karakter formatında gönderilmesi beklenmektedir.</td> <td>İ</td> <td>İ</td> <td>İ</td> <td>-</td> <td>-</td> <td>-</td></tr> <tr><td>X-JWS-Signature</td> <td>AN1..4096</td> <td>Payload gövdesinin ayrılmış bir JWS imzasını içeren üstbilgi.<br> Bu başlığın ne zaman belirtilmesi gerektiği hususu ilgili endpoint için belirtilmiştir.<br> Mesaj imzalama kullanılan API ve methoda göre gönderimi zorunludur.</td> <td>K</td> <td>K</td> <td>K</td> <td>K</td> <td>-</td> <td>-</td></tr></tbody></table> <h2 id="_3-16-yanıt-baslıgı"><a href="#_3-16-yanıt-baslıgı" class="header-anchor">#</a> 3.16. Yanıt Başlığı</h2> <ul><li>&quot;Başlık isimleri&quot; yorumlanırken küçük büyük harfe duyarlı olmamalıdır. Örneğin &quot;x-ReQuEsT-Id&quot; geçerli bir başlık ismidir.</li> <li>&quot;Başlık değerleri&quot; yorumlanırken ise küçük büyük harf duyarlılığı olmalıdır. Örneğin &quot;xyz123&quot; ile &quot;XYZ123&quot; değerleri farklıdır.</li> <li>Başlık değerlerinde ISO-8859-1 standartında yer alan karakter kümesi kullanılmalıdır. Örneğin &quot;Link&quot; değerinde &quot;İOS12&quot; yazmak, büyük &quot;İ&quot; harfinin ISO-8859-1 içerisinde yer almamasından dolayı, hataya yol açacaktır.</li></ul> <p><strong>Tablo 3: Yanıt Başlığında Yer Alan Veriler</strong></p> <table><thead><tr><th>Başlık İsimleri</th> <th>Format</th> <th>Notlar</th> <th>Kullanım Durumu <br>OBH<br>HBH<br>GKD</th> <th>Kullanım Durumu<br> OAS<br>ODS</th></tr></thead> <tbody><tr><td>X-Request-ID</td> <td>AN1..36</td> <td>YÖS tarafından belirlenen çağrıya özgü talep kimliği. İstek numarası <br> <strong>İlgili istek başlığındaki bilgi geri dönülür.</strong></td> <td>Z</td> <td>Z</td></tr> <tr><td>X-Group-ID</td> <td>AN1..36</td> <td>İsteği başlatan YÖS tarafından belirlenen işlem akışına özgü talep kimliği. İşlem grup numarası.<br><strong>İlgili istek başlığındaki bu değer geri dönülür.</strong></td> <td>Z</td> <td>-</td></tr> <tr><td>X-ASPSP-Code</td> <td>AN4</td> <td>Hesap Hizmeti Sağlayıcısının (HHS) kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td> <td>Z</td> <td>Z</td></tr> <tr><td>X-TPP-Code</td> <td>AN4</td> <td>Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur</td> <td>Z</td> <td>Z</td></tr> <tr><td>Content-Type</td> <td>AN1..20</td> <td>Standart HTTP Başlığı; Talepte sağlanan payload’ın biçimini temsil eder: <strong>application/json</strong></td> <td>Z</td> <td>Z</td></tr> <tr><td>X-JWS-Signature</td> <td>AN1..4096</td> <td>JWS imzasını içeren üstbilgi. Bu başlığın hangi yanıtlar için kullanılması gerektiği ilgili endpoint için belirtilmiştir. <br>Hata durumlarında, yanıt gövdesi değeri dönülüyor ise imzalanmalı ve imza bilgisi x-jws-signature alanında iletilmelidir.<br> Ancak uygulama katmanı tarafından yakalanamayan dolayısı ile imzalanamayan hata durumlarında x-jws-signature alanı HHS'ler tarafından boş gönderilebilir.</td> <td>K</td> <td>K</td></tr> <tr><td>X-RateLimit-Limit</td> <td>N 1..18</td> <td>İstek kısıtı uygulanan servislerde en fazla kaç adet istek yapılabileceğini gösterir. Kısıt uygulanan servislerde bu başlığın dönmesi zorunludur.</td> <td>K</td> <td>-</td></tr> <tr><td>X-RateLimit-Remaining</td> <td>N 1..18</td> <td>İstek kısıtı uygulanan servislerde kaç adet istek hakkı kaldığını gösterir. Kısıt uygulanan servislerde bu başlığın dönmesi zorunludur.</td> <td>K</td> <td>-</td></tr> <tr><td>X-RateLimit-Reset</td> <td>AN 1..255</td> <td>İstek kısıtı uygulanan servislerde çağrım hakkı bittikten sonra yeniden denemeden önce beklemesi gereken süreyi (saniye cinsinden) gösterir. HTTP 429 durum kodu (Too Many Requests) ile dönülen yanıtların başlığında dönülmesi zorunludur.<br> YÖS olarak yaptığınız sistemsel sorgularda; HTTP 429 durum kodu (Too Many Requests) ile dönülen yanıt aldığınızda tekrar sorgu yapmadan önce “X-RateLimit-Reset” yanıt başlığını kontrol ederek, bu başlıktaki süre kadar bekledikten sonra yeniden sorgulama yapılması gerekmektedir.</td> <td>K</td> <td>-</td></tr> <tr><td>x-total-count</td> <td>N 1..18</td> <td>Hesaplar, İşlemler, Bakiye, İletilemeyen Olaylar servislerinde sayfalama kullanıldığı durumda, sorgu sonucu dönecek toplam kayıt sayısı bilgisi, bu alanda HHS isteğine bağlı olarak gönderilebilir. <br> Kayıt sayısı 0 olduğu durumda gönderimi zorunludur.</td> <td>K</td> <td>K</td></tr> <tr><td>Link</td> <td>1..4096</td> <td>“Link” alanının <a href="/v1.1.0/contents/hesap-bilgisi-hizmeti.html#hesap-bilgisi-hizmeti-icin-erisim-adresleri">Hesap Bilgisi Hizmeti için Erişim Adresleri</a> <br> tablosundaki parametre  = Sayfalama olan API’lerde ve İletilemeyen Olaylar API'sinde gönderim yapılması zorunludur.<br> Sayfalama yapısı kullanıldığında gelen yanıtta birden fazla sayfa var ise; önceki, sonraki, ilk, son sayfalara gitmek için gerekli referanslar link headerında aşağıdaki örnekteki gibi doldurulabilir. <br>x-total-count alanının gönderimi kayıt sayısı 0 olduğu durum dışında isteğe bağlı olduğu için; Link içerisindeki son sayfa bilgisi  (last) isteğe bağlı hale getirilmiştir. “Önceki”( prev) ve “Sonraki” (next) adımlarının uygun olan her durumda yer alması zorunludur.<br>İlk sayfada “Önceki” seçeneği olmamalı, son sayfada ise “Sonraki” seçeneği olmamalıdır. <br><br> <strong>&lt;/ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&amp;hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&amp;srlmKrtr=islGrckZaman&amp;srlmYon=Y&amp;syfNo=6&amp;syfKytSayi=100&gt;; rel=&quot;next&quot;,<br> &lt;/ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&amp;hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&amp;srlmKrtr=islGrckZaman&amp;srlmYon=Y&amp;syfNo=4&amp;syfKytSayi=100&gt;; rel=&quot;prev&quot;,<br> &lt;/ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&amp;hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&amp;srlmKrtr=islGrckZaman&amp;srlmYon=Y&amp;syfNo=14&amp;syfKytSayi=100&gt;; rel=&quot;last&quot;,<br> &lt;/ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&amp;hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&amp;srlmKrtr=islGrckZaman&amp;srlmYon=Y&amp;syfNo=0&amp;syfKytSayi=100&gt;; rel=&quot;first&quot;</strong> <br><br> Hiç hesap hareketinin olmadığı durumda dönen yanıt başlığınızın şu şekilde olması beklenmektedir.<br> Response body:<br>[]<br>Response header:<br>Link: &lt;/ohvps/hbh/s1.1/hesaplar?srlmKrtr=hspRef&amp;srlmYon=A&amp;syfNo=1&amp;syfKytSayi=100&gt;; rel=&quot;last&quot;,&lt;/ohvps/hbh/s1.1/hesaplar?srlmKrtr=hspRef&amp;srlmYon=A&amp;syfNo=1&amp;syfKytSayi=100&gt;; rel=&quot;first&quot;<br> x-total-count alanı da 0 olarak iletilmelidir.</td> <td>K</td> <td>K</td></tr></tbody></table> <h2 id="_3-17-idempotency-kuralları"><a href="#_3-17-idempotency-kuralları" class="header-anchor">#</a> 3.17. Idempotency Kuralları</h2> <p>YÖS’ün aşağıdaki durumlarda aynı istek numarası (x-request-id) ve aynı veri gövdesiyle çağrıyı tekrarlaması; HHS’nin de bu durumlarda aynı yanıtı dönmesi gereklidir.</p> <ul><li>HHS’nin yanıtı kesinti/arıza nedeniyle YÖS’e ulaşmaz ve zaman aşımı söz konusu olması,</li> <li>ÖHK, YÖS uygulaması üzerinden çift tıklama ile mükerrer defa HHS API’lerini çağırılması,
(API kontrollerinden önce YÖS uygulamasının, çift tıklama kontrolü yapması önerilmektedir.)</li> <li>YÖS, yanıt almasına rağmen işleyemeden kaybedilmesi,</li></ul> <p>durumlarında HHS aşağıdaki kuralları işletir:</p> <ul><li>HHS gelen istek numarasını ve veri gövdesini birleştirerek checksum değeri üretir.<br>
chesksum değeri x-request-id|request.body ‘nin hash algoritmalarından (CRC32,MD5 vb)  geçirilerek üretilebilir.</li> <li>HHS bu checksum değeri ile YÖS’e dönmüş olduğu yanıtı 5 dk boyunca saklar.  Saklama yöntemi olarak veri tabanı veya önbellek araçları kullanılabilir.</li> <li>YÖS aynı istek numarası ve aynı veri gövdesi ile yeni bir çağrı yaptığında, aynı checksum değeri üretileceği için 5dk boyunca bu değere karşılık gelen yanıtı döner.</li> <li>5 dk sonrasında istek numarası veya veri gövdesi değişmemiş olsa dahi bu HHS tarafından yeni istek olarak kabul edilir.</li></ul> <p>Aşağıdaki Public Post işlemleri için bu kural setinin işletilmesi gerekmektedir:</p> <p>1- Ödeme emri rızası oluşturma<br>
2- Erişim belirteci oluşturma<br>
3- Ödeme emri<br>
4- Hesap bilgisi rızası oluşturma</p> <h2 id="_3-18-http-durum-kodları"><a href="#_3-18-http-durum-kodları" class="header-anchor">#</a> 3.18. HTTP Durum Kodları</h2> <p>RFC 2616'da belirlenmiş olan durum kodları (status code) gönderilen isteğin durumunu YÖS’a standart bir şekilde ifade eder. Eğer bir hata varsa hatayı, gönderilen istek başarılı bir şekilde işlem gördüyse ona ilişkin durumu aktarır. Durum kodları genel olarak 5 kategoridedir.</p> <ul><li>1xx Bilgi</li> <li>2xx Başarılı</li> <li>3xx Yönlendirme</li> <li>4xx İstemci Hatası</li> <li>5xx Sunucu Hatası</li></ul> <p><strong>errorCode Alanında Kullanılabilecek Sıralı Hata Tipleri :</strong></p> <blockquote><p><strong>TR.OHVPS.Resource</strong></p> <blockquote><p><strong>⇨	InvalidFormat</strong><br> <strong>⇨	ConsentMismatch</strong><br> <strong>⇨	NotFound</strong><br> <strong>⇨	InvalidSignature</strong><br> <strong>⇨	MissingSignature</strong><br> <strong>⇨	MethodNotAllowed</strong><br> <strong>⇨	NotAcceptable</strong><br> <strong>⇨	UnsupportedMediaType</strong><br> <strong>⇨	ConsentRevoked</strong></p></blockquote></blockquote> <blockquote><p><strong>TR.OHVPS.Business</strong></p> <blockquote><p><strong>⇨	InvalidContent</strong><br> <strong>⇨	InvalidAccount</strong></p></blockquote></blockquote> <blockquote><p><strong>TR.OHVPS.Connection</strong></p> <blockquote><p><strong>⇨	InvalidCertificate</strong><br> <strong>⇨	ExceededRate</strong><br> <strong>⇨	InvalidTPP</strong><br> <strong>⇨	InvalidASPSP</strong><br> <strong>⇨	InvalidToken</strong><br> <strong>⇨	InvalidTPPRole</strong></p></blockquote></blockquote> <blockquote><p><strong>TR.OHVPS.Server</strong></p> <blockquote><p><strong>⇨	InternalError</strong><br> <strong>⇨	ServiceUnavailable</strong></p></blockquote></blockquote> <p>TR.OHVPS.Resource.InvalidFormat hatası alındığı durumda; fieldErrors nesnesi içerisinde verilecek hata kodları :</p> <blockquote><p><strong>TR.OHVPS.Field</strong></p> <blockquote><p><strong>⇨	Missing</strong><br> <strong>⇨	Invalid</strong></p></blockquote></blockquote> <p><strong>Veri Tipi Örneği:</strong></p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d8bd4e5f-f094-48a6-aee1-3a800e2709d9&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:33:15+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Validation error&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Şema kontrolleri başarısız&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fieldErrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;objectName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odemeEmriRizasiIstegi&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odmBsltm.islTtr.prBrm&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;messageTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boş değer olamaz&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;must not be null&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Field.Missing&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;objectName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odemeEmriRizasiIstegi&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odmBsltm.kmlk.kmlkVrs&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;messageTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boyut '1' ile '30' arasında olmalı&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;size must be between 1 and 30&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Field.Invalid&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.InvalidFormat&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><strong>Tablo 4: HTTP Durum Kodları</strong></p> <table><thead><tr><th>HTTP Durum</th> <th>İstek Sonucu ve Açıklamalar</th> <th>POST</th> <th>GET</th> <th>DELETE</th></tr></thead> <tbody><tr><td>200 OK</td> <td><strong>İstek Başarıyla Tamamlandı.</strong><br>Kaynak güncellemek için yapılan (örneğin, GET) ve başarıyla tamamlanan isteklerinde kullanılır.</td> <td>H</td> <td>E</td> <td>H</td></tr> <tr><td>201 Created</td> <td><strong>İstek Başarılı Oldu.</strong><br>Kaynak yaratma isteği (örneğin, POST /ödeme-emri-rizasi) başarıyla sonuçlandı.</td> <td>E</td> <td>H</td> <td>H</td></tr> <tr><td>204 No Content</td> <td><strong>Silme işlemi başarıyla tamamlandı.</strong><br>Kaynak silme isteği (örneğin, <strong>DELETE /hesap-rizasi/{RizaNo}</strong>) başarıyla sonuçlandı.</td> <td>H</td> <td>H</td> <td>E</td></tr> <tr><td>400 Bad Request</td> <td><strong>İstekte bozuk, eksik veya uyumlu olmayan JSON gövdesi, URL parametreleri veya başlık alanları var.</strong> İstekle başlatılan işlem yapısal bozukluk, eksik veya tutarsız veri veya HHS tarafındaki kontrollerin hatalı sonuçlanması nedeniyle hata ile sonuçlanır ve hataya ilişkin veriler hata nesnesi içerisinde dönülür.</td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>401 Unauthorized</td> <td><strong>Yetkilendirme başlığı eksik, hatalı veya geçersiz olduğundan istek yetkilendirilmediğinde ve erişim reddedildiğinde http 401 kodu dönülmelidir.</strong></td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>403 Forbidden</td> <td><strong>Erişim belirtecinin veya rızanın kapsamı uyuşmuyor.</strong><br>YÖS bir hesaba/işlem kaynağına erişmeye çalışır ve YÖS, istenen kaynağa erişmek için geçerli izinlere sahip bir rızası yoktur. <br>Örneğin; hesap bilgisi rızası bakiye izni almamıştır ancak /bakiyeler adresinden istekte bulunmuştur.</td> <td></td> <td></td> <td></td></tr> <tr><td>404 Not Found</td> <td>**HHS geçerli bir API erişim adresini sağlamıyorsa, o URL'ye gelen istekler için 404 (Bulunamadı) ile yanıt vermelidir.**YÖS, uygulama esaslarında tanımlanmayan bir kaynak için bir URL'ye erişmeye çalışırsa (örneğin, GET /yurtdisi-odeme), HHS, 404 (Bulunamadı) ile yanıt vermeyi seçebilir.</td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>405 Method Not Allowed</td> <td><strong>YÖS, desteklenmeyen bir yöntemle kaynağa erişmeye çalıştı.</strong></td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>406 Not Acceptable</td> <td><strong>İstek, geçersiz bir karakter kümesi içeriyor.</strong></td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>415 Unsupported Media Type</td> <td><strong>İstek gövdesi hedef kaynakta bu yöntem tarafından desteklenmeyen bir biçimde oluşturulduğu için işlem reddedildi</strong></td> <td>E</td> <td>H</td> <td>H</td></tr> <tr><td>429 Too Many Requests</td> <td><strong>Belirli bir süre içinde çok fazla talepte bulunulduğu için işlem reddedildi.</strong> HHS’ler adil kullanım politikalarını aşan talepleri kısıtlayabilir.</td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>500 Internal Server Error</td> <td><strong>API sunucu / servis katmanında sorun oluştu. İşlem başarısız.</strong><br> 5XX hata durumlarında yanıt gövde değeri olmadığı için mesaj imzalama yapılamaz ve x-jws-signature alanı boş olarak iletilir.<br> Bu durumda x-jws-signature kontrolü yapılmamalıdır.</td> <td>E</td> <td>E</td> <td>E</td></tr> <tr><td>503 Service Unavailable</td> <td><strong>Hizmet sürümü kullanımdan kaldırıldı.</strong> Bir API'nin kullanımdan kaldırıldığı ve artık bir HHS tarafından operasyonel olarak desteklenmediği durumlarda, URI yolu hala etkin olabilir ve API isteklerini kabul edebilir.  Bu durumda, YÖS'ün API sürümünün çevrimdışı olduğunun farkında olması için 503 Hizmet Kullanılamıyor dönmesi önerilir.</td> <td>E</td> <td>E</td> <td>E</td></tr></tbody></table> <p><strong>Hata Örnekleri:</strong></p> <p><ins><strong>400 Bad Request</strong></ins></p> <p><strong>TR.OHVPS.Business.InvalidContent</strong> hatası HHS tarafından yapılacak iş kuralı kontrollerinin başarısız olduğu durumda verilmelidir.<br> <strong>TR.OHVPS.Resource.InvalidFormat</strong> hatası şema validasyonu, alan uzunluk ve varlık kontrollerinin başarısız olduğu durumda verilmelidir.</p> <div class="language-JSON extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7f115b9c-d7c2-4a2a-bc45-5a9891c79072&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:47:57+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Validation error&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Şema kontrolleri başarısız&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fieldErrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;objectName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odemeEmriRizasiIstegi&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odmBsltm.alc.unv&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;messageTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boyut '3' ile '140' arasında olmalı&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;size must be between 3 and 140&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Field.Invalid&quot;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token property">&quot;objectName&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odemeEmriRizasiIstegi&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;odmBsltm.islTtr.ttr&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;messageTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;boş değer olamaz&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;must not be null&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Field.Missing&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.InvalidFormat&quot;</span>
<span class="token punctuation">}</span> 

</code></pre></div><p>Zorunlu header alanlarından biri ya da birkaçı eksik olarak gönderilirse aşağıdaki gibi bir hata dönüşü gerçekleşebilir.</p> <p>HHS uygulaması tarafından dönülebilecek hata örnekleri:</p> <div class="language-JSON extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2005515d-f0e6-4a07-a439-0ef3b0f56011&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:39:26+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Validation error&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Şema kontrolleri başarısız&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.InvalidFormat&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;fieldErrors&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>         
            <span class="token property">&quot;field&quot;</span><span class="token operator">:</span> <span class="token string">&quot;X-Request-ID&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;messageTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;X-Request-ID değeri boş olamaz.&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;X-Request-ID cannot be null.&quot;</span><span class="token punctuation">,</span>
            <span class="token property">&quot;code&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Field.Invalid&quot;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span> 

</code></pre></div><p>Business hata örneği - 1:</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;677cfd9d-77c1-4ea3-8bdf-74a6e9887177&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:05:59+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;gonUnvan wrong&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Gönderen Ünvan hatalı&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Business.InvalidContent&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p>Business hata örneği - 2:</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;5df3b402-3aca-4305-a35b-5af0f3184b40&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:06:47+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Sender account is disabled or not found.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Gonderen hesap aktif değil veya bulunamadı.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Business.InvalidAccount&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p>GEÇİT'te yapılan zorunlu header kontrollerinde aşağıdaki hatalar dönebilir:</p> <div class="language-JSON extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:40:28+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d4375748-6fc7-4f7e-94f3-6411cab1d59f&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Geçersiz HHS kodu.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Connection.InvalidASPSP&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Invalid ASPSP Code&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p>GEÇİT tarafından dönülecek hata örneği:</p> <div class="language-JSON extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:40:28+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;d4375748-6fc7-4f7e-94f3-6411cab1d59f&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Geçersiz HHS kodu.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Connection.InvalidTPP&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Invalid TPP Code&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">400</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bad Request&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p>GEÇİT tarafından dönülecek hata örneği:</p> <div class="language-JSON extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:14:05+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/hbh/s1.1/hesap-bilgisi-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ee1e3ea7-a5e5-468b-bb02-314148f84e6a&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Geçersiz yös rolü. İlgili api çağrısı için yetkisi yok.&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Connection.InvalidTPPRole&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Invalid TPP Role&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Forbidden&quot;</span>
<span class="token punctuation">}</span> 

</code></pre></div><p><ins><strong>401 Unauthorized</strong></ins></p> <p><strong>YÖS, süresi dolmuş bir erişim belirteci kullandığında, HHS 401 (Yetkisiz) http kodu ile aşağıdaki hata kodunu dönmelidir.</strong> Aşağıdaki nedenlerden herhangi biri nedeniyle bir Erişim Belirtecinin süresi dolduğunda bu durum ortaya çıkabilir:</p> <ul><li>Rızanın süresi doldu (Son Kullanma Tarihi geçti)</li> <li>Erişim Belirtecinin şüpheli kullanımı veya sahtekarlık şüphesi</li> <li>Rızada belirlenen gün sayısının aşımı
Bu hata, müşteriden doğru izinlerle yeniden kimlik doğrulaması isteyerek çözülebilir.</li></ul> <div class="language-json extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/gkd/s1.1/erisim-belirteci&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;ed3fd667-fc58-40ad-a982-e8937faccd15&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:17:33+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">401</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Unauthorized&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Refresh token expired or not found in database&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Yenileme belirteci zaman aşımına uğramış veya veri tabanında yok&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Connection.InvalidToken&quot;</span>
<span class="token punctuation">}</span> 
 

</code></pre></div><p><ins><strong>403 Forbidden</strong></ins></p> <p>Örn; YÖS yetkisi olmayan rol(ÖBH/HBH) ile işlem yapmaya çalıştığı durumda 403 hatası alarak işleme devam edemez.</p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/hbh/s1.1/bakiye&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3e48ea98-f889-48b9-aa6e-28aabc6cfb14&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:20:05+03:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">403</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Forbidden&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Forbidden&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Bakiye Bilgileri için ÖHK izni bulunmamaktadır.&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.Forbidden&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><ins><strong>404 Not Found</strong></ins></p> <p>Örn; GET /odeme-emri-rizasi/123456 çağrısı durumunda 123456 geçerli bir ödeme kaynağı değilse, HHS, 404 koduyla cevap vermelidir.</p> <div class="language-JSON extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi/123456&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;22f52b2d-d442-4a6a-8f39-d23eba45a34b&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T10:53:53+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">404</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Not Found&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Resource not found&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.NotFound&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Kaynak bulunamadı&quot;</span>
<span class="token punctuation">}</span> 

</code></pre></div><p><ins><strong>405 Method Not Allowed</strong></ins></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3e5c6b28-7ee4-4469-b541-843fb4a94eec&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:35:10+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">405</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Method Not Allowed&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Method not allowed&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.MethodNotAllowed&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;İstek yapılan URL için izin verilmeyen metot&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><ins><strong>406 Not Acceptable</strong></ins></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;3e5c6b28-7ee4-4469-b541-843fb4a94eec&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:35:10+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">406</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Not Acceptable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Not Acceptable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.NotAcceptable&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Kabul edilmedi&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><ins><strong>415 Unsupported Media Type</strong></ins></p> <p>İstek başlığında content-type, JSON dışında bir veri iletilirse bu hata verilebilir.</p> <div class="language-json extra-class"><pre class="language-json"><code>
<span class="token punctuation">{</span>
    <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;63cc94b6-1b51-4648-9671-95e6e2e7e03d&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:37:12+03:00&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">415</span><span class="token punctuation">,</span>
    <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Unsupported Media Type&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Content type not supported&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Resource.UnsupportedMediaType&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Desteklenmeyen içerik tipi’&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><ins><strong>429 Too Many Requests</strong></ins></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/hbh/s1.1/hesaplar/aef6061f-2978-4bb4-980d-b4c634c8055b/islemler&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;20473c5f-2f4f-4b2e-8b66-7978aec442f7&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T00:21:07+03:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">429</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Too Many Requests&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Exceeded rate&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Erişim sıklığı limiti aşımı&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Connection.ExceededRate&quot;</span>
<span class="token punctuation">}</span> 
</code></pre></div><p><ins><strong>500 Internal Server Error</strong></ins></p> <div class="language-json extra-class"><pre class="language-json"><code><span class="token punctuation">{</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1b90c6dc-0277-4755-8b05-9297ddfab743&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/obh/s1.1/odeme-emri-rizasi&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-22T11:41:34+03:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Internal Server Error&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Unexpected condition was encountered.&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Beklenmeyen bir durumla karşılaşıldı.&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Server.InternalError&quot;</span>
<span class="token punctuation">}</span> 

</code></pre></div><p><ins><strong>503 Service Unavailable</strong></ins></p> <div class="language-json extra-class"><pre class="language-json"><code>
  <span class="token property">&quot;timestamp&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2022-12-20T23:18:56+03:00&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;/ohvps/hbh/s1.1/hesap-bilgisi-rizasi/2a72678ee3d24de2be47887e4903a8c6&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;e76315b7-09f4-4295-b6d8-1f7fec632159&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformationTr&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HHS şu anda hizmet veremiyor.&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;errorCode&quot;</span><span class="token operator">:</span> <span class="token string">&quot;TR.OHVPS.Server.ServiceUnavailable&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;moreInformation&quot;</span><span class="token operator">:</span> <span class="token string">&quot;HHS is currently unavailable&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpCode&quot;</span><span class="token operator">:</span> <span class="token number">503</span><span class="token punctuation">,</span>
  <span class="token property">&quot;httpMessage&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Service Unavailable&quot;</span>

</code></pre></div><h2 id="_3-19-maskeleme-kuralları"><a href="#_3-19-maskeleme-kuralları" class="header-anchor">#</a> 3.19. Maskeleme Kuralları</h2> <p>Maskeli olarak iletilmesi gereken verilerin maskeleme kuralları şu şekildedir:</p> <ul><li>IBAN verileri Hesap Numarası : İlk 4 ve son 4 karakteri açık, diğer karakterler maskeli olmalıdır. Örnek: TR54******************4812</li> <li>Ad-Soyadı / Ticari Unvan : Her kelimenin ilk 2 karakteri açık, sonraki karakterler yerine 4 adet ‘<em>’ karakteri konumlandırılmalıdır.
Örneğin: “FATİH SERKAN EREN” ifadesi “FA</em>*** SE**** ER****” şeklinde gösterilmelidir.</li> <li>Tabela Unvanı : Her kelimenin ilk 2 karakteri açık, sonraki karakterler yerine 4 adet '<em>' karakteri konumlandırılmalıdır. Örneğin “BANKALARARASI KART MERKEZİ ANONİM ŞİRKETİ” ifadesi “BA</em>*** KA**** ME**** AN**** Şİ****” şeklinde gösterilmelidir.</li> <li>YÖS’ten girilen alıcı unvan ve IBAN bilgileri ödeme emri rızası ve ödeme emri yanıtında açık dönülür, Kolas akışında ödeme emri rızası yanıtı ve ödeme emri istek ve yanıtında maskeli taşınır.</li></ul> <h2 id="_3-20-fonksiyonel-olmayan-gereksinimler"><a href="#_3-20-fonksiyonel-olmayan-gereksinimler" class="header-anchor">#</a> 3.20. Fonksiyonel Olmayan Gereksinimler</h2> <ul><li><p>HHS’lerin sunuyor oldukları servisleri en fazla 3000 ms içinde yanıt dönecek şekilde tasarlamalıdır.</p></li> <li><p>HHS'ler mevcut online işlem kanallarından sundukları erişilebilirlik ve performans kriterlerinden daha düşük bir hizmet kalitesi sunmamalıdır.</p></li> <li><p>HHS’lerin sunuyor oldukları servislere sistemin güvenlik ve sürekliliğini sağlamak adına rate limit koyma ihtiyaçları olur ise, standartlar ve ihtiyaçlara uygun şekilde bir konfigürasyon yapabilirler. <br></p></li> <li><p>HHS rate limit tanımı uyguluyor ise; YÖS'ler arasında ayrım yapmadan, adil ve makul sınırlar dahilinde uygulamalıdır.   <br></p></li> <li><p>YÖS tarafından kullanıcının başlatmadığı otomatik sorgu limitleri <strong>3.21 Otomatik Sorgular</strong> bölümünde detaylandırılmıştır. HHS'lerin bu servisler için minimumda cevap vermesi gereken sorgu sayıları belirlenmiştir. Bu sayıların üzerinde yapılan servis çağrısına yanıt dönmek HHS inisiyatifindedir. Diğer taraftan kullanıcının başlattığı istekler için uygulanacak limitler, HHS'nin online işlem kanallarından sunulan sorgu limitlerinden daha az olmamalıdır.</p></li> <li><p>HHS'ler, çağrım limitlerini aşan istekler için HTTP 429 - Too Many Request hatasını dönmelidir. Örnek hata mesajı <strong>3.18 HTTP Durum Kodları</strong> bölümünde bulunmaktadır. Rate Limit özelinde tanımlanmış parametreler olan X-RateLimit-Limit, X-RateLimit-Remaining ve X-RateLimit-Reset alanları da  <strong>3.16 Yanıt Başlığı</strong> bölümünde açıklanmıştır. YÖS'ler de HHS'nin belirlediği rate limit kurallarına uymakla yükümlüdür.</p></li></ul> <h2 id="_3-21-otomatik-sorgular"><a href="#_3-21-otomatik-sorgular" class="header-anchor">#</a> 3.21. Otomatik Sorgular</h2> <p>YÖS uygulaması, ÖHK'nın başlattığı işlemler neticesinde API çağrımı yapabileceği gibi, sistemsel bir şekilde otomatik API çağrımı da yapabilir.<br>
HHS, API çağrımının ÖHK'lı ya da ÖHK'sız olduğunu istek parametreleri içerisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre “E” ise ÖHK’lı, “H” ise sistemsel yapılmış bir sorgu anlamına gelmektedir.</p> <p>ÖHK YÖS uygulamasına giriş yaptığı andan çıkış yaptığı ana kadar yani ÖHK oturumu boyunca yapılan API çağrımlarında, PSU-Initiated  değerinin &quot;E&quot; olması gerekmektedir.  YÖS uygulamasında ÖHK oturumu boyunca,  ÖHK'nın bilgilerinden minimumda &quot;bakiye&quot; bilgisinin, uygulama arayüzlerinde güncel değeri ile online sorgularla gösterimi YÖS'ün insiyatifindedir.</p> <p>ÖHK’nın başlattığı sorgular için HHS tarafından belirlenen üst rate limitler dahilinde çağrım yapılabilir.</p> <p>YÖS, aşağıdaki API'leri sistemsel bir şekilde çağırabilir.<br>
HHS'lerin bu servisler için minimumda cevap vermesi gereken sorgu sayıları belirlenmiştir. Bu sayıların üzerinde yapılan servis çağrısına yanıt dönmek HHS inisiyatifindedir.<br>
HHS tarafından izin verilen sorgu sayısının üzerinde yapılan bir sorgu için HTTP 429 durum kodu (Too Many Requests) hatası dönülmelidir. Yanıt gövdesinde tekrar hata nesnesinin oluşturulması HHS inisiyatifindedir. <br>HHS yanıt headerı alanında iletilecek X-RateLimit-Reset (saniye cinsinden) değeri kadar süre sonunda
YÖS'ün tekrar sorgulama yapması beklenmektedir.</p> <table><thead><tr><th>No</th> <th>Kaynak</th> <th>HTTP işlemi</th> <th>Erişim Adresi</th> <th>Otomatik Sorgu Sayısı</th></tr></thead> <tbody><tr><td>1</td> <td>erisim-belirteci</td> <td>POST</td> <td>/erisim-belirteci</td> <td>---</td></tr> <tr><td>2</td> <td>odeme-emri-rizasi</td> <td>GET</td> <td>/odeme-emri-rizasi/{rizaNo}</td> <td>Rıza bazında günde 4</td></tr> <tr><td>3</td> <td>odeme-emri</td> <td>GET</td> <td>/odeme-emri/{odemeEmriNo}</td> <td>Rıza bazında günde 24</td></tr> <tr><td>4</td> <td>hesap-bilgisi-rizasi</td> <td>GET</td> <td>/hesap-bilgisi-rizasi/{RizaNo}</td> <td>Rıza bazında günde 4</td></tr> <tr><td>5</td> <td>hesap-bilgisi-rizasi</td> <td>DELETE</td> <td>/hesap-bilgisi-rizasi/{RizaNo}</td> <td>---</td></tr> <tr><td>6</td> <td>hesaplar</td> <td>GET</td> <td>/hesaplar</td> <td>Bireysel günde 4<br> Kurumsal günde 4</td></tr> <tr><td>7</td> <td>hesaplar</td> <td>GET</td> <td>/hesaplar/{hspRef}</td> <td>Bireysel günde 4<br>Kurumsal günde 4</td></tr> <tr><td>8</td> <td>bakiye</td> <td>GET</td> <td>/hesaplar/{hspRef}/bakiye</td> <td>Bireysel günde 24<br>Kurumsal ÖHK - günde 24</td></tr> <tr><td>9</td> <td>bakiye</td> <td>GET</td> <td>/bakiye</td> <td>Bireysel günde 24<br>Kurumsal ÖHK - günde 24</td></tr> <tr><td>10</td> <td>islemler</td> <td>GET</td> <td>/hesaplar/{hspRef}/işlemler</td> <td>Bireysel günde 4<br>Kurumsal ÖHK - saatte 12</td></tr></tbody></table> <p>YÖS ve HHS son 24 saat içerisindeki sorgu sayılarını toplayarak elde ettiği sonuçlarla limit kontrolü yapmalıdır (Pencere yöntemi).</p> <p>İşlemler servisinin çağrım detaylarına <a href="/v1.1.0/contents/hesap-bilgisi-hizmeti.html#_7-8-adim-3-5-ve-3-6-islemlerin-sorgulanması">^Bölüm 7.8</a> üzerinden ulaşılabilir.</p> <p>Hesap bilgisi rızasının YÖS tarafından otomatik bir şekilde iptal edilmesi durumu <a href="/v1.1.0/contents/erisim-belirteci.html">^Bölüm 9'da</a> açıklanmıştır.</p> <p><strong>Olay Bildirim Servis Çağrımları</strong> <br>
Olay bildirime bağlı servis çağrımlarında (PSU-Initiated=O), yapılan her isteğe HHS'nin yanıt vermesi gereklidir. Otomatik sorgularda uygulanan üst limitler, olay bildirim servislerinde geçerli değildir. <br>
Olay bildirim servislerini kullanmak istemeyen YÖS'ler otomatik sorguları kullanarak sistemlerini güncellemeye devam edebilirler.</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/v1.1.0/contents/kapsam-ve-dayanak.html" class="prev">
        2. Kapsam ve Dayanak
      </a></span> <span class="next"><a href="/v1.1.0/contents/riza-durumlari.html">
        4. Rıza Durumları
      </a>
      →
    </span></p></div> <div class="footer-wrapper"><footer class="page-edit footer"><div class="footer-info"><p style="padding-right:15px;">© Tüm hakları saklıdır.</p></div></footer></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.93076482.js" defer></script><script src="/assets/js/8.7b64f4e3.js" defer></script><script src="/assets/js/5.84780e47.js" defer></script><script src="/assets/js/4.1766b0b6.js" defer></script><script src="/assets/js/80.33d749d2.js" defer></script>
  </body>
</html>
