<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>6.	Ödeme Emri Başlatma Hizmeti | (ÖHVPS) API İLKE VE KURALLARI</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.4cb6486d.css" as="style"><link rel="preload" href="/assets/js/app.4b4fd2a6.js" as="script"><link rel="preload" href="/assets/js/12.a5734c1f.js" as="script"><link rel="preload" href="/assets/js/2.6760484d.js" as="script"><link rel="preload" href="/assets/js/5.83a11720.js" as="script"><link rel="prefetch" href="/assets/js/10.2793f3a3.js"><link rel="prefetch" href="/assets/js/11.cbf67b8f.js"><link rel="prefetch" href="/assets/js/13.e89d2d1e.js"><link rel="prefetch" href="/assets/js/14.68c0f1bf.js"><link rel="prefetch" href="/assets/js/15.2a42c49e.js"><link rel="prefetch" href="/assets/js/16.1e0d6369.js"><link rel="prefetch" href="/assets/js/17.ff35525f.js"><link rel="prefetch" href="/assets/js/18.e633f9de.js"><link rel="prefetch" href="/assets/js/19.e0227e7d.js"><link rel="prefetch" href="/assets/js/20.c48a140b.js"><link rel="prefetch" href="/assets/js/21.ac296008.js"><link rel="prefetch" href="/assets/js/22.ab93ffa7.js"><link rel="prefetch" href="/assets/js/23.f9fd744f.js"><link rel="prefetch" href="/assets/js/24.66311ad9.js"><link rel="prefetch" href="/assets/js/25.d2d1ac7e.js"><link rel="prefetch" href="/assets/js/26.005d6d1c.js"><link rel="prefetch" href="/assets/js/27.f0840892.js"><link rel="prefetch" href="/assets/js/28.9a20fe78.js"><link rel="prefetch" href="/assets/js/29.71ada298.js"><link rel="prefetch" href="/assets/js/3.a4d67d2e.js"><link rel="prefetch" href="/assets/js/30.b778ad28.js"><link rel="prefetch" href="/assets/js/31.bb78115f.js"><link rel="prefetch" href="/assets/js/32.24e2b602.js"><link rel="prefetch" href="/assets/js/33.b4f2f026.js"><link rel="prefetch" href="/assets/js/34.2c08aeea.js"><link rel="prefetch" href="/assets/js/35.bc3c3cdd.js"><link rel="prefetch" href="/assets/js/36.ddc388a9.js"><link rel="prefetch" href="/assets/js/37.9a9642a9.js"><link rel="prefetch" href="/assets/js/38.0845325c.js"><link rel="prefetch" href="/assets/js/39.ca2fb7cd.js"><link rel="prefetch" href="/assets/js/4.7737490c.js"><link rel="prefetch" href="/assets/js/40.5f9c0c85.js"><link rel="prefetch" href="/assets/js/6.b161c38a.js"><link rel="prefetch" href="/assets/js/7.c6f5ea2f.js"><link rel="prefetch" href="/assets/js/8.2d8da0ec.js"><link rel="prefetch" href="/assets/js/9.34e46cb1.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4cb6486d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/TCMB_logo.svg.png" alt="(ÖHVPS) API İLKE VE KURALLARI" class="logo"> <span class="site-name can-hide">(ÖHVPS) API İLKE VE KURALLARI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/v1.1.0/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable open"><span>SÜRÜM 1.1.0 - TASLAK </span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/v1.1.0/contents/tanim-ve-kisitlamalar.html" class="sidebar-link">1. Tanımlar ve Kısıtlamalar</a></li><li><a href="/v1.1.0/contents/kapsam-ve-dayanak.html" class="sidebar-link">2. Kapsam ve Dayanak</a></li><li><a href="/v1.1.0/contents/temel-prensipler.html" class="sidebar-link">3. Temel Prensipler</a></li><li><a href="/v1.1.0/contents/riza-durumlari.html" class="sidebar-link">4. Rıza Durumları</a></li><li><a href="/v1.1.0/contents/gkd.html" class="sidebar-link">5. Güçlü Kimlik Doğrulama</a></li><li><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html" aria-current="page" class="active sidebar-link">6. Ödeme Emri Başlatma Hizmeti</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-1-adim-0-odeme-emri-baslatma-istegi" class="sidebar-link">6.1.	ADIM 0 - Ödeme Emri Başlatma Isteği</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-2-adim-1-odeme-emri-rızasının-hazırlanması" class="sidebar-link">6.2.	ADIM 1 - Ödeme Emri Rızasının Hazırlanması</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-3-adim-2-odeme-emri-rızasının-yetkilendirilmesi" class="sidebar-link">6.3.	ADIM 2- Ödeme Emri Rızasının Yetkilendirilmesi</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-4-adim-2-1-odeme-emri-rızasının-sorgulanması-istege-baglı" class="sidebar-link">6.4.	ADIM 2.1 – Ödeme Emri Rızasının Sorgulanması (isteğe bağlı)</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-5-adim-3-odeme-emrinin-olusturulması" class="sidebar-link">6.5.	ADIM 3- Ödeme Emrinin Oluşturulması</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-6-adim-3-1-odeme-emri-sorgusu-istege-baglı" class="sidebar-link">6.6.	ADIM 3.1- Ödeme Emri Sorgusu (İsteğe bağlı)</a></li><li class="sidebar-sub-header"><a href="/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html#_6-7healthcheck-api" class="sidebar-link">6.7	Healthcheck API</a></li></ul></li><li><a href="/v1.1.0/contents/hesap-bilgisi-hizmeti.html" class="sidebar-link">7. Hesap Bilgisi Hizmeti</a></li><li><a href="/v1.1.0/contents/hhs-yos-api.html" class="sidebar-link">8. HHS ve YÖS API</a></li><li><a href="/v1.1.0/contents/erisim-belirteci.html" class="sidebar-link">9. Erişim Belirteci API</a></li><li><a href="/v1.1.0/contents/ekler.html" class="sidebar-link">10. Ekler</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.2/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.2 </span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.1/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.1</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/surum-yonetimi.html" class="sidebar-link">Sürüm Yönetimi</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_6-odeme-emri-baslatma-hizmeti"><a href="#_6-odeme-emri-baslatma-hizmeti" class="header-anchor">#</a> 6.	Ödeme Emri Başlatma Hizmeti</h1> <p>Ödeme emri başlatma işlemi havale, FAST ya da PÖS ödemesiyle sonuçlanabilir. Ödeme işleminin amacı kişiden kişiye para transferi, e-ticaret ödemesi gibi farklı ödeme türleri olabilir. Ödemenin amacına göre ÖBHS’nin ileteceği veri setinde farklılaşmalar olabilir.</p> <p>Ödeme Emri Başlatma Hizmeti 5 temel akışdan oluşur:</p> <ol start="0"><li><strong>Ödeme Emri Başlatma İsteğinin tetiklenmesi:</strong> ÖHK ÖBHS mobil uygulama ya da websitesinden ödeme emrini başlatır.</li> <li><strong>Ödeme Emri Rıza Hazırlanması:</strong> ÖBHS, “Ödeme Emri Başlatma” işlemi için izin oluşturulması isteğini HHS’ye iletir.</li> <li><strong>Ödeme Emri Rızasının Yetkilendirilmesi:</strong> HHS, gerekli gördüğü durumlarda ÖHK’yı GKD ile doğrular ve ödeme emri rızasına erişim için erişim belirteci tanımlanmasını temin eder.</li> <li><strong>Ödeme Emrinin Başlatılması:</strong> ÖBHS, “ödeme emri”ni HHS’ye iletir.</li> <li><strong>Ödeme Emri Rıza Durumu, Ödeme Emri Durumu, Ödeme Emri Detayı Sorguları:</strong> ÖBHS, Ödeme Emri Rıza Durumu, Ödeme Emri Durumu, Ödeme Emri Detayı bilgilerini isteğe bağlı olarak sorgulayabilir.</li></ol> <p><img src="/assets/img/OdmemeEmriBaslatmaHizmetiUstDuzeyIsAkisi.0d3f6ca3.png" alt="Odeme Emri Baslatma Hizmeti Ust Düzey İş Akışı"></p> <p><strong>Şekil 4: Ödeme Emri Başlatma Hizmeti Üst Düzey İş Akışı</strong></p> <h3 id="odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"><a href="#odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints" class="header-anchor">#</a> Ödeme Emri Başlatma Hizmeti için Erişim Adresleri (Endpoints)</h3> <p>Ödeme Emri Başlatma Hizmeti İçin Erişim Adreslerinin Etki Alanı (Scope) = “odeme_emri” olarak belirtilmelidir.</p> <p><strong>Tablo 6: Ödeme Emri Başlatma Hizmeti İçin Erişim Adresleri</strong></p> <table><thead><tr><th>No</th> <th>Kaynak</th> <th>HTTP işlemi</th> <th>Erişim Adresi</th> <th>Zorunlu / İsteğe Bağlı</th> <th>Yetkilendirme Türü</th> <th>İmzalama</th> <th>İstem Nesnesi</th> <th>Yanıt Nesnesi</th></tr></thead> <tbody><tr><td>1</td> <td>odeme-emri-rizasi</td> <td>POST</td> <td>/odeme-emri-rizasi</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı İstek ve Yanıt</td> <td>OdemeEmriRizasiIstegi</td> <td>OdemeEmriRizasi</td></tr> <tr><td>2</td> <td>erisim-belirteci (GKD için)</td> <td>POST</td> <td>/erisim-belirteci</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı İstek ve Yanıt</td> <td>ErisimBelirteciIstegi</td> <td>ErisimBelirteci</td></tr> <tr><td>2.1</td> <td>odeme-emri-rizasi</td> <td>GET</td> <td>/odeme-emri-rizasi/{rizaNo}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı Yanıt</td> <td>-</td> <td>OdemeEmriRizaYaniti</td></tr> <tr><td>3</td> <td>odeme-emri</td> <td>POST</td> <td>/odeme-emri</td> <td>Z</td> <td>İstemci Kimlik Bilgileri &amp; Yetkilendirme Kodu (GKD)</td> <td>İmzalı İstek ve Yanıt</td> <td>OdemeEmriIstegi</td> <td>OdemeEmri</td></tr> <tr><td>3.1</td> <td>odeme-emri</td> <td>GET</td> <td>/odeme-emri/{odemeEmriNo}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri &amp; Yetkilendirme Kodu (GKD)</td> <td>İmzalı Yanıt</td> <td>-</td> <td>OdemeEmri</td></tr></tbody></table> <h2 id="_6-1-adim-0-odeme-emri-baslatma-istegi"><a href="#_6-1-adim-0-odeme-emri-baslatma-istegi" class="header-anchor">#</a> 6.1.	ADIM 0 - Ödeme Emri Başlatma Isteği</h2> <ul><li>ÖHK, ÖBHS uygulamasında (web arayüzü/mobil uygulama) ödeme emri başlatma işlemine onay verir.</li> <li>Gönderen hesap detaylarının bu aşamada belirtilmesi zorunlu değildir.</li></ul> <h2 id="_6-2-adim-1-odeme-emri-rızasının-hazırlanması"><a href="#_6-2-adim-1-odeme-emri-rızasının-hazırlanması" class="header-anchor">#</a> 6.2.	ADIM 1 - Ödeme Emri Rızasının Hazırlanması</h2> <img src="/assets/img/OdemeEmriRizasininHazirlanmasi.255b636e.png" width="75%"> <p><strong>Şekil 5: Ödeme Emri Rızasının Hazırlanması</strong></p> <ul><li><p>ÖBHS, ödeme hizmeti kullanıcı hesabının bulunduğu HHS’ye bağlanarak ödeme emri rıza kaynağının oluşturulmasını (odemeEmriRizasi) sağlar.</p></li> <li><p>POST isteği TLS protokolü tesis edilen iletişim katmanı üzerinden gerçekleştirilir. TLS için nitelikli sertifikalar kullanılır.</p></li> <li><p>POST isteğinin başlığındaki alanlar ve istemcinin sertifikasındaki özel alanlar kullanılarak istemcinin yetkilendirilmesi sağlanır:</p> <ul><li>İstekte bulunan ÖBHS yetkilendirilmiş mi?</li> <li>İstekte bulunan yetkilendirilmiş ödeme hizmeti sağlayıcısı ÖBHS rolüne sahip mi?</li> <li>İstekte bulunulan HHS kodu doğru mu?</li></ul></li> <li><p>POST başarılı olursa, HHS, ödeme emri için içeride rıza olup olmamasına bakılmaksızın yeni bir rıza tanımlayıcısı RizaNo içeren odemeEmriRizasi  yanıt olarak döner.</p></li> <li><p>1 ÖHK'nın 1 YÖS için 1HHS'de istediği kadar rızası olabilir.</p></li> <li><p>HHS tarafında RizaDurumu değişkeninin durumu “Yetki Bekleniyor” olarak güncellenir.</p></li> <li><p>YÖS’ün doğrulama ekranı olarak ÖHK’ya açacağı URL adresini de ilgili rıza numarasına göre oluşturur. Burada 2 farklı yöntemle URL oluşturabilir.</p> <ul><li><strong>Statik URL</strong> :<br>
HHS’nin base pathi/alt-dizin/{rızaNo}<br>
Örnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a<br>
Bu adres için ilgili doğrulama sayfası önden hazırlanmalı ve ÖHK’nın doğrulama sayfasına erişimi için yayınlanmış olmalıdır (publish edilmelidir).</li> <li><strong>Dinamik URL</strong>:<br>
HHS’nin base pathi/alt-dizin/GKD Karşılama Ekranı?rizano={rızano}<br>
Örnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a</li></ul></li></ul> <p><strong>POST /odeme-emri-rizasi</strong></p> <p>İSTEK:</p> <p>ÖBHS, bu API erişim adresinden HHS’ye yeni bir OdemeEmriRizasi oluşturulması için istekte bulunur:</p> <ul><li>ÖBHS, ödeme emri başlatma isteği olduğunu HHS’ye bildirir.</li> <li>ÖBHS, ÖHK’nın, ÖBHS arayüzünden verdiği rızanın (“Ön Onay”) bir kopyasının HHS nezdinde müşteri tarafından onaylanması için HHS’ye gönderilmesini sağlar.</li> <li>HHS; istek mesajında yer alan alanların ÖHVPS API İlke ve Kuralları dökümanında belirtilen şartları sağlayacak şekilde zorunluluk, uzunluk ve içerik kontrollerini yapar. (Zorunlu)</li> <li>HHS; YÖS API ile alınan ÖBHS bilgilerinin içerisinde yer alan yönlendirme ve bildirim adresleri ile ödeme emri rızası nesnesi request mesajında paylaşılan adreslerin uyumlu olup olmadığının kontrollerini yapar. (Zorunlu)</li> <li>HHS; kimlik bilgileri nesnesinde eğer kimlik bilgileri iletilmiş ise; bu veri ile ÖHK’nın HHS müşterisi olup olmadığının kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal ÖHK’lar için yapılmalıdır.  (Koşullu Zorunlu)</li> <li>HHS kimlik bilgisi ile gönderen unvanının uyumlu olduğunun kontrol eder. HHS'ler EFT/FAST işlemlerinde kabul ettikleri kontrol kriterleri ile işleme izin verebilirler. (Zorunlu)</li> <li>Gönderen Hesap Numarası ile ilgili Tablo7’de belirtilen kontroller yapılmalıdır. (Zorunlu)</li> <li>HHS, ödeme için benzersiz “RizaNo” ile “OdemeEmriRizasi” nesnesi oluşturur ve ÖBHS’ye döner.</li> <li>HHS, OdemeEmriRizasi oluşturduğu anda durumunu “Yetki Bekleniyor” olarak düzenler.<br>
Bu aşamada ÖHK’nın HHS tarafından tanımlanmış ve isteğin veri alanında gönderen hesaba (borçlandırılacak hesaba) ilişkin bir bilgisinin olması gerekmez.<br>
Hesap bakiye kontrolünün rıza aşamasında yapılmaması gerekmektedir. Çünkü ÖHK ödeme emri gerçekleşene kadar hesabına para eklemesi yapabilir.</li></ul> <p><strong>POST /odeme-emri-rizasi</strong> isteğinin (REQUEST) gövdesinde (BODY)  “odemeEmriRizasiIstegi” nesnesi (Tablo-7) kullanılır. İstek başarıyla sonuçlanırsa HHS kaynak sunucusunda “odemeEmriRizasi” (Tablo-8) nesnesi oluşturulur.</p> <p><strong>Tek Seferlik Ödeme</strong><br>
Tek seferlik ödeme akışı YÖS'ten HHS'ye giden istekte, gönderen kimlik bilgilerinin olmadığı durumda gerçekleşir. Gönderen kimlik bilgisi olmadığında, KOLAS sorgusu yapılamayacağından ötürü, HHS tarafından TR.OHVPS.Business.InvalidContent hatası dönülmelidir.<br>
Tek seferlik ödeme akışı hem işyeri ödemelerinde hem de kişiden kişiye para transferlerinde kullanılabilen bir akıştır.
Aşağıdaki senaryolar tek seferlik ödemeye örnek olarak gösterilebilir.<br>
İşyeri Ödemesi akışı örneği: Bir e-ticaret sitesinde, üye olmadan alışveriş yapılması ve ödemenin YÖS tarafından kimlik bilgisi olmadan başlatılması<br>
Kişiden kişiye para transferi akışı örneği: QR veya diğer yöntemler ile alıcı bilgilerinin gönderici ile paylaşılması ve YÖS üzerinden gönderici bilgileri olmadan alıcıya para transferi yapılması için rıza verilmesi</p> <h4 id="basarili-istek"><a href="#basarili-istek" class="header-anchor">#</a> <strong>BAŞARILI İSTEK:</strong></h4> <p><strong>Tablo 7: “OdemeEmriRizasiIstegi” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format: Veri modeli İsmi</th> <th>Zorunlu / Koşullu / İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından ödeme emri rızası oluşturulması sırasında yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td><strong>Katılımcı Bilgisi</strong></td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td> <td></td></tr> <tr><td><strong>&gt;Hesap Hizmeti Sağlayıcısı Kodu</strong></td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td> <td>HHS, hhsKod’un kendisine ait olduğunu ve istek başlığındaki x-aspsp-code değeri ile aynı olduğunu kontrol eder. <br>Hata durumunda <strong>TR.OHVPS.Connection.InvalidASPSP</strong> hata kodunu döner.</td></tr> <tr><td><strong>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</strong></td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur.</td> <td>HHS, yosKod’un geçerli bir Ödeme Hizmeti Sağlayıcısı Kodu olduğunu ve istek başlığındaki x-tpp-code değeri ile aynı olduğunu kontrol eder. Hata durumunda <strong>TR.OHVPS.Connection.InvalidTPP</strong> hata kodunu döner.</td></tr> <tr><td><strong>GKD</strong></td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Yetkilendirme Yöntemi</strong></td> <td>yetYntm</td> <td>AN1</td> <td>İ</td> <td><strong>TR.OHVPS.DataCode.GkdTur</strong> sıralı veri türü değerlerinden birini alır. Yetkilendirme yöntemi, ÖBHS tarafından belirtilmeyebilir.</td> <td>HHS, ÖBHS’nin belirlediği yöntemi dikkate alarak kendi belirlediği yöntemi kullanır.</td></tr> <tr><td><strong>&gt; Yönlenme Adresi</strong></td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli güçlü kimlik doğrulama için zorunlu.<br> YÖS’ün ileteceği adrestir.<br> YÖS Yönlendirmeli GKD yöntemi ile akışı destekliyorsa, yetYntm değişkeninden bağımsız olarak yönlendirme adresini iletmelidir.<br> Durum kodu(drmKod), yönlendirme adresine parametre olarak eklenmelidir.</td> <td>HHS, müşteri uygulama / tarayıcısını bu alanda belirtilen adrese yönlendirir.</td></tr> <tr><td><strong>&gt; Bildirim Adresi</strong></td> <td>bldAdr</td> <td>AN1..1024</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu. YÖS’ün ileteceği adrestir.<br> YÖS Ayrık GKD yöntemi ile akışı destekliyorsa, yetYntm değişkeninden bağımsız olarak bildirim adresini iletmelidir.<br> Durum kodu(drmKod), yönlendirme adresine parametre olarak eklenmelidir.</td> <td>HHS, ayrık GKD sonrası bu alanda belirtilen adrese otorizasyon kodunu (authentication code) iletir.</td></tr> <tr><td><strong>Ödeme Başlatma</strong></td> <td>odmBsltm</td> <td>Kompleks: OdemeBaslatma</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Kimlik</strong></td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Kimlik Türü</strong></td> <td>kmlkTur</td> <td>AN1</td> <td>K</td> <td><strong>TR.OHVPS.DataCode.KimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td> <td>Çerçeve sözleşme kapsamındaki ödemelerde kullanımı zorunludur.<br>HHS geçerli bir Kimlik Numarası Türü olduğunu kontrol eder.<br>Kurum adına yapılan (ticari) ödemelerde, kurum adına işlem yapan kullanıcının kimlik türünün bu alanda gönderilmesi zorunludur.</td></tr> <tr><td><strong>&gt;&gt; Kimlik Verisi</strong></td> <td>kmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır.<br><strong>TR.OHVPS.DataCode.KimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td> <td>Çerçeve sözleşme kapsamındaki ödemelerde kullanımı zorunludur.<br>HHS, ÖBHS tarafından iletilmesi durumunda Kimlik Verisi üzeriden çapraz kontroller uygulamalı ve Kimlik Verisini temel alarak GKD gerçekleştirmelidir.<br> Pasaport numarasına ilişkin kontroller HHS'nin halihazırda kullandığı veri, akış ve tabi olduğu diğer düzenlemelerdeki işleyiş ile aynı şekilde ele alınmalıdır.<br> Kurum adına yapılan (ticari) ödemelerde, kurum adına işlem yapan kullanıcının kimlik türünün bu alanda gönderilmesi zorunludur.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Türü</strong></td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür.<br><strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td> <td>Kurum adına yapılan (ticari) ödemelerde kullanımı zorunludur.<br> HHS geçerli bir Kurum Kimlik Numarası Türü olduğunu kontrol eder.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Verisi</strong></td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir.<br> <strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td> <td>Kurum adına yapılan (ticari) ödemelerde kullanımı zorunludur.<br> HHS, ÖBHS tarafından iletilmesi durumunda Kurum Kimlik Verisi üzeriden çapraz kontroller uygulamalıdır.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Hizmeti Kullanıcısı Türü</strong></td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OhkTur</strong> sıralı veri türü değerlerinden birini alır <strong>(B: Bireysel, K:Kurumsal)</strong></td> <td>Kurum adına yapılan ödemelerde K değerini alır. Kurum Kimlik Türü ve Kurum Kimlik Verisi alanlarının girilmiş olduğu çapraz olarak kontrol edilir.</td></tr> <tr><td><strong>&gt; İşlem Tutarı</strong></td> <td>islTtr</td> <td>Kompleks:Tutar</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para Birimi.<br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>53: (Para Birimi)</strong> alanında tanımlı Para Birimi verisi kullanılır.</td> <td>HHS geçerli bir para birimi olduğu kontrol eder.</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS'nin ön yüzde kullanıcıdan teyit aldığı tutar. <br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>54: (Tutar)</strong> alanında tanımlı Tutar verisi kullanılır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td></td></tr> <tr><td><strong>&gt; Gönderen</strong></td> <td>gon</td> <td>Kompleks:Hesap</td> <td>İ</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>İ</td> <td>Gönderenin unvanıdır.<br> HHS, bu bilgiyi ÖBHS sisteminden gelen veri yerine FAST’a iletirken kendi sisteminden alabilir.</td> <td>HHS’nin bu veri ile kendi sistemlerindeki verinin farklı olması ve Kimlik Numarası ile eşleşmemesi durumunda ödeme emri başlatma isteği reddedilir.<br> ÖBHS verisi ile HHS verisinin farklılaşması durumunun ise risk değerlendirme sistemlerine girdi olarak kullanması tavsiye edilir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>İ</td> <td>ÖBHS'nin ön yüzünden daha önce kayıt altına alınmış hesaplar arasından seçtirdiği veya müşteriye girdiği IBAN’dır.<br> ÖBHS tarafından iletilmediği durumda, gönderen hesap bilgisini müşteri tarafından HHS’nin dijital kanalında GKD sonrasında seçilebilir. Bu amaçla ÖBHS arayüzünde HHS seçtirilmelidir.<br> Hesap Referansı kullanılıyorsa Hesap Numarası kullanılmayabilir. Hesap referansı ile ödeme emri rızası başlatılacak ise HHS hesap referansı değeri ile ilişkilendirilmiş mevcut bir hesap bilgisi rızası var mı kontrol etmelidir. Eğer aktif bir rızası yok ise <strong>TR.OHVPS.Business.InvalidContent</strong> hatası verilmelidir.</td> <td>ÖBHS tarafından iletildiği durumda; IBAN içerisindeki HHS kodunun istek başlığındaki HHS kodu ile aynı olduğu (hesabın HHS’ye aitliğinin kontrolü), IBAN’ın doğruluğu (kontrol basamağı doğrulaması), Hesap numarasının ÖHK’ya ait olduğu, HHS’ye özel ödeme izni verilmeyen farklı statülerin bulunması durumu kontrol edilir.<br> Kontrol başarısız olduğunda <strong>TR.OHVPS.Business. InvalidAccount</strong> hatası YÖS’e iletilir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Referansı</strong></td> <td>hspRef</td> <td>AN5..40</td> <td>İ</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid).<br>YÖS bazında farklılaşması gerekmez.<br> ÖBHS’nin aynı zamanda HBHS olduğu durumda müşteri rızası tesis edilmiş bir hesabın referansı üzerinden de ödeme başaltılabilir.<br> Hesap Numarası kullanılıyorsa Hesap Referansı kullanılmayabilir.</td> <td>HspRef'e bağlı IBAN değiştiğinde yeni IBAN'ın da ilgili HspRef ile ilişkilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiğinde HHS'nin yeni IBAN ve hesap hareketlerini dönebilmesi mümkün olacaktır. HspRef’in, IBAN değiştiğinde değiştirilmemesi tavsiye edilmektedir.</td></tr> <tr><td><strong>&gt; Alıcı</strong></td> <td>alc</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>K</td> <td><strong>Kolay Adres Sistemi</strong> kullanılmıyorsa zorunludur.<br> Alıcının unvanıdır. ÖBHS ekranlarından girişi yapılabileceği gibi ÖBHS’nin kayıtlı alıcılarından yapılan seçimle de doldurup gönderebildiği bilgi olabilir.<br> FAST-TR Karekod Veri Organizasyonunda;<br> İşyeri tarafından sunulan uzun karekod yapısının <strong>59:</strong> alanında tanımlı İşyeri adı alanıdır, Kişiden Kişiye Ödeme Karekod Yapısının <strong>07:</strong> alanında tanımlı <br> <strong>Ödeme Alıcısının Adı ve Soyadı</strong> alanıdır. <br><br>FAST-TR Karekod dışındaki iş yeri ödemelerinde; yine Unvan alanında işyeri adı bilgisi gönderilmelidir.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>K</td> <td><strong>Alıcının Hesap Numarası (IBAN)</strong> alanıdır.<br> <strong>Kolay Adres Sistemi</strong> kullanılmıyorsa zorunludur.<br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>30-01:</strong> alanında tanımlı İş Yeri IBAN verisi kullanılır.<br> Alıcının birden fazla hesabının kullanılabilir olduğu durumlarda (özellikle işyeri ödemelerinde HHS nezdindeki hesap (on-us havale akışı) tercih edilmelidir.</td> <td>HHS (Gönderen Katılımcı) tarafından IBAN doğrulaması (kontrol basamağı doğrulaması) yapılır.</td></tr> <tr><td><strong>&gt;&gt; Kolay Adres</strong></td> <td>kolas</td> <td>Kompleks:Kolas</td> <td>K</td> <td></td> <td>Tek seferlik ödemelerde ( kimlik bilgileri boş iletildiğinde) KOLAS nesnesi dolu iletiliyorsa; HHS tarafından TR.OHVPS.Business.InvalidContent hatası dönülmelidir</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Türü</strong></td> <td>kolasTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KolasTur</strong> sıralı veri türü değerlerinden birini alır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td> <td>HHS (Gönderen FAST katılımcısı) tarafından KOLAS Servisine yapılan sorguda girdi olarak kullanılır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Değeri</strong></td> <td>kolasDgr</td> <td>AN7..50</td> <td>Z</td> <td>Müşterinin eklediği, HHS (FAST katılımcısı) tarafından doğrulanmış Kolay Adres değeridir. Alabileceği değerler BKM “Kolay Adresleme Sistemi Uygulama Kuralları” belgesinde tanımlıdır.<br> Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td> <td>HHS (Gönderen FAST katılımcısı) tarafından KOLAS Servisine yapılan sorguda girdi olarak kullanılır.</td></tr> <tr><td><strong>&gt; Karekod</strong></td> <td>kkod</td> <td>Kompleks:Karekod</td> <td>K</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Akış Türü</strong></td> <td>aksTur</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KareKodAksTur</strong> sıralı veri değerlerinden birini alır. Kolay Adresi Sistemi ile birlikte kullanılmaz.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Referansı</strong></td> <td>kkodRef</td> <td>AN1..12</td> <td>K</td> <td><strong>Karekod referans numarasını</strong> gösterir.<br>Okunan karekodda referans değeri varsa kullanılması zorunludur.<br> Karekod ilke ve kurallar belgesinde tanımlandığı şekilde kullanılması gerekmektedir.<br> Kolay Adresi Sistemi ile birlikte kullanılmaz.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Üretici Kodu</strong></td> <td>kkodUrtcKod</td> <td>AN4</td> <td>Z</td> <td>Karekod üreticisinin kodu.<br> Ödeme Hizmeti Sağlayıcıları ve TCMB tarafından uygun görülen ödeme sistemi işleticisi TR Karekod üretebilmek için BKM’ye kayıt başvurusu yaparak karekod üretici kodu alabileceklerdir. Bankalar EFT kodlarını kullanacak olup ayrıca kayıt yaptırmalarına gerek bulunmamaktadır. 4 haneden kısa değerlerin sol tarafı ’0’ karakteri ile tamamlanmalıdır.</td> <td></td></tr> <tr><td><strong>&gt; Ödeme Ayrıntıları</strong></td> <td>odmAyr</td> <td>Kompleks: OdemeAyrintilari</td> <td>Z</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Ödeme Kaynağı</strong></td> <td>odmKynk</td> <td>AN1</td> <td>Z</td> <td>Ödemenin başlatıldığı kaynağı belirtir. <strong>TR.OHVPS.DataCode.OdemeKaynak</strong> sıralı veri veri değerlerinden “O” değeri atanarak iletilmelidir. “O” değeri “Açık bankacılık aracılığı ile gönderilen ödemelerde kullanılır.” anlamını taşımaktadır.</td> <td>HHS, YÖS'ün API deseninde &quot;O&quot; kodunu ilettiğini kontrol eder.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Amacı</strong></td> <td>odmAmc</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeAmaci</strong> sıralı veri değerlerinden birini alır. Karekod akışında, FAST Karekod Veri Organizasyonundaki 62-08: alanında tanımlı Ödeme Amacı verisi kullanılır.</td> <td>HHS geçerli bir Ödeme Amacı kodu olduğunu kontrol eder.</td></tr> <tr><td><strong>&gt;&gt; Referans Bilgisi</strong></td> <td>refBlg</td> <td>AN1..140</td> <td>K</td> <td>Ödemeye özel <strong>Referans Bilgisi</strong> alanıdır. Karekod işlemi değil ise zorunludur.<br> -	Kişiden kişiye fon aktarımlarında: Gün içerisinde ÖHK özelinde, her işleme özel biricik olarak oluşturulan referans bilgisidir. <br>Karekod P2P akışı için referans bilgisi (Karekod referans numarası değil, işleme özel üretilecek referans bilgisidir.) YÖS tarafından atanacaktır. <br> -	E-ticaret işlemlerinde sipariş/takip numarası/müşteri/abone numarası<br> -	İşyeri Ödemesi Karekod akışında, FAST Karekod Veri Organizasyonundaki<br> -	62-01: alanında tanımlı Fatura Numarası <br> -	62-06: alanında tanımlı Müşteri Numarası <br> verilerinden biri kullanılır.</td> <td>YÖS bu değeri ÖHK’yı HHS’ye yönlendirmeden önceki ekranda göstermeli, ve HHS bu değeri GKD için kullandığı önyüzünde “işlem doğrulama kodunun” bir unsuru olarak yine ÖHK’ya göstermelidir.</td></tr> <tr><td><strong>&gt;&gt; Açıklama</strong></td> <td>odmAcklm</td> <td>AN1..50</td> <td>İ</td> <td>ÖBHS’nin ÖHK’dan aldığı ya da kendisinin atadığı işlem açıklaması bilgisi.</td> <td></td></tr> <tr><td><strong>&gt; ÖBHS Masraf Tutarı</strong></td> <td>obhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td> <td></td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td></td></tr> <tr><td><strong>İşyeri Ödeme Bilgileri</strong></td> <td>isyOdmBlg</td> <td>Kompleks:IsyeriOdemeBilgileri</td> <td>İ</td> <td>İşyeri ödemelerinde kullanılabilecek alanlardır. Karekodlu işyeri ödemesi akışında bu alanlar dolu geldiği için isteğe bağlı olarak gönderilebilir. isyOdmBlg alanlarının en az birinin dolu olması durumunda istekte yer alır.<br> İşyeri Ödeme Bilgileri, YÖS uygulama önyüzünde ÖHK’nın bildiği ve girişi yapılması beklenen bir bilgi olmamalıdır. YÖS tarafından sistemsel olarak doldurulması gereklidir.</td> <td></td></tr> <tr><td><strong>&gt; İşyeri Kategori Kodu</strong></td> <td>isyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlemin, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC). Ödeme Amacı = ‘06’ ya da ‘04’ olan ödeme işlemleri için doldurulabilir. <br>4 karakterden küçük değerlerin başına 0 eklenerek iletilmesi gereklidir.</td> <td></td></tr> <tr><td><strong>&gt; Alt İşyeri Kategori Kodu</strong></td> <td>altIsyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlem alt işyerinden gerçekleştiriliyorsa, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC).<br>4 karakterden küçük değerlerin başına 0 eklenerek iletilmesi gereklidir.</td> <td></td></tr> <tr><td><strong>&gt;Üye İş Yeri Tekil Kimlik</strong></td> <td>genelUyeIsyeriNo</td> <td>AN8</td> <td>İ</td> <td>İşyeri kayıt sisteminde kayıtlı İşyeri için BKM tarafından üretilmiş olan genel işyeri numarasıdır (GlobalMerchantId) 8 haneden küçük gönderiminde başa ‘0’ eklenmelidir. Örnek değer ‘01630618’</td> <td></td></tr></tbody></table> <h4 id="basarili-yanit"><a href="#basarili-yanit" class="header-anchor">#</a> <strong>BAŞARILI YANIT:</strong></h4> <p>POST işleminin RESPONSE gövdesini (BODY) oluşturan “OdemeEmriRizasi” nesnesi Tablo-8’deki parametrelerden oluşur:</p> <p><strong>Tablo 8: “OdemeEmriRizasi” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format: Veri modeli İsmi</th> <th>Zorunlu / Koşullu / İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td><strong>Riza Bilgileri</strong></td> <td>rzBlg</td> <td>Kompleks: RizaBilgileri</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Rıza No</strong></td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>OdemeEmriRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td></tr> <tr><td><strong>&gt; Oluşturma Zamanı</strong></td> <td>olusZmn</td> <td>ISODateTime</td> <td>Z</td> <td>OdemeEmriRizasi nesnesinin oluşturulma zamanı</td></tr> <tr><td><strong>&gt; Güncellenme Zamanı</strong></td> <td>gnclZmn</td> <td>ISODateTime</td> <td>Z</td> <td>OdemeEmriRizasi nesnesinin güncellenme zamanı</td></tr> <tr><td><strong>&gt; Rıza Durumu</strong></td> <td>rizaDrm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.RizaDurumu</strong> sıralı veri tipini değerlerinden birini alır.</td></tr> <tr><td><strong>&gt; Rıza Iptal Detay Kodu</strong></td> <td>rizaIptDtyKod</td> <td>AN2</td> <td>K</td> <td><strong>Rıza durumunun iptal olduğu durumda zorunludur. Alabileceği değerler 4. Bölümde detaylandırılmıştır.</strong></td></tr> <tr><td><strong>Katılımcı Bilgisi</strong></td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td></tr> <tr><td><strong>&gt;Hesap Hizmeti Sağlayıcısı Kodu</strong></td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td></tr> <tr><td><strong>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</strong></td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur.</td></tr> <tr><td><strong>GKD</strong></td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Yetkilendirme Yöntemi</strong></td> <td>yetYntm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.GkdTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt; Yönlenme Adresi</strong></td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli güçlü kimlik doğrulama için zorunlu.<br></td></tr> <tr><td><strong>&gt; Bildirim Adresi</strong></td> <td>bldAdr</td> <td>AN1..1024</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu.</td></tr> <tr><td><strong>&gt; HHS Yönlenme Adresi</strong></td> <td>hhsYonAdr</td> <td>AN1..1024</td> <td>K</td> <td>GKD doğrulama bilgilerinin girilebilmesi için uygulamadan açılacak yönlendirme sayfasının adresi</td></tr> <tr><td><strong>&gt; Yetkilendirme Tamamlanma Zamanı</strong></td> <td>yetTmmZmn</td> <td>ISODateTime</td> <td>Z</td> <td>Yetkilendirme akışının tamamlanması gereken son zamanı gösterir. <br> HHS tarafından maksimum 5 dk içinde işlem tamamlanacak şekil zaman damgası oluşturulur. Zaman aşımı olduğunda HHS’nin GKD’ye izin vermeyecek şekilde hata mesajı vermesi gerekmektedir.<br> Rıza durumu Yetkilendirildi statüsüne geçene kadarki süredir.</td></tr> <tr><td><strong>Ödeme Başlatma</strong></td> <td>odmBsltm</td> <td>Kompleks: OdemeBaslatma</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Kimlik</strong></td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Kimlik Türü</strong></td> <td>kmlkTur</td> <td>AN1</td> <td>K</td> <td><strong>TR.OHVPS.DataCode.KimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Kimlik Verisi</strong></td> <td>kmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır.<br><strong>TR.OHVPS.DataCode.KimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Türü</strong></td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür.<br><strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Verisi</strong></td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir.<br> <strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Hizmeti Kullanıcısı Türü</strong></td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OhkTur</strong> sıralı veri türü değerlerinden birini alır <strong>(B: Bireysel, K:Kurumsal)</strong></td></tr> <tr><td><strong>&gt; İşlem Tutarı</strong></td> <td>islTtr</td> <td>Kompleks:Tutar</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para Birimi.<br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>53: (Para Birimi)</strong> alanında tanımlı Para Birimi verisi kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS'nin ön yüzde kullanıcıdan teyit aldığı tutar. <br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>54: (Tutar)</strong> alanında tanımlı Tutar verisi kullanılır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>&gt; Gönderen</strong></td> <td>gon</td> <td>Kompleks:Hesap</td> <td>İ</td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>İ</td> <td>Gönderenin unvanıdır.<br> HHS, bu bilgiyi ÖBHS sisteminden gelen veri yerine FAST’a iletirken kendi sisteminden alabilir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>İ</td> <td>ÖBHS'nin ön yüzünden daha önce kayıt altına alınmış hesaplar arasından seçtirdiği veya müşteriye girdiği IBAN’dır.<br> ÖBHS tarafından iletilmediği durumda, gönderen hesap bilgisini müşteri tarafından HHS’nin dijital kanalında GKD sonrasında seçilebilir. Bu amaçla ÖBHS arayüzünde HHS seçtirilmelidir.<br> <strong>GKD sonrası HHS ekranında seçilen Hesap Numarası POST işleminin yanıtında dönülemez ancak isteğe bağlı GET sorgusu ile dönülebilir.</strong> <br> Hesap Referansı kullanılıyorsa Hesap Numarası kullanılmayabilir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Referansı</strong></td> <td>hspRef</td> <td>AN5..40</td> <td>İ</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid).<br>YÖS bazında farklılaşması gerekmez.<br> ÖBHS’nin aynı zamanda HBHS olduğu durumda müşteri rızası tesis edilmiş bir hesabın referansı üzerinden de ödeme başaltılabilir.<br> <strong>GKD sonrası HHS ekranında seçilen Hesap Referansı POST işleminin yanıtında dönülemez ancak isteğe bağlı GET sorgusu ile dönülebilir.</strong> <br> Hesap Numarası kullanılıyorsa Hesap Referansı kullanılmayabilir.</td></tr> <tr><td><strong>&gt; Alıcı</strong></td> <td>alc</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen adres kaydı yaptırmış olan alıcının maskeli ad-soyadı veya maskeli ticari unvan bilgisidir.<br>Kolas’tan dönen “account owner” alanı kullanılmalıdır.<br>Kolay adres değil ise ÖBHS tarafından istek mesajında iletilen unvan bilgisidir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>Z</td> <td>ÖBHS tarafından istek mesajında iletilip doğrulanan veya Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen alıcı maskeli IBAN bilgisidir.</td></tr> <tr><td><strong>&gt;&gt; Kolay Adres</strong></td> <td>kolas</td> <td>Kompleks:Kolas</td> <td>K</td> <td></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Türü</strong></td> <td>kolasTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KolasTur</strong> sıralı veri türü değerlerinden birini alır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Değeri</strong></td> <td>kolasDgr</td> <td>AN7..50</td> <td>Z</td> <td>Müşterinin eklediği, HHS (FAST katılımcısı) tarafından doğrulanmış Kolay Adres değeridir. Alabileceği değerler BKM “Kolay Adresleme Sistemi Uygulama Kuralları” belgesinde tanımlıdır.<br> Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Referans Numarası</strong></td> <td>kolasRefNo</td> <td>N12</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı KOLAS tarafından ilgili sorguya özel olarak üretilmiş referans numarasıdır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Hesap Türü</strong></td> <td>kolasHspTur</td> <td>AN1</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı hesap türü bilgisidir:<br> <strong>TR.OHVPS.DataCode.KolasHspTur</strong> sıralı veri değerlerinden birini alır.</td></tr> <tr><td><strong>&gt; Karekod</strong></td> <td>kkod</td> <td>Kompleks:Karekod</td> <td>K</td> <td></td></tr> <tr><td><strong>&gt;&gt; Akış Türü</strong></td> <td>aksTur</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KareKodAksTur</strong> sıralı veri değerlerinden birini alır. Kolay Adresi Sistemi ile birlikte kullanılmaz.</td></tr> <tr><td><strong>&gt;&gt; Referansı</strong></td> <td>kkodRef</td> <td>AN1..12</td> <td>K</td> <td><strong>Karekod referans numarasını</strong> gösterir.</td></tr> <tr><td><strong>&gt;&gt; Üretici Kodu</strong></td> <td>kkodUrtcKod</td> <td>AN4</td> <td>Z</td> <td>Karekod üreticisinin kodu.<br> Ödeme Hizmeti Sağlayıcıları ve TCMB tarafından uygun görülen ödeme sistemi işleticisi TR Karekod üretebilmek için BKM’ye kayıt başvurusu yaparak karekod üretici kodu alabileceklerdir. Bankalar EFT kodlarını kullanacak olup ayrıca kayıt yaptırmalarına gerek bulunmamaktadır. 4 haneden kısa değerlerin sol tarafı ’0’ karakteri ile tamamlanmalıdır.</td></tr> <tr><td><strong>&gt; Ödeme Ayrıntıları</strong></td> <td>odmAyr</td> <td>Kompleks: OdemeAyrintilari</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Ödeme Kaynağı</strong></td> <td>odmKynk</td> <td>AN1</td> <td>Z</td> <td>Ödemenin başlatıldığı kaynağı belirtir. <strong>TR.OHVPS.DataCode.OdemeKaynak</strong> sıralı veri değerlerinden “O” değerini alır. “O” değeri “Açık bankacılık aracılığı ile gönderilen ödemelerde kullanılır.” anlamını taşımaktadır.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Amacı</strong></td> <td>odmAmc</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeAmaci</strong> sıralı veri değerlerinden birini alır. Karekod akışında, FAST Karekod Veri Organizasyonundaki 62-08: alanında tanımlı Ödeme Amacı verisi kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Referans Bilgisi</strong></td> <td>refBlg</td> <td>AN1..140</td> <td>K</td> <td>Ödemeye özel <strong>Referans Bilgisi</strong> alanıdır. Karekod işlemi değil ise zorunludur.<br> -	Kişiden kişiye fon aktarımlarda: Gün içerisinde ÖHK özelinde, her işleme özel biricik olarak oluşturulan referans bilgisidir.<br> Karekod P2P akışı için referans bilgisi (Karekod referans numarası değil, işleme özel üretilecek referans bilgisidir.) YÖS tarafından atanacaktır.<br> -	E-ticaret işlemlerinde sipariş/takip numarası/müşteri/abone numarası<br> - İşyeri Ödemesi Karekod akışında, FAST Karekod Veri Organizasyonundaki<br> -	62-01: alanında tanımlı Fatura Numarası <br> -	62-06: alanında tanımlı Müşteri Numarası <br> verilerinden biri kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Açıklama</strong></td> <td>odmAcklm</td> <td>AN1..50</td> <td>İ</td> <td>ÖBHS’nin ÖHK’dan aldığı ya da kendisinin atadığı işlem açıklaması bilgisi.</td></tr> <tr><td><strong>&gt;&gt; ÖHK Mesaj Alanı</strong></td> <td>ohkMsj</td> <td>AN1..200</td> <td>İ</td> <td>HHS’nin ÖHK’ya göstermek üzere ilettiği mesaj.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Sistemi</strong></td> <td>odmStm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeSistemi</strong> sıralı veri değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Beklenen Ödeme Zamanı</strong></td> <td>bekOdmZmn</td> <td>ISODateTime</td> <td>K</td> <td>İşlemin yönlendirildiği ödeme sistemi PÖS ise ve PÖS işlem saatleri dışında ise işlemin yapılabileceği ilk zaman bilgisidir. Bu alan ileri vadeli ödemeler için düşünülmüştür. İlk fazda doldurulmasına gerek olmadığı düşünülmektedir.</td></tr> <tr><td><strong>&gt; ÖBHS Masraf Tutarı</strong></td> <td>obhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>&gt; HHS Masraf Tutarı</strong></td> <td>hhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>HHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>İşyeri Ödeme Bilgileri</strong></td> <td>isyOdmBlg</td> <td>Kompleks:IsyeriOdemeBilgileri</td> <td>İ</td> <td>İşyeri ödemelerinde kullanılabilecek alanlardır. Karekodlu işyeri ödemesi akışında bu alanlar dolu geldiği için isteğe bağlı olarak gönderilebilir. isyOdmBlg alanlarının en az birinin dolu olması durumunda yanıtta yer alır.</td></tr> <tr><td><strong>&gt; İşyeri Kategori Kodu</strong></td> <td>isyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlemin, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC). Ödeme Amacı = ‘06’ ya da ‘04’ olan ödeme işlemleri için doldurulabilir.</td></tr> <tr><td><strong>&gt; Alt İşyeri Kategori Kodu</strong></td> <td>altIsyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlem alt işyerinden gerçekleştiriliyorsa, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC).</td></tr> <tr><td><strong>&gt;Üye İş Yeri Tekil Kimlik</strong></td> <td>genelUyeIsyeriNo</td> <td>AN8</td> <td>İ</td> <td>İşyeri kayıt sisteminde kayıtlı İşyeri için BKM tarafından üretilmiş olan genel işyeri numarasıdır (GlobalMerchantId) 8 haneden küçük gönderiminde başa ‘0’ eklenmelidir. Örnek değer ‘01630618’</td></tr></tbody></table> <h2 id="_6-3-adim-2-odeme-emri-rızasının-yetkilendirilmesi"><a href="#_6-3-adim-2-odeme-emri-rızasının-yetkilendirilmesi" class="header-anchor">#</a> 6.3.	ADIM 2- Ödeme Emri Rızasının Yetkilendirilmesi</h2> <img src="/assets/img/OdemeEmriRizasininYetkilendirilmesi.eb4e6ca5.png" width="75%"> <p><strong>Şekil 6: Ödeme Emri Rızasının Yetkilendirilmesi</strong></p> <p>ÖBHS, ÖHK’nın ödeme emrini yetkilendirmesi isteğini iletir. Ödeme emrinin yetkilendirilmesi, HHS tarafından gerçekleştirilen Yönlendirme veya Ayrık GKD yöntemiyle yapılır.</p> <ul><li><p><strong>Yönlendirmeli doğrulama akışında</strong>, ÖBHS ÖHK’yı HHS’ye yönlendirir.</p> <ul><li>ÖBHS tarafından yönlendirme, bir önceki adımdaki RizaNo’yu içerir.</li> <li>Yönlendirmenin RizaNo’yu içermesi sayesinde, HHS hangi ödeme emriyle ilişkili olarak yönlendirme yapıldığını ilişkilendirebilir.</li> <li>HHS, ÖHK için GKD sürecini işletir.</li></ul> <p>ÖHK’yı doğrularsa,</p> <ol><li>ÖHK -bir önceki adımda seçmediyse- borçlu hesabını seçer.</li> <li>HHS, ödeme emri rıza kaynağının durumunu “Yetkilendirildi” olarak günceller.</li> <li>HHS, ÖHK’yı “olumlu yönlendirme akışı” ile ÖBHS tarafından tanımlanan yönlendirme adresine yönlendirir:</li></ol></li></ul> <div class="language- extra-class"><pre class="language-text"><code>yonAdr?rizaDrm=Y&amp;yetKod=xx&amp;rizaNo=yy&amp;rizaTip=O&amp;drmKod=zzz
</code></pre></div><p>ÖHK’yı doğrulayamazsa,<br>
1. HHS, ödeme emri rıza kaynağının durumunu “Yetki İptal” olarak günceller.<br>
2. HHS, ÖHK’yı “olumsuz yönlendirme akışı” ile ÖBHS tarafından tanımlanan yönlendirme adresine yönlendirir:</p> <div class="language- extra-class"><pre class="language-text"><code>yonAdr?rizaDrm=I&amp;rizaNo=yy&amp;rizaTip=O&amp;drmKod=zzz
</code></pre></div><p>HHS tarafında oluşabilecek bir hata durumunun YÖS’e aktarılması gerektiği durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir.<br>
Hata açıklamalarının neler olabileceği ve YÖS’ün kendi uygulamasında bu hatayı ne şekilde göstereceği aşağıda tariflenmiştir.</p> <div class="language- extra-class"><pre class="language-text"><code>yonAdr?rizaDrm=I&amp;rizaNo=yy&amp;rizaTip=O&amp;rizaIptDtyKod=11&amp;drmKod=zzz
</code></pre></div><p>URL’de iletilen “Rıza İptal Detay Kodu” Rıza durumları bölümünde (4. Bölüm) belirtilen hata kodları ile aynı olacak şekilde tasarlanmıştır. GKD sırasında yapılması gereken kontroller 5.3 bölümünde detaylandırılmıştır.</p> <ul><li><strong>Ayrık doğrulama akışında</strong>, HHS, ÖHK’nın ödeme emrini başlattığı uygulamadan farklı olabilecek bir “doğrulama” uygulamasında işlemi doğrulamasını ister.
<ul><li>Ayrık akış ÖBHS’nin farklı bir kanal kullanarak yetkilendirme isteği göndermesiyle başlatılır.</li> <li>Bu yetkilendirme isteği, yetkilendirilecek ödeme emri rızasının eşleştirileceği ÖHK’nın bulunması için ilgili veriyi taşır.</li> <li>HHS, ÖHK’yı doğrular.</li> <li>ÖHK -bir önceki adımda seçmediyse- borçlandırılacak hesabını seçer.</li> <li>HHS, ödeme emri rıza kaynağının durumunu “Yetkilendirildi” olarak günceller.</li></ul></li></ul> <p>Başarılı GKD sonrasında (rizaDrm=’Y’) ilgili rıza nesnesi için (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alınmasının ardından erişim belirteci erişim adresine POST çağrısı yapılarak yetkilendirme kodu karşılığında erişim belirteci ve yenileme belirteci alınır. POST /erişim-belirteci erişim noktası EK-3’te açıklanmıştır.</p> <p>Erişim belirteci alındıktan sonra; HHS, ödeme emri rıza kaynağının durumunu “Yetki Kullanıldı” olarak günceller.</p> <h2 id="_6-4-adim-2-1-odeme-emri-rızasının-sorgulanması-istege-baglı"><a href="#_6-4-adim-2-1-odeme-emri-rızasının-sorgulanması-istege-baglı" class="header-anchor">#</a> 6.4.	ADIM 2.1 – Ödeme Emri Rızasının Sorgulanması (isteğe bağlı)</h2> <img src="/assets/img/OdemeEmriRizasininSorgulanmasi.e1734768.png" width="75%"> <p><strong>Şekil 7: “odemeEmriRizasi” nesnesinin sorgulanması (isteğe bağlı)</strong></p> <p>GKD işleminin başarıyla tamamlanıp Ödeme Emri Rızasının yetkilendirilmesi esnasında, gönderen hesap seçiminin HHS ekranında yapıldığı durumlar olabilir. Bu durumlarda ödeme emri isteğinde gönderen hesap bilgileri alanının zorunlu olması nedeniyle, <strong>OdemeEmriRizasi</strong> nesnesi sorgulanarak gönderen hesap bilgileri (hesap numarası ve/veya hesap referansı) alınmalıdır. HHS, “<strong>ADIM 2 -Ödeme Emri Rızasının Yetkilendirilmesi</strong>” akışında ÖHK’nın hesapları arasında seçim yapmasını ve seçilen hesap bilgisinin <strong>OdemeEmriRizasi</strong> nesnesine işler.</p> <p><strong>GET /odeme-emri-rizasi/{RizaNo}</strong></p> <p>ÖBHS, mevcut durumunu kontrol etmek için, oluşturulan bir <strong>OdemeEmriRizasi</strong> kaynağının durumunu isteğe bağlı olarak alabilir.</p> <p><strong>Durum</strong></p> <p><strong>OdemeEmriRizasi</strong> kaynağı için kullanılabilecek durum göstergeleri şu şekildedir:</p> <ul><li>Yetki Bekleniyor</li> <li>Yetkilendirildi</li> <li>Yetki Kullanıldı</li> <li>Yetki Ödeme Emrine Dönüştü</li> <li>Yetki Sonlandırıldı</li> <li>Yetki İptal</li></ul> <p>Ödeme emri rıza durum değişiklikleri 4.2 bölümünde detaylandırılmıştır.</p> <p><strong>BAŞARILI YANIT:</strong></p> <p><strong>GET /odeme-emri-rizasi/{RizaNo}</strong> yanıtının (RESPONSE) gövdesinde (BODY)  “OdemeEmriRizasiİstegi” nesnesi kullanılır. İstek başarıyla sonuçlanırsa HHS kaynak sunucusunda Tablo-8’de yer alan parametreleri içeren “OdemeEmriRizasi” oluşturulur.</p> <p>Gönderen Hesap Bilgisinin, ADIM 2 (Ödeme Emri Rızasının Yetkilendirilmesi) sonrasında HHS ekranından seçildiği akışta “OdemeEmriRizasi” nesnesi güncellenir ve ÖBHS <strong>GET /odeme-emri-rizasi/{RizaNo}</strong> isteği yaparak güncel gönderen hesap bilgisi bilgisini de içeren “OdemeEmriRizasi” nesnesini çekmelidir.</p> <p>Çerçeve sözleşme kapsamında olmayan tek seferlik ödeme işlemlerinde, Kimlik Türü ve Kimlik Verisi bilgilerinin ödeme emri rızası sırasında gönderimi zorunlu değildir. Başarılı GKD sonrası, yani erişim belirteci alındığında, ödeme emri oluşmadan önce, YÖS’ün ödeme emri rızasını sorgulayarak bu bilgileri alması ve ödeme emrini oluştururken Kimlik Türü ve Kimlik Verisi alanlarını dolu olarak göndermesi beklenmektedir.  Ancak rıza durumu “Yetki Bekleniyor - B”, “Yetkilendirildi - Y” ve “Yetki İptal - I” statülerinde ise, ödeme emri rızası sorgulamasında, HHS’nin Kimlik Türü ve Kimlik Verisi bilgisini YÖS ile paylaşmaması gerekmektedir.</p> <h2 id="_6-5-adim-3-odeme-emrinin-olusturulması"><a href="#_6-5-adim-3-odeme-emrinin-olusturulması" class="header-anchor">#</a> 6.5.	ADIM 3- Ödeme Emrinin Oluşturulması</h2> <img src="/assets/img/OdemeEmrininOlusturulmasi.f79cf9a6.png" width="75%"> <p><strong>Şekil 8: Ödeme Emrinin Oluşturulması</strong></p> <p><strong>POST /odeme-emri</strong></p> <ul><li>ÖHK’nın Güçlü Kimlik Doğrulama ile işlemi yetkilendirmesi sonrasında, ÖBHS OdemeEmri kaynağını oluşturur.</li> <li>Ödeme emri (OdemeEmri) uygun ödeme kaynağına POST isteği yapılarak başlatılır.
<ul><li>POST HHS tarafından işlenir: RizaDurumu “Yetki Kullanıldı” ise işleme başlanır.</li> <li>POST /odeme-emri-rizasi ile POST /odeme-emri isteklerinde istek alanların aynı olması beklenmektedir. HHS tarafından kontrolü sağlanmalıdır.POST verisindeki Gönderen Hesap Numarası ve Alıcı Hesap Numarasının aynı bankaya aitse HAVALE değilse FAST veya PÖS iş akışına geçilir.</li> <li>POST verisinin modele göre kontrolü yapılır (alan kontrolleri)</li> <li>POST verisinin mantıksal kontrolleri yapılır (IBAN kontrolü, çapraz alan kontroller)</li> <li>OdemeEmriDurumu “Gerçekleşti” / “Gönderildi” / “Gerçekleşmedi” olarak güncellenir.</li></ul></li> <li>POST başarılı olursa, içerisinde OdemeEmriNo ve OdemeEmriDurumu değişkenleri de bulunan OdemeEmri nesnesi ÖBHS’ye döner ve RizaDurumu değişkenin değeri “Yetki Ödeme Emrine Dönüştü” olarak güncellenir.</li></ul> <p><strong>BAŞARILI İSTEK:</strong></p> <p><strong>Tablo 9: “OdemeEmriIstegi” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format: Veri modeli İsmi</th> <th>Zorunlu / Koşullu / İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından ödeme emri oluşturulması sırasında yapılması gereken kontrol ve işlemler</th> <th>FAST A01 PÖS M01 mesaj mapping</th></tr></thead> <tbody><tr><td><strong>Riza Bilgileri</strong></td> <td>rzBlg</td> <td>Kompleks: RizaBilgileri</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt; Rıza No</strong></td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>OdemeEmriRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Oluşturma Zamanı</strong></td> <td>olusZmn</td> <td>ISODateTime</td> <td>Z</td> <td>OdemeEmriRizasi nesnesinin oluşturulma zamanı</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Rıza Durumu</strong></td> <td>rizaDrm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.RizaDurumu</strong> sıralı veri tipini değerlerinden birini alır.</td> <td></td> <td></td></tr> <tr><td><strong>Katılımcı Bilgisi</strong></td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt;Hesap Hizmeti Sağlayıcısı Kodu</strong></td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td> <td>HHS, hhsKod’un kendisine ait olduğunu ve istek başlığındaki x-aspsp-code değeri ile aynı olduğunu kontrol eder.<br> Hata durumunda <strong>TR.OHVPS.Connection.InvalidASPSP</strong> hata kodunu döner.</td> <td>Gönderen katılımcı kodu (yani bankanın FAST/PÖS’teki Katılımcı kodu)</td></tr> <tr><td><strong>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</strong></td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur.</td> <td>HHS, yosKod’un geçerli bir Ödeme Hizmeti Sağlayıcısı Kodu olduğunu ve istek başlığındaki x-tpp-code değeri ile aynı olduğunu kontrol eder.<br> Hata durumunda <strong>TR.OHVPS.Connection.InvalidTPP</strong> hata kodunu döner.</td> <td><strong>YosKod</strong></td></tr> <tr><td><strong>GKD</strong></td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt; Yetkilendirme Yöntemi</strong></td> <td>yetYntm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.GkdTur</strong> sıralı veri türü değerlerinden birini alır.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Yönlenme Adresi</strong></td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli güçlü kimlik doğrulama için zorunlu.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Bildirim Adresi</strong></td> <td>bldAdr</td> <td>AN1..1024</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; HHS Yönlenme Adresi</strong></td> <td>hhsYonAdr</td> <td>AN1..1024</td> <td>K</td> <td>GKD doğrulama bilgilerinin girilebilmesi için uygulamadan açılacak yönlendirme sayfasının adresi</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Yetkilendirme Tamamlanma Zamanı</strong></td> <td>yetTmmZmn</td> <td>ISODateTime</td> <td>Z</td> <td>Yetkilendirme akışının tamamlanması gereken son zamanı gösterir. <br> Rıza durumu Yetkilendirildi statüsüne geçene kadarki süredir.</td> <td></td> <td></td></tr> <tr><td><strong>Ödeme Başlatma</strong></td> <td>odmBsltm</td> <td>Kompleks: OdemeBaslatma</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt; Kimlik</strong></td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Kimlik Türü</strong></td> <td>kmlkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td> <td>Çerçeve sözleşme kapsamındaki ödemelerde kullanımı zorunludur.<br>Ödeme Emri Rizası Nesnesindeki Kimlik Numarası Türü verisi ile aynı olmalıdır.<br>Kurum adına yapılan (ticari) ödemelerde, kurum adına işlem yapan kullanıcının kimlik türünün bu alanda gönderilmesi zorunludur.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Kimlik Verisi</strong></td> <td>kmlkVrs</td> <td>AN1..30</td> <td>Z</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır.<br><strong>TR.OHVPS.DataCode.KimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td> <td>Çerçeve sözleşme kapsamındaki ödemelerde kullanımı zorunludur.<br>HHS, ÖBHS tarafından iletilmesi durumunda Kimlik Verisi üzeriden çapraz kontroller uygulamalı ve Kimlik Verisini temel alarak GKD gerçekleştirmelidir.<br>Ödeme Emri Rizası Nesnesindeki Kimlik Numarası verisi ile aynı olmalıdır.<br>Gerçek kişi tarafından yapılan ödemelerde,<br>1. HHS, Gönderen Adı ve Gönderen Hesap Numarasını ödeme emri isteğinde (Havale/FAST/PÖS) gönderir.<br>- Gönderen Adı ve diğer tüm müşteri bilgileri, Kimlik Numarası üzerinden elde edillir.<br>Pasaport numarasına ilişkin kontroller HHS'nin halihazırda kullandığı veri, akış ve tabi olduğu diğer düzenlemelerdeki işleyiş ile aynı şekilde ele alınmalıdır.<br>Kurum adına yapılan (ticari) ödemelerde, kurum adına işlem yapan kullanıcının kimlik verisi bu alanda gönderilebilmesi zorunludur.</td> <td><strong>GonKimN / Psp</strong></td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Türü</strong></td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür.<br><strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td> <td>Kurum adına yapılan (ticari) ödemelerde kullanımı zorunludur.<br>Ödeme Emri Rizası Nesnesindeki Kurum Kimlik Türü verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Verisi</strong></td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir.<br> <strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td> <td>Kurum adına yapılan (ticari) ödemelerde kullanımı zorunludur.<br>Ödeme Emri Rizası Nesnesindeki Kurum Kimlik Verisi ile aynı olmalıdır.</td> <td><strong>GonKimN / VKN</strong></td></tr> <tr><td><strong>&gt;&gt; Ödeme Hizmeti Kullanıcısı Türü</strong></td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OhkTur</strong> sıralı veri türü değerlerinden birini alır <strong>(B: Bireysel, K:Kurumsal)</strong></td> <td>Kurum adına yapılan ödemelerde K değerini alır. Kurum Kimlik Türü ve Kurum Kimlik Verisi alanlarının giilmiş olduğu çapraz olarak kontrol edilir.<br> Ödeme Emri Rizası Nesnesindeki ÖHK Türü ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt; İşlem Tutarı</strong></td> <td>islTtr</td> <td>Kompleks:Tutar</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para Birimi.<br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>53: (Para Birimi)</strong> alanında tanımlı Para Birimi verisi kullanılır.</td> <td>Ödeme Emri Rizası Nesnesindeki Para Birimi verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS'nin ön yüzde kullanıcıdan teyit aldığı tutar. <br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>54: (Tutar)</strong> alanında tanımlı Tutar verisi kullanılır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td>Ödeme Emri Rizası Nesnesindeki İşlem Tutarı verisi ile aynı olmalıdır.<br>HHS işlem tutarı ödeme mesajında (Havale/FAST/PÖS) aynen taşınmak durumundadır.</td> <td><strong>Ttr</strong></td></tr> <tr><td><strong>&gt; Gönderen</strong></td> <td>gon</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>Z</td> <td>Gönderen kişinin ad soyad ya da ticari unvan bilgisi.</td> <td>HHS ve ÖBHS verisi tutarlı olmalıdır.<br> ÖBHS verisi ile HHS verisinin farklılaşması durumunun ise risk değerlendirme sistemlerine girdi olarak kullanması tavsiye edilir.</td> <td><strong>GonAd</strong></td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>K</td> <td>ÖBHS'nin ön yüzünden seçtirdiği/kullanıcıya girdiği IBAN<br>Hesap numarası ya da Hesap Referansı alanlarından en az birinin dolu olarak gelmesi gerekmektedir.</td> <td>Ödeme Emri Rizası Yanıtı Nesnesindeki Gönderen Hesap Numarası verisi ile aynı olmalıdır.</td> <td><strong>GonHesN</strong></td></tr> <tr><td><strong>&gt;&gt; Hesap Referansı</strong></td> <td>hspRef</td> <td>AN5..40</td> <td>K</td> <td>ÖBHS’nin aynı zamanda HBHS olduğu durumda müşteri rızası tesis edilmiş bir hesabın referansı üzerinden de ödeme başlatılabilir.<br>GKD sonrası HHS ekranında seçilen Hesap Referansı POST işleminin yanıtında dönülemez ancak isteğe bağlı GET sorgusu ile dönülebilir.<br>Hesap Numarası kullanılıyorsa Hesap Referansı kullanılmayabilir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Alıcı</strong></td> <td>alc</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen adres kaydı yaptırmış olan alıcının maskeli ad-soyadı veya maskeli ticari unvan bilgisidir.<br>Kolay adres değil ise ÖBHS tarafından istek mesajında iletilen unvan bilgisidir.</td> <td>YÖS’ten alıcı ad soyad bilgisi geliyorsa ve HHS'nin kontrolünden başarılı bir şekilde geçti ise HHS'nin tekrar alıcı ad soyad bilgisi için giriş yaptırmasına gerek bulunmamaktadır.</td> <td><strong>AlAd</strong></td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>Z</td> <td>Alıcının Hesap Numarası alanıdır (IBAN).<br>Kolay Adres  sorgusunda dönülen adres kaydı yaptırmış olan alıcının maskeli IBAN bilgisidir.<br>Kolay adres değil ise ÖBHS tarafından istek mesajında iletilen IBAN bilgisidir. Karekod akışında, FAST Karekod Veri Organizasyonundaki 30-01: alanında tanımlı İş Yeri IBAN verisi kullanılır.</td> <td>Ödeme Emri Rizası Yanıtı Nesnesindeki Alıcı Hesap Numarası verisi ile aynı olmalıdır.<br> Kontroller başarıyla sonuçlanırsa, bilgi FAST/PÖS AlHesN alanına doğrudan aktarır ve FAST/PÖS Alan Katılımcı Kodu (AlKK) olarak Alıcı HHS Kodu kullanılır.<br> KOLAS sorgusu sonucunda ödeme emrinde iletilen maskeli bilgi ile HHS’nin kendi ödeme emri rızası isteğinde tuttuğu KOLAS sorgusundan dönülen bilgi maskelenerek karşılaştırılır. Eğer aynı değilse uygun hata kodu dönülerek işlem sonlandırılır.</td> <td><strong>AlHesN</strong></td></tr> <tr><td><strong>&gt;&gt; Kolay Adres</strong></td> <td>kolas</td> <td>Kompleks:Kolas</td> <td>K</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Türü</strong></td> <td>kolasTur</td> <td>AN1</td> <td>Z</td> <td>Müşterinin sorgulamak istediği Kolay Adres Tipi değeridir. <br><strong>TR.OHVPS.DataCode.KolasTur</strong> sıralı veri türü değerlerinden birini alır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td> <td>Ödeme Emri Rizası Yanıtı Nesnesindeki Kolay Adres Tipi verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Değeri</strong></td> <td>kolasDgr</td> <td>AN7..50</td> <td>Z</td> <td>Müşterinin eklediği, HHS (FAST katılımcısı) tarafından doğrulanmış Kolay Adres değeridir. Alabileceği değerler BKM “Kolay Adresleme Sistemi Uygulama Kuralları” belgesinde tanımlıdır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td> <td>Ödeme Emri Rizası Yanıtı Nesnesindeki Kolay Adres Değeri verisi ile aynı olmalıdır.</td> <td><strong>FAST (KolasRef)</strong></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Referans Numarası</strong></td> <td>kolasRefNo</td> <td>N12</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı KOLAS tarafından ilgili sorguya özel olarak üretilmiş referans numarasıdır.</td> <td></td> <td><strong>KolasRef ( hem FAST hem de PÖS için aynı)</strong></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Hesap Türü</strong></td> <td>kolasHspTur</td> <td>AN1</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı hesap türü bilgisidir:<br> <strong>TR.OHVPS.DataCode.KolasHspTur</strong> sıralı veri değerlerinden birini alır.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Karekod</strong></td> <td>kkod</td> <td>Kompleks:Karekod</td> <td>K</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Akış Türü</strong></td> <td>aksTur</td> <td>AN2</td> <td>Z</td> <td>Karekod Akış Türü Karekod ödemesinin hangi akışla gerçekleştirildiğini gösterir.<br> Kolay Adresi Sistemi ile birlikte kullanılmaz.<br> 01: FAST katılımcısından dinamik doğrulama hizmeti alınan işyeri ödemesi<br> 02: FAST katılımcısından statik doğrulama hizmeti alınan işyeri ödemesi<br>03: Kişiden kişiye ödemeler</td> <td>Ödeme Emri Rizası Nesnesindeki Kare Kod Akış Türü verisi ile aynı olmalıdır.</td> <td><strong>FAST: KrkdAksTur</strong></td></tr> <tr><td><strong>&gt;&gt; Referansı</strong></td> <td>kkodRef</td> <td>AN1..12</td> <td>K</td> <td>Karekod referans numarasını gösterir.<br> Okunan karekodda referans değeri varsa kullanılması zorunludur.<br>Kolay Adresi Sistemi ile birlikte kullanılmaz.</td> <td>Ödeme Emri Rizası Nesnesindeki Karekod Referansı verisi ile aynı olmalıdır.<br> Çevrimiçi doğrulama hizmeti alınmayan statik karekodlar için Referans numarasının bulunmadığı durumlarda HHS tarafından “NONREF” ifadesi girilir.<br></td> <td><strong>FAST: Karekod Referansı (KrkdRef)</strong></td></tr> <tr><td><strong>&gt;&gt; Üretici Kodu</strong></td> <td>kkodUrtcKod</td> <td>AN4</td> <td>Z</td> <td>Karekod üreticisinin kodu.<br> Ödeme Hizmeti Sağlayıcıları ve TCMB tarafından uygun görülen ödeme sistemi işleticisi TR Karekod üretebilmek için BKM’ye kayıt başvurusu yaparak karekod üretici kodu alabileceklerdir. Bankalar EFT kodlarını kullanacak olup ayrıca kayıt yaptırmalarına gerek bulunmamaktadır. 4 haneden kısa değerlerin sol tarafı ’0’ karakteri ile tamamlanmalıdır.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Ödeme Ayrıntıları</strong></td> <td>odmAyr</td> <td>Kompleks: OdemeAyrintilari</td> <td>Z</td> <td></td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Ödeme Kaynağı</strong></td> <td>odmKynk</td> <td>AN1</td> <td>Z</td> <td>Ödemenin başlatıldığı kaynağı belirtir. <strong>TR.OHVPS.DataCode.OdemeKaynak</strong> sıralı veri değerlerinden “O” değeri atanarak iletilmelidir. “O” değeri “Açık bankacılık aracılığı ile gönderilen ödemelerde kullanılır.” anlamını taşımaktadır.</td> <td>Ödeme Emri Rizası Nesnesindeki Ödeme Kaynağı verisi ile aynı olmalıdır.<br>HHS tarafından ödeme mesajında (FAST/PÖS) aynen taşınmak durumundadır.</td> <td><strong>FAST/PÖS: OdmKynk</strong></td></tr> <tr><td><strong>&gt;&gt; Ödeme Amacı</strong></td> <td>odmAmc</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeAmaci</strong> sıralı veri değerlerinden birini alır.</td> <td>Ödeme Emri Rizası Nesnesindeki Ödeme Amacı verisi ile aynı olmalıdır.<br>HHS tarafından ödeme mesajında (FAST/PÖS) aynen taşınmak durumundadır.</td> <td><strong>FAST (OdmAmc)/PÖS(OdmAmaci)</strong></td></tr> <tr><td><strong>&gt;&gt; Referans Bilgisi</strong></td> <td>refBlg</td> <td>AN1..140</td> <td>K</td> <td>Ödemeye özel <strong>Referans Bilgisi</strong> alanıdır. Karekod işlemi değil ise zorunludur.<br> -	Kişiden kişiye fon aktarımlarda: Gün içerisinde ÖHK özelinde, her işleme özel biricik olarak oluşturulan referans bilgisidir.<br> Karekod P2P akışı için referans bilgisi (Karekod referans numarası değil, işleme özel üretilecek referans bilgisidir.) YÖS tarafından atanacaktır.<br> -	E-ticaret işlemlerinde sipariş/takip numarası/müşteri/abone numarası<br> -İşyeri Ödemesi Karekod akışında, FAST Karekod Veri Organizasyonundaki<br> -	62-01: alanında tanımlı Fatura Numarası <br> -	62-06: alanında tanımlı Müşteri Numarası <br> verilerinden biri kullanılır.</td> <td>Ödeme Emri Rizası Nesnesindeki Referans Bilgisi verisi ile aynı olmalıdır.</td> <td><strong>RefBlg (Hem FAST hem de PÖS için aynı)</strong></td></tr> <tr><td><strong>&gt;&gt; Açıklama</strong></td> <td>odmAcklm</td> <td>AN1..50</td> <td>İ</td> <td>ÖBHS’nin ÖHK’dan aldığı ya da kendisinin atadığı işlem açıklaması bilgisi.</td> <td></td> <td><strong>FAST/PÖS Acklm</strong></td></tr> <tr><td><strong>&gt;&gt; ÖHK Mesaj Alanı</strong></td> <td>ohkMsj</td> <td>AN1..200</td> <td>İ</td> <td>HHS’nin ÖHK’ya göstermek üzere ilettiği mesaj.</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Ödeme Sistemi</strong></td> <td>odmStm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeSistemi</strong> sıralı veri değerlerinden birini alır.</td> <td>Ödeme Emri Rizası Nesnesindeki Ödeme Sistemi verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Beklenen Ödeme Zamanı</strong></td> <td>bekOdmZmn</td> <td>ISODateTime</td> <td>K</td> <td>İşlemin yönlendirildiği ödeme sistemi PÖS ise ve PÖS işlem saatleri dışında ise işlemin yapılabileceği ilk zaman bilgisi</td> <td></td> <td></td></tr> <tr><td><strong>&gt; ÖBHS Masraf Tutarı</strong></td> <td>obhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td> <td>Ödeme Emri Rizası Nesnesindeki ÖBHS Masraf Para Birimi verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td>Ödeme Emri Rizası Nesnesindeki ÖBHS Masraf Tutarı verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt; HHS Masraf Tutarı</strong></td> <td>hhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td> <td>Ödeme Emri Rizası Nesnesindeki HHS Masraf Para Birimi verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>HHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td>Ödeme Emri Rizası Nesnesindeki HHS Masraf Tutarı verisi ile aynı olmalıdır.</td> <td></td></tr> <tr><td><strong>İşyeri Ödeme Bilgileri</strong></td> <td>isyOdmBlg</td> <td>Kompleks:IsyeriOdemeBilgileri</td> <td>İ</td> <td>İşyeri ödemelerinde kullanılabilecek alanlardır. Karekodlu işyeri ödemesi akışında bu alanlar dolu geldiği için isteğe bağlı olarak gönderilebilir. isyOdmBlg alanlarının en az birinin dolu olması durumunda istekte yer alır. <br>İşyeri Ödeme Bilgileri, YÖS uygulama önyüzünde ÖHK’nın bildiği ve girişi yapılması beklenen bir bilgi olmamalıdır. YÖS tarafından sistemsel olarak doldurulması gereklidir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; İşyeri Kategori Kodu</strong></td> <td>isyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlemin, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC). Ödeme Amacı = ‘06’ ya da ‘04’ olan ödeme işlemleri için doldurulabilir.<br>4 karakterden küçük değerlerin başına 0 eklenerek iletilmesi gereklidir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt; Alt İşyeri Kategori Kodu</strong></td> <td>altIsyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlem alt işyerinden gerçekleştiriliyorsa, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC).<br>4 karakterden küçük değerlerin başına 0 eklenerek iletilmesi gereklidir.</td> <td></td> <td></td></tr> <tr><td><strong>&gt;Üye İş Yeri Tekil Kimlik</strong></td> <td>genelUyeIsyeriNo</td> <td>AN8</td> <td>İ</td> <td>İşyeri kayıt sisteminde kayıtlı İşyeri için BKM tarafından üretilmiş olan genel işyeri numarasıdır (GlobalMerchantId) 8 haneden küçük gönderiminde başa ‘0’ eklenmelidir. Örnek değer ‘01630618’</td> <td></td> <td></td></tr></tbody></table> <p><strong>BAŞARILI YANIT:</strong></p> <p>POST işleminin RESPONSE gövdesini (BODY) oluşturan “OdemeEmri” nesnesi Tablo-10’daki parametrelerden oluşur:</p> <p><strong>Tablo 10: “OdemeEmri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format: Veri modeli İsmi</th> <th>Zorunlu / Koşullu / İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td><strong>Riza Bilgileri</strong></td> <td>rzBlg</td> <td>Kompleks: RizaBilgileri</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Rıza No</strong></td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>OdemeEmriRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td></tr> <tr><td><strong>&gt; Oluşturma Zamanı</strong></td> <td>olusZmn</td> <td>ISODateTime</td> <td>Z</td> <td>OdemeEmriRizasi nesnesinin oluşturulma zamanıdır.</td></tr> <tr><td><strong>&gt; Rıza Durumu</strong></td> <td>rizaDrm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.RizaDurumu</strong> sıralı veri tipini değerlerinden birini alır.</td></tr> <tr><td><strong>Katılımcı Bilgisi</strong></td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td></tr> <tr><td><strong>&gt;Hesap Hizmeti Sağlayıcısı Kodu</strong></td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td></tr> <tr><td><strong>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</strong></td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur.</td></tr> <tr><td><strong>GKD</strong></td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Yetkilendirme Yöntemi</strong></td> <td>yetYntm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.GkdTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt; Yönlenme Adresi</strong></td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli güçlü kimlik doğrulama için zorunlu.</td></tr> <tr><td><strong>&gt; Bildirim Adresi</strong></td> <td>bldAdr</td> <td>AN1..1024</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu.</td></tr> <tr><td><strong>&gt; HHS Yönlenme Adresi</strong></td> <td>hhsYonAdr</td> <td>AN1..1024</td> <td>K</td> <td>GKD doğrulama bilgilerinin girilebilmesi için uygulamadan açılacak yönlendirme sayfasının adresi</td></tr> <tr><td><strong>&gt; Yetkilendirme Tamamlanma Zamanı</strong></td> <td>yetTmmZmn</td> <td>ISODateTime</td> <td>Z</td> <td>Yetkilendirme akışının tamamlanması gereken son zamanı gösterir. <br> Rıza durumu Yetkilendirildi statüsüne geçene kadarki süredir.</td></tr> <tr><td><strong>Emir Bilgileri</strong></td> <td>emrBlg</td> <td>Kompleks: EmirBilgileri</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Ödeme Emri Numarası</strong></td> <td>odmEmriNo</td> <td>AN1..128</td> <td>Z</td> <td>odemeEmri nesnesinin UID'sidir. OdemeEmrine İlişkin sorgular bu ID üzerinden yapılır.</td></tr> <tr><td><strong>&gt; Ödeme Emri Zaman</strong></td> <td>odmEmriZmn</td> <td>ISODateTime</td> <td>Z</td> <td>odemeEmri nesnesinin oluşturulma zamanıdır.</td></tr> <tr><td><strong>Ödeme Başlatma</strong></td> <td>odmBsltm</td> <td>Kompleks: OdemeBaslatma</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt; Kimlik</strong></td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Kimlik Türü</strong></td> <td>kmlkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Kimlik Verisi</strong></td> <td>kmlkVrs</td> <td>AN1..30</td> <td>Z</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır.<br><strong>TR.OHVPS.DataCode.KimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Türü</strong></td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür.<br><strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Kurum Kimlik Verisi</strong></td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>Kurum adına yapılan ödemelerde ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir.<br> <strong>TR.OHVPS.DataCode.KurumKimlikTur</strong> değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Hizmeti Kullanıcısı Türü</strong></td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OhkTur</strong> sıralı veri türü değerlerinden birini alır <strong>(B: Bireysel, K:Kurumsal)</strong></td></tr> <tr><td><strong>&gt; İşlem Tutarı</strong></td> <td>islTtr</td> <td>Kompleks:Tutar</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para Birimi.<br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>53: (Para Birimi)</strong> alanında tanımlı Para Birimi verisi kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS'nin ön yüzde kullanıcıdan teyit aldığı tutar. <br> Karekod akışında, FAST Karekod Veri Organizasyonundaki <strong>54: (Tutar)</strong> alanında tanımlı Tutar verisi kullanılır.  <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>&gt; Gönderen</strong></td> <td>gon</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>Z</td> <td>Gönderen kişinin ad soyad ya da ticari unvan bilgisi.</td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>K</td> <td>ÖBHS tarafından iletilip doğrulanan veya HHS ekranında seçilen Gönderen Hesap Numarası dönülür.</td></tr> <tr><td><strong>&gt;&gt; Hesap Referansı</strong></td> <td>hspRef</td> <td>AN5..40</td> <td>K</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid)<br> YÖS bazında farklılaşması gerekmez.<br>ÖBHS’nin aynı zamanda HBHS olduğu durumda müşteri rızası tesis edilmiş bir hesabın referansı üzerinden de ödeme başaltılabilir.<br>GKD sonrası HHS ekranında seçilen Hesap Referansı POST işleminin yanıtında dönülemez ancak isteğe bağlı GET sorgusu ile dönülebilir.<br>Hesap Numarası kullanılıyorsa Hesap Referansı kullanılmayabilir.</td></tr> <tr><td><strong>&gt; Alıcı</strong></td> <td>alc</td> <td>Kompleks:Hesap</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Unvan</strong></td> <td>unv</td> <td>AN3..140</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen adres kaydı yaptırmış olan alıcının maskeli ad-soyadı veya maskeli ticari unvan bilgisidir. Kolas’tan dönen “account owner” alanı kullanılmalıdır.<br>Kolay adres değil ise ÖBHS tarafından istek mesajında iletilen unvan bilgisidir.</td></tr> <tr><td><strong>&gt;&gt; Hesap Numarası</strong></td> <td>hspNo</td> <td>AN26</td> <td>Z</td> <td>Alıcının Hesap Numarası alanıdır (IBAN).<br>Kolay Adres  sorgusunda dönülen adres kaydı yaptırmış olan alıcının maskeli IBAN bilgisidir.<br>Kolay adres değil ise ÖBHS tarafından istek mesajında iletilen IBAN bilgisidir. Karekod akışında, FAST Karekod Veri Organizasyonundaki 30-01: alanında tanımlı İş Yeri IBAN verisi kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Kolay Adres</strong></td> <td>kolas</td> <td>Kompleks:Kolas</td> <td>K</td> <td></td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Türü</strong></td> <td>kolasTur</td> <td>AN1</td> <td>Z</td> <td>Müşterinin sorgulamak istediği Kolay Adres Tipi değeridir. <br><strong>TR.OHVPS.DataCode.KolasTur</strong> sıralı veri türü değerlerinden birini alır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Değeri</strong></td> <td>kolasDgr</td> <td>AN7..50</td> <td>Z</td> <td>Müşterinin eklediği, HHS (FAST katılımcısı) tarafından doğrulanmış Kolay Adres değeridir. Alabileceği değerler BKM “Kolay Adresleme Sistemi Uygulama Kuralları” belgesinde tanımlıdır.<br> Alıcı Hesap Numarası girilmediyse kullanımı zorunludur ve <strong>Kolay Adres Tipi</strong> alanıyla birlikte kullanılır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Referans Numarası</strong></td> <td>kolasRefNo</td> <td>N12</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı KOLAS tarafından ilgili sorguya özel olarak üretilmiş referans numarasıdır.</td></tr> <tr><td><strong>&gt;&gt;&gt; Kolas Hesap Türü</strong></td> <td>kolasHspTur</td> <td>AN1</td> <td>Z</td> <td>Kolay Adres Alıcı Sorgusunda başarılı sorgu sonucunda dönülen, BKM Kolay Adresleme Sistemi Uygulama Kuralları’nda tanımlı hesap türü bilgisidir:<br> <strong>TR.OHVPS.DataCode.KolasHspTur</strong> sıralı veri değerlerinden birini alır.</td></tr> <tr><td><strong>&gt; Karekod</strong></td> <td>kkod</td> <td>Kompleks:Karekod</td> <td>K</td> <td></td></tr> <tr><td><strong>&gt;&gt; Akış Türü</strong></td> <td>aksTur</td> <td>AN2</td> <td>Z</td> <td>Karekod Akış Türü Karekod ödemesinin hangi akışla gerçekleştirildiğini gösterir.<br> Kolay Adresi Sistemi ile birlikte kullanılmaz.<br> 01: FAST katılımcısından dinamik doğrulama hizmeti alınan işyeri ödemesi<br> 02: FAST katılımcısından statik doğrulama hizmeti alınan işyeri ödemesi<br>03: Kişiden kişiye ödemeler</td></tr> <tr><td><strong>&gt;&gt; Referansı</strong></td> <td>kkodRef</td> <td>AN1..12</td> <td>K</td> <td>Karekod referans numarasını gösterir.<br> Okunan karekodda referans değeri varsa kullanılması zorunludur.<br>Kolay Adresi Sistemi ile birlikte kullanılmaz.</td></tr> <tr><td><strong>&gt;&gt; Üretici Kodu</strong></td> <td>kkodUrtcKod</td> <td>AN4</td> <td>Z</td> <td>Karekod üreticisinin kodu.<br> Ödeme Hizmeti Sağlayıcıları ve TCMB tarafından uygun görülen ödeme sistemi işleticisi TR Karekod üretebilmek için BKM’ye kayıt başvurusu yaparak karekod üretici kodu alabileceklerdir. Bankalar EFT kodlarını kullanacak olup ayrıca kayıt yaptırmalarına gerek bulunmamaktadır. 4 haneden kısa değerlerin sol tarafı ’0’ karakteri ile tamamlanmalıdır.</td></tr> <tr><td><strong>&gt; Ödeme Ayrıntıları</strong></td> <td>odmAyr</td> <td>Kompleks: OdemeAyrintilari</td> <td>Z</td> <td></td></tr> <tr><td><strong>&gt;&gt; Ödeme Kaynağı</strong></td> <td>odmKynk</td> <td>AN1</td> <td>Z</td> <td>Ödemenin başlatıldığı kaynağı belirtir. <strong>TR.OHVPS.DataCode.OdemeKaynak</strong> sıralı veri değerlerinden “O”  değerini alır. “O” değeri “Açık bankacılık aracılığı ile gönderilen ödemelerde kullanılır.” anlamını taşımaktadır.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Durumu</strong></td> <td>odmDrm</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeDurumu</strong> sıralı veri değerlerinden birini alır.  <br> <br> Ödeme Durumu alanı ile ilgili olarak HHS’ler tarafından YÖS’lere  OdemeEmri servisi yanıtında 02:Gönderildi, 04:Onayda Bekliyor,05:İşleme Alındı yanıtları gönderilebilir.<br> <br><strong>05:İşleme Alındı</strong> durumu YÖS tarafından müşteriye gösterilmeyen bir koddur. Bu kod dönüldüğünde YÖS uygulamasında ÖHK’ya ödeme durumu <strong>02:Gönderildi</strong> olarak gösterilir. İşlemin son durumunun teyidi için YÖS ödeme emri sorgulaması yapmalıdır.<br> <br><strong>02:Gönderildi</strong> durumu oluştuktan sonra YÖS tarafından ödeme emri sorgulaması yapılarak ödeme durumunun güncel değeri öğrenilir. Güncel değerler <strong>01:Gerçekleşti,03:Gerçekleşmedi</strong> durumları olabilir.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Amacı</strong></td> <td>odmAmc</td> <td>AN2</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeAmaci</strong> sıralı veri değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Referans Bilgisi</strong></td> <td>refBlg</td> <td>AN1..140</td> <td>K</td> <td>Ödemeye özel <strong>Referans Bilgisi</strong> alanıdır. Karekod işlemi değil ise zorunludur.<br> -	Kişiden kişiye fon aktarımlarda: Gün içerisinde ÖHK özelinde, her işleme özel biricik olarak oluşturulan referans bilgisidir.<br> Karekod P2P akışı için referans bilgisi (Karekod referans numarası değil, işleme özel üretilecek referans bilgisidir.) YÖS tarafından atanacaktır.<br> -	E-ticaret işlemlerinde sipariş/takip numarası/müşteri/abone numarası<br> - İşyeri Ödemesi Karekod akışında, FAST Karekod Veri Organizasyonundaki<br> -	62-01: alanında tanımlı Fatura Numarası <br> -	62-06: alanında tanımlı Müşteri Numarası <br> verilerinden biri kullanılır.</td></tr> <tr><td><strong>&gt;&gt; Açıklama</strong></td> <td>odmAcklm</td> <td>AN1..50</td> <td>İ</td> <td>ÖBHS’nin ÖHK’dan aldığı ya da kendisinin atadığı işlem açıklaması bilgisi.</td></tr> <tr><td><strong>&gt;&gt; ÖHK Mesaj Alanı</strong></td> <td>ohkMsj</td> <td>AN1..200</td> <td>İ</td> <td>HHS’nin ÖHK’ya göstermek üzere ilettiği mesaj.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Sistemi</strong></td> <td>odmStm</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.OdemeSistemi</strong> sıralı veri değerlerinden birini alır.</td></tr> <tr><td><strong>&gt;&gt; Ödeme Sistem Numarası</strong></td> <td>odmStmNo</td> <td>AN10..50</td> <td>K</td> <td>Ödeme başarılı başlatıldıysa, ödemenin başlatıldığı sistemdeki referans numarası. Gerektiğinde ilgili ödeme sisteminde/HHS’de söz konusu ödemeye karşılık gelen mesajla bağlantı kurmada kullanılır. <br> Ödeme Hizmeti kullanıcısına işlemin takibi için gösterilebilir. <br>İşlemin yönlendirildiği ödeme sistemi FAST ya da PÖS ise sistemdeki ilgili mesajın Tarih, GönderenKatilimKodu ve SorguNumarasi değerlerinin birleşiminden oluşur. Bu 3 alan mevcutta kullanıldığı formatta aralarına dikey çizgi (Unicode U+2223) işareti koyularak, birleştirmeli ve iletilmelidir. Örn : Tarih|GönderenKatilimKodu|SorguNumarasi  <br>Ödeme Havale/Virman işlemi ise HHS’nin üretmiş olduğu havale/virman numarasını içerir. Buradaki format da Tarih|GönderenKatilimKodu|Havale-virman numarası şeklinde olmalıdır.</td></tr> <tr><td><strong>&gt;&gt; Beklenen Ödeme Zamanı</strong></td> <td>bekOdmZmn</td> <td>ISODateTime</td> <td>K</td> <td>İşlemin yönlendirildiği ödeme sistemi PÖS ise ve PÖS işlem saatleri dışında ise işlemin yapılabileceği ilk zaman bilgisi</td></tr> <tr><td><strong>&gt; ÖBHS Masraf Tutarı</strong></td> <td>obhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>ÖBHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>&gt; HHS Masraf Tutarı</strong></td> <td>hhsMsrfTtr</td> <td>Kompleks:Tutar</td> <td>İ</td> <td>API İlke ve Kuralları 1.0 sürümünde bu nesnenin API deseninde gönderilmemesi gerekmektedir.</td></tr> <tr><td><strong>&gt;&gt; Para Birimi</strong></td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi (TRY, USD, EUR vb.).</td></tr> <tr><td><strong>&gt;&gt; Tutar</strong></td> <td>ttr</td> <td>AN1..24</td> <td>Z</td> <td>HHS’nin işlemle ilgili ÖHK’nın borçlandırılmasını belirttiği masraf tutarı. İşlem Tutarı ile aynı para biriminde olmalıdır. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td><strong>İşyeri Ödeme Bilgileri</strong></td> <td>isyOdmBlg</td> <td>Kompleks:IsyeriOdemeBilgileri</td> <td>İ</td> <td>İşyeri ödemelerinde kullanılabilecek alanlardır. Karekodlu işyeri ödemesi akışında bu alanlar dolu geldiği için isteğe bağlı olarak gönderilebilir. isyOdmBlg alanlarının en az birinin dolu olması durumunda yanıtta yer alır.</td></tr> <tr><td><strong>&gt; İşyeri Kategori Kodu</strong></td> <td>isyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlemin, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC). Ödeme Amacı = ‘06’ ya da ‘04’ olan ödeme işlemleri için doldurulabilir.</td></tr> <tr><td><strong>&gt; Alt İşyeri Kategori Kodu</strong></td> <td>altIsyKtgKod</td> <td>AN4</td> <td>İ</td> <td>İşlem alt işyerinden gerçekleştiriliyorsa, ISO 18245:2003 uyumlu İşyeri Kategori Kodudur (Merchant Category Code, MCC).</td></tr> <tr><td><strong>&gt;Üye İş Yeri Tekil Kimlik</strong></td> <td>genelUyeIsyeriNo</td> <td>AN8</td> <td>İ</td> <td>İşyeri kayıt sisteminde kayıtlı İşyeri için BKM tarafından üretilmiş olan genel işyeri numarasıdır (GlobalMerchantId) 8 haneden küçük gönderiminde başa ‘0’ eklenmelidir. Örnek değer ‘01630618’</td></tr></tbody></table> <h2 id="_6-6-adim-3-1-odeme-emri-sorgusu-istege-baglı"><a href="#_6-6-adim-3-1-odeme-emri-sorgusu-istege-baglı" class="header-anchor">#</a> 6.6.	ADIM 3.1- Ödeme Emri Sorgusu (İsteğe bağlı)</h2> <img src="/assets/img/OdemeEmriSorgulanmasi.7006c5c3.png" width="75%"> <p><strong>Şekil 9: Ödeme Emri Sorgusu</strong></p> <h3 id="get-odeme-emri-odemeemrino"><a href="#get-odeme-emri-odemeemrino" class="header-anchor">#</a> GET /odeme-emri/{odemeEmriNo}</h3> <p>ÖBHS, bu erişim adresi aracılığıyla ödeme emrini sorgulayabilir.</p> <p><strong>BAŞARILI YANIT:</strong></p> <p>GET /odeme-emri/{odemeEmriNo} yanıtının (RESPONSE) gövdesinde (BODY)  “OdemeEmri” nesnesi bulunur. İstek başarıyla sonuçlanırsa HHS kaynak sunucusunda Tablo-10’da yer alan parametreleri içeren “OdemeEmri” nesnesi döner.</p> <h2 id="_6-7healthcheck-api"><a href="#_6-7healthcheck-api" class="header-anchor">#</a> 6.7	Healthcheck API</h2> <h3 id="get-health"><a href="#get-health" class="header-anchor">#</a> GET /health</h3> <p>HHS’lerin sunacağı bu servis, düzenli olarak BKM tarafından çağırılarak servislerin ayakta olup olmadıklarının kontrolünün sağlanması planlanmaktadır</p> <p>Başarılı yanıtta Http 200 kodu dönülmelidir.</p> <p>Başarılı Yanıt:</p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format: Veri modeli İsmi</th> <th>Zorunlu / Koşullu / İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>status</td> <td>status</td> <td>AN2..20</td> <td>Z</td> <td>“UP”, “DOWN” değerlerini alabilir</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/v1.1.0/contents/gkd.html" class="prev">
        5. Güçlü Kimlik Doğrulama
      </a></span> <span class="next"><a href="/v1.1.0/contents/hesap-bilgisi-hizmeti.html">
        7. Hesap Bilgisi Hizmeti
      </a>
      →
    </span></p></div> <div class="footer-wrapper"><footer class="page-edit footer"><div class="footer-info"><p style="padding-right:15px;">© Tüm hakları saklıdır.</p></div></footer></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.4b4fd2a6.js" defer></script><script src="/assets/js/12.a5734c1f.js" defer></script><script src="/assets/js/2.6760484d.js" defer></script><script src="/assets/js/5.83a11720.js" defer></script>
  </body>
</html>
