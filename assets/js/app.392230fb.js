(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[]]);!function(e){function n(n){for(var a,t,d=n[0],s=n[1],m=n[2],o=0,k=[];o<d.length;o++)t=d[o],Object.prototype.hasOwnProperty.call(r,t)&&r[t]&&k.push(r[t][0]),r[t]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);for(u&&u(n);k.length;)k.shift()();return l.push.apply(l,m||[]),i()}function i(){for(var e,n=0;n<l.length;n++){for(var i=l[n],a=!0,d=1;d<i.length;d++){var s=i[d];0!==r[s]&&(a=!1)}a&&(l.splice(n--,1),e=t(t.s=i[0]))}return e}var a={},r={13:0},l=[];function t(n){if(a[n])return a[n].exports;var i=a[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.e=function(e){var n=[],i=r[e];if(0!==i)if(i)n.push(i[2]);else{var a=new Promise((function(n,a){i=r[e]=[n,a]}));n.push(i[2]=a);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,t.nc&&d.setAttribute("nonce",t.nc),d.src=function(e){return t.p+"assets/js/"+({14:"vendors~docsearch"}[e]||e)+"."+{1:"c8a54a76",2:"1fea5acc",3:"972778d6",4:"251ecbb8",5:"15938fdf",6:"891ffd49",7:"ba226371",8:"9be4df52",9:"e8c984ba",10:"0013b1ca",11:"a3070fdc",12:"566a3746",14:"5a984fc5",15:"d1b7b5ca",16:"fa3faba3",17:"1a0c8e92",18:"f1a32fb9",19:"db50cfa3",20:"08e89fa0",21:"83e734ab",22:"ddb88fe1",23:"e7f73ff9",24:"bd8dbdc4",25:"d3c8b620",26:"4bf8a98d",27:"ff1d9e6b",28:"b7df9e2b",29:"8b9f29b1",30:"e8340684",31:"cbf3b03e",32:"b7cc1a7a",33:"f462d3de",34:"7c089a6b",35:"384f732f",36:"70874847",37:"9e51f23a",38:"66c36614",39:"ecc273e5",40:"1672db31",41:"7b8afaf4",42:"848ebf48",43:"08b78d5f",44:"7f1bcb91",45:"b6d4a6d8",46:"9b1bb3df",47:"b38fa65c",48:"73cc88a4",49:"8fcc906e",50:"9823450c",51:"b82cae03",52:"d1db42cd",53:"6e7eefae",54:"76e88dfe",55:"f0875cb9",56:"58f71397",57:"eb78941b",58:"40bf9850",59:"501b2319",60:"3cc60006",61:"1fe88ee1",62:"8638b710",63:"9862a296",64:"d548f274",65:"b4e4f6ab",66:"0018cbce",67:"feca7be4",68:"b7d9e107",69:"b1a09e5f",70:"b3527401",71:"542419a5",72:"23f80ea5",73:"30dbca3a",74:"5a79b7f0",75:"f262b7f9",76:"5cd4030f",77:"3ee7128f",78:"451cd678",79:"b8c70d10",80:"ac72ceb5",81:"72a03af0",82:"b45a4a50",83:"5b7cc9c7",84:"46618482",85:"d6229fb5",86:"4835385b",87:"6520c62e",88:"12faecc4",89:"8b7a37aa",90:"217a4b34",91:"207b4781",92:"80f84780",93:"9e5d47dd",94:"0569f129",95:"b362b4c1",96:"2d231ba0",97:"f05d429c",98:"f6be17e8",99:"2cb5d2f5",100:"6d86156e",101:"172ad69c",102:"67cf6e91",103:"995efdba",104:"b0434a6a",105:"134c00dd",106:"cd86eef2",107:"320e6ac1",108:"bccfa910",109:"db7c7fc1",110:"932844af",111:"e0e213cf"}[e]+".js"}(e);var s=new Error;l=function(n){d.onerror=d.onload=null,clearTimeout(m);var i=r[e];if(0!==i){if(i){var a=n&&("load"===n.type?"missing":n.type),l=n&&n.target&&n.target.src;s.message="Loading chunk "+e+" failed.\n("+a+": "+l+")",s.name="ChunkLoadError",s.type=a,s.request=l,i[1](s)}r[e]=void 0}};var m=setTimeout((function(){l({type:"timeout",target:d})}),12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(n)},t.m=e,t.c=a,t.d=function(e,n,i){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:i})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(t.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var a in e)t.d(i,a,function(n){return e[n]}.bind(null,a));return i},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="/",t.oe=function(e){throw console.error(e),e};var d=window.webpackJsonp=window.webpackJsonp||[],s=d.push.bind(d);d.push=n,d=d.slice();for(var m=0;m<d.length;m++)n(d[m]);var u=s;l.push([145,0]),i()}([function(e,n,i){"use strict";i.r(n),i.d(n,"EffectScope",(function(){return Sn})),i.d(n,"computed",(function(){return sn})),i.d(n,"customRef",(function(){return en})),i.d(n,"default",(function(){return qa})),i.d(n,"defineAsyncComponent",(function(){return Pi})),i.d(n,"defineComponent",(function(){return ji})),i.d(n,"del",(function(){return Ee})),i.d(n,"effectScope",(function(){return hn})),i.d(n,"getCurrentInstance",(function(){return ke})),i.d(n,"getCurrentScope",(function(){return zn})),i.d(n,"h",(function(){return yi})),i.d(n,"inject",(function(){return An})),i.d(n,"isProxy",(function(){return xe})),i.d(n,"isReactive",(function(){return Me})),i.d(n,"isReadonly",(function(){return Fe})),i.d(n,"isRef",(function(){return je})),i.d(n,"isShallow",(function(){return _e})),i.d(n,"markRaw",(function(){return we})),i.d(n,"mergeDefaults",(function(){return si})),i.d(n,"nextTick",(function(){return Bi})),i.d(n,"onActivated",(function(){return Ci})),i.d(n,"onBeforeMount",(function(){return Oi})),i.d(n,"onBeforeUnmount",(function(){return Zi})),i.d(n,"onBeforeUpdate",(function(){return Ii})),i.d(n,"onDeactivated",(function(){return Vi})),i.d(n,"onErrorCaptured",(function(){return Li})),i.d(n,"onMounted",(function(){return Di})),i.d(n,"onRenderTracked",(function(){return _i})),i.d(n,"onRenderTriggered",(function(){return Fi})),i.d(n,"onScopeDispose",(function(){return vn})),i.d(n,"onServerPrefetch",(function(){return Mi})),i.d(n,"onUnmounted",(function(){return Gi})),i.d(n,"onUpdated",(function(){return Ei})),i.d(n,"provide",(function(){return Kn})),i.d(n,"proxyRefs",(function(){return qe})),i.d(n,"reactive",(function(){return Ge})),i.d(n,"readonly",(function(){return rn})),i.d(n,"ref",(function(){return Ue})),i.d(n,"set",(function(){return Ie})),i.d(n,"shallowReactive",(function(){return Ce})),i.d(n,"shallowReadonly",(function(){return dn})),i.d(n,"shallowRef",(function(){return $e})),i.d(n,"toRaw",(function(){return Le})),i.d(n,"toRef",(function(){return an})),i.d(n,"toRefs",(function(){return nn})),i.d(n,"triggerRef",(function(){return We})),i.d(n,"unref",(function(){return Xe})),i.d(n,"useAttrs",(function(){return li})),i.d(n,"useCssModule",(function(){return Ri})),i.d(n,"useCssVars",(function(){return Yi})),i.d(n,"useListeners",(function(){return ti})),i.d(n,"useSlots",(function(){return ri})),i.d(n,"version",(function(){return wi})),i.d(n,"watch",(function(){return pn})),i.d(n,"watchEffect",(function(){return kn})),i.d(n,"watchPostEffect",(function(){return yn})),i.d(n,"watchSyncEffect",(function(){return bn}));
/*!
 * Vue.js v2.7.16
 * (c) 2014-2023 Evan You
 * Released under the MIT License.
 */
var a=Object.freeze({}),r=Array.isArray;function l(e){return null==e}function t(e){return null!=e}function d(e){return!0===e}function s(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e||"boolean"==typeof e}function m(e){return"function"==typeof e}function u(e){return null!==e&&"object"==typeof e}var o=Object.prototype.toString;function k(e){return"[object Object]"===o.call(e)}function y(e){return"[object RegExp]"===o.call(e)}function b(e){var n=parseFloat(String(e));return n>=0&&Math.floor(n)===n&&isFinite(e)}function c(e){return t(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function g(e){return null==e?"":Array.isArray(e)||k(e)&&e.toString===o?JSON.stringify(e,p,2):String(e)}function p(e,n){return n&&n.__v_isRef?n.value:n}function H(e){var n=parseFloat(e);return isNaN(n)?e:n}function S(e,n){for(var i=Object.create(null),a=e.split(","),r=0;r<a.length;r++)i[a[r]]=!0;return n?function(e){return i[e.toLowerCase()]}:function(e){return i[e]}}S("slot,component",!0);var h=S("key,ref,slot,slot-scope,is");function z(e,n){var i=e.length;if(i){if(n===e[i-1])return void(e.length=i-1);var a=e.indexOf(n);if(a>-1)return e.splice(a,1)}}var v=Object.prototype.hasOwnProperty;function K(e,n){return v.call(e,n)}function f(e){var n=Object.create(null);return function(i){return n[i]||(n[i]=e(i))}}var A=/-(\w)/g,T=f((function(e){return e.replace(A,(function(e,n){return n?n.toUpperCase():""}))})),B=f((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),R=/\B([A-Z])/g,Y=f((function(e){return e.replace(R,"-$1").toLowerCase()}));var P=Function.prototype.bind?function(e,n){return e.bind(n)}:function(e,n){function i(i){var a=arguments.length;return a?a>1?e.apply(n,arguments):e.call(n,i):e.call(n)}return i._length=e.length,i};function N(e,n){n=n||0;for(var i=e.length-n,a=new Array(i);i--;)a[i]=e[i+n];return a}function O(e,n){for(var i in n)e[i]=n[i];return e}function D(e){for(var n={},i=0;i<e.length;i++)e[i]&&O(n,e[i]);return n}function I(e,n,i){}var E=function(e,n,i){return!1},Z=function(e){return e};function G(e,n){if(e===n)return!0;var i=u(e),a=u(n);if(!i||!a)return!i&&!a&&String(e)===String(n);try{var r=Array.isArray(e),l=Array.isArray(n);if(r&&l)return e.length===n.length&&e.every((function(e,i){return G(e,n[i])}));if(e instanceof Date&&n instanceof Date)return e.getTime()===n.getTime();if(r||l)return!1;var t=Object.keys(e),d=Object.keys(n);return t.length===d.length&&t.every((function(i){return G(e[i],n[i])}))}catch(e){return!1}}function C(e,n){for(var i=0;i<e.length;i++)if(G(e[i],n))return i;return-1}function V(e){var n=!1;return function(){n||(n=!0,e.apply(this,arguments))}}function M(e,n){return e===n?0===e&&1/e!=1/n:e==e||n==n}var _=["component","directive","filter"],F=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],x={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:E,isReservedAttr:E,isUnknownElement:E,getTagNamespace:I,parsePlatformTagName:Z,mustUseProp:E,async:!0,_lifecycleHooks:F},L=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function w(e){var n=(e+"").charCodeAt(0);return 36===n||95===n}function j(e,n,i,a){Object.defineProperty(e,n,{value:i,enumerable:!!a,writable:!0,configurable:!0})}var U=new RegExp("[^".concat(L.source,".$_\\d]"));var $="__proto__"in{},J="undefined"!=typeof window,W=J&&window.navigator.userAgent.toLowerCase(),X=W&&/msie|trident/.test(W),q=W&&W.indexOf("msie 9.0")>0,Q=W&&W.indexOf("edge/")>0;W&&W.indexOf("android");var ee=W&&/iphone|ipad|ipod|ios/.test(W);W&&/chrome\/\d+/.test(W),W&&/phantomjs/.test(W);var ne,ie=W&&W.match(/firefox\/(\d+)/),ae={}.watch,re=!1;if(J)try{var le={};Object.defineProperty(le,"passive",{get:function(){re=!0}}),window.addEventListener("test-passive",null,le)}catch(e){}var te=function(){return void 0===ne&&(ne=!J&&"undefined"!=typeof global&&(global.process&&"server"===global.process.env.VUE_ENV)),ne},de=J&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function se(e){return"function"==typeof e&&/native code/.test(e.toString())}var me,ue="undefined"!=typeof Symbol&&se(Symbol)&&"undefined"!=typeof Reflect&&se(Reflect.ownKeys);me="undefined"!=typeof Set&&se(Set)?Set:function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(e){return!0===this.set[e]},e.prototype.add=function(e){this.set[e]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var oe=null;function ke(){return oe&&{proxy:oe}}function ye(e){void 0===e&&(e=null),e||oe&&oe._scope.off(),oe=e,e&&e._scope.on()}var be=function(){function e(e,n,i,a,r,l,t,d){this.tag=e,this.data=n,this.children=i,this.text=a,this.elm=r,this.ns=void 0,this.context=l,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=n&&n.key,this.componentOptions=t,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=d,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(e.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),e}(),ce=function(e){void 0===e&&(e="");var n=new be;return n.text=e,n.isComment=!0,n};function ge(e){return new be(void 0,void 0,void 0,String(e))}function pe(e){var n=new be(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return n.ns=e.ns,n.isStatic=e.isStatic,n.key=e.key,n.isComment=e.isComment,n.fnContext=e.fnContext,n.fnOptions=e.fnOptions,n.fnScopeId=e.fnScopeId,n.asyncMeta=e.asyncMeta,n.isCloned=!0,n}"function"==typeof SuppressedError&&SuppressedError;var He=0,Se=[],he=function(){function e(){this._pending=!1,this.id=He++,this.subs=[]}return e.prototype.addSub=function(e){this.subs.push(e)},e.prototype.removeSub=function(e){this.subs[this.subs.indexOf(e)]=null,this._pending||(this._pending=!0,Se.push(this))},e.prototype.depend=function(n){e.target&&e.target.addDep(this)},e.prototype.notify=function(e){var n=this.subs.filter((function(e){return e}));for(var i=0,a=n.length;i<a;i++){0,n[i].update()}},e}();he.target=null;var ze=[];function ve(e){ze.push(e),he.target=e}function Ke(){ze.pop(),he.target=ze[ze.length-1]}var fe=Array.prototype,Ae=Object.create(fe);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(e){var n=fe[e];j(Ae,e,(function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var r,l=n.apply(this,i),t=this.__ob__;switch(e){case"push":case"unshift":r=i;break;case"splice":r=i.slice(2)}return r&&t.observeArray(r),t.dep.notify(),l}))}));var Te=Object.getOwnPropertyNames(Ae),Be={},Re=!0;function Ye(e){Re=e}var Pe={notify:I,depend:I,addSub:I,removeSub:I},Ne=function(){function e(e,n,i){if(void 0===n&&(n=!1),void 0===i&&(i=!1),this.value=e,this.shallow=n,this.mock=i,this.dep=i?Pe:new he,this.vmCount=0,j(e,"__ob__",this),r(e)){if(!i)if($)e.__proto__=Ae;else for(var a=0,l=Te.length;a<l;a++){j(e,d=Te[a],Ae[d])}n||this.observeArray(e)}else{var t=Object.keys(e);for(a=0;a<t.length;a++){var d;De(e,d=t[a],Be,void 0,n,i)}}}return e.prototype.observeArray=function(e){for(var n=0,i=e.length;n<i;n++)Oe(e[n],!1,this.mock)},e}();function Oe(e,n,i){return e&&K(e,"__ob__")&&e.__ob__ instanceof Ne?e.__ob__:!Re||!i&&te()||!r(e)&&!k(e)||!Object.isExtensible(e)||e.__v_skip||je(e)||e instanceof be?void 0:new Ne(e,n,i)}function De(e,n,i,a,l,t,d){void 0===d&&(d=!1);var s=new he,m=Object.getOwnPropertyDescriptor(e,n);if(!m||!1!==m.configurable){var u=m&&m.get,o=m&&m.set;u&&!o||i!==Be&&2!==arguments.length||(i=e[n]);var k=l?i&&i.__ob__:Oe(i,!1,t);return Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:function(){var n=u?u.call(e):i;return he.target&&(s.depend(),k&&(k.dep.depend(),r(n)&&Ze(n))),je(n)&&!l?n.value:n},set:function(n){var a=u?u.call(e):i;if(M(a,n)){if(o)o.call(e,n);else{if(u)return;if(!l&&je(a)&&!je(n))return void(a.value=n);i=n}k=l?n&&n.__ob__:Oe(n,!1,t),s.notify()}}}),s}}function Ie(e,n,i){if(!Fe(e)){var a=e.__ob__;return r(e)&&b(n)?(e.length=Math.max(e.length,n),e.splice(n,1,i),a&&!a.shallow&&a.mock&&Oe(i,!1,!0),i):n in e&&!(n in Object.prototype)?(e[n]=i,i):e._isVue||a&&a.vmCount?i:a?(De(a.value,n,i,void 0,a.shallow,a.mock),a.dep.notify(),i):(e[n]=i,i)}}function Ee(e,n){if(r(e)&&b(n))e.splice(n,1);else{var i=e.__ob__;e._isVue||i&&i.vmCount||Fe(e)||K(e,n)&&(delete e[n],i&&i.dep.notify())}}function Ze(e){for(var n=void 0,i=0,a=e.length;i<a;i++)(n=e[i])&&n.__ob__&&n.__ob__.dep.depend(),r(n)&&Ze(n)}function Ge(e){return Ve(e,!1),e}function Ce(e){return Ve(e,!0),j(e,"__v_isShallow",!0),e}function Ve(e,n){if(!Fe(e)){Oe(e,n,te());0}}function Me(e){return Fe(e)?Me(e.__v_raw):!(!e||!e.__ob__)}function _e(e){return!(!e||!e.__v_isShallow)}function Fe(e){return!(!e||!e.__v_isReadonly)}function xe(e){return Me(e)||Fe(e)}function Le(e){var n=e&&e.__v_raw;return n?Le(n):e}function we(e){return Object.isExtensible(e)&&j(e,"__v_skip",!0),e}function je(e){return!(!e||!0!==e.__v_isRef)}function Ue(e){return Je(e,!1)}function $e(e){return Je(e,!0)}function Je(e,n){if(je(e))return e;var i={};return j(i,"__v_isRef",!0),j(i,"__v_isShallow",n),j(i,"dep",De(i,"value",e,null,n,te())),i}function We(e){e.dep&&e.dep.notify()}function Xe(e){return je(e)?e.value:e}function qe(e){if(Me(e))return e;for(var n={},i=Object.keys(e),a=0;a<i.length;a++)Qe(n,e,i[a]);return n}function Qe(e,n,i){Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:function(){var e=n[i];if(je(e))return e.value;var a=e&&e.__ob__;return a&&a.dep.depend(),e},set:function(e){var a=n[i];je(a)&&!je(e)?a.value=e:n[i]=e}})}function en(e){var n=new he,i=e((function(){n.depend()}),(function(){n.notify()})),a=i.get,r=i.set,l={get value(){return a()},set value(e){r(e)}};return j(l,"__v_isRef",!0),l}function nn(e){var n=r(e)?new Array(e.length):{};for(var i in e)n[i]=an(e,i);return n}function an(e,n,i){var a=e[n];if(je(a))return a;var r={get value(){var a=e[n];return void 0===a?i:a},set value(i){e[n]=i}};return j(r,"__v_isRef",!0),r}function rn(e){return ln(e,!1)}function ln(e,n){if(!k(e))return e;if(Fe(e))return e;var i=n?"__v_rawToShallowReadonly":"__v_rawToReadonly",a=e[i];if(a)return a;var r=Object.create(Object.getPrototypeOf(e));j(e,i,r),j(r,"__v_isReadonly",!0),j(r,"__v_raw",e),je(e)&&j(r,"__v_isRef",!0),(n||_e(e))&&j(r,"__v_isShallow",!0);for(var l=Object.keys(e),t=0;t<l.length;t++)tn(r,e,l[t],n);return r}function tn(e,n,i,a){Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:function(){var e=n[i];return a||!k(e)?e:rn(e)},set:function(){}})}function dn(e){return ln(e,!0)}function sn(e,n){var i,a,r=m(e);r?(i=e,a=I):(i=e.get,a=e.set);var l=te()?null:new Xi(oe,i,I,{lazy:!0});var t={effect:l,get value(){return l?(l.dirty&&l.evaluate(),he.target&&l.depend(),l.value):i()},set value(e){a(e)}};return j(t,"__v_isRef",!0),j(t,"__v_isReadonly",r),t}var mn="".concat("watcher"," callback"),un="".concat("watcher"," getter"),on="".concat("watcher"," cleanup");function kn(e,n){return Hn(e,null,n)}function yn(e,n){return Hn(e,null,{flush:"post"})}function bn(e,n){return Hn(e,null,{flush:"sync"})}var cn,gn={};function pn(e,n,i){return Hn(e,n,i)}function Hn(e,n,i){var l=void 0===i?a:i,t=l.immediate,d=l.deep,s=l.flush,u=void 0===s?"pre":s;l.onTrack,l.onTrigger;var o,k,y=oe,b=function(e,n,i){void 0===i&&(i=null);var a=ci(e,null,i,y,n);return d&&a&&a.__ob__&&a.__ob__.dep.depend(),a},c=!1,g=!1;if(je(e)?(o=function(){return e.value},c=_e(e)):Me(e)?(o=function(){return e.__ob__.dep.depend(),e},d=!0):r(e)?(g=!0,c=e.some((function(e){return Me(e)||_e(e)})),o=function(){return e.map((function(e){return je(e)?e.value:Me(e)?(e.__ob__.dep.depend(),$i(e)):m(e)?b(e,un):void 0}))}):o=m(e)?n?function(){return b(e,un)}:function(){if(!y||!y._isDestroyed)return k&&k(),b(e,"watcher",[H])}:I,n&&d){var p=o;o=function(){return $i(p())}}var H=function(e){k=S.onStop=function(){b(e,on)}};if(te())return H=I,n?t&&b(n,mn,[o(),g?[]:void 0,H]):o(),I;var S=new Xi(oe,o,I,{lazy:!0});S.noRecurse=!n;var h=g?[]:gn;return S.run=function(){if(S.active)if(n){var e=S.get();(d||c||(g?e.some((function(e,n){return M(e,h[n])})):M(e,h)))&&(k&&k(),b(n,mn,[e,h===gn?void 0:h,H]),h=e)}else S.get()},"sync"===u?S.update=S.run:"post"===u?(S.post=!0,S.update=function(){return Ha(S)}):S.update=function(){if(y&&y===oe&&!y._isMounted){var e=y._preWatchers||(y._preWatchers=[]);e.indexOf(S)<0&&e.push(S)}else Ha(S)},n?t?S.run():h=S.get():"post"===u&&y?y.$once("hook:mounted",(function(){return S.get()})):S.get(),function(){S.teardown()}}var Sn=function(){function e(e){void 0===e&&(e=!1),this.detached=e,this.active=!0,this.effects=[],this.cleanups=[],this.parent=cn,!e&&cn&&(this.index=(cn.scopes||(cn.scopes=[])).push(this)-1)}return e.prototype.run=function(e){if(this.active){var n=cn;try{return cn=this,e()}finally{cn=n}}else 0},e.prototype.on=function(){cn=this},e.prototype.off=function(){cn=this.parent},e.prototype.stop=function(e){if(this.active){var n=void 0,i=void 0;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].teardown();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!e){var a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.parent=void 0,this.active=!1}},e}();function hn(e){return new Sn(e)}function zn(){return cn}function vn(e){cn&&cn.cleanups.push(e)}function Kn(e,n){oe&&(fn(oe)[e]=n)}function fn(e){var n=e._provided,i=e.$parent&&e.$parent._provided;return i===n?e._provided=Object.create(i):n}function An(e,n,i){void 0===i&&(i=!1);var a=oe;if(a){var r=a.$parent&&a.$parent._provided;if(r&&e in r)return r[e];if(arguments.length>1)return i&&m(n)?n.call(a):n}else 0}var Tn=f((function(e){var n="&"===e.charAt(0),i="~"===(e=n?e.slice(1):e).charAt(0),a="!"===(e=i?e.slice(1):e).charAt(0);return{name:e=a?e.slice(1):e,once:i,capture:a,passive:n}}));function Bn(e,n){function i(){var e=i.fns;if(!r(e))return ci(e,null,arguments,n,"v-on handler");for(var a=e.slice(),l=0;l<a.length;l++)ci(a[l],null,arguments,n,"v-on handler")}return i.fns=e,i}function Rn(e,n,i,a,r,t){var s,m,u,o;for(s in e)m=e[s],u=n[s],o=Tn(s),l(m)||(l(u)?(l(m.fns)&&(m=e[s]=Bn(m,t)),d(o.once)&&(m=e[s]=r(o.name,m,o.capture)),i(o.name,m,o.capture,o.passive,o.params)):m!==u&&(u.fns=m,e[s]=u));for(s in n)l(e[s])&&a((o=Tn(s)).name,n[s],o.capture)}function Yn(e,n,i){var a;e instanceof be&&(e=e.data.hook||(e.data.hook={}));var r=e[n];function s(){i.apply(this,arguments),z(a.fns,s)}l(r)?a=Bn([s]):t(r.fns)&&d(r.merged)?(a=r).fns.push(s):a=Bn([r,s]),a.merged=!0,e[n]=a}function Pn(e,n,i,a,r){if(t(n)){if(K(n,i))return e[i]=n[i],r||delete n[i],!0;if(K(n,a))return e[i]=n[a],r||delete n[a],!0}return!1}function Nn(e){return s(e)?[ge(e)]:r(e)?function e(n,i){var a,m,u,o,k=[];for(a=0;a<n.length;a++)l(m=n[a])||"boolean"==typeof m||(u=k.length-1,o=k[u],r(m)?m.length>0&&(On((m=e(m,"".concat(i||"","_").concat(a)))[0])&&On(o)&&(k[u]=ge(o.text+m[0].text),m.shift()),k.push.apply(k,m)):s(m)?On(o)?k[u]=ge(o.text+m):""!==m&&k.push(ge(m)):On(m)&&On(o)?k[u]=ge(o.text+m.text):(d(n._isVList)&&t(m.tag)&&l(m.key)&&t(i)&&(m.key="__vlist".concat(i,"_").concat(a,"__")),k.push(m)));return k}(e):void 0}function On(e){return t(e)&&t(e.text)&&!1===e.isComment}function Dn(e,n){var i,a,l,d,s=null;if(r(e)||"string"==typeof e)for(s=new Array(e.length),i=0,a=e.length;i<a;i++)s[i]=n(e[i],i);else if("number"==typeof e)for(s=new Array(e),i=0;i<e;i++)s[i]=n(i+1,i);else if(u(e))if(ue&&e[Symbol.iterator]){s=[];for(var m=e[Symbol.iterator](),o=m.next();!o.done;)s.push(n(o.value,s.length)),o=m.next()}else for(l=Object.keys(e),s=new Array(l.length),i=0,a=l.length;i<a;i++)d=l[i],s[i]=n(e[d],d,i);return t(s)||(s=[]),s._isVList=!0,s}function In(e,n,i,a){var r,l=this.$scopedSlots[e];l?(i=i||{},a&&(i=O(O({},a),i)),r=l(i)||(m(n)?n():n)):r=this.$slots[e]||(m(n)?n():n);var t=i&&i.slot;return t?this.$createElement("template",{slot:t},r):r}function En(e){return Za(this.$options,"filters",e,!0)||Z}function Zn(e,n){return r(e)?-1===e.indexOf(n):e!==n}function Gn(e,n,i,a,r){var l=x.keyCodes[n]||i;return r&&a&&!x.keyCodes[n]?Zn(r,a):l?Zn(l,e):a?Y(a)!==n:void 0===e}function Cn(e,n,i,a,l){if(i)if(u(i)){r(i)&&(i=D(i));var t=void 0,d=function(r){if("class"===r||"style"===r||h(r))t=e;else{var d=e.attrs&&e.attrs.type;t=a||x.mustUseProp(n,d,r)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var s=T(r),m=Y(r);s in t||m in t||(t[r]=i[r],l&&((e.on||(e.on={}))["update:".concat(r)]=function(e){i[r]=e}))};for(var s in i)d(s)}else;return e}function Vn(e,n){var i=this._staticTrees||(this._staticTrees=[]),a=i[e];return a&&!n||_n(a=i[e]=this.$options.staticRenderFns[e].call(this._renderProxy,this._c,this),"__static__".concat(e),!1),a}function Mn(e,n,i){return _n(e,"__once__".concat(n).concat(i?"_".concat(i):""),!0),e}function _n(e,n,i){if(r(e))for(var a=0;a<e.length;a++)e[a]&&"string"!=typeof e[a]&&Fn(e[a],"".concat(n,"_").concat(a),i);else Fn(e,n,i)}function Fn(e,n,i){e.isStatic=!0,e.key=n,e.isOnce=i}function xn(e,n){if(n)if(k(n)){var i=e.on=e.on?O({},e.on):{};for(var a in n){var r=i[a],l=n[a];i[a]=r?[].concat(r,l):l}}else;return e}function Ln(e,n,i,a){n=n||{$stable:!i};for(var l=0;l<e.length;l++){var t=e[l];r(t)?Ln(t,n,i):t&&(t.proxy&&(t.fn.proxy=!0),n[t.key]=t.fn)}return a&&(n.$key=a),n}function wn(e,n){for(var i=0;i<n.length;i+=2){var a=n[i];"string"==typeof a&&a&&(e[n[i]]=n[i+1])}return e}function jn(e,n){return"string"==typeof e?n+e:e}function Un(e){e._o=Mn,e._n=H,e._s=g,e._l=Dn,e._t=In,e._q=G,e._i=C,e._m=Vn,e._f=En,e._k=Gn,e._b=Cn,e._v=ge,e._e=ce,e._u=Ln,e._g=xn,e._d=wn,e._p=jn}function $n(e,n){if(!e||!e.length)return{};for(var i={},a=0,r=e.length;a<r;a++){var l=e[a],t=l.data;if(t&&t.attrs&&t.attrs.slot&&delete t.attrs.slot,l.context!==n&&l.fnContext!==n||!t||null==t.slot)(i.default||(i.default=[])).push(l);else{var d=t.slot,s=i[d]||(i[d]=[]);"template"===l.tag?s.push.apply(s,l.children||[]):s.push(l)}}for(var m in i)i[m].every(Jn)&&delete i[m];return i}function Jn(e){return e.isComment&&!e.asyncFactory||" "===e.text}function Wn(e){return e.isComment&&e.asyncFactory}function Xn(e,n,i,r){var l,t=Object.keys(i).length>0,d=n?!!n.$stable:!t,s=n&&n.$key;if(n){if(n._normalized)return n._normalized;if(d&&r&&r!==a&&s===r.$key&&!t&&!r.$hasNormal)return r;for(var m in l={},n)n[m]&&"$"!==m[0]&&(l[m]=qn(e,i,m,n[m]))}else l={};for(var u in i)u in l||(l[u]=Qn(i,u));return n&&Object.isExtensible(n)&&(n._normalized=l),j(l,"$stable",d),j(l,"$key",s),j(l,"$hasNormal",t),l}function qn(e,n,i,a){var l=function(){var n=oe;ye(e);var i=arguments.length?a.apply(null,arguments):a({}),l=(i=i&&"object"==typeof i&&!r(i)?[i]:Nn(i))&&i[0];return ye(n),i&&(!l||1===i.length&&l.isComment&&!Wn(l))?void 0:i};return a.proxy&&Object.defineProperty(n,i,{get:l,enumerable:!0,configurable:!0}),l}function Qn(e,n){return function(){return e[n]}}function ei(e){return{get attrs(){if(!e._attrsProxy){var n=e._attrsProxy={};j(n,"_v_attr_proxy",!0),ni(n,e.$attrs,a,e,"$attrs")}return e._attrsProxy},get listeners(){e._listenersProxy||ni(e._listenersProxy={},e.$listeners,a,e,"$listeners");return e._listenersProxy},get slots(){return function(e){e._slotsProxy||ai(e._slotsProxy={},e.$scopedSlots);return e._slotsProxy}(e)},emit:P(e.$emit,e),expose:function(n){n&&Object.keys(n).forEach((function(i){return Qe(e,n,i)}))}}}function ni(e,n,i,a,r){var l=!1;for(var t in n)t in e?n[t]!==i[t]&&(l=!0):(l=!0,ii(e,t,a,r));for(var t in e)t in n||(l=!0,delete e[t]);return l}function ii(e,n,i,a){Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:function(){return i[a][n]}})}function ai(e,n){for(var i in n)e[i]=n[i];for(var i in e)i in n||delete e[i]}function ri(){return di().slots}function li(){return di().attrs}function ti(){return di().listeners}function di(){var e=oe;return e._setupContext||(e._setupContext=ei(e))}function si(e,n){var i=r(e)?e.reduce((function(e,n){return e[n]={},e}),{}):e;for(var a in n){var l=i[a];l?r(l)||m(l)?i[a]={type:l,default:n[a]}:l.default=n[a]:null===l&&(i[a]={default:n[a]})}return i}var mi=null;function ui(e,n){return(e.__esModule||ue&&"Module"===e[Symbol.toStringTag])&&(e=e.default),u(e)?n.extend(e):e}function oi(e){if(r(e))for(var n=0;n<e.length;n++){var i=e[n];if(t(i)&&(t(i.componentOptions)||Wn(i)))return i}}function ki(e,n,i,a,o,k){return(r(i)||s(i))&&(o=a,a=i,i=void 0),d(k)&&(o=2),function(e,n,i,a,s){if(t(i)&&t(i.__ob__))return ce();t(i)&&t(i.is)&&(n=i.is);if(!n)return ce();0;r(a)&&m(a[0])&&((i=i||{}).scopedSlots={default:a[0]},a.length=0);2===s?a=Nn(a):1===s&&(a=function(e){for(var n=0;n<e.length;n++)if(r(e[n]))return Array.prototype.concat.apply([],e);return e}(a));var o,k;if("string"==typeof n){var y=void 0;k=e.$vnode&&e.$vnode.ns||x.getTagNamespace(n),o=x.isReservedTag(n)?new be(x.parsePlatformTagName(n),i,a,void 0,void 0,e):i&&i.pre||!t(y=Za(e.$options,"components",n))?new be(n,i,a,void 0,void 0,e):Ta(y,i,e,a,n)}else o=Ta(n,i,e,a);return r(o)?o:t(o)?(t(k)&&function e(n,i,a){n.ns=i,"foreignObject"===n.tag&&(i=void 0,a=!0);if(t(n.children))for(var r=0,s=n.children.length;r<s;r++){var m=n.children[r];t(m.tag)&&(l(m.ns)||d(a)&&"svg"!==m.tag)&&e(m,i,a)}}(o,k),t(i)&&function(e){u(e.style)&&$i(e.style);u(e.class)&&$i(e.class)}(i),o):ce()}(e,n,i,a,o)}function yi(e,n,i){return ki(oe,e,n,i,2,!0)}function bi(e,n,i){ve();try{if(n)for(var a=n;a=a.$parent;){var r=a.$options.errorCaptured;if(r)for(var l=0;l<r.length;l++)try{if(!1===r[l].call(a,e,n,i))return}catch(e){gi(e,a,"errorCaptured hook")}}gi(e,n,i)}finally{Ke()}}function ci(e,n,i,a,r){var l;try{(l=i?e.apply(n,i):e.call(n))&&!l._isVue&&c(l)&&!l._handled&&(l.catch((function(e){return bi(e,a,r+" (Promise/async)")})),l._handled=!0)}catch(e){bi(e,a,r)}return l}function gi(e,n,i){if(x.errorHandler)try{return x.errorHandler.call(null,e,n,i)}catch(n){n!==e&&pi(n,null,"config.errorHandler")}pi(e,n,i)}function pi(e,n,i){if(!J||"undefined"==typeof console)throw e;console.error(e)}var Hi,Si=!1,hi=[],zi=!1;function vi(){zi=!1;var e=hi.slice(0);hi.length=0;for(var n=0;n<e.length;n++)e[n]()}if("undefined"!=typeof Promise&&se(Promise)){var Ki=Promise.resolve();Hi=function(){Ki.then(vi),ee&&setTimeout(I)},Si=!0}else if(X||"undefined"==typeof MutationObserver||!se(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())Hi="undefined"!=typeof setImmediate&&se(setImmediate)?function(){setImmediate(vi)}:function(){setTimeout(vi,0)};else{var fi=1,Ai=new MutationObserver(vi),Ti=document.createTextNode(String(fi));Ai.observe(Ti,{characterData:!0}),Hi=function(){fi=(fi+1)%2,Ti.data=String(fi)},Si=!0}function Bi(e,n){var i;if(hi.push((function(){if(e)try{e.call(n)}catch(e){bi(e,n,"nextTick")}else i&&i(n)})),zi||(zi=!0,Hi()),!e&&"undefined"!=typeof Promise)return new Promise((function(e){i=e}))}function Ri(e){if(void 0===e&&(e="$style"),!oe)return a;var n=oe[e];return n||a}function Yi(e){if(J){var n=oe;n&&yn((function(){var i=n.$el,a=e(n,n._setupProxy);if(i&&1===i.nodeType){var r=i.style;for(var l in a)r.setProperty("--".concat(l),a[l])}}))}}function Pi(e){m(e)&&(e={loader:e});var n=e.loader,i=e.loadingComponent,a=e.errorComponent,r=e.delay,l=void 0===r?200:r,t=e.timeout,d=(e.suspensible,e.onError);var s=null,u=0,o=function(){var e;return s||(e=s=n().catch((function(e){if(e=e instanceof Error?e:new Error(String(e)),d)return new Promise((function(n,i){d(e,(function(){return n((u++,s=null,o()))}),(function(){return i(e)}),u+1)}));throw e})).then((function(n){return e!==s&&s?s:(n&&(n.__esModule||"Module"===n[Symbol.toStringTag])&&(n=n.default),n)})))};return function(){return{component:o(),delay:l,timeout:t,error:a,loading:i}}}function Ni(e){return function(n,i){if(void 0===i&&(i=oe),i)return function(e,n,i){var a=e.$options;a[n]=Oa(a[n],i)}(i,e,n)}}var Oi=Ni("beforeMount"),Di=Ni("mounted"),Ii=Ni("beforeUpdate"),Ei=Ni("updated"),Zi=Ni("beforeDestroy"),Gi=Ni("destroyed"),Ci=Ni("activated"),Vi=Ni("deactivated"),Mi=Ni("serverPrefetch"),_i=Ni("renderTracked"),Fi=Ni("renderTriggered"),xi=Ni("errorCaptured");function Li(e,n){void 0===n&&(n=oe),xi(e,n)}var wi="2.7.16";function ji(e){return e}var Ui=new me;function $i(e){return function e(n,i){var a,l,t=r(n);if(!t&&!u(n)||n.__v_skip||Object.isFrozen(n)||n instanceof be)return;if(n.__ob__){var d=n.__ob__.dep.id;if(i.has(d))return;i.add(d)}if(t)for(a=n.length;a--;)e(n[a],i);else if(je(n))e(n.value,i);else for(l=Object.keys(n),a=l.length;a--;)e(n[l[a]],i)}(e,Ui),Ui.clear(),e}var Ji,Wi=0,Xi=function(){function e(e,n,i,a,r){var l,t;l=this,void 0===(t=cn&&!cn._vm?cn:e?e._scope:void 0)&&(t=cn),t&&t.active&&t.effects.push(l),(this.vm=e)&&r&&(e._watcher=this),a?(this.deep=!!a.deep,this.user=!!a.user,this.lazy=!!a.lazy,this.sync=!!a.sync,this.before=a.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=i,this.id=++Wi,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new me,this.newDepIds=new me,this.expression="",m(n)?this.getter=n:(this.getter=function(e){if(!U.test(e)){var n=e.split(".");return function(e){for(var i=0;i<n.length;i++){if(!e)return;e=e[n[i]]}return e}}}(n),this.getter||(this.getter=I)),this.value=this.lazy?void 0:this.get()}return e.prototype.get=function(){var e;ve(this);var n=this.vm;try{e=this.getter.call(n,n)}catch(e){if(!this.user)throw e;bi(e,n,'getter for watcher "'.concat(this.expression,'"'))}finally{this.deep&&$i(e),Ke(),this.cleanupDeps()}return e},e.prototype.addDep=function(e){var n=e.id;this.newDepIds.has(n)||(this.newDepIds.add(n),this.newDeps.push(e),this.depIds.has(n)||e.addSub(this))},e.prototype.cleanupDeps=function(){for(var e=this.deps.length;e--;){var n=this.deps[e];this.newDepIds.has(n.id)||n.removeSub(this)}var i=this.depIds;this.depIds=this.newDepIds,this.newDepIds=i,this.newDepIds.clear(),i=this.deps,this.deps=this.newDeps,this.newDeps=i,this.newDeps.length=0},e.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Ha(this)},e.prototype.run=function(){if(this.active){var e=this.get();if(e!==this.value||u(e)||this.deep){var n=this.value;if(this.value=e,this.user){var i='callback for watcher "'.concat(this.expression,'"');ci(this.cb,this.vm,[e,n],this.vm,i)}else this.cb.call(this.vm,e,n)}}},e.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},e.prototype.depend=function(){for(var e=this.deps.length;e--;)this.deps[e].depend()},e.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&z(this.vm._scope.effects,this),this.active){for(var e=this.deps.length;e--;)this.deps[e].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},e}();function qi(e,n){Ji.$on(e,n)}function Qi(e,n){Ji.$off(e,n)}function ea(e,n){var i=Ji;return function a(){var r=n.apply(null,arguments);null!==r&&i.$off(e,a)}}function na(e,n,i){Ji=e,Rn(n,i||{},qi,Qi,ea,e),Ji=void 0}var ia=null;function aa(e){var n=ia;return ia=e,function(){ia=n}}function ra(e){for(;e&&(e=e.$parent);)if(e._inactive)return!0;return!1}function la(e,n){if(n){if(e._directInactive=!1,ra(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var i=0;i<e.$children.length;i++)la(e.$children[i]);ta(e,"activated")}}function ta(e,n,i,a){void 0===a&&(a=!0),ve();var r=oe,l=zn();a&&ye(e);var t=e.$options[n],d="".concat(n," hook");if(t)for(var s=0,m=t.length;s<m;s++)ci(t[s],e,i||null,e,d);e._hasHookEvent&&e.$emit("hook:"+n),a&&(ye(r),l&&l.on()),Ke()}var da=[],sa=[],ma={},ua=!1,oa=!1,ka=0;var ya=0,ba=Date.now;if(J&&!X){var ca=window.performance;ca&&"function"==typeof ca.now&&ba()>document.createEvent("Event").timeStamp&&(ba=function(){return ca.now()})}var ga=function(e,n){if(e.post){if(!n.post)return 1}else if(n.post)return-1;return e.id-n.id};function pa(){var e,n;for(ya=ba(),oa=!0,da.sort(ga),ka=0;ka<da.length;ka++)(e=da[ka]).before&&e.before(),n=e.id,ma[n]=null,e.run();var i=sa.slice(),a=da.slice();ka=da.length=sa.length=0,ma={},ua=oa=!1,function(e){for(var n=0;n<e.length;n++)e[n]._inactive=!0,la(e[n],!0)}(i),function(e){var n=e.length;for(;n--;){var i=e[n],a=i.vm;a&&a._watcher===i&&a._isMounted&&!a._isDestroyed&&ta(a,"updated")}}(a),function(){for(var e=0;e<Se.length;e++){var n=Se[e];n.subs=n.subs.filter((function(e){return e})),n._pending=!1}Se.length=0}(),de&&x.devtools&&de.emit("flush")}function Ha(e){var n=e.id;if(null==ma[n]&&(e!==he.target||!e.noRecurse)){if(ma[n]=!0,oa){for(var i=da.length-1;i>ka&&da[i].id>e.id;)i--;da.splice(i+1,0,e)}else da.push(e);ua||(ua=!0,Bi(pa))}}function Sa(e,n){if(e){for(var i=Object.create(null),a=ue?Reflect.ownKeys(e):Object.keys(e),r=0;r<a.length;r++){var l=a[r];if("__ob__"!==l){var t=e[l].from;if(t in n._provided)i[l]=n._provided[t];else if("default"in e[l]){var d=e[l].default;i[l]=m(d)?d.call(n):d}else 0}}return i}}function ha(e,n,i,l,t){var s,m=this,u=t.options;K(l,"_uid")?(s=Object.create(l))._original=l:(s=l,l=l._original);var o=d(u._compiled),k=!o;this.data=e,this.props=n,this.children=i,this.parent=l,this.listeners=e.on||a,this.injections=Sa(u.inject,l),this.slots=function(){return m.$slots||Xn(l,e.scopedSlots,m.$slots=$n(i,l)),m.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Xn(l,e.scopedSlots,this.slots())}}),o&&(this.$options=u,this.$slots=this.slots(),this.$scopedSlots=Xn(l,e.scopedSlots,this.$slots)),u._scopeId?this._c=function(e,n,i,a){var t=ki(s,e,n,i,a,k);return t&&!r(t)&&(t.fnScopeId=u._scopeId,t.fnContext=l),t}:this._c=function(e,n,i,a){return ki(s,e,n,i,a,k)}}function za(e,n,i,a,r){var l=pe(e);return l.fnContext=i,l.fnOptions=a,n.slot&&((l.data||(l.data={})).slot=n.slot),l}function va(e,n){for(var i in n)e[T(i)]=n[i]}function Ka(e){return e.name||e.__name||e._componentTag}Un(ha.prototype);var fa={init:function(e,n){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var i=e;fa.prepatch(i,i)}else{(e.componentInstance=function(e,n){var i={_isComponent:!0,_parentVnode:e,parent:n},a=e.data.inlineTemplate;t(a)&&(i.render=a.render,i.staticRenderFns=a.staticRenderFns);return new e.componentOptions.Ctor(i)}(e,ia)).$mount(n?e.elm:void 0,n)}},prepatch:function(e,n){var i=n.componentOptions;!function(e,n,i,r,l){var t=r.data.scopedSlots,d=e.$scopedSlots,s=!!(t&&!t.$stable||d!==a&&!d.$stable||t&&e.$scopedSlots.$key!==t.$key||!t&&e.$scopedSlots.$key),m=!!(l||e.$options._renderChildren||s),u=e.$vnode;e.$options._parentVnode=r,e.$vnode=r,e._vnode&&(e._vnode.parent=r),e.$options._renderChildren=l;var o=r.data.attrs||a;e._attrsProxy&&ni(e._attrsProxy,o,u.data&&u.data.attrs||a,e,"$attrs")&&(m=!0),e.$attrs=o,i=i||a;var k=e.$options._parentListeners;if(e._listenersProxy&&ni(e._listenersProxy,i,k||a,e,"$listeners"),e.$listeners=e.$options._parentListeners=i,na(e,i,k),n&&e.$options.props){Ye(!1);for(var y=e._props,b=e.$options._propKeys||[],c=0;c<b.length;c++){var g=b[c],p=e.$options.props;y[g]=Ga(g,p,n,e)}Ye(!0),e.$options.propsData=n}m&&(e.$slots=$n(l,r.context),e.$forceUpdate())}(n.componentInstance=e.componentInstance,i.propsData,i.listeners,n,i.children)},insert:function(e){var n,i=e.context,a=e.componentInstance;a._isMounted||(a._isMounted=!0,ta(a,"mounted")),e.data.keepAlive&&(i._isMounted?((n=a)._inactive=!1,sa.push(n)):la(a,!0))},destroy:function(e){var n=e.componentInstance;n._isDestroyed||(e.data.keepAlive?function e(n,i){if(!(i&&(n._directInactive=!0,ra(n))||n._inactive)){n._inactive=!0;for(var a=0;a<n.$children.length;a++)e(n.$children[a]);ta(n,"deactivated")}}(n,!0):n.$destroy())}},Aa=Object.keys(fa);function Ta(e,n,i,s,m){if(!l(e)){var o=i.$options._base;if(u(e)&&(e=o.extend(e)),"function"==typeof e){var k;if(l(e.cid)&&void 0===(e=function(e,n){if(d(e.error)&&t(e.errorComp))return e.errorComp;if(t(e.resolved))return e.resolved;var i=mi;if(i&&t(e.owners)&&-1===e.owners.indexOf(i)&&e.owners.push(i),d(e.loading)&&t(e.loadingComp))return e.loadingComp;if(i&&!t(e.owners)){var a=e.owners=[i],r=!0,s=null,m=null;i.$on("hook:destroyed",(function(){return z(a,i)}));var o=function(e){for(var n=0,i=a.length;n<i;n++)a[n].$forceUpdate();e&&(a.length=0,null!==s&&(clearTimeout(s),s=null),null!==m&&(clearTimeout(m),m=null))},k=V((function(i){e.resolved=ui(i,n),r?a.length=0:o(!0)})),y=V((function(n){t(e.errorComp)&&(e.error=!0,o(!0))})),b=e(k,y);return u(b)&&(c(b)?l(e.resolved)&&b.then(k,y):c(b.component)&&(b.component.then(k,y),t(b.error)&&(e.errorComp=ui(b.error,n)),t(b.loading)&&(e.loadingComp=ui(b.loading,n),0===b.delay?e.loading=!0:s=setTimeout((function(){s=null,l(e.resolved)&&l(e.error)&&(e.loading=!0,o(!1))}),b.delay||200)),t(b.timeout)&&(m=setTimeout((function(){m=null,l(e.resolved)&&y(null)}),b.timeout)))),r=!1,e.loading?e.loadingComp:e.resolved}}(k=e,o)))return function(e,n,i,a,r){var l=ce();return l.asyncFactory=e,l.asyncMeta={data:n,context:i,children:a,tag:r},l}(k,n,i,s,m);n=n||{},Xa(e),t(n.model)&&function(e,n){var i=e.model&&e.model.prop||"value",a=e.model&&e.model.event||"input";(n.attrs||(n.attrs={}))[i]=n.model.value;var l=n.on||(n.on={}),d=l[a],s=n.model.callback;t(d)?(r(d)?-1===d.indexOf(s):d!==s)&&(l[a]=[s].concat(d)):l[a]=s}(e.options,n);var y=function(e,n,i){var a=n.options.props;if(!l(a)){var r={},d=e.attrs,s=e.props;if(t(d)||t(s))for(var m in a){var u=Y(m);Pn(r,s,m,u,!0)||Pn(r,d,m,u,!1)}return r}}(n,e);if(d(e.options.functional))return function(e,n,i,l,d){var s=e.options,m={},u=s.props;if(t(u))for(var o in u)m[o]=Ga(o,u,n||a);else t(i.attrs)&&va(m,i.attrs),t(i.props)&&va(m,i.props);var k=new ha(i,m,d,l,e),y=s.render.call(null,k._c,k);if(y instanceof be)return za(y,i,k.parent,s,k);if(r(y)){for(var b=Nn(y)||[],c=new Array(b.length),g=0;g<b.length;g++)c[g]=za(b[g],i,k.parent,s,k);return c}}(e,y,n,i,s);var b=n.on;if(n.on=n.nativeOn,d(e.options.abstract)){var g=n.slot;n={},g&&(n.slot=g)}!function(e){for(var n=e.hook||(e.hook={}),i=0;i<Aa.length;i++){var a=Aa[i],r=n[a],l=fa[a];r===l||r&&r._merged||(n[a]=r?Ba(l,r):l)}}(n);var p=Ka(e.options)||m;return new be("vue-component-".concat(e.cid).concat(p?"-".concat(p):""),n,void 0,void 0,void 0,i,{Ctor:e,propsData:y,listeners:b,tag:m,children:s},k)}}}function Ba(e,n){var i=function(i,a){e(i,a),n(i,a)};return i._merged=!0,i}var Ra=I,Ya=x.optionMergeStrategies;function Pa(e,n,i){if(void 0===i&&(i=!0),!n)return e;for(var a,r,l,t=ue?Reflect.ownKeys(n):Object.keys(n),d=0;d<t.length;d++)"__ob__"!==(a=t[d])&&(r=e[a],l=n[a],i&&K(e,a)?r!==l&&k(r)&&k(l)&&Pa(r,l):Ie(e,a,l));return e}function Na(e,n,i){return i?function(){var a=m(n)?n.call(i,i):n,r=m(e)?e.call(i,i):e;return a?Pa(a,r):r}:n?e?function(){return Pa(m(n)?n.call(this,this):n,m(e)?e.call(this,this):e)}:n:e}function Oa(e,n){var i=n?e?e.concat(n):r(n)?n:[n]:e;return i?function(e){for(var n=[],i=0;i<e.length;i++)-1===n.indexOf(e[i])&&n.push(e[i]);return n}(i):i}function Da(e,n,i,a){var r=Object.create(e||null);return n?O(r,n):r}Ya.data=function(e,n,i){return i?Na(e,n,i):n&&"function"!=typeof n?e:Na(e,n)},F.forEach((function(e){Ya[e]=Oa})),_.forEach((function(e){Ya[e+"s"]=Da})),Ya.watch=function(e,n,i,a){if(e===ae&&(e=void 0),n===ae&&(n=void 0),!n)return Object.create(e||null);if(!e)return n;var l={};for(var t in O(l,e),n){var d=l[t],s=n[t];d&&!r(d)&&(d=[d]),l[t]=d?d.concat(s):r(s)?s:[s]}return l},Ya.props=Ya.methods=Ya.inject=Ya.computed=function(e,n,i,a){if(!e)return n;var r=Object.create(null);return O(r,e),n&&O(r,n),r},Ya.provide=function(e,n){return e?function(){var i=Object.create(null);return Pa(i,m(e)?e.call(this):e),n&&Pa(i,m(n)?n.call(this):n,!1),i}:n};var Ia=function(e,n){return void 0===n?e:n};function Ea(e,n,i){if(m(n)&&(n=n.options),function(e,n){var i=e.props;if(i){var a,l,t={};if(r(i))for(a=i.length;a--;)"string"==typeof(l=i[a])&&(t[T(l)]={type:null});else if(k(i))for(var d in i)l=i[d],t[T(d)]=k(l)?l:{type:l};else 0;e.props=t}}(n),function(e,n){var i=e.inject;if(i){var a=e.inject={};if(r(i))for(var l=0;l<i.length;l++)a[i[l]]={from:i[l]};else if(k(i))for(var t in i){var d=i[t];a[t]=k(d)?O({from:t},d):{from:d}}else 0}}(n),function(e){var n=e.directives;if(n)for(var i in n){var a=n[i];m(a)&&(n[i]={bind:a,update:a})}}(n),!n._base&&(n.extends&&(e=Ea(e,n.extends,i)),n.mixins))for(var a=0,l=n.mixins.length;a<l;a++)e=Ea(e,n.mixins[a],i);var t,d={};for(t in e)s(t);for(t in n)K(e,t)||s(t);function s(a){var r=Ya[a]||Ia;d[a]=r(e[a],n[a],i,a)}return d}function Za(e,n,i,a){if("string"==typeof i){var r=e[n];if(K(r,i))return r[i];var l=T(i);if(K(r,l))return r[l];var t=B(l);return K(r,t)?r[t]:r[i]||r[l]||r[t]}}function Ga(e,n,i,a){var r=n[e],l=!K(i,e),t=i[e],d=_a(Boolean,r.type);if(d>-1)if(l&&!K(r,"default"))t=!1;else if(""===t||t===Y(e)){var s=_a(String,r.type);(s<0||d<s)&&(t=!0)}if(void 0===t){t=function(e,n,i){if(!K(n,"default"))return;var a=n.default;0;if(e&&e.$options.propsData&&void 0===e.$options.propsData[i]&&void 0!==e._props[i])return e._props[i];return m(a)&&"Function"!==Va(n.type)?a.call(e):a}(a,r,e);var u=Re;Ye(!0),Oe(t),Ye(u)}return t}var Ca=/^\s*function (\w+)/;function Va(e){var n=e&&e.toString().match(Ca);return n?n[1]:""}function Ma(e,n){return Va(e)===Va(n)}function _a(e,n){if(!r(n))return Ma(n,e)?0:-1;for(var i=0,a=n.length;i<a;i++)if(Ma(n[i],e))return i;return-1}var Fa={enumerable:!0,configurable:!0,get:I,set:I};function xa(e,n,i){Fa.get=function(){return this[n][i]},Fa.set=function(e){this[n][i]=e},Object.defineProperty(e,i,Fa)}function La(e){var n=e.$options;if(n.props&&function(e,n){var i=e.$options.propsData||{},a=e._props=Ce({}),r=e.$options._propKeys=[];e.$parent&&Ye(!1);var l=function(l){r.push(l);var t=Ga(l,n,i,e);De(a,l,t,void 0,!0),l in e||xa(e,"_props",l)};for(var t in n)l(t);Ye(!0)}(e,n.props),function(e){var n=e.$options,i=n.setup;if(i){var a=e._setupContext=ei(e);ye(e),ve();var r=ci(i,null,[e._props||Ce({}),a],e,"setup");if(Ke(),ye(),m(r))n.render=r;else if(u(r))if(e._setupState=r,r.__sfc){var l=e._setupProxy={};for(var t in r)"__sfc"!==t&&Qe(l,r,t)}else for(var t in r)w(t)||Qe(e,r,t);else 0}}(e),n.methods&&function(e,n){e.$options.props;for(var i in n)e[i]="function"!=typeof n[i]?I:P(n[i],e)}(e,n.methods),n.data)!function(e){var n=e.$options.data;k(n=e._data=m(n)?function(e,n){ve();try{return e.call(n,n)}catch(e){return bi(e,n,"data()"),{}}finally{Ke()}}(n,e):n||{})||(n={});var i=Object.keys(n),a=e.$options.props,r=(e.$options.methods,i.length);for(;r--;){var l=i[r];0,a&&K(a,l)||w(l)||xa(e,"_data",l)}var t=Oe(n);t&&t.vmCount++}(e);else{var i=Oe(e._data={});i&&i.vmCount++}n.computed&&function(e,n){var i=e._computedWatchers=Object.create(null),a=te();for(var r in n){var l=n[r],t=m(l)?l:l.get;0,a||(i[r]=new Xi(e,t||I,I,wa)),r in e||ja(e,r,l)}}(e,n.computed),n.watch&&n.watch!==ae&&function(e,n){for(var i in n){var a=n[i];if(r(a))for(var l=0;l<a.length;l++)Ja(e,i,a[l]);else Ja(e,i,a)}}(e,n.watch)}var wa={lazy:!0};function ja(e,n,i){var a=!te();m(i)?(Fa.get=a?Ua(n):$a(i),Fa.set=I):(Fa.get=i.get?a&&!1!==i.cache?Ua(n):$a(i.get):I,Fa.set=i.set||I),Object.defineProperty(e,n,Fa)}function Ua(e){return function(){var n=this._computedWatchers&&this._computedWatchers[e];if(n)return n.dirty&&n.evaluate(),he.target&&n.depend(),n.value}}function $a(e){return function(){return e.call(this,this)}}function Ja(e,n,i,a){return k(i)&&(a=i,i=i.handler),"string"==typeof i&&(i=e[i]),e.$watch(n,i,a)}var Wa=0;function Xa(e){var n=e.options;if(e.super){var i=Xa(e.super);if(i!==e.superOptions){e.superOptions=i;var a=function(e){var n,i=e.options,a=e.sealedOptions;for(var r in i)i[r]!==a[r]&&(n||(n={}),n[r]=i[r]);return n}(e);a&&O(e.extendOptions,a),(n=e.options=Ea(i,e.extendOptions)).name&&(n.components[n.name]=e)}}return n}function qa(e){this._init(e)}function Qa(e){e.cid=0;var n=1;e.extend=function(e){e=e||{};var i=this,a=i.cid,r=e._Ctor||(e._Ctor={});if(r[a])return r[a];var l=Ka(e)||Ka(i.options);var t=function(e){this._init(e)};return(t.prototype=Object.create(i.prototype)).constructor=t,t.cid=n++,t.options=Ea(i.options,e),t.super=i,t.options.props&&function(e){var n=e.options.props;for(var i in n)xa(e.prototype,"_props",i)}(t),t.options.computed&&function(e){var n=e.options.computed;for(var i in n)ja(e.prototype,i,n[i])}(t),t.extend=i.extend,t.mixin=i.mixin,t.use=i.use,_.forEach((function(e){t[e]=i[e]})),l&&(t.options.components[l]=t),t.superOptions=i.options,t.extendOptions=e,t.sealedOptions=O({},t.options),r[a]=t,t}}function er(e){return e&&(Ka(e.Ctor.options)||e.tag)}function nr(e,n){return r(e)?e.indexOf(n)>-1:"string"==typeof e?e.split(",").indexOf(n)>-1:!!y(e)&&e.test(n)}function ir(e,n){var i=e.cache,a=e.keys,r=e._vnode,l=e.$vnode;for(var t in i){var d=i[t];if(d){var s=d.name;s&&!n(s)&&ar(i,t,a,r)}}l.componentOptions.children=void 0}function ar(e,n,i,a){var r=e[n];!r||a&&r.tag===a.tag||r.componentInstance.$destroy(),e[n]=null,z(i,n)}!function(e){e.prototype._init=function(e){var n=this;n._uid=Wa++,n._isVue=!0,n.__v_skip=!0,n._scope=new Sn(!0),n._scope.parent=void 0,n._scope._vm=!0,e&&e._isComponent?function(e,n){var i=e.$options=Object.create(e.constructor.options),a=n._parentVnode;i.parent=n.parent,i._parentVnode=a;var r=a.componentOptions;i.propsData=r.propsData,i._parentListeners=r.listeners,i._renderChildren=r.children,i._componentTag=r.tag,n.render&&(i.render=n.render,i.staticRenderFns=n.staticRenderFns)}(n,e):n.$options=Ea(Xa(n.constructor),e||{},n),n._renderProxy=n,n._self=n,function(e){var n=e.$options,i=n.parent;if(i&&!n.abstract){for(;i.$options.abstract&&i.$parent;)i=i.$parent;i.$children.push(e)}e.$parent=i,e.$root=i?i.$root:e,e.$children=[],e.$refs={},e._provided=i?i._provided:Object.create(null),e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}(n),function(e){e._events=Object.create(null),e._hasHookEvent=!1;var n=e.$options._parentListeners;n&&na(e,n)}(n),function(e){e._vnode=null,e._staticTrees=null;var n=e.$options,i=e.$vnode=n._parentVnode,r=i&&i.context;e.$slots=$n(n._renderChildren,r),e.$scopedSlots=i?Xn(e.$parent,i.data.scopedSlots,e.$slots):a,e._c=function(n,i,a,r){return ki(e,n,i,a,r,!1)},e.$createElement=function(n,i,a,r){return ki(e,n,i,a,r,!0)};var l=i&&i.data;De(e,"$attrs",l&&l.attrs||a,null,!0),De(e,"$listeners",n._parentListeners||a,null,!0)}(n),ta(n,"beforeCreate",void 0,!1),function(e){var n=Sa(e.$options.inject,e);n&&(Ye(!1),Object.keys(n).forEach((function(i){De(e,i,n[i])})),Ye(!0))}(n),La(n),function(e){var n=e.$options.provide;if(n){var i=m(n)?n.call(e):n;if(!u(i))return;for(var a=fn(e),r=ue?Reflect.ownKeys(i):Object.keys(i),l=0;l<r.length;l++){var t=r[l];Object.defineProperty(a,t,Object.getOwnPropertyDescriptor(i,t))}}}(n),ta(n,"created"),n.$options.el&&n.$mount(n.$options.el)}}(qa),function(e){var n={get:function(){return this._data}},i={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",n),Object.defineProperty(e.prototype,"$props",i),e.prototype.$set=Ie,e.prototype.$delete=Ee,e.prototype.$watch=function(e,n,i){if(k(n))return Ja(this,e,n,i);(i=i||{}).user=!0;var a=new Xi(this,e,n,i);if(i.immediate){var r='callback for immediate watcher "'.concat(a.expression,'"');ve(),ci(n,this,[a.value],this,r),Ke()}return function(){a.teardown()}}}(qa),function(e){var n=/^hook:/;e.prototype.$on=function(e,i){var a=this;if(r(e))for(var l=0,t=e.length;l<t;l++)a.$on(e[l],i);else(a._events[e]||(a._events[e]=[])).push(i),n.test(e)&&(a._hasHookEvent=!0);return a},e.prototype.$once=function(e,n){var i=this;function a(){i.$off(e,a),n.apply(i,arguments)}return a.fn=n,i.$on(e,a),i},e.prototype.$off=function(e,n){var i=this;if(!arguments.length)return i._events=Object.create(null),i;if(r(e)){for(var a=0,l=e.length;a<l;a++)i.$off(e[a],n);return i}var t,d=i._events[e];if(!d)return i;if(!n)return i._events[e]=null,i;for(var s=d.length;s--;)if((t=d[s])===n||t.fn===n){d.splice(s,1);break}return i},e.prototype.$emit=function(e){var n=this,i=n._events[e];if(i){i=i.length>1?N(i):i;for(var a=N(arguments,1),r='event handler for "'.concat(e,'"'),l=0,t=i.length;l<t;l++)ci(i[l],n,a,n,r)}return n}}(qa),function(e){e.prototype._update=function(e,n){var i=this,a=i.$el,r=i._vnode,l=aa(i);i._vnode=e,i.$el=r?i.__patch__(r,e):i.__patch__(i.$el,e,n,!1),l(),a&&(a.__vue__=null),i.$el&&(i.$el.__vue__=i);for(var t=i;t&&t.$vnode&&t.$parent&&t.$vnode===t.$parent._vnode;)t.$parent.$el=t.$el,t=t.$parent},e.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){ta(e,"beforeDestroy"),e._isBeingDestroyed=!0;var n=e.$parent;!n||n._isBeingDestroyed||e.$options.abstract||z(n.$children,e),e._scope.stop(),e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),ta(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}(qa),function(e){Un(e.prototype),e.prototype.$nextTick=function(e){return Bi(e,this)},e.prototype._render=function(){var e=this,n=e.$options,i=n.render,a=n._parentVnode;a&&e._isMounted&&(e.$scopedSlots=Xn(e.$parent,a.data.scopedSlots,e.$slots,e.$scopedSlots),e._slotsProxy&&ai(e._slotsProxy,e.$scopedSlots)),e.$vnode=a;var l,t=oe,d=mi;try{ye(e),mi=e,l=i.call(e._renderProxy,e.$createElement)}catch(n){bi(n,e,"render"),l=e._vnode}finally{mi=d,ye(t)}return r(l)&&1===l.length&&(l=l[0]),l instanceof be||(l=ce()),l.parent=a,l}}(qa);var rr=[String,RegExp,Array],lr={KeepAlive:{name:"keep-alive",abstract:!0,props:{include:rr,exclude:rr,max:[String,Number]},methods:{cacheVNode:function(){var e=this.cache,n=this.keys,i=this.vnodeToCache,a=this.keyToCache;if(i){var r=i.tag,l=i.componentInstance,t=i.componentOptions;e[a]={name:er(t),tag:r,componentInstance:l},n.push(a),this.max&&n.length>parseInt(this.max)&&ar(e,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)ar(this.cache,e,this.keys)},mounted:function(){var e=this;this.cacheVNode(),this.$watch("include",(function(n){ir(e,(function(e){return nr(n,e)}))})),this.$watch("exclude",(function(n){ir(e,(function(e){return!nr(n,e)}))}))},updated:function(){this.cacheVNode()},render:function(){var e=this.$slots.default,n=oi(e),i=n&&n.componentOptions;if(i){var a=er(i),r=this.include,l=this.exclude;if(r&&(!a||!nr(r,a))||l&&a&&nr(l,a))return n;var t=this.cache,d=this.keys,s=null==n.key?i.Ctor.cid+(i.tag?"::".concat(i.tag):""):n.key;t[s]?(n.componentInstance=t[s].componentInstance,z(d,s),d.push(s)):(this.vnodeToCache=n,this.keyToCache=s),n.data.keepAlive=!0}return n||e&&e[0]}}};!function(e){var n={get:function(){return x}};Object.defineProperty(e,"config",n),e.util={warn:Ra,extend:O,mergeOptions:Ea,defineReactive:De},e.set=Ie,e.delete=Ee,e.nextTick=Bi,e.observable=function(e){return Oe(e),e},e.options=Object.create(null),_.forEach((function(n){e.options[n+"s"]=Object.create(null)})),e.options._base=e,O(e.options.components,lr),function(e){e.use=function(e){var n=this._installedPlugins||(this._installedPlugins=[]);if(n.indexOf(e)>-1)return this;var i=N(arguments,1);return i.unshift(this),m(e.install)?e.install.apply(e,i):m(e)&&e.apply(null,i),n.push(e),this}}(e),function(e){e.mixin=function(e){return this.options=Ea(this.options,e),this}}(e),Qa(e),function(e){_.forEach((function(n){e[n]=function(e,i){return i?("component"===n&&k(i)&&(i.name=i.name||e,i=this.options._base.extend(i)),"directive"===n&&m(i)&&(i={bind:i,update:i}),this.options[n+"s"][e]=i,i):this.options[n+"s"][e]}}))}(e)}(qa),Object.defineProperty(qa.prototype,"$isServer",{get:te}),Object.defineProperty(qa.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(qa,"FunctionalRenderContext",{value:ha}),qa.version=wi;var tr=S("style,class"),dr=S("input,textarea,option,select,progress"),sr=S("contenteditable,draggable,spellcheck"),mr=S("events,caret,typing,plaintext-only"),ur=S("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),or="http://www.w3.org/1999/xlink",kr=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},yr=function(e){return kr(e)?e.slice(6,e.length):""},br=function(e){return null==e||!1===e};function cr(e){for(var n=e.data,i=e,a=e;t(a.componentInstance);)(a=a.componentInstance._vnode)&&a.data&&(n=gr(a.data,n));for(;t(i=i.parent);)i&&i.data&&(n=gr(n,i.data));return function(e,n){if(t(e)||t(n))return pr(e,Hr(n));return""}(n.staticClass,n.class)}function gr(e,n){return{staticClass:pr(e.staticClass,n.staticClass),class:t(e.class)?[e.class,n.class]:n.class}}function pr(e,n){return e?n?e+" "+n:e:n||""}function Hr(e){return Array.isArray(e)?function(e){for(var n,i="",a=0,r=e.length;a<r;a++)t(n=Hr(e[a]))&&""!==n&&(i&&(i+=" "),i+=n);return i}(e):u(e)?function(e){var n="";for(var i in e)e[i]&&(n&&(n+=" "),n+=i);return n}(e):"string"==typeof e?e:""}var Sr={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},hr=S("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),zr=S("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),vr=function(e){return hr(e)||zr(e)};var Kr=Object.create(null);var fr=S("text,number,password,search,email,tel,url");var Ar=Object.freeze({__proto__:null,createElement:function(e,n){var i=document.createElement(e);return"select"!==e||n.data&&n.data.attrs&&void 0!==n.data.attrs.multiple&&i.setAttribute("multiple","multiple"),i},createElementNS:function(e,n){return document.createElementNS(Sr[e],n)},createTextNode:function(e){return document.createTextNode(e)},createComment:function(e){return document.createComment(e)},insertBefore:function(e,n,i){e.insertBefore(n,i)},removeChild:function(e,n){e.removeChild(n)},appendChild:function(e,n){e.appendChild(n)},parentNode:function(e){return e.parentNode},nextSibling:function(e){return e.nextSibling},tagName:function(e){return e.tagName},setTextContent:function(e,n){e.textContent=n},setStyleScope:function(e,n){e.setAttribute(n,"")}}),Tr={create:function(e,n){Br(n)},update:function(e,n){e.data.ref!==n.data.ref&&(Br(e,!0),Br(n))},destroy:function(e){Br(e,!0)}};function Br(e,n){var i=e.data.ref;if(t(i)){var a=e.context,l=e.componentInstance||e.elm,d=n?null:l,s=n?void 0:l;if(m(i))ci(i,a,[d],a,"template ref function");else{var u=e.data.refInFor,o="string"==typeof i||"number"==typeof i,k=je(i),y=a.$refs;if(o||k)if(u){var b=o?y[i]:i.value;n?r(b)&&z(b,l):r(b)?b.includes(l)||b.push(l):o?(y[i]=[l],Rr(a,i,y[i])):i.value=[l]}else if(o){if(n&&y[i]!==l)return;y[i]=s,Rr(a,i,d)}else if(k){if(n&&i.value!==l)return;i.value=d}else 0}}}function Rr(e,n,i){var a=e._setupState;a&&K(a,n)&&(je(a[n])?a[n].value=i:a[n]=i)}var Yr=new be("",{},[]),Pr=["create","activate","update","remove","destroy"];function Nr(e,n){return e.key===n.key&&e.asyncFactory===n.asyncFactory&&(e.tag===n.tag&&e.isComment===n.isComment&&t(e.data)===t(n.data)&&function(e,n){if("input"!==e.tag)return!0;var i,a=t(i=e.data)&&t(i=i.attrs)&&i.type,r=t(i=n.data)&&t(i=i.attrs)&&i.type;return a===r||fr(a)&&fr(r)}(e,n)||d(e.isAsyncPlaceholder)&&l(n.asyncFactory.error))}function Or(e,n,i){var a,r,l={};for(a=n;a<=i;++a)t(r=e[a].key)&&(l[r]=a);return l}var Dr={create:Ir,update:Ir,destroy:function(e){Ir(e,Yr)}};function Ir(e,n){(e.data.directives||n.data.directives)&&function(e,n){var i,a,r,l=e===Yr,t=n===Yr,d=Zr(e.data.directives,e.context),s=Zr(n.data.directives,n.context),m=[],u=[];for(i in s)a=d[i],r=s[i],a?(r.oldValue=a.value,r.oldArg=a.arg,Cr(r,"update",n,e),r.def&&r.def.componentUpdated&&u.push(r)):(Cr(r,"bind",n,e),r.def&&r.def.inserted&&m.push(r));if(m.length){var o=function(){for(var i=0;i<m.length;i++)Cr(m[i],"inserted",n,e)};l?Yn(n,"insert",o):o()}u.length&&Yn(n,"postpatch",(function(){for(var i=0;i<u.length;i++)Cr(u[i],"componentUpdated",n,e)}));if(!l)for(i in d)s[i]||Cr(d[i],"unbind",e,e,t)}(e,n)}var Er=Object.create(null);function Zr(e,n){var i,a,r=Object.create(null);if(!e)return r;for(i=0;i<e.length;i++){if((a=e[i]).modifiers||(a.modifiers=Er),r[Gr(a)]=a,n._setupState&&n._setupState.__sfc){var l=a.def||Za(n,"_setupState","v-"+a.name);a.def="function"==typeof l?{bind:l,update:l}:l}a.def=a.def||Za(n.$options,"directives",a.name)}return r}function Gr(e){return e.rawName||"".concat(e.name,".").concat(Object.keys(e.modifiers||{}).join("."))}function Cr(e,n,i,a,r){var l=e.def&&e.def[n];if(l)try{l(i.elm,e,i,a,r)}catch(a){bi(a,i.context,"directive ".concat(e.name," ").concat(n," hook"))}}var Vr=[Tr,Dr];function Mr(e,n){var i=n.componentOptions;if(!(t(i)&&!1===i.Ctor.options.inheritAttrs||l(e.data.attrs)&&l(n.data.attrs))){var a,r,s=n.elm,m=e.data.attrs||{},u=n.data.attrs||{};for(a in(t(u.__ob__)||d(u._v_attr_proxy))&&(u=n.data.attrs=O({},u)),u)r=u[a],m[a]!==r&&_r(s,a,r,n.data.pre);for(a in(X||Q)&&u.value!==m.value&&_r(s,"value",u.value),m)l(u[a])&&(kr(a)?s.removeAttributeNS(or,yr(a)):sr(a)||s.removeAttribute(a))}}function _r(e,n,i,a){a||e.tagName.indexOf("-")>-1?Fr(e,n,i):ur(n)?br(i)?e.removeAttribute(n):(i="allowfullscreen"===n&&"EMBED"===e.tagName?"true":n,e.setAttribute(n,i)):sr(n)?e.setAttribute(n,function(e,n){return br(n)||"false"===n?"false":"contenteditable"===e&&mr(n)?n:"true"}(n,i)):kr(n)?br(i)?e.removeAttributeNS(or,yr(n)):e.setAttributeNS(or,n,i):Fr(e,n,i)}function Fr(e,n,i){if(br(i))e.removeAttribute(n);else{if(X&&!q&&"TEXTAREA"===e.tagName&&"placeholder"===n&&""!==i&&!e.__ieph){var a=function(n){n.stopImmediatePropagation(),e.removeEventListener("input",a)};e.addEventListener("input",a),e.__ieph=!0}e.setAttribute(n,i)}}var xr={create:Mr,update:Mr};function Lr(e,n){var i=n.elm,a=n.data,r=e.data;if(!(l(a.staticClass)&&l(a.class)&&(l(r)||l(r.staticClass)&&l(r.class)))){var d=cr(n),s=i._transitionClasses;t(s)&&(d=pr(d,Hr(s))),d!==i._prevClass&&(i.setAttribute("class",d),i._prevClass=d)}}var wr,jr={create:Lr,update:Lr};function Ur(e,n,i){var a=wr;return function r(){var l=n.apply(null,arguments);null!==l&&Wr(e,r,i,a)}}var $r=Si&&!(ie&&Number(ie[1])<=53);function Jr(e,n,i,a){if($r){var r=ya,l=n;n=l._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=r||e.timeStamp<=0||e.target.ownerDocument!==document)return l.apply(this,arguments)}}wr.addEventListener(e,n,re?{capture:i,passive:a}:i)}function Wr(e,n,i,a){(a||wr).removeEventListener(e,n._wrapper||n,i)}function Xr(e,n){if(!l(e.data.on)||!l(n.data.on)){var i=n.data.on||{},a=e.data.on||{};wr=n.elm||e.elm,function(e){if(t(e.__r)){var n=X?"change":"input";e[n]=[].concat(e.__r,e[n]||[]),delete e.__r}t(e.__c)&&(e.change=[].concat(e.__c,e.change||[]),delete e.__c)}(i),Rn(i,a,Jr,Wr,Ur,n.context),wr=void 0}}var qr,Qr={create:Xr,update:Xr,destroy:function(e){return Xr(e,Yr)}};function el(e,n){if(!l(e.data.domProps)||!l(n.data.domProps)){var i,a,r=n.elm,s=e.data.domProps||{},m=n.data.domProps||{};for(i in(t(m.__ob__)||d(m._v_attr_proxy))&&(m=n.data.domProps=O({},m)),s)i in m||(r[i]="");for(i in m){if(a=m[i],"textContent"===i||"innerHTML"===i){if(n.children&&(n.children.length=0),a===s[i])continue;1===r.childNodes.length&&r.removeChild(r.childNodes[0])}if("value"===i&&"PROGRESS"!==r.tagName){r._value=a;var u=l(a)?"":String(a);nl(r,u)&&(r.value=u)}else if("innerHTML"===i&&zr(r.tagName)&&l(r.innerHTML)){(qr=qr||document.createElement("div")).innerHTML="<svg>".concat(a,"</svg>");for(var o=qr.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}else if(a!==s[i])try{r[i]=a}catch(e){}}}}function nl(e,n){return!e.composing&&("OPTION"===e.tagName||function(e,n){var i=!0;try{i=document.activeElement!==e}catch(e){}return i&&e.value!==n}(e,n)||function(e,n){var i=e.value,a=e._vModifiers;if(t(a)){if(a.number)return H(i)!==H(n);if(a.trim)return i.trim()!==n.trim()}return i!==n}(e,n))}var il={create:el,update:el},al=f((function(e){var n={},i=/:(.+)/;return e.split(/;(?![^(]*\))/g).forEach((function(e){if(e){var a=e.split(i);a.length>1&&(n[a[0].trim()]=a[1].trim())}})),n}));function rl(e){var n=ll(e.style);return e.staticStyle?O(e.staticStyle,n):n}function ll(e){return Array.isArray(e)?D(e):"string"==typeof e?al(e):e}var tl,dl=/^--/,sl=/\s*!important$/,ml=function(e,n,i){if(dl.test(n))e.style.setProperty(n,i);else if(sl.test(i))e.style.setProperty(Y(n),i.replace(sl,""),"important");else{var a=ol(n);if(Array.isArray(i))for(var r=0,l=i.length;r<l;r++)e.style[a]=i[r];else e.style[a]=i}},ul=["Webkit","Moz","ms"],ol=f((function(e){if(tl=tl||document.createElement("div").style,"filter"!==(e=T(e))&&e in tl)return e;for(var n=e.charAt(0).toUpperCase()+e.slice(1),i=0;i<ul.length;i++){var a=ul[i]+n;if(a in tl)return a}}));function kl(e,n){var i=n.data,a=e.data;if(!(l(i.staticStyle)&&l(i.style)&&l(a.staticStyle)&&l(a.style))){var r,d,s=n.elm,m=a.staticStyle,u=a.normalizedStyle||a.style||{},o=m||u,k=ll(n.data.style)||{};n.data.normalizedStyle=t(k.__ob__)?O({},k):k;var y=function(e,n){var i,a={};if(n)for(var r=e;r.componentInstance;)(r=r.componentInstance._vnode)&&r.data&&(i=rl(r.data))&&O(a,i);(i=rl(e.data))&&O(a,i);for(var l=e;l=l.parent;)l.data&&(i=rl(l.data))&&O(a,i);return a}(n,!0);for(d in o)l(y[d])&&ml(s,d,"");for(d in y)r=y[d],ml(s,d,null==r?"":r)}}var yl={create:kl,update:kl},bl=/\s+/;function cl(e,n){if(n&&(n=n.trim()))if(e.classList)n.indexOf(" ")>-1?n.split(bl).forEach((function(n){return e.classList.add(n)})):e.classList.add(n);else{var i=" ".concat(e.getAttribute("class")||""," ");i.indexOf(" "+n+" ")<0&&e.setAttribute("class",(i+n).trim())}}function gl(e,n){if(n&&(n=n.trim()))if(e.classList)n.indexOf(" ")>-1?n.split(bl).forEach((function(n){return e.classList.remove(n)})):e.classList.remove(n),e.classList.length||e.removeAttribute("class");else{for(var i=" ".concat(e.getAttribute("class")||""," "),a=" "+n+" ";i.indexOf(a)>=0;)i=i.replace(a," ");(i=i.trim())?e.setAttribute("class",i):e.removeAttribute("class")}}function pl(e){if(e){if("object"==typeof e){var n={};return!1!==e.css&&O(n,Hl(e.name||"v")),O(n,e),n}return"string"==typeof e?Hl(e):void 0}}var Hl=f((function(e){return{enterClass:"".concat(e,"-enter"),enterToClass:"".concat(e,"-enter-to"),enterActiveClass:"".concat(e,"-enter-active"),leaveClass:"".concat(e,"-leave"),leaveToClass:"".concat(e,"-leave-to"),leaveActiveClass:"".concat(e,"-leave-active")}})),Sl=J&&!q,hl="transition",zl="transitionend",vl="animation",Kl="animationend";Sl&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(hl="WebkitTransition",zl="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(vl="WebkitAnimation",Kl="webkitAnimationEnd"));var fl=J?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function Al(e){fl((function(){fl(e)}))}function Tl(e,n){var i=e._transitionClasses||(e._transitionClasses=[]);i.indexOf(n)<0&&(i.push(n),cl(e,n))}function Bl(e,n){e._transitionClasses&&z(e._transitionClasses,n),gl(e,n)}function Rl(e,n,i){var a=Pl(e,n),r=a.type,l=a.timeout,t=a.propCount;if(!r)return i();var d="transition"===r?zl:Kl,s=0,m=function(){e.removeEventListener(d,u),i()},u=function(n){n.target===e&&++s>=t&&m()};setTimeout((function(){s<t&&m()}),l+1),e.addEventListener(d,u)}var Yl=/\b(transform|all)(,|$)/;function Pl(e,n){var i,a=window.getComputedStyle(e),r=(a[hl+"Delay"]||"").split(", "),l=(a[hl+"Duration"]||"").split(", "),t=Nl(r,l),d=(a[vl+"Delay"]||"").split(", "),s=(a[vl+"Duration"]||"").split(", "),m=Nl(d,s),u=0,o=0;return"transition"===n?t>0&&(i="transition",u=t,o=l.length):"animation"===n?m>0&&(i="animation",u=m,o=s.length):o=(i=(u=Math.max(t,m))>0?t>m?"transition":"animation":null)?"transition"===i?l.length:s.length:0,{type:i,timeout:u,propCount:o,hasTransform:"transition"===i&&Yl.test(a[hl+"Property"])}}function Nl(e,n){for(;e.length<n.length;)e=e.concat(e);return Math.max.apply(null,n.map((function(n,i){return Ol(n)+Ol(e[i])})))}function Ol(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function Dl(e,n){var i=e.elm;t(i._leaveCb)&&(i._leaveCb.cancelled=!0,i._leaveCb());var a=pl(e.data.transition);if(!l(a)&&!t(i._enterCb)&&1===i.nodeType){for(var r=a.css,d=a.type,s=a.enterClass,o=a.enterToClass,k=a.enterActiveClass,y=a.appearClass,b=a.appearToClass,c=a.appearActiveClass,g=a.beforeEnter,p=a.enter,S=a.afterEnter,h=a.enterCancelled,z=a.beforeAppear,v=a.appear,K=a.afterAppear,f=a.appearCancelled,A=a.duration,T=ia,B=ia.$vnode;B&&B.parent;)T=B.context,B=B.parent;var R=!T._isMounted||!e.isRootInsert;if(!R||v||""===v){var Y=R&&y?y:s,P=R&&c?c:k,N=R&&b?b:o,O=R&&z||g,D=R&&m(v)?v:p,I=R&&K||S,E=R&&f||h,Z=H(u(A)?A.enter:A);0;var G=!1!==r&&!q,C=Zl(D),M=i._enterCb=V((function(){G&&(Bl(i,N),Bl(i,P)),M.cancelled?(G&&Bl(i,Y),E&&E(i)):I&&I(i),i._enterCb=null}));e.data.show||Yn(e,"insert",(function(){var n=i.parentNode,a=n&&n._pending&&n._pending[e.key];a&&a.tag===e.tag&&a.elm._leaveCb&&a.elm._leaveCb(),D&&D(i,M)})),O&&O(i),G&&(Tl(i,Y),Tl(i,P),Al((function(){Bl(i,Y),M.cancelled||(Tl(i,N),C||(El(Z)?setTimeout(M,Z):Rl(i,d,M)))}))),e.data.show&&(n&&n(),D&&D(i,M)),G||C||M()}}}function Il(e,n){var i=e.elm;t(i._enterCb)&&(i._enterCb.cancelled=!0,i._enterCb());var a=pl(e.data.transition);if(l(a)||1!==i.nodeType)return n();if(!t(i._leaveCb)){var r=a.css,d=a.type,s=a.leaveClass,m=a.leaveToClass,o=a.leaveActiveClass,k=a.beforeLeave,y=a.leave,b=a.afterLeave,c=a.leaveCancelled,g=a.delayLeave,p=a.duration,S=!1!==r&&!q,h=Zl(y),z=H(u(p)?p.leave:p);0;var v=i._leaveCb=V((function(){i.parentNode&&i.parentNode._pending&&(i.parentNode._pending[e.key]=null),S&&(Bl(i,m),Bl(i,o)),v.cancelled?(S&&Bl(i,s),c&&c(i)):(n(),b&&b(i)),i._leaveCb=null}));g?g(K):K()}function K(){v.cancelled||(!e.data.show&&i.parentNode&&((i.parentNode._pending||(i.parentNode._pending={}))[e.key]=e),k&&k(i),S&&(Tl(i,s),Tl(i,o),Al((function(){Bl(i,s),v.cancelled||(Tl(i,m),h||(El(z)?setTimeout(v,z):Rl(i,d,v)))}))),y&&y(i,v),S||h||v())}}function El(e){return"number"==typeof e&&!isNaN(e)}function Zl(e){if(l(e))return!1;var n=e.fns;return t(n)?Zl(Array.isArray(n)?n[0]:n):(e._length||e.length)>1}function Gl(e,n){!0!==n.data.show&&Dl(n)}var Cl=function(e){var n,i,a={},m=e.modules,u=e.nodeOps;for(n=0;n<Pr.length;++n)for(a[Pr[n]]=[],i=0;i<m.length;++i)t(m[i][Pr[n]])&&a[Pr[n]].push(m[i][Pr[n]]);function o(e){var n=u.parentNode(e);t(n)&&u.removeChild(n,e)}function k(e,n,i,r,l,s,m){if(t(e.elm)&&t(s)&&(e=s[m]=pe(e)),e.isRootInsert=!l,!function(e,n,i,r){var l=e.data;if(t(l)){var s=t(e.componentInstance)&&l.keepAlive;if(t(l=l.hook)&&t(l=l.init)&&l(e,!1),t(e.componentInstance))return y(e,n),b(i,e.elm,r),d(s)&&function(e,n,i,r){var l,d=e;for(;d.componentInstance;)if(d=d.componentInstance._vnode,t(l=d.data)&&t(l=l.transition)){for(l=0;l<a.activate.length;++l)a.activate[l](Yr,d);n.push(d);break}b(i,e.elm,r)}(e,n,i,r),!0}}(e,n,i,r)){var o=e.data,k=e.children,g=e.tag;t(g)?(e.elm=e.ns?u.createElementNS(e.ns,g):u.createElement(g,e),H(e),c(e,k,n),t(o)&&p(e,n),b(i,e.elm,r)):d(e.isComment)?(e.elm=u.createComment(e.text),b(i,e.elm,r)):(e.elm=u.createTextNode(e.text),b(i,e.elm,r))}}function y(e,n){t(e.data.pendingInsert)&&(n.push.apply(n,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,g(e)?(p(e,n),H(e)):(Br(e),n.push(e))}function b(e,n,i){t(e)&&(t(i)?u.parentNode(i)===e&&u.insertBefore(e,n,i):u.appendChild(e,n))}function c(e,n,i){if(r(n)){0;for(var a=0;a<n.length;++a)k(n[a],i,e.elm,null,!0,n,a)}else s(e.text)&&u.appendChild(e.elm,u.createTextNode(String(e.text)))}function g(e){for(;e.componentInstance;)e=e.componentInstance._vnode;return t(e.tag)}function p(e,i){for(var r=0;r<a.create.length;++r)a.create[r](Yr,e);t(n=e.data.hook)&&(t(n.create)&&n.create(Yr,e),t(n.insert)&&i.push(e))}function H(e){var n;if(t(n=e.fnScopeId))u.setStyleScope(e.elm,n);else for(var i=e;i;)t(n=i.context)&&t(n=n.$options._scopeId)&&u.setStyleScope(e.elm,n),i=i.parent;t(n=ia)&&n!==e.context&&n!==e.fnContext&&t(n=n.$options._scopeId)&&u.setStyleScope(e.elm,n)}function h(e,n,i,a,r,l){for(;a<=r;++a)k(i[a],l,e,n,!1,i,a)}function z(e){var n,i,r=e.data;if(t(r))for(t(n=r.hook)&&t(n=n.destroy)&&n(e),n=0;n<a.destroy.length;++n)a.destroy[n](e);if(t(n=e.children))for(i=0;i<e.children.length;++i)z(e.children[i])}function v(e,n,i){for(;n<=i;++n){var a=e[n];t(a)&&(t(a.tag)?(K(a),z(a)):o(a.elm))}}function K(e,n){if(t(n)||t(e.data)){var i,r=a.remove.length+1;for(t(n)?n.listeners+=r:n=function(e,n){function i(){0==--i.listeners&&o(e)}return i.listeners=n,i}(e.elm,r),t(i=e.componentInstance)&&t(i=i._vnode)&&t(i.data)&&K(i,n),i=0;i<a.remove.length;++i)a.remove[i](e,n);t(i=e.data.hook)&&t(i=i.remove)?i(e,n):n()}else o(e.elm)}function f(e,n,i,a){for(var r=i;r<a;r++){var l=n[r];if(t(l)&&Nr(e,l))return r}}function A(e,n,i,r,s,m){if(e!==n){t(n.elm)&&t(r)&&(n=r[s]=pe(n));var o=n.elm=e.elm;if(d(e.isAsyncPlaceholder))t(n.asyncFactory.resolved)?R(e.elm,n,i):n.isAsyncPlaceholder=!0;else if(d(n.isStatic)&&d(e.isStatic)&&n.key===e.key&&(d(n.isCloned)||d(n.isOnce)))n.componentInstance=e.componentInstance;else{var y,b=n.data;t(b)&&t(y=b.hook)&&t(y=y.prepatch)&&y(e,n);var c=e.children,p=n.children;if(t(b)&&g(n)){for(y=0;y<a.update.length;++y)a.update[y](e,n);t(y=b.hook)&&t(y=y.update)&&y(e,n)}l(n.text)?t(c)&&t(p)?c!==p&&function(e,n,i,a,r){var d,s,m,o=0,y=0,b=n.length-1,c=n[0],g=n[b],p=i.length-1,H=i[0],S=i[p],z=!r;for(0;o<=b&&y<=p;)l(c)?c=n[++o]:l(g)?g=n[--b]:Nr(c,H)?(A(c,H,a,i,y),c=n[++o],H=i[++y]):Nr(g,S)?(A(g,S,a,i,p),g=n[--b],S=i[--p]):Nr(c,S)?(A(c,S,a,i,p),z&&u.insertBefore(e,c.elm,u.nextSibling(g.elm)),c=n[++o],S=i[--p]):Nr(g,H)?(A(g,H,a,i,y),z&&u.insertBefore(e,g.elm,c.elm),g=n[--b],H=i[++y]):(l(d)&&(d=Or(n,o,b)),l(s=t(H.key)?d[H.key]:f(H,n,o,b))?k(H,a,e,c.elm,!1,i,y):Nr(m=n[s],H)?(A(m,H,a,i,y),n[s]=void 0,z&&u.insertBefore(e,m.elm,c.elm)):k(H,a,e,c.elm,!1,i,y),H=i[++y]);o>b?h(e,l(i[p+1])?null:i[p+1].elm,i,y,p,a):y>p&&v(n,o,b)}(o,c,p,i,m):t(p)?(t(e.text)&&u.setTextContent(o,""),h(o,null,p,0,p.length-1,i)):t(c)?v(c,0,c.length-1):t(e.text)&&u.setTextContent(o,""):e.text!==n.text&&u.setTextContent(o,n.text),t(b)&&t(y=b.hook)&&t(y=y.postpatch)&&y(e,n)}}}function T(e,n,i){if(d(i)&&t(e.parent))e.parent.data.pendingInsert=n;else for(var a=0;a<n.length;++a)n[a].data.hook.insert(n[a])}var B=S("attrs,class,staticClass,staticStyle,key");function R(e,n,i,a){var r,l=n.tag,s=n.data,m=n.children;if(a=a||s&&s.pre,n.elm=e,d(n.isComment)&&t(n.asyncFactory))return n.isAsyncPlaceholder=!0,!0;if(t(s)&&(t(r=s.hook)&&t(r=r.init)&&r(n,!0),t(r=n.componentInstance)))return y(n,i),!0;if(t(l)){if(t(m))if(e.hasChildNodes())if(t(r=s)&&t(r=r.domProps)&&t(r=r.innerHTML)){if(r!==e.innerHTML)return!1}else{for(var u=!0,o=e.firstChild,k=0;k<m.length;k++){if(!o||!R(o,m[k],i,a)){u=!1;break}o=o.nextSibling}if(!u||o)return!1}else c(n,m,i);if(t(s)){var b=!1;for(var g in s)if(!B(g)){b=!0,p(n,i);break}!b&&s.class&&$i(s.class)}}else e.data!==n.text&&(e.data=n.text);return!0}return function(e,n,i,r){if(!l(n)){var s,m=!1,o=[];if(l(e))m=!0,k(n,o);else{var y=t(e.nodeType);if(!y&&Nr(e,n))A(e,n,o,null,null,r);else{if(y){if(1===e.nodeType&&e.hasAttribute("data-server-rendered")&&(e.removeAttribute("data-server-rendered"),i=!0),d(i)&&R(e,n,o))return T(n,o,!0),e;s=e,e=new be(u.tagName(s).toLowerCase(),{},[],void 0,s)}var b=e.elm,c=u.parentNode(b);if(k(n,o,b._leaveCb?null:c,u.nextSibling(b)),t(n.parent))for(var p=n.parent,H=g(n);p;){for(var S=0;S<a.destroy.length;++S)a.destroy[S](p);if(p.elm=n.elm,H){for(var h=0;h<a.create.length;++h)a.create[h](Yr,p);var K=p.data.hook.insert;if(K.merged)for(var f=K.fns.slice(1),B=0;B<f.length;B++)f[B]()}else Br(p);p=p.parent}t(c)?v([e],0,0):t(e.tag)&&z(e)}}return T(n,o,m),n.elm}t(e)&&z(e)}}({nodeOps:Ar,modules:[xr,jr,Qr,il,yl,J?{create:Gl,activate:Gl,remove:function(e,n){!0!==e.data.show?Il(e,n):n()}}:{}].concat(Vr)});q&&document.addEventListener("selectionchange",(function(){var e=document.activeElement;e&&e.vmodel&&jl(e,"input")}));var Vl={inserted:function(e,n,i,a){"select"===i.tag?(a.elm&&!a.elm._vOptions?Yn(i,"postpatch",(function(){Vl.componentUpdated(e,n,i)})):Ml(e,n,i.context),e._vOptions=[].map.call(e.options,xl)):("textarea"===i.tag||fr(e.type))&&(e._vModifiers=n.modifiers,n.modifiers.lazy||(e.addEventListener("compositionstart",Ll),e.addEventListener("compositionend",wl),e.addEventListener("change",wl),q&&(e.vmodel=!0)))},componentUpdated:function(e,n,i){if("select"===i.tag){Ml(e,n,i.context);var a=e._vOptions,r=e._vOptions=[].map.call(e.options,xl);if(r.some((function(e,n){return!G(e,a[n])})))(e.multiple?n.value.some((function(e){return Fl(e,r)})):n.value!==n.oldValue&&Fl(n.value,r))&&jl(e,"change")}}};function Ml(e,n,i){_l(e,n,i),(X||Q)&&setTimeout((function(){_l(e,n,i)}),0)}function _l(e,n,i){var a=n.value,r=e.multiple;if(!r||Array.isArray(a)){for(var l,t,d=0,s=e.options.length;d<s;d++)if(t=e.options[d],r)l=C(a,xl(t))>-1,t.selected!==l&&(t.selected=l);else if(G(xl(t),a))return void(e.selectedIndex!==d&&(e.selectedIndex=d));r||(e.selectedIndex=-1)}}function Fl(e,n){return n.every((function(n){return!G(n,e)}))}function xl(e){return"_value"in e?e._value:e.value}function Ll(e){e.target.composing=!0}function wl(e){e.target.composing&&(e.target.composing=!1,jl(e.target,"input"))}function jl(e,n){var i=document.createEvent("HTMLEvents");i.initEvent(n,!0,!0),e.dispatchEvent(i)}function Ul(e){return!e.componentInstance||e.data&&e.data.transition?e:Ul(e.componentInstance._vnode)}var $l={model:Vl,show:{bind:function(e,n,i){var a=n.value,r=(i=Ul(i)).data&&i.data.transition,l=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;a&&r?(i.data.show=!0,Dl(i,(function(){e.style.display=l}))):e.style.display=a?l:"none"},update:function(e,n,i){var a=n.value;!a!=!n.oldValue&&((i=Ul(i)).data&&i.data.transition?(i.data.show=!0,a?Dl(i,(function(){e.style.display=e.__vOriginalDisplay})):Il(i,(function(){e.style.display="none"}))):e.style.display=a?e.__vOriginalDisplay:"none")},unbind:function(e,n,i,a,r){r||(e.style.display=e.__vOriginalDisplay)}}},Jl={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function Wl(e){var n=e&&e.componentOptions;return n&&n.Ctor.options.abstract?Wl(oi(n.children)):e}function Xl(e){var n={},i=e.$options;for(var a in i.propsData)n[a]=e[a];var r=i._parentListeners;for(var a in r)n[T(a)]=r[a];return n}function ql(e,n){if(/\d-keep-alive$/.test(n.tag))return e("keep-alive",{props:n.componentOptions.propsData})}var Ql=function(e){return e.tag||Wn(e)},et=function(e){return"show"===e.name},nt={name:"transition",props:Jl,abstract:!0,render:function(e){var n=this,i=this.$slots.default;if(i&&(i=i.filter(Ql)).length){0;var a=this.mode;0;var r=i[0];if(function(e){for(;e=e.parent;)if(e.data.transition)return!0}(this.$vnode))return r;var l=Wl(r);if(!l)return r;if(this._leaving)return ql(e,r);var t="__transition-".concat(this._uid,"-");l.key=null==l.key?l.isComment?t+"comment":t+l.tag:s(l.key)?0===String(l.key).indexOf(t)?l.key:t+l.key:l.key;var d=(l.data||(l.data={})).transition=Xl(this),m=this._vnode,u=Wl(m);if(l.data.directives&&l.data.directives.some(et)&&(l.data.show=!0),u&&u.data&&!function(e,n){return n.key===e.key&&n.tag===e.tag}(l,u)&&!Wn(u)&&(!u.componentInstance||!u.componentInstance._vnode.isComment)){var o=u.data.transition=O({},d);if("out-in"===a)return this._leaving=!0,Yn(o,"afterLeave",(function(){n._leaving=!1,n.$forceUpdate()})),ql(e,r);if("in-out"===a){if(Wn(l))return m;var k,y=function(){k()};Yn(d,"afterEnter",y),Yn(d,"enterCancelled",y),Yn(o,"delayLeave",(function(e){k=e}))}}return r}}},it=O({tag:String,moveClass:String},Jl);function at(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function rt(e){e.data.newPos=e.elm.getBoundingClientRect()}function lt(e){var n=e.data.pos,i=e.data.newPos,a=n.left-i.left,r=n.top-i.top;if(a||r){e.data.moved=!0;var l=e.elm.style;l.transform=l.WebkitTransform="translate(".concat(a,"px,").concat(r,"px)"),l.transitionDuration="0s"}}delete it.mode;var tt={Transition:nt,TransitionGroup:{props:it,beforeMount:function(){var e=this,n=this._update;this._update=function(i,a){var r=aa(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,r(),n.call(e,i,a)}},render:function(e){for(var n=this.tag||this.$vnode.data.tag||"span",i=Object.create(null),a=this.prevChildren=this.children,r=this.$slots.default||[],l=this.children=[],t=Xl(this),d=0;d<r.length;d++){if((u=r[d]).tag)if(null!=u.key&&0!==String(u.key).indexOf("__vlist"))l.push(u),i[u.key]=u,(u.data||(u.data={})).transition=t;else;}if(a){var s=[],m=[];for(d=0;d<a.length;d++){var u;(u=a[d]).data.transition=t,u.data.pos=u.elm.getBoundingClientRect(),i[u.key]?s.push(u):m.push(u)}this.kept=e(n,null,s),this.removed=m}return e(n,null,l)},updated:function(){var e=this.prevChildren,n=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,n)&&(e.forEach(at),e.forEach(rt),e.forEach(lt),this._reflow=document.body.offsetHeight,e.forEach((function(e){if(e.data.moved){var i=e.elm,a=i.style;Tl(i,n),a.transform=a.WebkitTransform=a.transitionDuration="",i.addEventListener(zl,i._moveCb=function e(a){a&&a.target!==i||a&&!/transform$/.test(a.propertyName)||(i.removeEventListener(zl,e),i._moveCb=null,Bl(i,n))})}})))},methods:{hasMove:function(e,n){if(!Sl)return!1;if(this._hasMove)return this._hasMove;var i=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach((function(e){gl(i,e)})),cl(i,n),i.style.display="none",this.$el.appendChild(i);var a=Pl(i);return this.$el.removeChild(i),this._hasMove=a.hasTransform}}}};qa.config.mustUseProp=function(e,n,i){return"value"===i&&dr(e)&&"button"!==n||"selected"===i&&"option"===e||"checked"===i&&"input"===e||"muted"===i&&"video"===e},qa.config.isReservedTag=vr,qa.config.isReservedAttr=tr,qa.config.getTagNamespace=function(e){return zr(e)?"svg":"math"===e?"math":void 0},qa.config.isUnknownElement=function(e){if(!J)return!0;if(vr(e))return!1;if(e=e.toLowerCase(),null!=Kr[e])return Kr[e];var n=document.createElement(e);return e.indexOf("-")>-1?Kr[e]=n.constructor===window.HTMLUnknownElement||n.constructor===window.HTMLElement:Kr[e]=/HTMLUnknownElement/.test(n.toString())},O(qa.options.directives,$l),O(qa.options.components,tt),qa.prototype.__patch__=J?Cl:I,qa.prototype.$mount=function(e,n){return function(e,n,i){var a;e.$el=n,e.$options.render||(e.$options.render=ce),ta(e,"beforeMount"),a=function(){e._update(e._render(),i)},new Xi(e,a,I,{before:function(){e._isMounted&&!e._isDestroyed&&ta(e,"beforeUpdate")}},!0),i=!1;var r=e._preWatchers;if(r)for(var l=0;l<r.length;l++)r[l].run();return null==e.$vnode&&(e._isMounted=!0,ta(e,"mounted")),e}(this,e=e&&J?function(e){if("string"==typeof e){var n=document.querySelector(e);return n||document.createElement("div")}return e}(e):void 0,n)},J&&setTimeout((function(){x.devtools&&de&&de.emit("init",qa)}),0)},function(e,n,i){"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,n,i){"use strict";var a="object"==typeof document&&document.all;e.exports=void 0===a&&void 0!==a?function(e){return"function"==typeof e||e===a}:function(e){return"function"==typeof e}},function(e,n,i){"use strict";var a=function(e){return e&&e.Math===Math&&e};e.exports=a("object"==typeof globalThis&&globalThis)||a("object"==typeof window&&window)||a("object"==typeof self&&self)||a("object"==typeof global&&global)||a("object"==typeof this&&this)||function(){return this}()||Function("return this")()},function(e,n,i){"use strict";var a=i(36),r=Function.prototype,l=r.call,t=a&&r.bind.bind(l,l);e.exports=a?t:function(e){return function(){return l.apply(e,arguments)}}},function(e,n,i){"use strict";var a=i(9),r=String,l=TypeError;e.exports=function(e){if(a(e))return e;throw new l(r(e)+" is not an object")}},function(e,n,i){"use strict";var a=i(36),r=Function.prototype.call;e.exports=a?r.bind(r):function(){return r.apply(r,arguments)}},function(e,n,i){"use strict";var a=i(1);e.exports=!a((function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(e,n,i){"use strict";var a=i(4),r=i(33),l=a({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,n){return l(r(e),n)}},function(e,n,i){"use strict";var a=i(2);e.exports=function(e){return"object"==typeof e?null!==e:a(e)}},function(e,n,i){"use strict";var a=i(3),r=i(84).f,l=i(20),t=i(45),d=i(55),s=i(76),m=i(157);e.exports=function(e,n){var i,u,o,k,y,b=e.target,c=e.global,g=e.stat;if(i=c?a:g?a[b]||d(b,{}):a[b]&&a[b].prototype)for(u in n){if(k=n[u],o=e.dontCallGetSet?(y=r(i,u))&&y.value:i[u],!m(c?u:b+(g?".":"#")+u,e.forced)&&void 0!==o){if(typeof k==typeof o)continue;s(k,o)}(e.sham||o&&o.sham)&&l(k,"sham",!0),t(i,u,k,e)}}},function(e,n,i){"use strict";var a=i(2),r=i(48),l=TypeError;e.exports=function(e){if(a(e))return e;throw new l(r(e)+" is not a function")}},function(e,n,i){"use strict";var a=i(6),r=i(5),l=i(35);e.exports=function(e,n,i){var t,d;r(e);try{if(!(t=l(e,"return"))){if("throw"===n)throw i;return i}t=a(t,e)}catch(e){d=!0,t=e}if("throw"===n)throw i;if(d)throw t;return r(t),i}},function(e,n){var i=Array.isArray;e.exports=i},function(e,n,i){var a=i(98),r="object"==typeof self&&self&&self.Object===Object&&self,l=a||r||Function("return this")();e.exports=l},function(e,n,i){"use strict";var a=i(3),r=i(88),l=i(8),t=i(49),d=i(47),s=i(86),m=a.Symbol,u=r("wks"),o=s?m.for||m:m&&m.withoutSetter||t;e.exports=function(e){return l(u,e)||(u[e]=d&&l(m,e)?m[e]:o("Symbol."+e)),u[e]}},function(e,n,i){"use strict";var a=i(10),r=i(3),l=i(134),t=i(5),d=i(2),s=i(72),m=i(122),u=i(127),o=i(1),k=i(8),y=i(15),b=i(94).IteratorPrototype,c=i(7),g=i(19),p=y("toStringTag"),H=TypeError,S=r.Iterator,h=g||!d(S)||S.prototype!==b||!o((function(){S({})})),z=function(){if(l(this,b),s(this)===b)throw new H("Abstract class Iterator not directly constructable")},v=function(e,n){c?m(b,e,{configurable:!0,get:function(){return n},set:function(n){if(t(this),this===b)throw new H("You can't redefine this property");k(this,e)?this[e]=n:u(this,e,n)}}):b[e]=n};k(b,p)||v(p,"Iterator"),!h&&k(b,"constructor")&&b.constructor!==Object||v("constructor",z),z.prototype=b,a({global:!0,constructor:!0,forced:h},{Iterator:z})},function(e,n,i){"use strict";var a=i(7),r=i(89),l=i(91),t=i(5),d=i(85),s=TypeError,m=Object.defineProperty,u=Object.getOwnPropertyDescriptor;n.f=a?l?function(e,n,i){if(t(e),n=d(n),t(i),"function"==typeof e&&"prototype"===n&&"value"in i&&"writable"in i&&!i.writable){var a=u(e,n);a&&a.writable&&(e[n]=i.value,i={configurable:"configurable"in i?i.configurable:a.configurable,enumerable:"enumerable"in i?i.enumerable:a.enumerable,writable:!1})}return m(e,n,i)}:m:function(e,n,i){if(t(e),n=d(n),t(i),r)try{return m(e,n,i)}catch(e){}if("get"in i||"set"in i)throw new s("Accessors not supported");return"value"in i&&(e[n]=i.value),e}},function(e,n,i){var a=i(198),r=i(201);e.exports=function(e,n){var i=r(e,n);return a(i)?i:void 0}},function(e,n,i){"use strict";e.exports=!1},function(e,n,i){"use strict";var a=i(7),r=i(17),l=i(34);e.exports=a?function(e,n,i){return r.f(e,n,l(1,i))}:function(e,n,i){return e[n]=i,e}},function(e,n,i){"use strict";var a=i(4),r=a({}.toString),l=a("".slice);e.exports=function(e){return l(r(e),8,-1)}},function(e,n){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,n,i){"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},function(e,n,i){"use strict";var a=i(10),r=i(6),l=i(11),t=i(5),d=i(23),s=i(77),m=i(95),u=i(19),o=i(12),k=i(80),y=i(26),b=!u&&!k("filter",(function(){})),c=!u&&!b&&y("filter",TypeError),g=u||b||c,p=s((function(){for(var e,n,i=this.iterator,a=this.predicate,l=this.next;;){if(e=t(r(l,i)),this.done=!!e.done)return;if(n=e.value,m(i,a,[n,this.counter++],!0))return n}}));a({target:"Iterator",proto:!0,real:!0,forced:g},{filter:function(e){t(this);try{l(e)}catch(e){o(this,"throw",e)}return c?r(c,this,e):new p(d(this),{predicate:e})}})},function(e,n,i){"use strict";var a=i(3),r=i(2),l=function(e){return r(e)?e:void 0};e.exports=function(e,n){return arguments.length<2?l(a[e]):a[e]&&a[e][n]}},function(e,n,i){"use strict";var a=i(3);e.exports=function(e,n){var i=a.Iterator,r=i&&i.prototype,l=r&&r[e],t=!1;if(l)try{l.call({next:function(){return{done:!0}},return:function(){t=!0}},-1)}catch(e){e instanceof n||(t=!1)}if(!t)return l}},function(e,n,i){var a=i(28),r=i(183),l=i(184),t=a?a.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":t&&t in Object(e)?r(e):l(e)}},function(e,n,i){var a=i(14).Symbol;e.exports=a},function(e,n,i){"use strict";function a(e,n,i,a,r,l,t,d){var s,m="function"==typeof e?e.options:e;if(n&&(m.render=n,m.staticRenderFns=i,m._compiled=!0),a&&(m.functional=!0),l&&(m._scopeId="data-v-"+l),t?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(t)},m._ssrRegister=s):r&&(s=d?function(){r.call(this,(m.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(m.functional){m._injectStyles=s;var u=m.render;m.render=function(e,n){return s.call(n),u(e,n)}}else{var o=m.beforeCreate;m.beforeCreate=o?[].concat(o,s):[s]}return{exports:e,options:m}}i.d(n,"a",(function(){return a}))},function(e,n,i){"use strict";var a=i(133);e.exports=function(e){return a(e.length)}},function(e,n,i){"use strict";var a=i(10),r=i(6),l=i(11),t=i(5),d=i(23),s=i(77),m=i(95),u=i(12),o=i(80),k=i(26),y=i(19),b=!y&&!o("map",(function(){})),c=!y&&!b&&k("map",TypeError),g=y||b||c,p=s((function(){var e=this.iterator,n=t(r(this.next,e));if(!(this.done=!!n.done))return m(e,this.mapper,[n.value,this.counter++],!0)}));a({target:"Iterator",proto:!0,real:!0,forced:g},{map:function(e){t(this);try{l(e)}catch(e){u(this,"throw",e)}return c?r(c,this,e):new p(d(this),{mapper:e})}})},function(e,n,i){"use strict";var a=i(4);e.exports=a({}.isPrototypeOf)},function(e,n,i){"use strict";var a=i(46),r=Object;e.exports=function(e){return r(a(e))}},function(e,n,i){"use strict";e.exports=function(e,n){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:n}}},function(e,n,i){"use strict";var a=i(11),r=i(52);e.exports=function(e,n){var i=e[n];return r(i)?void 0:a(i)}},function(e,n,i){"use strict";var a=i(1);e.exports=!a((function(){var e=function(){}.bind();return"function"!=typeof e||e.hasOwnProperty("prototype")}))},function(e,n,i){"use strict";var a=i(78),r=i(46);e.exports=function(e){return a(r(e))}},function(e,n,i){var a=i(188),r=i(189),l=i(190),t=i(191),d=i(192);function s(e){var n=-1,i=null==e?0:e.length;for(this.clear();++n<i;){var a=e[n];this.set(a[0],a[1])}}s.prototype.clear=a,s.prototype.delete=r,s.prototype.get=l,s.prototype.has=t,s.prototype.set=d,e.exports=s},function(e,n,i){var a=i(100);e.exports=function(e,n){for(var i=e.length;i--;)if(a(e[i][0],n))return i;return-1}},function(e,n,i){var a=i(18)(Object,"create");e.exports=a},function(e,n,i){var a=i(210);e.exports=function(e,n){var i=e.__data__;return a(n)?i["string"==typeof n?"string":"hash"]:i.map}},function(e,n,i){var a=i(66);e.exports=function(e){if("string"==typeof e||a(e))return e;var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(e,n,i){var a,r;
/* NProgress, (c) 2013, 2014 Rico Sta. Cruz - http://ricostacruz.com/nprogress
 * @license MIT */void 0===(r="function"==typeof(a=function(){var e,n,i={version:"0.2.0"},a=i.settings={minimum:.08,easing:"ease",positionUsing:"",speed:200,trickle:!0,trickleRate:.02,trickleSpeed:800,showSpinner:!0,barSelector:'[role="bar"]',spinnerSelector:'[role="spinner"]',parent:"body",template:'<div class="bar" role="bar"><div class="peg"></div></div><div class="spinner" role="spinner"><div class="spinner-icon"></div></div>'};function r(e,n,i){return e<n?n:e>i?i:e}function l(e){return 100*(-1+e)}i.configure=function(e){var n,i;for(n in e)void 0!==(i=e[n])&&e.hasOwnProperty(n)&&(a[n]=i);return this},i.status=null,i.set=function(e){var n=i.isStarted();e=r(e,a.minimum,1),i.status=1===e?null:e;var s=i.render(!n),m=s.querySelector(a.barSelector),u=a.speed,o=a.easing;return s.offsetWidth,t((function(n){""===a.positionUsing&&(a.positionUsing=i.getPositioningCSS()),d(m,function(e,n,i){var r;return(r="translate3d"===a.positionUsing?{transform:"translate3d("+l(e)+"%,0,0)"}:"translate"===a.positionUsing?{transform:"translate("+l(e)+"%,0)"}:{"margin-left":l(e)+"%"}).transition="all "+n+"ms "+i,r}(e,u,o)),1===e?(d(s,{transition:"none",opacity:1}),s.offsetWidth,setTimeout((function(){d(s,{transition:"all "+u+"ms linear",opacity:0}),setTimeout((function(){i.remove(),n()}),u)}),u)):setTimeout(n,u)})),this},i.isStarted=function(){return"number"==typeof i.status},i.start=function(){i.status||i.set(0);var e=function(){setTimeout((function(){i.status&&(i.trickle(),e())}),a.trickleSpeed)};return a.trickle&&e(),this},i.done=function(e){return e||i.status?i.inc(.3+.5*Math.random()).set(1):this},i.inc=function(e){var n=i.status;return n?("number"!=typeof e&&(e=(1-n)*r(Math.random()*n,.1,.95)),n=r(n+e,0,.994),i.set(n)):i.start()},i.trickle=function(){return i.inc(Math.random()*a.trickleRate)},e=0,n=0,i.promise=function(a){return a&&"resolved"!==a.state()?(0===n&&i.start(),e++,n++,a.always((function(){0==--n?(e=0,i.done()):i.set((e-n)/e)})),this):this},i.render=function(e){if(i.isRendered())return document.getElementById("nprogress");m(document.documentElement,"nprogress-busy");var n=document.createElement("div");n.id="nprogress",n.innerHTML=a.template;var r,t=n.querySelector(a.barSelector),s=e?"-100":l(i.status||0),u=document.querySelector(a.parent);return d(t,{transition:"all 0 linear",transform:"translate3d("+s+"%,0,0)"}),a.showSpinner||(r=n.querySelector(a.spinnerSelector))&&k(r),u!=document.body&&m(u,"nprogress-custom-parent"),u.appendChild(n),n},i.remove=function(){u(document.documentElement,"nprogress-busy"),u(document.querySelector(a.parent),"nprogress-custom-parent");var e=document.getElementById("nprogress");e&&k(e)},i.isRendered=function(){return!!document.getElementById("nprogress")},i.getPositioningCSS=function(){var e=document.body.style,n="WebkitTransform"in e?"Webkit":"MozTransform"in e?"Moz":"msTransform"in e?"ms":"OTransform"in e?"O":"";return n+"Perspective"in e?"translate3d":n+"Transform"in e?"translate":"margin"};var t=function(){var e=[];function n(){var i=e.shift();i&&i(n)}return function(i){e.push(i),1==e.length&&n()}}(),d=function(){var e=["Webkit","O","Moz","ms"],n={};function i(i){return i=i.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(e,n){return n.toUpperCase()})),n[i]||(n[i]=function(n){var i=document.body.style;if(n in i)return n;for(var a,r=e.length,l=n.charAt(0).toUpperCase()+n.slice(1);r--;)if((a=e[r]+l)in i)return a;return n}(i))}function a(e,n,a){n=i(n),e.style[n]=a}return function(e,n){var i,r,l=arguments;if(2==l.length)for(i in n)void 0!==(r=n[i])&&n.hasOwnProperty(i)&&a(e,i,r);else a(e,l[1],l[2])}}();function s(e,n){return("string"==typeof e?e:o(e)).indexOf(" "+n+" ")>=0}function m(e,n){var i=o(e),a=i+n;s(i,n)||(e.className=a.substring(1))}function u(e,n){var i,a=o(e);s(e,n)&&(i=a.replace(" "+n+" "," "),e.className=i.substring(1,i.length-1))}function o(e){return(" "+(e.className||"")+" ").replace(/\s+/gi," ")}function k(e){e&&e.parentNode&&e.parentNode.removeChild(e)}return i})?a.call(n,i,n,e):a)||(e.exports=r)},function(e,n,i){"use strict";var a=i(137),r=i(6),l=i(5),t=i(48),d=i(168),s=i(30),m=i(32),u=i(169),o=i(81),k=i(12),y=TypeError,b=function(e,n){this.stopped=e,this.result=n},c=b.prototype;e.exports=function(e,n,i){var g,p,H,S,h,z,v,K=i&&i.that,f=!(!i||!i.AS_ENTRIES),A=!(!i||!i.IS_RECORD),T=!(!i||!i.IS_ITERATOR),B=!(!i||!i.INTERRUPTED),R=a(n,K),Y=function(e){return g&&k(g,"normal"),new b(!0,e)},P=function(e){return f?(l(e),B?R(e[0],e[1],Y):R(e[0],e[1])):B?R(e,Y):R(e)};if(A)g=e.iterator;else if(T)g=e;else{if(!(p=o(e)))throw new y(t(e)+" is not iterable");if(d(p)){for(H=0,S=s(e);S>H;H++)if((h=P(e[H]))&&m(c,h))return h;return new b(!1)}g=u(e,p)}for(z=A?e.next:g.next;!(v=r(z,g)).done;){try{h=P(v.value)}catch(e){k(g,"throw",e)}if("object"==typeof h&&h&&m(c,h))return h}return new b(!1)}},function(e,n,i){"use strict";var a=i(2),r=i(17),l=i(92),t=i(55);e.exports=function(e,n,i,d){d||(d={});var s=d.enumerable,m=void 0!==d.name?d.name:n;if(a(i)&&l(i,m,d),d.global)s?e[n]=i:t(n,i);else{try{d.unsafe?e[n]&&(s=!0):delete e[n]}catch(e){}s?e[n]=i:r.f(e,n,{value:i,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return e}},function(e,n,i){"use strict";var a=i(52),r=TypeError;e.exports=function(e){if(a(e))throw new r("Can't call method on "+e);return e}},function(e,n,i){"use strict";var a=i(79),r=i(1),l=i(3).String;e.exports=!!Object.getOwnPropertySymbols&&!r((function(){var e=Symbol("symbol detection");return!l(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&a&&a<41}))},function(e,n,i){"use strict";var a=String;e.exports=function(e){try{return a(e)}catch(e){return"Object"}}},function(e,n,i){"use strict";var a=i(4),r=0,l=Math.random(),t=a(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+t(++r+l,36)}},function(e,n,i){"use strict";var a,r,l,t=i(150),d=i(3),s=i(9),m=i(20),u=i(8),o=i(54),k=i(56),y=i(57),b=d.TypeError,c=d.WeakMap;if(t||o.state){var g=o.state||(o.state=new c);g.get=g.get,g.has=g.has,g.set=g.set,a=function(e,n){if(g.has(e))throw new b("Object already initialized");return n.facade=e,g.set(e,n),n},r=function(e){return g.get(e)||{}},l=function(e){return g.has(e)}}else{var p=k("state");y[p]=!0,a=function(e,n){if(u(e,p))throw new b("Object already initialized");return n.facade=e,m(e,p,n),n},r=function(e){return u(e,p)?e[p]:{}},l=function(e){return u(e,p)}}e.exports={set:a,get:r,has:l,enforce:function(e){return l(e)?r(e):a(e,{})},getterFor:function(e){return function(n){var i;if(!s(n)||(i=r(n)).type!==e)throw new b("Incompatible receiver, "+e+" required");return i}}}},function(e,n,i){"use strict";var a=i(36),r=Function.prototype,l=r.apply,t=r.call;e.exports="object"==typeof Reflect&&Reflect.apply||(a?t.bind(l):function(){return t.apply(l,arguments)})},function(e,n,i){"use strict";e.exports=function(e){return null==e}},function(e,n,i){"use strict";var a=i(25),r=i(2),l=i(32),t=i(86),d=Object;e.exports=t?function(e){return"symbol"==typeof e}:function(e){var n=a("Symbol");return r(n)&&l(n.prototype,d(e))}},function(e,n,i){"use strict";var a=i(19),r=i(3),l=i(55),t=e.exports=r["__core-js_shared__"]||l("__core-js_shared__",{});(t.versions||(t.versions=[])).push({version:"3.48.0",mode:a?"pure":"global",copyright:" 20132025 Denis Pushkarev (zloirock.ru), 20252026 CoreJS Company (core-js.io). All rights reserved.",license:"https://github.com/zloirock/core-js/blob/v3.48.0/LICENSE",source:"https://github.com/zloirock/core-js"})},function(e,n,i){"use strict";var a=i(3),r=Object.defineProperty;e.exports=function(e,n){try{r(a,e,{value:n,configurable:!0,writable:!0})}catch(i){a[e]=n}return n}},function(e,n,i){"use strict";var a=i(88),r=i(49),l=a("keys");e.exports=function(e){return l[e]||(l[e]=r(e))}},function(e,n,i){"use strict";e.exports={}},function(e,n,i){"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(e,n,i){var a=i(182),r=i(22),l=Object.prototype,t=l.hasOwnProperty,d=l.propertyIsEnumerable,s=a(function(){return arguments}())?a:function(e){return r(e)&&t.call(e,"callee")&&!d.call(e,"callee")};e.exports=s},function(e,n,i){var a=i(18)(i(14),"Map");e.exports=a},function(e,n){e.exports=function(e){var n=typeof e;return null!=e&&("object"==n||"function"==n)}},function(e,n,i){var a=i(202),r=i(209),l=i(211),t=i(212),d=i(213);function s(e){var n=-1,i=null==e?0:e.length;for(this.clear();++n<i;){var a=e[n];this.set(a[0],a[1])}}s.prototype.clear=a,s.prototype.delete=r,s.prototype.get=l,s.prototype.has=t,s.prototype.set=d,e.exports=s},function(e,n){e.exports=function(e){var n=-1,i=Array(e.size);return e.forEach((function(e){i[++n]=e})),i}},function(e,n){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,n,i){var a=i(13),r=i(66),l=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,t=/^\w*$/;e.exports=function(e,n){if(a(e))return!1;var i=typeof e;return!("number"!=i&&"symbol"!=i&&"boolean"!=i&&null!=e&&!r(e))||(t.test(e)||!l.test(e)||null!=n&&e in Object(n))}},function(e,n,i){var a=i(27),r=i(22);e.exports=function(e){return"symbol"==typeof e||r(e)&&"[object Symbol]"==a(e)}},function(e,n){e.exports=function(e){return e}},function(e,n,i){"use strict";var a=i(155);e.exports=function(e){var n=+e;return n!=n||0===n?0:a(n)}},function(e,n,i){"use strict";var a=i(74),r=String;e.exports=function(e){if("Symbol"===a(e))throw new TypeError("Cannot convert a Symbol value to a string");return r(e)}},function(e,n,i){"use strict";var a=i(10),r=i(6),l=i(44),t=i(11),d=i(5),s=i(23),m=i(12),u=i(26)("some",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(e){d(this);try{t(e)}catch(e){m(this,"throw",e)}if(u)return r(u,this,e);var n=s(this),i=0;return l(n,(function(n,a){if(e(n,i++))return a()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},function(e,n,i){"use strict";var a=i(10),r=i(6),l=i(44),t=i(11),d=i(5),s=i(23),m=i(12),u=i(26)("forEach",TypeError);a({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(e){d(this);try{t(e)}catch(e){m(this,"throw",e)}if(u)return r(u,this,e);var n=s(this),i=0;l(n,(function(n){e(n,i++)}),{IS_RECORD:!0})}})},function(e,n,i){"use strict";var a=i(8),r=i(2),l=i(33),t=i(56),d=i(158),s=t("IE_PROTO"),m=Object,u=m.prototype;e.exports=d?m.getPrototypeOf:function(e){var n=l(e);if(a(n,s))return n[s];var i=n.constructor;return r(i)&&n instanceof i?i.prototype:n instanceof m?u:null}},function(e,n,i){"use strict";var a,r=i(5),l=i(159),t=i(58),d=i(57),s=i(161),m=i(90),u=i(56),o=u("IE_PROTO"),k=function(){},y=function(e){return"<script>"+e+"<\/script>"},b=function(e){e.write(y("")),e.close();var n=e.parentWindow.Object;return e=null,n},c=function(){try{a=new ActiveXObject("htmlfile")}catch(e){}var e,n;c="undefined"!=typeof document?document.domain&&a?b(a):((n=m("iframe")).style.display="none",s.appendChild(n),n.src=String("javascript:"),(e=n.contentWindow.document).open(),e.write(y("document.F=Object")),e.close(),e.F):b(a);for(var i=t.length;i--;)delete c.prototype[t[i]];return c()};d[o]=!0,e.exports=Object.create||function(e,n){var i;return null!==e?(k.prototype=r(e),i=new k,k.prototype=null,i[o]=e):i=c(),void 0===n?i:l.f(i,n)}},function(e,n,i){"use strict";var a=i(170),r=i(2),l=i(21),t=i(15)("toStringTag"),d=Object,s="Arguments"===l(function(){return arguments}());e.exports=a?l:function(e){var n,i,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=function(e,n){try{return e[n]}catch(e){}}(n=d(e),t))?i:s?l(n):"Object"===(a=l(n))&&r(n.callee)?"Arguments":a}},function(e,n,i){"use strict";var a=i(124),r=i(9),l=i(46),t=i(171);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,n=!1,i={};try{(e=a(Object.prototype,"__proto__","set"))(i,[]),n=i instanceof Array}catch(e){}return function(i,a){return l(i),t(a),r(i)?(n?e(i,a):i.__proto__=a,i):i}}():void 0)},function(e,n,i){"use strict";var a=i(8),r=i(151),l=i(84),t=i(17);e.exports=function(e,n,i){for(var d=r(n),s=t.f,m=l.f,u=0;u<d.length;u++){var o=d[u];a(e,o)||i&&a(i,o)||s(e,o,m(n,o))}}},function(e,n,i){"use strict";var a=i(6),r=i(73),l=i(20),t=i(162),d=i(15),s=i(50),m=i(35),u=i(94).IteratorPrototype,o=i(163),k=i(12),y=i(164),b=d("toStringTag"),c=s.set,g=function(e){var n=s.getterFor(e?"WrapForValidIterator":"IteratorHelper");return t(r(u),{next:function(){var i=n(this);if(e)return i.nextHandler();if(i.done)return o(void 0,!0);try{var a=i.nextHandler();return i.returnHandlerResult?a:o(a,i.done)}catch(e){throw i.done=!0,e}},return:function(){var i=n(this),r=i.iterator;if(i.done=!0,e){var l=m(r,"return");return l?a(l,r):o(void 0,!0)}if(i.inner)try{k(i.inner.iterator,"normal")}catch(e){return k(r,"throw",e)}if(i.openIters)try{y(i.openIters,"normal")}catch(e){return k(r,"throw",e)}return r&&k(r,"normal"),o(void 0,!0)}})},p=g(!0),H=g(!1);l(H,b,"Iterator Helper"),e.exports=function(e,n,i){var a=function(a,r){r?(r.iterator=a.iterator,r.next=a.next):r=a,r.type=n?"WrapForValidIterator":"IteratorHelper",r.returnHandlerResult=!!i,r.nextHandler=e,r.counter=0,r.done=!1,c(this,r)};return a.prototype=n?p:H,a}},function(e,n,i){"use strict";var a=i(4),r=i(1),l=i(21),t=Object,d=a("".split);e.exports=r((function(){return!t("z").propertyIsEnumerable(0)}))?function(e){return"String"===l(e)?d(e,""):t(e)}:t},function(e,n,i){"use strict";var a,r,l=i(3),t=i(87),d=l.process,s=l.Deno,m=d&&d.versions||s&&s.version,u=m&&m.v8;u&&(r=(a=u.split("."))[0]>0&&a[0]<4?1:+(a[0]+a[1])),!r&&t&&(!(a=t.match(/Edge\/(\d+)/))||a[1]>=74)&&(a=t.match(/Chrome\/(\d+)/))&&(r=+a[1]),e.exports=r},function(e,n,i){"use strict";e.exports=function(e,n){var i="function"==typeof Iterator&&Iterator.prototype[e];if(i)try{i.call({next:null},n).next()}catch(e){return!0}}},function(e,n,i){"use strict";var a=i(74),r=i(35),l=i(52),t=i(96),d=i(15)("iterator");e.exports=function(e){if(!l(e))return r(e,d)||r(e,"@@iterator")||t[a(e)]}},function(e,n,i){"use strict";var a=i(21);e.exports=Array.isArray||function(e){return"Array"===a(e)}},function(e,n){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,n,i){"use strict";var a=i(7),r=i(6),l=i(146),t=i(34),d=i(37),s=i(85),m=i(8),u=i(89),o=Object.getOwnPropertyDescriptor;n.f=a?o:function(e,n){if(e=d(e),n=s(n),u)try{return o(e,n)}catch(e){}if(m(e,n))return t(!r(l.f,e,n),e[n])}},function(e,n,i){"use strict";var a=i(132),r=i(53);e.exports=function(e){var n=a(e,"string");return r(n)?n:n+""}},function(e,n,i){"use strict";var a=i(47);e.exports=a&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(e,n,i){"use strict";var a=i(3).navigator,r=a&&a.userAgent;e.exports=r?String(r):""},function(e,n,i){"use strict";var a=i(54);e.exports=function(e,n){return a[e]||(a[e]=n||{})}},function(e,n,i){"use strict";var a=i(7),r=i(1),l=i(90);e.exports=!a&&!r((function(){return 7!==Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a}))},function(e,n,i){"use strict";var a=i(3),r=i(9),l=a.document,t=r(l)&&r(l.createElement);e.exports=function(e){return t?l.createElement(e):{}}},function(e,n,i){"use strict";var a=i(7),r=i(1);e.exports=a&&r((function(){return 42!==Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(e,n,i){"use strict";var a=i(4),r=i(1),l=i(2),t=i(8),d=i(7),s=i(148).CONFIGURABLE,m=i(149),u=i(50),o=u.enforce,k=u.get,y=String,b=Object.defineProperty,c=a("".slice),g=a("".replace),p=a([].join),H=d&&!r((function(){return 8!==b((function(){}),"length",{value:8}).length})),S=String(String).split("String"),h=e.exports=function(e,n,i){"Symbol("===c(y(n),0,7)&&(n="["+g(y(n),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(n="get "+n),i&&i.setter&&(n="set "+n),(!t(e,"name")||s&&e.name!==n)&&(d?b(e,"name",{value:n,configurable:!0}):e.name=n),H&&i&&t(i,"arity")&&e.length!==i.arity&&b(e,"length",{value:i.arity});try{i&&t(i,"constructor")&&i.constructor?d&&b(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var a=o(e);return t(a,"source")||(a.source=p(S,"string"==typeof n?n:"")),e};Function.prototype.toString=h((function(){return l(this)&&k(this).source||m(this)}),"toString")},function(e,n,i){"use strict";var a=i(4),r=i(8),l=i(37),t=i(153).indexOf,d=i(57),s=a([].push);e.exports=function(e,n){var i,a=l(e),m=0,u=[];for(i in a)!r(d,i)&&r(a,i)&&s(u,i);for(;n.length>m;)r(a,i=n[m++])&&(~t(u,i)||s(u,i));return u}},function(e,n,i){"use strict";var a,r,l,t=i(1),d=i(2),s=i(9),m=i(73),u=i(72),o=i(45),k=i(15),y=i(19),b=k("iterator"),c=!1;[].keys&&("next"in(l=[].keys())?(r=u(u(l)))!==Object.prototype&&(a=r):c=!0),!s(a)||t((function(){var e={};return a[b].call(e)!==e}))?a={}:y&&(a=m(a)),d(a[b])||o(a,b,(function(){return this})),e.exports={IteratorPrototype:a,BUGGY_SAFARI_ITERATORS:c}},function(e,n,i){"use strict";var a=i(5),r=i(12);e.exports=function(e,n,i,l){try{return l?n(a(i)[0],i[1]):n(i)}catch(n){r(e,"throw",n)}}},function(e,n,i){"use strict";e.exports={}},function(e,n){e.exports=function(e,n){for(var i=-1,a=n.length,r=e.length;++i<a;)e[r+i]=n[i];return e}},function(e,n){var i="object"==typeof global&&global&&global.Object===Object&&global;e.exports=i},function(e,n,i){var a=i(38),r=i(193),l=i(194),t=i(195),d=i(196),s=i(197);function m(e){var n=this.__data__=new a(e);this.size=n.size}m.prototype.clear=r,m.prototype.delete=l,m.prototype.get=t,m.prototype.has=d,m.prototype.set=s,e.exports=m},function(e,n){e.exports=function(e,n){return e===n||e!=e&&n!=n}},function(e,n,i){var a=i(27),r=i(61);e.exports=function(e){if(!r(e))return!1;var n=a(e);return"[object Function]"==n||"[object GeneratorFunction]"==n||"[object AsyncFunction]"==n||"[object Proxy]"==n}},function(e,n){var i=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return i.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,n,i){var a=i(214),r=i(22);e.exports=function e(n,i,l,t,d){return n===i||(null==n||null==i||!r(n)&&!r(i)?n!=n&&i!=i:a(n,i,l,t,e,d))}},function(e,n,i){var a=i(105),r=i(217),l=i(106);e.exports=function(e,n,i,t,d,s){var m=1&i,u=e.length,o=n.length;if(u!=o&&!(m&&o>u))return!1;var k=s.get(e),y=s.get(n);if(k&&y)return k==n&&y==e;var b=-1,c=!0,g=2&i?new a:void 0;for(s.set(e,n),s.set(n,e);++b<u;){var p=e[b],H=n[b];if(t)var S=m?t(H,p,b,n,e,s):t(p,H,b,e,n,s);if(void 0!==S){if(S)continue;c=!1;break}if(g){if(!r(n,(function(e,n){if(!l(g,n)&&(p===e||d(p,e,i,t,s)))return g.push(n)}))){c=!1;break}}else if(p!==H&&!d(p,H,i,t,s)){c=!1;break}}return s.delete(e),s.delete(n),c}},function(e,n,i){var a=i(62),r=i(215),l=i(216);function t(e){var n=-1,i=null==e?0:e.length;for(this.__data__=new a;++n<i;)this.add(e[n])}t.prototype.add=t.prototype.push=r,t.prototype.has=l,e.exports=t},function(e,n){e.exports=function(e,n){return e.has(n)}},function(e,n,i){var a=i(227),r=i(233),l=i(111);e.exports=function(e){return l(e)?a(e):r(e)}},function(e,n,i){(function(e){var a=i(14),r=i(229),l=n&&!n.nodeType&&n,t=l&&"object"==typeof e&&e&&!e.nodeType&&e,d=t&&t.exports===l?a.Buffer:void 0,s=(d?d.isBuffer:void 0)||r;e.exports=s}).call(this,i(83)(e))},function(e,n){var i=/^(?:0|[1-9]\d*)$/;e.exports=function(e,n){var a=typeof e;return!!(n=null==n?9007199254740991:n)&&("number"==a||"symbol"!=a&&i.test(e))&&e>-1&&e%1==0&&e<n}},function(e,n,i){var a=i(230),r=i(231),l=i(232),t=l&&l.isTypedArray,d=t?r(t):a;e.exports=d},function(e,n,i){var a=i(101),r=i(64);e.exports=function(e){return null!=e&&r(e.length)&&!a(e)}},function(e,n,i){var a=i(18)(i(14),"Set");e.exports=a},function(e,n,i){var a=i(61);e.exports=function(e){return e==e&&!a(e)}},function(e,n){e.exports=function(e,n){return function(i){return null!=i&&(i[e]===n&&(void 0!==n||e in Object(i)))}}},function(e,n,i){var a=i(116),r=i(42);e.exports=function(e,n){for(var i=0,l=(n=a(n,e)).length;null!=e&&i<l;)e=e[r(n[i++])];return i&&i==l?e:void 0}},function(e,n,i){var a=i(13),r=i(65),l=i(243),t=i(246);e.exports=function(e,n){return a(e)?e:r(e,n)?[e]:l(t(e))}},function(e,n,i){},function(e,n,i){},function(e,n,i){var a=i(180),r=i(185),l=i(255),t=i(263),d=i(272),s=i(143),m=l((function(e){var n=s(e);return d(n)&&(n=void 0),t(a(e,1,d,!0),r(n,2))}));e.exports=m},function(e,n,i){"use strict";
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */var a=/["'&<>]/;e.exports=function(e){var n,i=""+e,r=a.exec(i);if(!r)return i;var l="",t=0,d=0;for(t=r.index;t<i.length;t++){switch(i.charCodeAt(t)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}d!==t&&(l+=i.substring(d,t)),d=t+1,l+=n}return d!==t?l+i.substring(d,t):l}},function(e,n){var i=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,r=/^0b[01]+$/i,l=/^0o[0-7]+$/i,t=parseInt,d="object"==typeof global&&global&&global.Object===Object&&global,s="object"==typeof self&&self&&self.Object===Object&&self,m=d||s||Function("return this")(),u=Object.prototype.toString,o=Math.max,k=Math.min,y=function(){return m.Date.now()};function b(e){var n=typeof e;return!!e&&("object"==n||"function"==n)}function c(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(b(e)){var n="function"==typeof e.valueOf?e.valueOf():e;e=b(n)?n+"":n}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(i,"");var d=r.test(e);return d||l.test(e)?t(e.slice(2),d?2:8):a.test(e)?NaN:+e}e.exports=function(e,n,i){var a,r,l,t,d,s,m=0,u=!1,g=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function H(n){var i=a,l=r;return a=r=void 0,m=n,t=e.apply(l,i)}function S(e){return m=e,d=setTimeout(z,n),u?H(e):t}function h(e){var i=e-s;return void 0===s||i>=n||i<0||g&&e-m>=l}function z(){var e=y();if(h(e))return v(e);d=setTimeout(z,function(e){var i=n-(e-s);return g?k(i,l-(e-m)):i}(e))}function v(e){return d=void 0,p&&a?H(e):(a=r=void 0,t)}function K(){var e=y(),i=h(e);if(a=arguments,r=this,s=e,i){if(void 0===d)return S(s);if(g)return d=setTimeout(z,n),H(s)}return void 0===d&&(d=setTimeout(z,n)),t}return n=c(n)||0,b(i)&&(u=!!i.leading,l=(g="maxWait"in i)?o(c(i.maxWait)||0,n):l,p="trailing"in i?!!i.trailing:p),K.cancel=function(){void 0!==d&&clearTimeout(d),m=0,a=s=r=d=void 0},K.flush=function(){return void 0===d?t:v(y())},K}},function(e,n,i){"use strict";var a=i(92),r=i(17);e.exports=function(e,n,i){return i.get&&a(i.get,n,{getter:!0}),i.set&&a(i.set,n,{setter:!0}),r.f(e,n,i)}},function(e,n,i){"use strict";var a=i(10),r=i(33),l=i(30),t=i(175),d=i(176);a({target:"Array",proto:!0,arity:1,forced:i(1)((function(){return 4294967297!==[].push.call({length:4294967296},1)}))||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var n=r(this),i=l(n),a=arguments.length;d(i+a);for(var s=0;s<a;s++)n[i]=arguments[s],i++;return t(n,i),i}})},function(e,n,i){"use strict";var a=i(4),r=i(11);e.exports=function(e,n,i){try{return a(r(Object.getOwnPropertyDescriptor(e,n)[i]))}catch(e){}}},function(e,n,i){"use strict";var a=i(69);e.exports=function(e,n){return void 0===e?arguments.length<2?"":n:a(e)}},function(e,n,i){"use strict";var a=i(10),r=i(25),l=i(51),t=i(6),d=i(4),s=i(1),m=i(82),u=i(2),o=i(177),k=i(53),y=i(21),b=i(69),c=i(178),g=i(142),p=i(49),H=i(47),S=i(179),h=String,z=r("JSON","stringify"),v=d(/./.exec),K=d("".charAt),f=d("".charCodeAt),A=d("".replace),T=d("".slice),B=d([].push),R=d(1.1.toString),Y=/[\uD800-\uDFFF]/g,P=/^[\uD800-\uDBFF]$/,N=/^[\uDC00-\uDFFF]$/,O=p(),D=O.length,I=!H||s((function(){var e=r("Symbol")("stringify detection");return"[null]"!==z([e])||"{}"!==z({a:e})||"{}"!==z(Object(e))})),E=s((function(){return'"\\udf06\\ud834"'!==z("\udf06\ud834")||'"\\udead"'!==z("\udead")})),Z=I?function(e,n){var i=c(arguments),a=C(n);if(u(a)||void 0!==e&&!k(e))return i[1]=function(e,n){if(u(a)&&(n=t(a,this,h(e),n)),!k(n))return n},l(z,null,i)}:z,G=function(e,n,i){var a=K(i,n-1),r=K(i,n+1);return v(P,e)&&!v(N,r)||v(N,e)&&!v(P,a)?"\\u"+R(f(e,0),16):e},C=function(e){if(u(e))return e;if(m(e)){for(var n=e.length,i=[],a=0;a<n;a++){var r=e[a];"string"==typeof r?B(i,r):"number"!=typeof r&&"Number"!==y(r)&&"String"!==y(r)||B(i,b(r))}var l=i.length,t=!0;return function(e,n){if(t)return t=!1,n;if(m(this))return n;for(var a=0;a<l;a++)if(i[a]===e)return n}}};z&&a({target:"JSON",stat:!0,arity:3,forced:I||E||!S},{stringify:function(e,n,i){var a=C(n),r=[],l=Z(e,(function(e,n){var i=u(a)?t(a,this,h(e),n):n;return!S&&o(i)?O+(B(r,i.rawJSON)-1):i}),i);if("string"!=typeof l)return l;if(E&&(l=A(l,Y,G)),S)return l;for(var d="",s=l.length,m=0;m<s;m++){var k=K(l,m);if('"'===k){var y=g(l,++m).end-1,b=T(l,m,y);d+=T(b,0,D)===O?r[T(b,D)]:'"'+b+'"',m=y}else d+=k}return d}})},function(e,n,i){"use strict";var a=i(7),r=i(17),l=i(34);e.exports=function(e,n,i){a?r.f(e,n,l(0,i)):e[n]=i}},function(e,n,i){"use strict";var a=i(10),r=i(165).left,l=i(166),t=i(79);a({target:"Array",proto:!0,forced:!i(135)&&t>79&&t<83||!l("reduce")},{reduce:function(e){var n=arguments.length;return r(this,e,n,n>1?arguments[1]:void 0)}})},function(e,n,i){"use strict";var a=i(10),r=i(44),l=i(11),t=i(5),d=i(23),s=i(12),m=i(26),u=i(51),o=i(1),k=TypeError,y=o((function(){[].keys().reduce((function(){}),void 0)})),b=!y&&m("reduce",k);a({target:"Iterator",proto:!0,real:!0,forced:y||b},{reduce:function(e){t(this);try{l(e)}catch(e){s(this,"throw",e)}var n=arguments.length<2,i=n?void 0:arguments[1];if(b)return u(b,this,n?[e]:[e,i]);var a=d(this),m=0;if(r(a,(function(a){n?(n=!1,i=a):i=e(i,a,m),m++}),{IS_RECORD:!0}),n)throw new k("Reduce of empty iterator with no initial value");return i}})},function(e,n,i){"use strict";var a=i(10),r=i(3),l=i(51),t=i(138),d=r.WebAssembly,s=7!==new Error("e",{cause:7}).cause,m=function(e,n){var i={};i[e]=t(e,n,s),a({global:!0,constructor:!0,arity:1,forced:s},i)},u=function(e,n){if(d&&d[e]){var i={};i[e]=t("WebAssembly."+e,n,s),a({target:"WebAssembly",stat:!0,constructor:!0,arity:1,forced:s},i)}};m("Error",(function(e){return function(n){return l(e,this,arguments)}})),m("EvalError",(function(e){return function(n){return l(e,this,arguments)}})),m("RangeError",(function(e){return function(n){return l(e,this,arguments)}})),m("ReferenceError",(function(e){return function(n){return l(e,this,arguments)}})),m("SyntaxError",(function(e){return function(n){return l(e,this,arguments)}})),m("TypeError",(function(e){return function(n){return l(e,this,arguments)}})),m("URIError",(function(e){return function(n){return l(e,this,arguments)}})),u("CompileError",(function(e){return function(n){return l(e,this,arguments)}})),u("LinkError",(function(e){return function(n){return l(e,this,arguments)}})),u("RuntimeError",(function(e){return function(n){return l(e,this,arguments)}}))},function(e,n,i){"use strict";var a=i(20),r=i(141),l=i(174),t=Error.captureStackTrace;e.exports=function(e,n,i,d){l&&(t?t(e,n):a(e,"stack",r(i,d)))}},function(e,n,i){"use strict";var a=i(6),r=i(9),l=i(53),t=i(35),d=i(147),s=i(15),m=TypeError,u=s("toPrimitive");e.exports=function(e,n){if(!r(e)||l(e))return e;var i,s=t(e,u);if(s){if(void 0===n&&(n="default"),i=a(s,e,n),!r(i)||l(i))return i;throw new m("Can't convert object to primitive value")}return void 0===n&&(n="number"),d(e,n)}},function(e,n,i){"use strict";var a=i(68),r=Math.min;e.exports=function(e){var n=a(e);return n>0?r(n,9007199254740991):0}},function(e,n,i){"use strict";var a=i(32),r=TypeError;e.exports=function(e,n){if(a(n,e))return e;throw new r("Incorrect invocation")}},function(e,n,i){"use strict";var a=i(136);e.exports="NODE"===a},function(e,n,i){"use strict";var a=i(3),r=i(87),l=i(21),t=function(e){return r.slice(0,e.length)===e};e.exports=t("Bun/")?"BUN":t("Cloudflare-Workers")?"CLOUDFLARE":t("Deno/")?"DENO":t("Node.js/")?"NODE":a.Bun&&"string"==typeof Bun.version?"BUN":a.Deno&&"object"==typeof Deno.version?"DENO":"process"===l(a.process)?"NODE":a.window&&a.document?"BROWSER":"REST"},function(e,n,i){"use strict";var a=i(167),r=i(11),l=i(36),t=a(a.bind);e.exports=function(e,n){return r(e),void 0===n?e:l?t(e,n):function(){return e.apply(n,arguments)}}},function(e,n,i){"use strict";var a=i(25),r=i(8),l=i(20),t=i(32),d=i(75),s=i(76),m=i(173),u=i(139),o=i(125),k=i(140),y=i(131),b=i(7),c=i(19);e.exports=function(e,n,i,g){var p=g?2:1,H=e.split("."),S=H[H.length-1],h=a.apply(null,H);if(h){var z=h.prototype;if(!c&&r(z,"cause")&&delete z.cause,!i)return h;var v=a("Error"),K=n((function(e,n){var i=o(g?n:e,void 0),a=g?new h(e):new h;return void 0!==i&&l(a,"message",i),y(a,K,a.stack,2),this&&t(z,this)&&u(a,this,K),arguments.length>p&&k(a,arguments[p]),a}));if(K.prototype=z,"Error"!==S?d?d(K,v):s(K,v,{name:!0}):b&&"stackTraceLimit"in h&&(m(K,h,"stackTraceLimit"),m(K,h,"prepareStackTrace")),s(K,h),!c)try{z.name!==S&&l(z,"name",S),z.constructor=K}catch(e){}return K}}},function(e,n,i){"use strict";var a=i(2),r=i(9),l=i(75);e.exports=function(e,n,i){var t,d;return l&&a(t=n.constructor)&&t!==i&&r(d=t.prototype)&&d!==i.prototype&&l(e,d),e}},function(e,n,i){"use strict";var a=i(9),r=i(20);e.exports=function(e,n){a(n)&&"cause"in n&&r(e,"cause",n.cause)}},function(e,n,i){"use strict";var a=i(4),r=Error,l=a("".replace),t=String(new r("zxcasd").stack),d=/\n\s*at [^:]*:[^\n]*/,s=d.test(t);e.exports=function(e,n){if(s&&"string"==typeof e&&!r.prepareStackTrace)for(;n--;)e=l(e,d,"");return e}},function(e,n,i){"use strict";var a=i(4),r=i(8),l=SyntaxError,t=parseInt,d=String.fromCharCode,s=a("".charAt),m=a("".slice),u=a(/./.exec),o={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":"\n","\\r":"\r","\\t":"\t"},k=/^[\da-f]{4}$/i,y=/^[\u0000-\u001F]$/;e.exports=function(e,n){for(var i=!0,a="";n<e.length;){var b=s(e,n);if("\\"===b){var c=m(e,n,n+2);if(r(o,c))a+=o[c],n+=2;else{if("\\u"!==c)throw new l('Unknown escape sequence: "'+c+'"');var g=m(e,n+=2,n+4);if(!u(k,g))throw new l("Bad Unicode escape at: "+n);a+=d(t(g,16)),n+=4}}else{if('"'===b){i=!1,n++;break}if(u(y,b))throw new l("Bad control character in string literal at: "+n);a+=b,n++}}if(i)throw new l("Unterminated string at: "+n);return{value:a,end:n}}},function(e,n){e.exports=function(e){var n=null==e?0:e.length;return n?e[n-1]:void 0}},function(e,n,i){var a=i(115);e.exports=function(e,n,i){var r=null==e?void 0:a(e,n);return void 0===r?i:r}},function(e,n,i){e.exports=i(277)},function(e,n,i){"use strict";var a={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor,l=r&&!a.call({1:2},1);n.f=l?function(e){var n=r(this,e);return!!n&&n.enumerable}:a},function(e,n,i){"use strict";var a=i(6),r=i(2),l=i(9),t=TypeError;e.exports=function(e,n){var i,d;if("string"===n&&r(i=e.toString)&&!l(d=a(i,e)))return d;if(r(i=e.valueOf)&&!l(d=a(i,e)))return d;if("string"!==n&&r(i=e.toString)&&!l(d=a(i,e)))return d;throw new t("Can't convert object to primitive value")}},function(e,n,i){"use strict";var a=i(7),r=i(8),l=Function.prototype,t=a&&Object.getOwnPropertyDescriptor,d=r(l,"name"),s=d&&"something"===function(){}.name,m=d&&(!a||a&&t(l,"name").configurable);e.exports={EXISTS:d,PROPER:s,CONFIGURABLE:m}},function(e,n,i){"use strict";var a=i(4),r=i(2),l=i(54),t=a(Function.toString);r(l.inspectSource)||(l.inspectSource=function(e){return t(e)}),e.exports=l.inspectSource},function(e,n,i){"use strict";var a=i(3),r=i(2),l=a.WeakMap;e.exports=r(l)&&/native code/.test(String(l))},function(e,n,i){"use strict";var a=i(25),r=i(4),l=i(152),t=i(156),d=i(5),s=r([].concat);e.exports=a("Reflect","ownKeys")||function(e){var n=l.f(d(e)),i=t.f;return i?s(n,i(e)):n}},function(e,n,i){"use strict";var a=i(93),r=i(58).concat("length","prototype");n.f=Object.getOwnPropertyNames||function(e){return a(e,r)}},function(e,n,i){"use strict";var a=i(37),r=i(154),l=i(30),t=function(e){return function(n,i,t){var d=a(n),s=l(d);if(0===s)return!e&&-1;var m,u=r(t,s);if(e&&i!=i){for(;s>u;)if((m=d[u++])!=m)return!0}else for(;s>u;u++)if((e||u in d)&&d[u]===i)return e||u||0;return!e&&-1}};e.exports={includes:t(!0),indexOf:t(!1)}},function(e,n,i){"use strict";var a=i(68),r=Math.max,l=Math.min;e.exports=function(e,n){var i=a(e);return i<0?r(i+n,0):l(i,n)}},function(e,n,i){"use strict";var a=Math.ceil,r=Math.floor;e.exports=Math.trunc||function(e){var n=+e;return(n>0?r:a)(n)}},function(e,n,i){"use strict";n.f=Object.getOwnPropertySymbols},function(e,n,i){"use strict";var a=i(1),r=i(2),l=/#|\.prototype\./,t=function(e,n){var i=s[d(e)];return i===u||i!==m&&(r(n)?a(n):!!n)},d=t.normalize=function(e){return String(e).replace(l,".").toLowerCase()},s=t.data={},m=t.NATIVE="N",u=t.POLYFILL="P";e.exports=t},function(e,n,i){"use strict";var a=i(1);e.exports=!a((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},function(e,n,i){"use strict";var a=i(7),r=i(91),l=i(17),t=i(5),d=i(37),s=i(160);n.f=a&&!r?Object.defineProperties:function(e,n){t(e);for(var i,a=d(n),r=s(n),m=r.length,u=0;m>u;)l.f(e,i=r[u++],a[i]);return e}},function(e,n,i){"use strict";var a=i(93),r=i(58);e.exports=Object.keys||function(e){return a(e,r)}},function(e,n,i){"use strict";var a=i(25);e.exports=a("document","documentElement")},function(e,n,i){"use strict";var a=i(45);e.exports=function(e,n,i){for(var r in n)a(e,r,n[r],i);return e}},function(e,n,i){"use strict";e.exports=function(e,n){return{value:e,done:n}}},function(e,n,i){"use strict";var a=i(12);e.exports=function(e,n,i){for(var r=e.length-1;r>=0;r--)if(void 0!==e[r])try{i=a(e[r].iterator,n,i)}catch(e){n="throw",i=e}if("throw"===n)throw i;return i}},function(e,n,i){"use strict";var a=i(11),r=i(33),l=i(78),t=i(30),d=TypeError,s="Reduce of empty array with no initial value",m=function(e){return function(n,i,m,u){var o=r(n),k=l(o),y=t(o);if(a(i),0===y&&m<2)throw new d(s);var b=e?y-1:0,c=e?-1:1;if(m<2)for(;;){if(b in k){u=k[b],b+=c;break}if(b+=c,e?b<0:y<=b)throw new d(s)}for(;e?b>=0:y>b;b+=c)b in k&&(u=i(u,k[b],b,o));return u}};e.exports={left:m(!1),right:m(!0)}},function(e,n,i){"use strict";var a=i(1);e.exports=function(e,n){var i=[][e];return!!i&&a((function(){i.call(null,n||function(){return 1},1)}))}},function(e,n,i){"use strict";var a=i(21),r=i(4);e.exports=function(e){if("Function"===a(e))return r(e)}},function(e,n,i){"use strict";var a=i(15),r=i(96),l=a("iterator"),t=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||t[l]===e)}},function(e,n,i){"use strict";var a=i(6),r=i(11),l=i(5),t=i(48),d=i(81),s=TypeError;e.exports=function(e,n){var i=arguments.length<2?d(e):n;if(r(i))return l(a(i,e));throw new s(t(e)+" is not iterable")}},function(e,n,i){"use strict";var a={};a[i(15)("toStringTag")]="z",e.exports="[object z]"===String(a)},function(e,n,i){"use strict";var a=i(172),r=String,l=TypeError;e.exports=function(e){if(a(e))return e;throw new l("Can't set "+r(e)+" as a prototype")}},function(e,n,i){"use strict";var a=i(9);e.exports=function(e){return a(e)||null===e}},function(e,n,i){"use strict";var a=i(17).f;e.exports=function(e,n,i){i in e||a(e,i,{configurable:!0,get:function(){return n[i]},set:function(e){n[i]=e}})}},function(e,n,i){"use strict";var a=i(1),r=i(34);e.exports=!a((function(){var e=new Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",r(1,7)),7!==e.stack)}))},function(e,n,i){"use strict";var a=i(7),r=i(82),l=TypeError,t=Object.getOwnPropertyDescriptor,d=a&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=d?function(e,n){if(r(e)&&!t(e,"length").writable)throw new l("Cannot set read only .length");return e.length=n}:function(e,n){return e.length=n}},function(e,n,i){"use strict";var a=TypeError;e.exports=function(e){if(e>9007199254740991)throw a("Maximum allowed index exceeded");return e}},function(e,n,i){"use strict";var a=i(9),r=i(50).get;e.exports=function(e){if(!a(e))return!1;var n=r(e);return!!n&&"RawJSON"===n.type}},function(e,n,i){"use strict";var a=i(4);e.exports=a([].slice)},function(e,n,i){"use strict";var a=i(1);e.exports=!a((function(){var e=JSON.rawJSON("9007199254740993");return!JSON.isRawJSON(e)||"9007199254740993"!==JSON.stringify(e)}))},function(e,n,i){var a=i(97),r=i(181);e.exports=function e(n,i,l,t,d){var s=-1,m=n.length;for(l||(l=r),d||(d=[]);++s<m;){var u=n[s];i>0&&l(u)?i>1?e(u,i-1,l,t,d):a(d,u):t||(d[d.length]=u)}return d}},function(e,n,i){var a=i(28),r=i(59),l=i(13),t=a?a.isConcatSpreadable:void 0;e.exports=function(e){return l(e)||r(e)||!!(t&&e&&e[t])}},function(e,n,i){var a=i(27),r=i(22);e.exports=function(e){return r(e)&&"[object Arguments]"==a(e)}},function(e,n,i){var a=i(28),r=Object.prototype,l=r.hasOwnProperty,t=r.toString,d=a?a.toStringTag:void 0;e.exports=function(e){var n=l.call(e,d),i=e[d];try{e[d]=void 0;var a=!0}catch(e){}var r=t.call(e);return a&&(n?e[d]=i:delete e[d]),r}},function(e,n){var i=Object.prototype.toString;e.exports=function(e){return i.call(e)}},function(e,n,i){var a=i(186),r=i(242),l=i(67),t=i(13),d=i(252);e.exports=function(e){return"function"==typeof e?e:null==e?l:"object"==typeof e?t(e)?r(e[0],e[1]):a(e):d(e)}},function(e,n,i){var a=i(187),r=i(241),l=i(114);e.exports=function(e){var n=r(e);return 1==n.length&&n[0][2]?l(n[0][0],n[0][1]):function(i){return i===e||a(i,e,n)}}},function(e,n,i){var a=i(99),r=i(103);e.exports=function(e,n,i,l){var t=i.length,d=t,s=!l;if(null==e)return!d;for(e=Object(e);t--;){var m=i[t];if(s&&m[2]?m[1]!==e[m[0]]:!(m[0]in e))return!1}for(;++t<d;){var u=(m=i[t])[0],o=e[u],k=m[1];if(s&&m[2]){if(void 0===o&&!(u in e))return!1}else{var y=new a;if(l)var b=l(o,k,u,e,n,y);if(!(void 0===b?r(k,o,3,l,y):b))return!1}}return!0}},function(e,n){e.exports=function(){this.__data__=[],this.size=0}},function(e,n,i){var a=i(39),r=Array.prototype.splice;e.exports=function(e){var n=this.__data__,i=a(n,e);return!(i<0)&&(i==n.length-1?n.pop():r.call(n,i,1),--this.size,!0)}},function(e,n,i){var a=i(39);e.exports=function(e){var n=this.__data__,i=a(n,e);return i<0?void 0:n[i][1]}},function(e,n,i){var a=i(39);e.exports=function(e){return a(this.__data__,e)>-1}},function(e,n,i){var a=i(39);e.exports=function(e,n){var i=this.__data__,r=a(i,e);return r<0?(++this.size,i.push([e,n])):i[r][1]=n,this}},function(e,n,i){var a=i(38);e.exports=function(){this.__data__=new a,this.size=0}},function(e,n){e.exports=function(e){var n=this.__data__,i=n.delete(e);return this.size=n.size,i}},function(e,n){e.exports=function(e){return this.__data__.get(e)}},function(e,n){e.exports=function(e){return this.__data__.has(e)}},function(e,n,i){var a=i(38),r=i(60),l=i(62);e.exports=function(e,n){var i=this.__data__;if(i instanceof a){var t=i.__data__;if(!r||t.length<199)return t.push([e,n]),this.size=++i.size,this;i=this.__data__=new l(t)}return i.set(e,n),this.size=i.size,this}},function(e,n,i){var a=i(101),r=i(199),l=i(61),t=i(102),d=/^\[object .+?Constructor\]$/,s=Function.prototype,m=Object.prototype,u=s.toString,o=m.hasOwnProperty,k=RegExp("^"+u.call(o).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!l(e)||r(e))&&(a(e)?k:d).test(t(e))}},function(e,n,i){var a,r=i(200),l=(a=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1."+a:"";e.exports=function(e){return!!l&&l in e}},function(e,n,i){var a=i(14)["__core-js_shared__"];e.exports=a},function(e,n){e.exports=function(e,n){return null==e?void 0:e[n]}},function(e,n,i){var a=i(203),r=i(38),l=i(60);e.exports=function(){this.size=0,this.__data__={hash:new a,map:new(l||r),string:new a}}},function(e,n,i){var a=i(204),r=i(205),l=i(206),t=i(207),d=i(208);function s(e){var n=-1,i=null==e?0:e.length;for(this.clear();++n<i;){var a=e[n];this.set(a[0],a[1])}}s.prototype.clear=a,s.prototype.delete=r,s.prototype.get=l,s.prototype.has=t,s.prototype.set=d,e.exports=s},function(e,n,i){var a=i(40);e.exports=function(){this.__data__=a?a(null):{},this.size=0}},function(e,n){e.exports=function(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}},function(e,n,i){var a=i(40),r=Object.prototype.hasOwnProperty;e.exports=function(e){var n=this.__data__;if(a){var i=n[e];return"__lodash_hash_undefined__"===i?void 0:i}return r.call(n,e)?n[e]:void 0}},function(e,n,i){var a=i(40),r=Object.prototype.hasOwnProperty;e.exports=function(e){var n=this.__data__;return a?void 0!==n[e]:r.call(n,e)}},function(e,n,i){var a=i(40);e.exports=function(e,n){var i=this.__data__;return this.size+=this.has(e)?0:1,i[e]=a&&void 0===n?"__lodash_hash_undefined__":n,this}},function(e,n,i){var a=i(41);e.exports=function(e){var n=a(this,e).delete(e);return this.size-=n?1:0,n}},function(e,n){e.exports=function(e){var n=typeof e;return"string"==n||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==e:null===e}},function(e,n,i){var a=i(41);e.exports=function(e){return a(this,e).get(e)}},function(e,n,i){var a=i(41);e.exports=function(e){return a(this,e).has(e)}},function(e,n,i){var a=i(41);e.exports=function(e,n){var i=a(this,e),r=i.size;return i.set(e,n),this.size+=i.size==r?0:1,this}},function(e,n,i){var a=i(99),r=i(104),l=i(218),t=i(221),d=i(237),s=i(13),m=i(108),u=i(110),o="[object Object]",k=Object.prototype.hasOwnProperty;e.exports=function(e,n,i,y,b,c){var g=s(e),p=s(n),H=g?"[object Array]":d(e),S=p?"[object Array]":d(n),h=(H="[object Arguments]"==H?o:H)==o,z=(S="[object Arguments]"==S?o:S)==o,v=H==S;if(v&&m(e)){if(!m(n))return!1;g=!0,h=!1}if(v&&!h)return c||(c=new a),g||u(e)?r(e,n,i,y,b,c):l(e,n,H,i,y,b,c);if(!(1&i)){var K=h&&k.call(e,"__wrapped__"),f=z&&k.call(n,"__wrapped__");if(K||f){var A=K?e.value():e,T=f?n.value():n;return c||(c=new a),b(A,T,i,y,c)}}return!!v&&(c||(c=new a),t(e,n,i,y,b,c))}},function(e,n){e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},function(e,n){e.exports=function(e){return this.__data__.has(e)}},function(e,n){e.exports=function(e,n){for(var i=-1,a=null==e?0:e.length;++i<a;)if(n(e[i],i,e))return!0;return!1}},function(e,n,i){var a=i(28),r=i(219),l=i(100),t=i(104),d=i(220),s=i(63),m=a?a.prototype:void 0,u=m?m.valueOf:void 0;e.exports=function(e,n,i,a,m,o,k){switch(i){case"[object DataView]":if(e.byteLength!=n.byteLength||e.byteOffset!=n.byteOffset)return!1;e=e.buffer,n=n.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=n.byteLength||!o(new r(e),new r(n)));case"[object Boolean]":case"[object Date]":case"[object Number]":return l(+e,+n);case"[object Error]":return e.name==n.name&&e.message==n.message;case"[object RegExp]":case"[object String]":return e==n+"";case"[object Map]":var y=d;case"[object Set]":var b=1&a;if(y||(y=s),e.size!=n.size&&!b)return!1;var c=k.get(e);if(c)return c==n;a|=2,k.set(e,n);var g=t(y(e),y(n),a,m,o,k);return k.delete(e),g;case"[object Symbol]":if(u)return u.call(e)==u.call(n)}return!1}},function(e,n,i){var a=i(14).Uint8Array;e.exports=a},function(e,n){e.exports=function(e){var n=-1,i=Array(e.size);return e.forEach((function(e,a){i[++n]=[a,e]})),i}},function(e,n,i){var a=i(222),r=Object.prototype.hasOwnProperty;e.exports=function(e,n,i,l,t,d){var s=1&i,m=a(e),u=m.length;if(u!=a(n).length&&!s)return!1;for(var o=u;o--;){var k=m[o];if(!(s?k in n:r.call(n,k)))return!1}var y=d.get(e),b=d.get(n);if(y&&b)return y==n&&b==e;var c=!0;d.set(e,n),d.set(n,e);for(var g=s;++o<u;){var p=e[k=m[o]],H=n[k];if(l)var S=s?l(H,p,k,n,e,d):l(p,H,k,e,n,d);if(!(void 0===S?p===H||t(p,H,i,l,d):S)){c=!1;break}g||(g="constructor"==k)}if(c&&!g){var h=e.constructor,z=n.constructor;h==z||!("constructor"in e)||!("constructor"in n)||"function"==typeof h&&h instanceof h&&"function"==typeof z&&z instanceof z||(c=!1)}return d.delete(e),d.delete(n),c}},function(e,n,i){var a=i(223),r=i(224),l=i(107);e.exports=function(e){return a(e,l,r)}},function(e,n,i){var a=i(97),r=i(13);e.exports=function(e,n,i){var l=n(e);return r(e)?l:a(l,i(e))}},function(e,n,i){var a=i(225),r=i(226),l=Object.prototype.propertyIsEnumerable,t=Object.getOwnPropertySymbols,d=t?function(e){return null==e?[]:(e=Object(e),a(t(e),(function(n){return l.call(e,n)})))}:r;e.exports=d},function(e,n){e.exports=function(e,n){for(var i=-1,a=null==e?0:e.length,r=0,l=[];++i<a;){var t=e[i];n(t,i,e)&&(l[r++]=t)}return l}},function(e,n){e.exports=function(){return[]}},function(e,n,i){var a=i(228),r=i(59),l=i(13),t=i(108),d=i(109),s=i(110),m=Object.prototype.hasOwnProperty;e.exports=function(e,n){var i=l(e),u=!i&&r(e),o=!i&&!u&&t(e),k=!i&&!u&&!o&&s(e),y=i||u||o||k,b=y?a(e.length,String):[],c=b.length;for(var g in e)!n&&!m.call(e,g)||y&&("length"==g||o&&("offset"==g||"parent"==g)||k&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||d(g,c))||b.push(g);return b}},function(e,n){e.exports=function(e,n){for(var i=-1,a=Array(e);++i<e;)a[i]=n(i);return a}},function(e,n){e.exports=function(){return!1}},function(e,n,i){var a=i(27),r=i(64),l=i(22),t={};t["[object Float32Array]"]=t["[object Float64Array]"]=t["[object Int8Array]"]=t["[object Int16Array]"]=t["[object Int32Array]"]=t["[object Uint8Array]"]=t["[object Uint8ClampedArray]"]=t["[object Uint16Array]"]=t["[object Uint32Array]"]=!0,t["[object Arguments]"]=t["[object Array]"]=t["[object ArrayBuffer]"]=t["[object Boolean]"]=t["[object DataView]"]=t["[object Date]"]=t["[object Error]"]=t["[object Function]"]=t["[object Map]"]=t["[object Number]"]=t["[object Object]"]=t["[object RegExp]"]=t["[object Set]"]=t["[object String]"]=t["[object WeakMap]"]=!1,e.exports=function(e){return l(e)&&r(e.length)&&!!t[a(e)]}},function(e,n){e.exports=function(e){return function(n){return e(n)}}},function(e,n,i){(function(e){var a=i(98),r=n&&!n.nodeType&&n,l=r&&"object"==typeof e&&e&&!e.nodeType&&e,t=l&&l.exports===r&&a.process,d=function(){try{var e=l&&l.require&&l.require("util").types;return e||t&&t.binding&&t.binding("util")}catch(e){}}();e.exports=d}).call(this,i(83)(e))},function(e,n,i){var a=i(234),r=i(235),l=Object.prototype.hasOwnProperty;e.exports=function(e){if(!a(e))return r(e);var n=[];for(var i in Object(e))l.call(e,i)&&"constructor"!=i&&n.push(i);return n}},function(e,n){var i=Object.prototype;e.exports=function(e){var n=e&&e.constructor;return e===("function"==typeof n&&n.prototype||i)}},function(e,n,i){var a=i(236)(Object.keys,Object);e.exports=a},function(e,n){e.exports=function(e,n){return function(i){return e(n(i))}}},function(e,n,i){var a=i(238),r=i(60),l=i(239),t=i(112),d=i(240),s=i(27),m=i(102),u=m(a),o=m(r),k=m(l),y=m(t),b=m(d),c=s;(a&&"[object DataView]"!=c(new a(new ArrayBuffer(1)))||r&&"[object Map]"!=c(new r)||l&&"[object Promise]"!=c(l.resolve())||t&&"[object Set]"!=c(new t)||d&&"[object WeakMap]"!=c(new d))&&(c=function(e){var n=s(e),i="[object Object]"==n?e.constructor:void 0,a=i?m(i):"";if(a)switch(a){case u:return"[object DataView]";case o:return"[object Map]";case k:return"[object Promise]";case y:return"[object Set]";case b:return"[object WeakMap]"}return n}),e.exports=c},function(e,n,i){var a=i(18)(i(14),"DataView");e.exports=a},function(e,n,i){var a=i(18)(i(14),"Promise");e.exports=a},function(e,n,i){var a=i(18)(i(14),"WeakMap");e.exports=a},function(e,n,i){var a=i(113),r=i(107);e.exports=function(e){for(var n=r(e),i=n.length;i--;){var l=n[i],t=e[l];n[i]=[l,t,a(t)]}return n}},function(e,n,i){var a=i(103),r=i(144),l=i(249),t=i(65),d=i(113),s=i(114),m=i(42);e.exports=function(e,n){return t(e)&&d(n)?s(m(e),n):function(i){var t=r(i,e);return void 0===t&&t===n?l(i,e):a(n,t,3)}}},function(e,n,i){var a=i(244),r=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,l=/\\(\\)?/g,t=a((function(e){var n=[];return 46===e.charCodeAt(0)&&n.push(""),e.replace(r,(function(e,i,a,r){n.push(a?r.replace(l,"$1"):i||e)})),n}));e.exports=t},function(e,n,i){var a=i(245);e.exports=function(e){var n=a(e,(function(e){return 500===i.size&&i.clear(),e})),i=n.cache;return n}},function(e,n,i){var a=i(62);function r(e,n){if("function"!=typeof e||null!=n&&"function"!=typeof n)throw new TypeError("Expected a function");var i=function(){var a=arguments,r=n?n.apply(this,a):a[0],l=i.cache;if(l.has(r))return l.get(r);var t=e.apply(this,a);return i.cache=l.set(r,t)||l,t};return i.cache=new(r.Cache||a),i}r.Cache=a,e.exports=r},function(e,n,i){var a=i(247);e.exports=function(e){return null==e?"":a(e)}},function(e,n,i){var a=i(28),r=i(248),l=i(13),t=i(66),d=a?a.prototype:void 0,s=d?d.toString:void 0;e.exports=function e(n){if("string"==typeof n)return n;if(l(n))return r(n,e)+"";if(t(n))return s?s.call(n):"";var i=n+"";return"0"==i&&1/n==-1/0?"-0":i}},function(e,n){e.exports=function(e,n){for(var i=-1,a=null==e?0:e.length,r=Array(a);++i<a;)r[i]=n(e[i],i,e);return r}},function(e,n,i){var a=i(250),r=i(251);e.exports=function(e,n){return null!=e&&r(e,n,a)}},function(e,n){e.exports=function(e,n){return null!=e&&n in Object(e)}},function(e,n,i){var a=i(116),r=i(59),l=i(13),t=i(109),d=i(64),s=i(42);e.exports=function(e,n,i){for(var m=-1,u=(n=a(n,e)).length,o=!1;++m<u;){var k=s(n[m]);if(!(o=null!=e&&i(e,k)))break;e=e[k]}return o||++m!=u?o:!!(u=null==e?0:e.length)&&d(u)&&t(k,u)&&(l(e)||r(e))}},function(e,n,i){var a=i(253),r=i(254),l=i(65),t=i(42);e.exports=function(e){return l(e)?a(t(e)):r(e)}},function(e,n){e.exports=function(e){return function(n){return null==n?void 0:n[e]}}},function(e,n,i){var a=i(115);e.exports=function(e){return function(n){return a(n,e)}}},function(e,n,i){var a=i(67),r=i(256),l=i(258);e.exports=function(e,n){return l(r(e,n,a),e+"")}},function(e,n,i){var a=i(257),r=Math.max;e.exports=function(e,n,i){return n=r(void 0===n?e.length-1:n,0),function(){for(var l=arguments,t=-1,d=r(l.length-n,0),s=Array(d);++t<d;)s[t]=l[n+t];t=-1;for(var m=Array(n+1);++t<n;)m[t]=l[t];return m[n]=i(s),a(e,this,m)}}},function(e,n){e.exports=function(e,n,i){switch(i.length){case 0:return e.call(n);case 1:return e.call(n,i[0]);case 2:return e.call(n,i[0],i[1]);case 3:return e.call(n,i[0],i[1],i[2])}return e.apply(n,i)}},function(e,n,i){var a=i(259),r=i(262)(a);e.exports=r},function(e,n,i){var a=i(260),r=i(261),l=i(67),t=r?function(e,n){return r(e,"toString",{configurable:!0,enumerable:!1,value:a(n),writable:!0})}:l;e.exports=t},function(e,n){e.exports=function(e){return function(){return e}}},function(e,n,i){var a=i(18),r=function(){try{var e=a(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=r},function(e,n){var i=Date.now;e.exports=function(e){var n=0,a=0;return function(){var r=i(),l=16-(r-a);if(a=r,l>0){if(++n>=800)return arguments[0]}else n=0;return e.apply(void 0,arguments)}}},function(e,n,i){var a=i(105),r=i(264),l=i(269),t=i(106),d=i(270),s=i(63);e.exports=function(e,n,i){var m=-1,u=r,o=e.length,k=!0,y=[],b=y;if(i)k=!1,u=l;else if(o>=200){var c=n?null:d(e);if(c)return s(c);k=!1,u=t,b=new a}else b=n?[]:y;e:for(;++m<o;){var g=e[m],p=n?n(g):g;if(g=i||0!==g?g:0,k&&p==p){for(var H=b.length;H--;)if(b[H]===p)continue e;n&&b.push(p),y.push(g)}else u(b,p,i)||(b!==y&&b.push(p),y.push(g))}return y}},function(e,n,i){var a=i(265);e.exports=function(e,n){return!!(null==e?0:e.length)&&a(e,n,0)>-1}},function(e,n,i){var a=i(266),r=i(267),l=i(268);e.exports=function(e,n,i){return n==n?l(e,n,i):a(e,r,i)}},function(e,n){e.exports=function(e,n,i,a){for(var r=e.length,l=i+(a?1:-1);a?l--:++l<r;)if(n(e[l],l,e))return l;return-1}},function(e,n){e.exports=function(e){return e!=e}},function(e,n){e.exports=function(e,n,i){for(var a=i-1,r=e.length;++a<r;)if(e[a]===n)return a;return-1}},function(e,n){e.exports=function(e,n,i){for(var a=-1,r=null==e?0:e.length;++a<r;)if(i(n,e[a]))return!0;return!1}},function(e,n,i){var a=i(112),r=i(271),l=i(63),t=a&&1/l(new a([,-0]))[1]==1/0?function(e){return new a(e)}:r;e.exports=t},function(e,n){e.exports=function(){}},function(e,n,i){var a=i(111),r=i(22);e.exports=function(e){return r(e)&&a(e)}},function(e,n,i){},function(e,n,i){},function(e,n,i){"use strict";i(117)},function(e,n,i){"use strict";i(118)},function(e,n,i){"use strict";i.r(n);i(16),i(24),i(31);var a=i(0);function r(e,n){for(var i in n)e[i]=n[i];return e}var l=/[!'()*]/g,t=function(e){return"%"+e.charCodeAt(0).toString(16)},d=/%2C/g,s=function(e){return encodeURIComponent(e).replace(l,t).replace(d,",")};function m(e){try{return decodeURIComponent(e)}catch(e){0}return e}var u=function(e){return null==e||"object"==typeof e?e:String(e)};function o(e){var n={};return(e=e.trim().replace(/^(\?|#|&)/,""))?(e.split("&").forEach((function(e){var i=e.replace(/\+/g," ").split("="),a=m(i.shift()),r=i.length>0?m(i.join("=")):null;void 0===n[a]?n[a]=r:Array.isArray(n[a])?n[a].push(r):n[a]=[n[a],r]})),n):n}function k(e){var n=e?Object.keys(e).map((function(n){var i=e[n];if(void 0===i)return"";if(null===i)return s(n);if(Array.isArray(i)){var a=[];return i.forEach((function(e){void 0!==e&&(null===e?a.push(s(n)):a.push(s(n)+"="+s(e)))})),a.join("&")}return s(n)+"="+s(i)})).filter((function(e){return e.length>0})).join("&"):null;return n?"?"+n:""}var y=/\/?$/;function b(e,n,i,a){var r=a&&a.options.stringifyQuery,l=n.query||{};try{l=c(l)}catch(e){}var t={name:n.name||e&&e.name,meta:e&&e.meta||{},path:n.path||"/",hash:n.hash||"",query:l,params:n.params||{},fullPath:H(n,r),matched:e?p(e):[]};return i&&(t.redirectedFrom=H(i,r)),Object.freeze(t)}function c(e){if(Array.isArray(e))return e.map(c);if(e&&"object"==typeof e){var n={};for(var i in e)n[i]=c(e[i]);return n}return e}var g=b(null,{path:"/"});function p(e){for(var n=[];e;)n.unshift(e),e=e.parent;return n}function H(e,n){var i=e.path,a=e.query;void 0===a&&(a={});var r=e.hash;return void 0===r&&(r=""),(i||"/")+(n||k)(a)+r}function S(e,n,i){return n===g?e===n:!!n&&(e.path&&n.path?e.path.replace(y,"")===n.path.replace(y,"")&&(i||e.hash===n.hash&&h(e.query,n.query)):!(!e.name||!n.name)&&(e.name===n.name&&(i||e.hash===n.hash&&h(e.query,n.query)&&h(e.params,n.params))))}function h(e,n){if(void 0===e&&(e={}),void 0===n&&(n={}),!e||!n)return e===n;var i=Object.keys(e).sort(),a=Object.keys(n).sort();return i.length===a.length&&i.every((function(i,r){var l=e[i];if(a[r]!==i)return!1;var t=n[i];return null==l||null==t?l===t:"object"==typeof l&&"object"==typeof t?h(l,t):String(l)===String(t)}))}function z(e){for(var n=0;n<e.matched.length;n++){var i=e.matched[n];for(var a in i.instances){var r=i.instances[a],l=i.enteredCbs[a];if(r&&l){delete i.enteredCbs[a];for(var t=0;t<l.length;t++)r._isBeingDestroyed||l[t](r)}}}}var v={name:"RouterView",functional:!0,props:{name:{type:String,default:"default"}},render:function(e,n){var i=n.props,a=n.children,l=n.parent,t=n.data;t.routerView=!0;for(var d=l.$createElement,s=i.name,m=l.$route,u=l._routerViewCache||(l._routerViewCache={}),o=0,k=!1;l&&l._routerRoot!==l;){var y=l.$vnode?l.$vnode.data:{};y.routerView&&o++,y.keepAlive&&l._directInactive&&l._inactive&&(k=!0),l=l.$parent}if(t.routerViewDepth=o,k){var b=u[s],c=b&&b.component;return c?(b.configProps&&K(c,t,b.route,b.configProps),d(c,t,a)):d()}var g=m.matched[o],p=g&&g.components[s];if(!g||!p)return u[s]=null,d();u[s]={component:p},t.registerRouteInstance=function(e,n){var i=g.instances[s];(n&&i!==e||!n&&i===e)&&(g.instances[s]=n)},(t.hook||(t.hook={})).prepatch=function(e,n){g.instances[s]=n.componentInstance},t.hook.init=function(e){e.data.keepAlive&&e.componentInstance&&e.componentInstance!==g.instances[s]&&(g.instances[s]=e.componentInstance),z(m)};var H=g.props&&g.props[s];return H&&(r(u[s],{route:m,configProps:H}),K(p,t,m,H)),d(p,t,a)}};function K(e,n,i,a){var l=n.props=function(e,n){switch(typeof n){case"undefined":return;case"object":return n;case"function":return n(e);case"boolean":return n?e.params:void 0;default:0}}(i,a);if(l){l=n.props=r({},l);var t=n.attrs=n.attrs||{};for(var d in l)e.props&&d in e.props||(t[d]=l[d],delete l[d])}}function f(e,n,i){var a=e.charAt(0);if("/"===a)return e;if("?"===a||"#"===a)return n+e;var r=n.split("/");i&&r[r.length-1]||r.pop();for(var l=e.replace(/^\//,"").split("/"),t=0;t<l.length;t++){var d=l[t];".."===d?r.pop():"."!==d&&r.push(d)}return""!==r[0]&&r.unshift(""),r.join("/")}function A(e){return e.replace(/\/(?:\s*\/)+/g,"/")}var T=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)},B=_,R=D,Y=function(e,n){return E(D(e,n),n)},P=E,N=M,O=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function D(e,n){for(var i,a=[],r=0,l=0,t="",d=n&&n.delimiter||"/";null!=(i=O.exec(e));){var s=i[0],m=i[1],u=i.index;if(t+=e.slice(l,u),l=u+s.length,m)t+=m[1];else{var o=e[l],k=i[2],y=i[3],b=i[4],c=i[5],g=i[6],p=i[7];t&&(a.push(t),t="");var H=null!=k&&null!=o&&o!==k,S="+"===g||"*"===g,h="?"===g||"*"===g,z=i[2]||d,v=b||c;a.push({name:y||r++,prefix:k||"",delimiter:z,optional:h,repeat:S,partial:H,asterisk:!!p,pattern:v?G(v):p?".*":"[^"+Z(z)+"]+?"})}}return l<e.length&&(t+=e.substr(l)),t&&a.push(t),a}function I(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function E(e,n){for(var i=new Array(e.length),a=0;a<e.length;a++)"object"==typeof e[a]&&(i[a]=new RegExp("^(?:"+e[a].pattern+")$",V(n)));return function(n,a){for(var r="",l=n||{},t=(a||{}).pretty?I:encodeURIComponent,d=0;d<e.length;d++){var s=e[d];if("string"!=typeof s){var m,u=l[s.name];if(null==u){if(s.optional){s.partial&&(r+=s.prefix);continue}throw new TypeError('Expected "'+s.name+'" to be defined')}if(T(u)){if(!s.repeat)throw new TypeError('Expected "'+s.name+'" to not repeat, but received `'+JSON.stringify(u)+"`");if(0===u.length){if(s.optional)continue;throw new TypeError('Expected "'+s.name+'" to not be empty')}for(var o=0;o<u.length;o++){if(m=t(u[o]),!i[d].test(m))throw new TypeError('Expected all "'+s.name+'" to match "'+s.pattern+'", but received `'+JSON.stringify(m)+"`");r+=(0===o?s.prefix:s.delimiter)+m}}else{if(m=s.asterisk?encodeURI(u).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):t(u),!i[d].test(m))throw new TypeError('Expected "'+s.name+'" to match "'+s.pattern+'", but received "'+m+'"');r+=s.prefix+m}}else r+=s}return r}}function Z(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function G(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function C(e,n){return e.keys=n,e}function V(e){return e&&e.sensitive?"":"i"}function M(e,n,i){T(n)||(i=n||i,n=[]);for(var a=(i=i||{}).strict,r=!1!==i.end,l="",t=0;t<e.length;t++){var d=e[t];if("string"==typeof d)l+=Z(d);else{var s=Z(d.prefix),m="(?:"+d.pattern+")";n.push(d),d.repeat&&(m+="(?:"+s+m+")*"),l+=m=d.optional?d.partial?s+"("+m+")?":"(?:"+s+"("+m+"))?":s+"("+m+")"}}var u=Z(i.delimiter||"/"),o=l.slice(-u.length)===u;return a||(l=(o?l.slice(0,-u.length):l)+"(?:"+u+"(?=$))?"),l+=r?"$":a&&o?"":"(?="+u+"|$)",C(new RegExp("^"+l,V(i)),n)}function _(e,n,i){return T(n)||(i=n||i,n=[]),i=i||{},e instanceof RegExp?function(e,n){var i=e.source.match(/\((?!\?)/g);if(i)for(var a=0;a<i.length;a++)n.push({name:a,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return C(e,n)}(e,n):T(e)?function(e,n,i){for(var a=[],r=0;r<e.length;r++)a.push(_(e[r],n,i).source);return C(new RegExp("(?:"+a.join("|")+")",V(i)),n)}(e,n,i):function(e,n,i){return M(D(e,i),n,i)}(e,n,i)}B.parse=R,B.compile=Y,B.tokensToFunction=P,B.tokensToRegExp=N;var F=Object.create(null);function x(e,n,i){n=n||{};try{var a=F[e]||(F[e]=B.compile(e));return"string"==typeof n.pathMatch&&(n[0]=n.pathMatch),a(n,{pretty:!0})}catch(e){return""}finally{delete n[0]}}function L(e,n,i,a){var l="string"==typeof e?{path:e}:e;if(l._normalized)return l;if(l.name){var t=(l=r({},e)).params;return t&&"object"==typeof t&&(l.params=r({},t)),l}if(!l.path&&l.params&&n){(l=r({},l))._normalized=!0;var d=r(r({},n.params),l.params);if(n.name)l.name=n.name,l.params=d;else if(n.matched.length){var s=n.matched[n.matched.length-1].path;l.path=x(s,d,n.path)}else 0;return l}var m=function(e){var n="",i="",a=e.indexOf("#");a>=0&&(n=e.slice(a),e=e.slice(0,a));var r=e.indexOf("?");return r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),{path:e,query:i,hash:n}}(l.path||""),k=n&&n.path||"/",y=m.path?f(m.path,k,i||l.append):k,b=function(e,n,i){void 0===n&&(n={});var a,r=i||o;try{a=r(e||"")}catch(e){a={}}for(var l in n){var t=n[l];a[l]=Array.isArray(t)?t.map(u):u(t)}return a}(m.query,l.query,a&&a.options.parseQuery),c=l.hash||m.hash;return c&&"#"!==c.charAt(0)&&(c="#"+c),{_normalized:!0,path:y,query:b,hash:c}}var w,j=function(){},U={name:"RouterLink",props:{to:{type:[String,Object],required:!0},tag:{type:String,default:"a"},custom:Boolean,exact:Boolean,exactPath:Boolean,append:Boolean,replace:Boolean,activeClass:String,exactActiveClass:String,ariaCurrentValue:{type:String,default:"page"},event:{type:[String,Array],default:"click"}},render:function(e){var n=this,i=this.$router,a=this.$route,l=i.resolve(this.to,a,this.append),t=l.location,d=l.route,s=l.href,m={},u=i.options.linkActiveClass,o=i.options.linkExactActiveClass,k=null==u?"router-link-active":u,c=null==o?"router-link-exact-active":o,g=null==this.activeClass?k:this.activeClass,p=null==this.exactActiveClass?c:this.exactActiveClass,H=d.redirectedFrom?b(null,L(d.redirectedFrom),null,i):d;m[p]=S(a,H,this.exactPath),m[g]=this.exact||this.exactPath?m[p]:function(e,n){return 0===e.path.replace(y,"/").indexOf(n.path.replace(y,"/"))&&(!n.hash||e.hash===n.hash)&&function(e,n){for(var i in n)if(!(i in e))return!1;return!0}(e.query,n.query)}(a,H);var h=m[p]?this.ariaCurrentValue:null,z=function(e){$(e)&&(n.replace?i.replace(t,j):i.push(t,j))},v={click:$};Array.isArray(this.event)?this.event.forEach((function(e){v[e]=z})):v[this.event]=z;var K={class:m},f=!this.$scopedSlots.$hasNormal&&this.$scopedSlots.default&&this.$scopedSlots.default({href:s,route:d,navigate:z,isActive:m[g],isExactActive:m[p]});if(f){if(1===f.length)return f[0];if(f.length>1||!f.length)return 0===f.length?e():e("span",{},f)}if("a"===this.tag)K.on=v,K.attrs={href:s,"aria-current":h};else{var A=function e(n){var i;if(n)for(var a=0;a<n.length;a++){if("a"===(i=n[a]).tag)return i;if(i.children&&(i=e(i.children)))return i}}(this.$slots.default);if(A){A.isStatic=!1;var T=A.data=r({},A.data);for(var B in T.on=T.on||{},T.on){var R=T.on[B];B in v&&(T.on[B]=Array.isArray(R)?R:[R])}for(var Y in v)Y in T.on?T.on[Y].push(v[Y]):T.on[Y]=z;var P=A.data.attrs=r({},A.data.attrs);P.href=s,P["aria-current"]=h}else K.on=v}return e(this.tag,K,this.$slots.default)}};function $(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey||e.defaultPrevented||void 0!==e.button&&0!==e.button)){if(e.currentTarget&&e.currentTarget.getAttribute){var n=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(n))return}return e.preventDefault&&e.preventDefault(),!0}}var J="undefined"!=typeof window;function W(e,n,i,a,r){var l=n||[],t=i||Object.create(null),d=a||Object.create(null);e.forEach((function(e){!function e(n,i,a,r,l,t){var d=r.path,s=r.name;0;var m=r.pathToRegexpOptions||{},u=function(e,n,i){i||(e=e.replace(/\/$/,""));if("/"===e[0])return e;if(null==n)return e;return A(n.path+"/"+e)}(d,l,m.strict);"boolean"==typeof r.caseSensitive&&(m.sensitive=r.caseSensitive);var o={path:u,regex:X(u,m),components:r.components||{default:r.component},alias:r.alias?"string"==typeof r.alias?[r.alias]:r.alias:[],instances:{},enteredCbs:{},name:s,parent:l,matchAs:t,redirect:r.redirect,beforeEnter:r.beforeEnter,meta:r.meta||{},props:null==r.props?{}:r.components?r.props:{default:r.props}};r.children&&r.children.forEach((function(r){var l=t?A(t+"/"+r.path):void 0;e(n,i,a,r,o,l)}));i[o.path]||(n.push(o.path),i[o.path]=o);if(void 0!==r.alias)for(var k=Array.isArray(r.alias)?r.alias:[r.alias],y=0;y<k.length;++y){0;var b={path:k[y],children:r.children};e(n,i,a,b,l,o.path||"/")}s&&(a[s]||(a[s]=o))}(l,t,d,e,r)}));for(var s=0,m=l.length;s<m;s++)"*"===l[s]&&(l.push(l.splice(s,1)[0]),m--,s--);return{pathList:l,pathMap:t,nameMap:d}}function X(e,n){return B(e,[],n)}function q(e,n){var i=W(e),a=i.pathList,r=i.pathMap,l=i.nameMap;function t(e,i,t){var d=L(e,i,!1,n),m=d.name;if(m){var u=l[m];if(!u)return s(null,d);var o=u.regex.keys.filter((function(e){return!e.optional})).map((function(e){return e.name}));if("object"!=typeof d.params&&(d.params={}),i&&"object"==typeof i.params)for(var k in i.params)!(k in d.params)&&o.indexOf(k)>-1&&(d.params[k]=i.params[k]);return d.path=x(u.path,d.params),s(u,d,t)}if(d.path){d.params={};for(var y=0;y<a.length;y++){var b=a[y],c=r[b];if(Q(c.regex,d.path,d.params))return s(c,d,t)}}return s(null,d)}function d(e,i){var a=e.redirect,r="function"==typeof a?a(b(e,i,null,n)):a;if("string"==typeof r&&(r={path:r}),!r||"object"!=typeof r)return s(null,i);var d=r,m=d.name,u=d.path,o=i.query,k=i.hash,y=i.params;if(o=d.hasOwnProperty("query")?d.query:o,k=d.hasOwnProperty("hash")?d.hash:k,y=d.hasOwnProperty("params")?d.params:y,m){l[m];return t({_normalized:!0,name:m,query:o,hash:k,params:y},void 0,i)}if(u){var c=function(e,n){return f(e,n.parent?n.parent.path:"/",!0)}(u,e);return t({_normalized:!0,path:x(c,y),query:o,hash:k},void 0,i)}return s(null,i)}function s(e,i,a){return e&&e.redirect?d(e,a||i):e&&e.matchAs?function(e,n,i){var a=t({_normalized:!0,path:x(i,n.params)});if(a){var r=a.matched,l=r[r.length-1];return n.params=a.params,s(l,n)}return s(null,n)}(0,i,e.matchAs):b(e,i,a,n)}return{match:t,addRoute:function(e,n){var i="object"!=typeof e?l[e]:void 0;W([n||e],a,r,l,i),i&&i.alias.length&&W(i.alias.map((function(e){return{path:e,children:[n]}})),a,r,l,i)},getRoutes:function(){return a.map((function(e){return r[e]}))},addRoutes:function(e){W(e,a,r,l)}}}function Q(e,n,i){var a=n.match(e);if(!a)return!1;if(!i)return!0;for(var r=1,l=a.length;r<l;++r){var t=e.keys[r-1];t&&(i[t.name||"pathMatch"]="string"==typeof a[r]?m(a[r]):a[r])}return!0}var ee=J&&window.performance&&window.performance.now?window.performance:Date;function ne(){return ee.now().toFixed(3)}var ie=ne();function ae(){return ie}function re(e){return ie=e}var le=Object.create(null);function te(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual");var e=window.location.protocol+"//"+window.location.host,n=window.location.href.replace(e,""),i=r({},window.history.state);return i.key=ae(),window.history.replaceState(i,"",n),window.addEventListener("popstate",me),function(){window.removeEventListener("popstate",me)}}function de(e,n,i,a){if(e.app){var r=e.options.scrollBehavior;r&&e.app.$nextTick((function(){var l=function(){var e=ae();if(e)return le[e]}(),t=r.call(e,n,i,a?l:null);t&&("function"==typeof t.then?t.then((function(e){be(e,l)})).catch((function(e){0})):be(t,l))}))}}function se(){var e=ae();e&&(le[e]={x:window.pageXOffset,y:window.pageYOffset})}function me(e){se(),e.state&&e.state.key&&re(e.state.key)}function ue(e){return ke(e.x)||ke(e.y)}function oe(e){return{x:ke(e.x)?e.x:window.pageXOffset,y:ke(e.y)?e.y:window.pageYOffset}}function ke(e){return"number"==typeof e}var ye=/^#\d/;function be(e,n){var i,a="object"==typeof e;if(a&&"string"==typeof e.selector){var r=ye.test(e.selector)?document.getElementById(e.selector.slice(1)):document.querySelector(e.selector);if(r){var l=e.offset&&"object"==typeof e.offset?e.offset:{};n=function(e,n){var i=document.documentElement.getBoundingClientRect(),a=e.getBoundingClientRect();return{x:a.left-i.left-n.x,y:a.top-i.top-n.y}}(r,l={x:ke((i=l).x)?i.x:0,y:ke(i.y)?i.y:0})}else ue(e)&&(n=oe(e))}else a&&ue(e)&&(n=oe(e));n&&("scrollBehavior"in document.documentElement.style?window.scrollTo({left:n.x,top:n.y,behavior:e.behavior}):window.scrollTo(n.x,n.y))}var ce,ge=J&&((-1===(ce=window.navigator.userAgent).indexOf("Android 2.")&&-1===ce.indexOf("Android 4.0")||-1===ce.indexOf("Mobile Safari")||-1!==ce.indexOf("Chrome")||-1!==ce.indexOf("Windows Phone"))&&window.history&&"function"==typeof window.history.pushState);function pe(e,n){se();var i=window.history;try{if(n){var a=r({},i.state);a.key=ae(),i.replaceState(a,"",e)}else i.pushState({key:re(ne())},"",e)}catch(i){window.location[n?"replace":"assign"](e)}}function He(e){pe(e,!0)}var Se={redirected:2,aborted:4,cancelled:8,duplicated:16};function he(e,n){return ve(e,n,Se.redirected,'Redirected when going from "'+e.fullPath+'" to "'+function(e){if("string"==typeof e)return e;if("path"in e)return e.path;var n={};return Ke.forEach((function(i){i in e&&(n[i]=e[i])})),JSON.stringify(n,null,2)}(n)+'" via a navigation guard.')}function ze(e,n){return ve(e,n,Se.cancelled,'Navigation cancelled from "'+e.fullPath+'" to "'+n.fullPath+'" with a new navigation.')}function ve(e,n,i,a){var r=new Error(a);return r._isRouter=!0,r.from=e,r.to=n,r.type=i,r}var Ke=["params","query","hash"];function fe(e){return Object.prototype.toString.call(e).indexOf("Error")>-1}function Ae(e,n){return fe(e)&&e._isRouter&&(null==n||e.type===n)}function Te(e,n,i){var a=function(r){r>=e.length?i():e[r]?n(e[r],(function(){a(r+1)})):a(r+1)};a(0)}function Be(e){return function(n,i,a){var r=!1,l=0,t=null;Re(e,(function(e,n,i,d){if("function"==typeof e&&void 0===e.cid){r=!0,l++;var s,m=Ne((function(n){var r;((r=n).__esModule||Pe&&"Module"===r[Symbol.toStringTag])&&(n=n.default),e.resolved="function"==typeof n?n:w.extend(n),i.components[d]=n,--l<=0&&a()})),u=Ne((function(e){var n="Failed to resolve async component "+d+": "+e;t||(t=fe(e)?e:new Error(n),a(t))}));try{s=e(m,u)}catch(e){u(e)}if(s)if("function"==typeof s.then)s.then(m,u);else{var o=s.component;o&&"function"==typeof o.then&&o.then(m,u)}}})),r||a()}}function Re(e,n){return Ye(e.map((function(e){return Object.keys(e.components).map((function(i){return n(e.components[i],e.instances[i],e,i)}))})))}function Ye(e){return Array.prototype.concat.apply([],e)}var Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function Ne(e){var n=!1;return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(!n)return n=!0,e.apply(this,i)}}var Oe=function(e,n){this.router=e,this.base=function(e){if(!e)if(J){var n=document.querySelector("base");e=(e=n&&n.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else e="/";"/"!==e.charAt(0)&&(e="/"+e);return e.replace(/\/$/,"")}(n),this.current=g,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[],this.listeners=[]};function De(e,n,i,a){var r=Re(e,(function(e,a,r,l){var t=function(e,n){"function"!=typeof e&&(e=w.extend(e));return e.options[n]}(e,n);if(t)return Array.isArray(t)?t.map((function(e){return i(e,a,r,l)})):i(t,a,r,l)}));return Ye(a?r.reverse():r)}function Ie(e,n){if(n)return function(){return e.apply(n,arguments)}}Oe.prototype.listen=function(e){this.cb=e},Oe.prototype.onReady=function(e,n){this.ready?e():(this.readyCbs.push(e),n&&this.readyErrorCbs.push(n))},Oe.prototype.onError=function(e){this.errorCbs.push(e)},Oe.prototype.transitionTo=function(e,n,i){var a,r=this;try{a=this.router.match(e,this.current)}catch(e){throw this.errorCbs.forEach((function(n){n(e)})),e}var l=this.current;this.confirmTransition(a,(function(){r.updateRoute(a),n&&n(a),r.ensureURL(),r.router.afterHooks.forEach((function(e){e&&e(a,l)})),r.ready||(r.ready=!0,r.readyCbs.forEach((function(e){e(a)})))}),(function(e){i&&i(e),e&&!r.ready&&(Ae(e,Se.redirected)&&l===g||(r.ready=!0,r.readyErrorCbs.forEach((function(n){n(e)}))))}))},Oe.prototype.confirmTransition=function(e,n,i){var a=this,r=this.current;this.pending=e;var l,t,d=function(e){!Ae(e)&&fe(e)&&(a.errorCbs.length?a.errorCbs.forEach((function(n){n(e)})):console.error(e)),i&&i(e)},s=e.matched.length-1,m=r.matched.length-1;if(S(e,r)&&s===m&&e.matched[s]===r.matched[m])return this.ensureURL(),e.hash&&de(this.router,r,e,!1),d(((t=ve(l=r,e,Se.duplicated,'Avoided redundant navigation to current location: "'+l.fullPath+'".')).name="NavigationDuplicated",t));var u=function(e,n){var i,a=Math.max(e.length,n.length);for(i=0;i<a&&e[i]===n[i];i++);return{updated:n.slice(0,i),activated:n.slice(i),deactivated:e.slice(i)}}(this.current.matched,e.matched),o=u.updated,k=u.deactivated,y=u.activated,b=[].concat(function(e){return De(e,"beforeRouteLeave",Ie,!0)}(k),this.router.beforeHooks,function(e){return De(e,"beforeRouteUpdate",Ie)}(o),y.map((function(e){return e.beforeEnter})),Be(y)),c=function(n,i){if(a.pending!==e)return d(ze(r,e));try{n(e,r,(function(n){!1===n?(a.ensureURL(!0),d(function(e,n){return ve(e,n,Se.aborted,'Navigation aborted from "'+e.fullPath+'" to "'+n.fullPath+'" via a navigation guard.')}(r,e))):fe(n)?(a.ensureURL(!0),d(n)):"string"==typeof n||"object"==typeof n&&("string"==typeof n.path||"string"==typeof n.name)?(d(he(r,e)),"object"==typeof n&&n.replace?a.replace(n):a.push(n)):i(n)}))}catch(e){d(e)}};Te(b,c,(function(){Te(function(e){return De(e,"beforeRouteEnter",(function(e,n,i,a){return function(e,n,i){return function(a,r,l){return e(a,r,(function(e){"function"==typeof e&&(n.enteredCbs[i]||(n.enteredCbs[i]=[]),n.enteredCbs[i].push(e)),l(e)}))}}(e,i,a)}))}(y).concat(a.router.resolveHooks),c,(function(){if(a.pending!==e)return d(ze(r,e));a.pending=null,n(e),a.router.app&&a.router.app.$nextTick((function(){z(e)}))}))}))},Oe.prototype.updateRoute=function(e){this.current=e,this.cb&&this.cb(e)},Oe.prototype.setupListeners=function(){},Oe.prototype.teardown=function(){this.listeners.forEach((function(e){e()})),this.listeners=[],this.current=g,this.pending=null};var Ee=function(e){function n(n,i){e.call(this,n,i),this._startLocation=Ze(this.base)}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.setupListeners=function(){var e=this;if(!(this.listeners.length>0)){var n=this.router,i=n.options.scrollBehavior,a=ge&&i;a&&this.listeners.push(te());var r=function(){var i=e.current,r=Ze(e.base);e.current===g&&r===e._startLocation||e.transitionTo(r,(function(e){a&&de(n,e,i,!0)}))};window.addEventListener("popstate",r),this.listeners.push((function(){window.removeEventListener("popstate",r)}))}},n.prototype.go=function(e){window.history.go(e)},n.prototype.push=function(e,n,i){var a=this,r=this.current;this.transitionTo(e,(function(e){pe(A(a.base+e.fullPath)),de(a.router,e,r,!1),n&&n(e)}),i)},n.prototype.replace=function(e,n,i){var a=this,r=this.current;this.transitionTo(e,(function(e){He(A(a.base+e.fullPath)),de(a.router,e,r,!1),n&&n(e)}),i)},n.prototype.ensureURL=function(e){if(Ze(this.base)!==this.current.fullPath){var n=A(this.base+this.current.fullPath);e?pe(n):He(n)}},n.prototype.getCurrentLocation=function(){return Ze(this.base)},n}(Oe);function Ze(e){var n=window.location.pathname,i=n.toLowerCase(),a=e.toLowerCase();return!e||i!==a&&0!==i.indexOf(A(a+"/"))||(n=n.slice(e.length)),(n||"/")+window.location.search+window.location.hash}var Ge=function(e){function n(n,i,a){e.call(this,n,i),a&&function(e){var n=Ze(e);if(!/^\/#/.test(n))return window.location.replace(A(e+"/#"+n)),!0}(this.base)||Ce()}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.setupListeners=function(){var e=this;if(!(this.listeners.length>0)){var n=this.router.options.scrollBehavior,i=ge&&n;i&&this.listeners.push(te());var a=function(){var n=e.current;Ce()&&e.transitionTo(Ve(),(function(a){i&&de(e.router,a,n,!0),ge||Fe(a.fullPath)}))},r=ge?"popstate":"hashchange";window.addEventListener(r,a),this.listeners.push((function(){window.removeEventListener(r,a)}))}},n.prototype.push=function(e,n,i){var a=this,r=this.current;this.transitionTo(e,(function(e){_e(e.fullPath),de(a.router,e,r,!1),n&&n(e)}),i)},n.prototype.replace=function(e,n,i){var a=this,r=this.current;this.transitionTo(e,(function(e){Fe(e.fullPath),de(a.router,e,r,!1),n&&n(e)}),i)},n.prototype.go=function(e){window.history.go(e)},n.prototype.ensureURL=function(e){var n=this.current.fullPath;Ve()!==n&&(e?_e(n):Fe(n))},n.prototype.getCurrentLocation=function(){return Ve()},n}(Oe);function Ce(){var e=Ve();return"/"===e.charAt(0)||(Fe("/"+e),!1)}function Ve(){var e=window.location.href,n=e.indexOf("#");return n<0?"":e=e.slice(n+1)}function Me(e){var n=window.location.href,i=n.indexOf("#");return(i>=0?n.slice(0,i):n)+"#"+e}function _e(e){ge?pe(Me(e)):window.location.hash=e}function Fe(e){ge?He(Me(e)):window.location.replace(Me(e))}var xe=function(e){function n(n,i){e.call(this,n,i),this.stack=[],this.index=-1}return e&&(n.__proto__=e),n.prototype=Object.create(e&&e.prototype),n.prototype.constructor=n,n.prototype.push=function(e,n,i){var a=this;this.transitionTo(e,(function(e){a.stack=a.stack.slice(0,a.index+1).concat(e),a.index++,n&&n(e)}),i)},n.prototype.replace=function(e,n,i){var a=this;this.transitionTo(e,(function(e){a.stack=a.stack.slice(0,a.index).concat(e),n&&n(e)}),i)},n.prototype.go=function(e){var n=this,i=this.index+e;if(!(i<0||i>=this.stack.length)){var a=this.stack[i];this.confirmTransition(a,(function(){var e=n.current;n.index=i,n.updateRoute(a),n.router.afterHooks.forEach((function(n){n&&n(a,e)}))}),(function(e){Ae(e,Se.duplicated)&&(n.index=i)}))}},n.prototype.getCurrentLocation=function(){var e=this.stack[this.stack.length-1];return e?e.fullPath:"/"},n.prototype.ensureURL=function(){},n}(Oe),Le=function(e){void 0===e&&(e={}),this.app=null,this.apps=[],this.options=e,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=q(e.routes||[],this);var n=e.mode||"hash";switch(this.fallback="history"===n&&!ge&&!1!==e.fallback,this.fallback&&(n="hash"),J||(n="abstract"),this.mode=n,n){case"history":this.history=new Ee(this,e.base);break;case"hash":this.history=new Ge(this,e.base,this.fallback);break;case"abstract":this.history=new xe(this,e.base);break;default:0}},we={currentRoute:{configurable:!0}};Le.prototype.match=function(e,n,i){return this.matcher.match(e,n,i)},we.currentRoute.get=function(){return this.history&&this.history.current},Le.prototype.init=function(e){var n=this;if(this.apps.push(e),e.$once("hook:destroyed",(function(){var i=n.apps.indexOf(e);i>-1&&n.apps.splice(i,1),n.app===e&&(n.app=n.apps[0]||null),n.app||n.history.teardown()})),!this.app){this.app=e;var i=this.history;if(i instanceof Ee||i instanceof Ge){var a=function(e){i.setupListeners(),function(e){var a=i.current,r=n.options.scrollBehavior;ge&&r&&"fullPath"in e&&de(n,e,a,!1)}(e)};i.transitionTo(i.getCurrentLocation(),a,a)}i.listen((function(e){n.apps.forEach((function(n){n._route=e}))}))}},Le.prototype.beforeEach=function(e){return Ue(this.beforeHooks,e)},Le.prototype.beforeResolve=function(e){return Ue(this.resolveHooks,e)},Le.prototype.afterEach=function(e){return Ue(this.afterHooks,e)},Le.prototype.onReady=function(e,n){this.history.onReady(e,n)},Le.prototype.onError=function(e){this.history.onError(e)},Le.prototype.push=function(e,n,i){var a=this;if(!n&&!i&&"undefined"!=typeof Promise)return new Promise((function(n,i){a.history.push(e,n,i)}));this.history.push(e,n,i)},Le.prototype.replace=function(e,n,i){var a=this;if(!n&&!i&&"undefined"!=typeof Promise)return new Promise((function(n,i){a.history.replace(e,n,i)}));this.history.replace(e,n,i)},Le.prototype.go=function(e){this.history.go(e)},Le.prototype.back=function(){this.go(-1)},Le.prototype.forward=function(){this.go(1)},Le.prototype.getMatchedComponents=function(e){var n=e?e.matched?e:this.resolve(e).route:this.currentRoute;return n?[].concat.apply([],n.matched.map((function(e){return Object.keys(e.components).map((function(n){return e.components[n]}))}))):[]},Le.prototype.resolve=function(e,n,i){var a=L(e,n=n||this.history.current,i,this),r=this.match(a,n),l=r.redirectedFrom||r.fullPath;return{location:a,route:r,href:function(e,n,i){var a="hash"===i?"#"+n:n;return e?A(e+"/"+a):a}(this.history.base,l,this.mode),normalizedTo:a,resolved:r}},Le.prototype.getRoutes=function(){return this.matcher.getRoutes()},Le.prototype.addRoute=function(e,n){this.matcher.addRoute(e,n),this.history.current!==g&&this.history.transitionTo(this.history.getCurrentLocation())},Le.prototype.addRoutes=function(e){this.matcher.addRoutes(e),this.history.current!==g&&this.history.transitionTo(this.history.getCurrentLocation())},Object.defineProperties(Le.prototype,we);var je=Le;function Ue(e,n){return e.push(n),function(){var i=e.indexOf(n);i>-1&&e.splice(i,1)}}Le.install=function e(n){if(!e.installed||w!==n){e.installed=!0,w=n;var i=function(e){return void 0!==e},a=function(e,n){var a=e.$options._parentVnode;i(a)&&i(a=a.data)&&i(a=a.registerRouteInstance)&&a(e,n)};n.mixin({beforeCreate:function(){i(this.$options.router)?(this._routerRoot=this,this._router=this.$options.router,this._router.init(this),n.util.defineReactive(this,"_route",this._router.history.current)):this._routerRoot=this.$parent&&this.$parent._routerRoot||this,a(this,this)},destroyed:function(){a(this)}}),Object.defineProperty(n.prototype,"$router",{get:function(){return this._routerRoot._router}}),Object.defineProperty(n.prototype,"$route",{get:function(){return this._routerRoot._route}}),n.component("RouterView",v),n.component("RouterLink",U);var r=n.config.optionMergeStrategies;r.beforeRouteEnter=r.beforeRouteLeave=r.beforeRouteUpdate=r.created}},Le.version="3.6.5",Le.isNavigationFailure=Ae,Le.NavigationFailureType=Se,Le.START_LOCATION=g,J&&window.Vue&&window.Vue.use(Le);i(128),i(71),i(129);i(130),i(123);var $e={"components/AlgoliaSearchBox":()=>Promise.all([i.e(0),i.e(27)]).then(i.bind(null,748)),"components/DropdownLink":()=>Promise.all([i.e(0),i.e(25)]).then(i.bind(null,494)),"components/DropdownTransition":()=>Promise.all([i.e(0),i.e(56)]).then(i.bind(null,454)),"components/Home":()=>Promise.all([i.e(0),i.e(40)]).then(i.bind(null,604)),"components/NavLink":()=>i.e(60).then(i.bind(null,395)),"components/NavLinks":()=>Promise.all([i.e(0),i.e(24)]).then(i.bind(null,509)),"components/Navbar":()=>Promise.all([i.e(0),i.e(4)]).then(i.bind(null,736)),"components/Page":()=>Promise.all([i.e(0),i.e(23)]).then(i.bind(null,605)),"components/PageEdit":()=>Promise.all([i.e(0),i.e(41)]).then(i.bind(null,524)),"components/PageNav":()=>Promise.all([i.e(0),i.e(34)]).then(i.bind(null,525)),"components/Sidebar":()=>Promise.all([i.e(0),i.e(22)]).then(i.bind(null,606)),"components/SidebarButton":()=>Promise.all([i.e(0),i.e(57)]).then(i.bind(null,608)),"components/SidebarGroup":()=>Promise.all([i.e(0),i.e(7)]).then(i.bind(null,510)),"components/SidebarLink":()=>Promise.all([i.e(0),i.e(43)]).then(i.bind(null,495)),"components/SidebarLinks":()=>Promise.all([i.e(0),i.e(7)]).then(i.bind(null,487)),"global-components/Badge":()=>Promise.all([i.e(0),i.e(9)]).then(i.bind(null,766)),"global-components/CodeBlock":()=>Promise.all([i.e(0),i.e(10)]).then(i.bind(null,749)),"global-components/CodeGroup":()=>Promise.all([i.e(0),i.e(11)]).then(i.bind(null,750)),"layouts/404":()=>i.e(12).then(i.bind(null,751)),"layouts/Layout":()=>Promise.all([i.e(0),i.e(4),i.e(5),i.e(8)]).then(i.bind(null,752)),NotFound:()=>i.e(12).then(i.bind(null,751)),Layout:()=>Promise.all([i.e(0),i.e(4),i.e(5),i.e(8)]).then(i.bind(null,752))},Je={"v-90050004":()=>i.e(69).then(i.bind(null,767)),"v-61b42a93":()=>i.e(70).then(i.bind(null,768)),"v-64dca03d":()=>i.e(61).then(i.bind(null,769)),"v-6465b33d":()=>i.e(71).then(i.bind(null,770)),"v-22024c43":()=>i.e(72).then(i.bind(null,771)),"v-81b8a67a":()=>i.e(73).then(i.bind(null,772)),"v-48317b86":()=>i.e(62).then(i.bind(null,773)),"v-23bd824f":()=>i.e(74).then(i.bind(null,774)),"v-822cf8c6":()=>i.e(75).then(i.bind(null,775)),"v-5b1695dd":()=>i.e(35).then(i.bind(null,776)),"v-4888cd9d":()=>i.e(76).then(i.bind(null,777)),"v-1178fa5d":()=>i.e(78).then(i.bind(null,778)),"v-7e81b77d":()=>i.e(44).then(i.bind(null,779)),"v-01c649bd":()=>i.e(28).then(i.bind(null,780)),"v-7301a6d1":()=>i.e(77).then(i.bind(null,781)),"v-432b5bd6":()=>i.e(79).then(i.bind(null,782)),"v-485bbe8d":()=>i.e(80).then(i.bind(null,783)),"v-bc107546":()=>i.e(63).then(i.bind(null,784)),"v-d80dcb06":()=>i.e(81).then(i.bind(null,785)),"v-3539d41d":()=>i.e(45).then(i.bind(null,786)),"v-f0808a06":()=>i.e(36).then(i.bind(null,787)),"v-1ef8939d":()=>i.e(29).then(i.bind(null,788)),"v-0ec6f57d":()=>i.e(82).then(i.bind(null,789)),"v-3e221f7d":()=>i.e(84).then(i.bind(null,790)),"v-1be15362":()=>i.e(83).then(i.bind(null,791)),"v-cc5a0b86":()=>i.e(64).then(i.bind(null,792)),"v-03088e53":()=>i.e(85).then(i.bind(null,793)),"v-8d4168c6":()=>i.e(65).then(i.bind(null,794)),"v-553c6446":()=>i.e(37).then(i.bind(null,795)),"v-751f6acf":()=>i.e(86).then(i.bind(null,796)),"v-9cc354c6":()=>i.e(87).then(i.bind(null,797)),"v-9e25e106":()=>i.e(46).then(i.bind(null,798)),"v-7e5b51bd":()=>i.e(30).then(i.bind(null,799)),"v-e8779b46":()=>i.e(90).then(i.bind(null,800)),"v-3358815e":()=>i.e(89).then(i.bind(null,801)),"v-206455c6":()=>i.e(88).then(i.bind(null,802)),"v-2fcc3a95":()=>i.e(91).then(i.bind(null,803)),"v-3637769d":()=>i.e(93).then(i.bind(null,804)),"v-70a6dc4e":()=>i.e(92).then(i.bind(null,805)),"v-3ee390dd":()=>i.e(94).then(i.bind(null,806)),"v-642a7506":()=>i.e(96).then(i.bind(null,807)),"v-68ac6685":()=>i.e(97).then(i.bind(null,808)),"v-6480bcc7":()=>i.e(95).then(i.bind(null,809)),"v-f0a9c5f2":()=>i.e(26).then(i.bind(null,810)),"v-e89e9b86":()=>i.e(66).then(i.bind(null,811)),"v-14ad9962":()=>i.e(98).then(i.bind(null,812)),"v-24f9d8c6":()=>i.e(67).then(i.bind(null,813)),"v-2b71dd9d":()=>i.e(99).then(i.bind(null,814)),"v-c07c3efa":()=>i.e(32).then(i.bind(null,815)),"v-2c81f446":()=>i.e(31).then(i.bind(null,816)),"v-143b3106":()=>i.e(47).then(i.bind(null,817)),"v-448b4d1d":()=>i.e(100).then(i.bind(null,818)),"v-29ce59bd":()=>i.e(33).then(i.bind(null,819)),"v-bfbd2b46":()=>i.e(102).then(i.bind(null,820)),"v-9f53f9d6":()=>i.e(103).then(i.bind(null,821)),"v-e73a02ea":()=>i.e(104).then(i.bind(null,822)),"v-64fc905e":()=>i.e(101).then(i.bind(null,823)),"v-7b0a82c6":()=>i.e(106).then(i.bind(null,824)),"v-48365a59":()=>i.e(105).then(i.bind(null,825)),"v-d8bdee46":()=>i.e(107).then(i.bind(null,826)),"v-b537e5f2":()=>i.e(108).then(i.bind(null,827)),"v-35eaf572":()=>i.e(109).then(i.bind(null,828)),"v-5a2e0d7d":()=>i.e(110).then(i.bind(null,829)),"v-aa99c1f6":()=>i.e(111).then(i.bind(null,830))};function We(e){const n=Object.create(null);return function(i){return n[i]||(n[i]=e(i))}}const Xe=/-(\w)/g,qe=We(e=>e.replace(Xe,(e,n)=>n?n.toUpperCase():"")),Qe=/\B([A-Z])/g,en=We(e=>e.replace(Qe,"-$1").toLowerCase()),nn=We(e=>e.charAt(0).toUpperCase()+e.slice(1));function an(e,n){if(!n)return;if(e(n))return e(n);return n.includes("-")?e(nn(qe(n))):e(nn(n))||e(en(n))}const rn=Object.assign({},$e,Je),ln=e=>rn[e],tn=e=>Je[e],dn=e=>$e[e],sn=e=>a.default.component(e);function mn(e){return an(tn,e)}function un(e){return an(dn,e)}function on(e){return an(ln,e)}function kn(e){return an(sn,e)}function yn(...e){return Promise.all(e.filter(e=>e).map(async e=>{if(!kn(e)&&on(e)){const n=await on(e)();a.default.component(e,n.default)}}))}function bn(e,n){"undefined"!=typeof window&&window.__VUEPRESS__&&(window.__VUEPRESS__[e]=n)}i(126);var cn=i(119),gn=i.n(cn),pn=i(120),Hn=i.n(pn),Sn={created(){if(this.siteMeta=this.$site.headTags.filter(([e])=>"meta"===e).map(([e,n])=>n),this.$ssrContext){const n=this.getMergedMetaTags();this.$ssrContext.title=this.$title,this.$ssrContext.lang=this.$lang,this.$ssrContext.pageMeta=(e=n)?e.map(e=>{let n="<meta";return Object.keys(e).forEach(i=>{n+=` ${i}="${Hn()(e[i])}"`}),n+">"}).join("\n    "):"",this.$ssrContext.canonicalLink=zn(this.$canonicalUrl)}var e},mounted(){this.currentMetaTags=[...document.querySelectorAll("meta")],this.updateMeta(),this.updateCanonicalLink()},methods:{updateMeta(){document.title=this.$title,document.documentElement.lang=this.$lang;const e=this.getMergedMetaTags();this.currentMetaTags=vn(e,this.currentMetaTags)},getMergedMetaTags(){const e=this.$page.frontmatter.meta||[];return gn()([{name:"description",content:this.$description}],e,this.siteMeta,Kn)},updateCanonicalLink(){hn(),this.$canonicalUrl&&document.head.insertAdjacentHTML("beforeend",zn(this.$canonicalUrl))}},watch:{$page(){this.updateMeta(),this.updateCanonicalLink()}},beforeDestroy(){vn(null,this.currentMetaTags),hn()}};function hn(){const e=document.querySelector("link[rel='canonical']");e&&e.remove()}function zn(e=""){return e?`<link href="${e}" rel="canonical" />`:""}function vn(e,n){if(n&&[...n].filter(e=>e.parentNode===document.head).forEach(e=>document.head.removeChild(e)),e)return e.map(e=>{const n=document.createElement("meta");return Object.keys(e).forEach(i=>{n.setAttribute(i,e[i])}),document.head.appendChild(n),n})}function Kn(e){for(const n of["name","property","itemprop"])if(e.hasOwnProperty(n))return e[n]+n;return JSON.stringify(e)}i(70);var fn=i(121),An={mounted(){window.addEventListener("scroll",this.onScroll)},methods:{onScroll:i.n(fn)()((function(){this.setActiveHash()}),300),setActiveHash(){const e=[].slice.call(document.querySelectorAll(".sidebar-link")),n=[].slice.call(document.querySelectorAll(".header-anchor")).filter(n=>e.some(e=>e.hash===n.hash)),i=Math.max(window.pageYOffset,document.documentElement.scrollTop,document.body.scrollTop),a=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),r=window.innerHeight+i;for(let e=0;e<n.length;e++){const l=n[e],t=n[e+1],d=0===e&&0===i||i>=l.parentElement.offsetTop+10&&(!t||i<t.parentElement.offsetTop-10),s=decodeURIComponent(this.$route.hash);if(d&&s!==decodeURIComponent(l.hash)){const i=l;if(r===a)for(let i=e+1;i<n.length;i++)if(s===decodeURIComponent(n[i].hash))return;return this.$vuepress.$set("disableScrollBehavior",!0),void this.$router.replace(decodeURIComponent(i.hash),()=>{this.$nextTick(()=>{this.$vuepress.$set("disableScrollBehavior",!1)})})}}}},beforeDestroy(){window.removeEventListener("scroll",this.onScroll)}},Tn=i(43),Bn=i.n(Tn),Rn=[Sn,An,{mounted(){Bn.a.configure({showSpinner:!1}),this.$router.beforeEach((e,n,i)=>{e.path===n.path||a.default.component(e.name)||Bn.a.start(),i()}),this.$router.afterEach(()=>{Bn.a.done(),this.isSidebarOpen=!1})}}],Yn={name:"GlobalLayout",computed:{layout(){const e=this.getLayout();return bn("layout",e),a.default.component(e)}},methods:{getLayout(){if(this.$page.path){const e=this.$page.frontmatter.layout;return e&&(this.$vuepress.getLayoutAsyncComponent(e)||this.$vuepress.getVueComponent(e))?e:"Layout"}return"NotFound"}}},Pn=i(29),Nn=Object(Pn.a)(Yn,(function(){return(0,this._self._c)(this.layout,{tag:"component"})}),[],!1,null,null,null).exports;!function(e,n,i){switch(n){case"components":e[n]||(e[n]={}),Object.assign(e[n],i);break;case"mixins":e[n]||(e[n]=[]),e[n].push(...i);break;default:throw new Error("Unknown option name.")}}(Nn,"mixins",Rn);const On=[{name:"v-90050004",path:"/",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-90050004").then(i)}},{path:"/index.html",redirect:"/"},{name:"v-61b42a93",path:"/dijital-cuzdan.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-61b42a93").then(i)}},{name:"v-64dca03d",path:"/pages/contact.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-64dca03d").then(i)}},{name:"v-6465b33d",path:"/sorulan-sorular.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-6465b33d").then(i)}},{name:"v-22024c43",path:"/surum-yonetimi.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-22024c43").then(i)}},{name:"v-81b8a67a",path:"/uyum-tarihleri.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-81b8a67a").then(i)}},{name:"v-48317b86",path:"/v1.0.1/contents/ekler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-48317b86").then(i)}},{name:"v-23bd824f",path:"/v1.0.1/contents/erisim-belirteci.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-23bd824f").then(i)}},{name:"v-822cf8c6",path:"/v1.0.1/contents/gkd.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-822cf8c6").then(i)}},{name:"v-5b1695dd",path:"/v1.0.1/contents/hesap-bilgisi-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-5b1695dd").then(i)}},{name:"v-4888cd9d",path:"/v1.0.1/contents/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-4888cd9d").then(i)}},{name:"v-1178fa5d",path:"/v1.0.1/contents/tanim-ve-kisitlamalar.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-1178fa5d").then(i)}},{name:"v-7e81b77d",path:"/v1.0.1/contents/kapsam-ve-dayanak.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-7e81b77d").then(i)}},{name:"v-01c649bd",path:"/v1.0.1/contents/odeme-emri-baslatma-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-01c649bd").then(i)}},{name:"v-7301a6d1",path:"/v1.0.1/contents/riza-durumlari.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-7301a6d1").then(i)}},{name:"v-432b5bd6",path:"/v1.0.1/contents/temel-prensipler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-432b5bd6").then(i)}},{name:"v-485bbe8d",path:"/v1.0.2/contents/erisim-belirteci.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-485bbe8d").then(i)}},{name:"v-bc107546",path:"/v1.0.2/contents/ekler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-bc107546").then(i)}},{name:"v-d80dcb06",path:"/v1.0.2/contents/gkd.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-d80dcb06").then(i)}},{name:"v-3539d41d",path:"/v1.0.2/contents/kapsam-ve-dayanak.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-3539d41d").then(i)}},{name:"v-f0808a06",path:"/v1.0.2/contents/hesap-bilgisi-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-f0808a06").then(i)}},{name:"v-1ef8939d",path:"/v1.0.2/contents/odeme-emri-baslatma-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-1ef8939d").then(i)}},{name:"v-0ec6f57d",path:"/v1.0.2/contents/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-0ec6f57d").then(i)}},{name:"v-3e221f7d",path:"/v1.0.2/contents/tanim-ve-kisitlamalar.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-3e221f7d").then(i)}},{name:"v-1be15362",path:"/v1.0.2/contents/riza-durumlari.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-1be15362").then(i)}},{name:"v-cc5a0b86",path:"/v1.1.0/contents/ekler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-cc5a0b86").then(i)}},{name:"v-03088e53",path:"/v1.0.2/contents/temel-prensipler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-03088e53").then(i)}},{name:"v-8d4168c6",path:"/v1.1.0/contents/gkd.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-8d4168c6").then(i)}},{name:"v-553c6446",path:"/v1.1.0/contents/hesap-bilgisi-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-553c6446").then(i)}},{name:"v-751f6acf",path:"/v1.1.0/contents/erisim-belirteci.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-751f6acf").then(i)}},{name:"v-9cc354c6",path:"/v1.1.0/contents/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-9cc354c6").then(i)}},{name:"v-9e25e106",path:"/v1.1.0/contents/kapsam-ve-dayanak.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-9e25e106").then(i)}},{name:"v-7e5b51bd",path:"/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-7e5b51bd").then(i)}},{name:"v-e8779b46",path:"/v1.1.0/contents/tanim-ve-kisitlamalar.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-e8779b46").then(i)}},{name:"v-3358815e",path:"/v1.1.0/contents/riza-durumlari.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-3358815e").then(i)}},{name:"v-206455c6",path:"/v1.1.0/contents/olay-bildirim.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-206455c6").then(i)}},{name:"v-2fcc3a95",path:"/v1.1.0/contents/temel-prensipler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-2fcc3a95").then(i)}},{name:"v-3637769d",path:"/v1.1.0/deneyalani/hesap-bilgisi-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-3637769d").then(i)}},{name:"v-70a6dc4e",path:"/v1.1.0/deneyalani/genel-bilgiler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-70a6dc4e").then(i)}},{name:"v-3ee390dd",path:"/v1.1.0/deneyalani/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-3ee390dd").then(i)}},{name:"v-642a7506",path:"/v1.1.0/deneyalani/olay-bildirim-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-642a7506").then(i)}},{name:"v-68ac6685",path:"/v1.1.0/deneyalani/test.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-68ac6685").then(i)}},{name:"v-6480bcc7",path:"/v1.1.0/deneyalani/odeme-emri-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-6480bcc7").then(i)}},{name:"v-f0a9c5f2",path:"/v2.0.0/contents/duzenli-odeme-emri-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-f0a9c5f2").then(i)}},{name:"v-e89e9b86",path:"/v2.0.0/contents/ekler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-e89e9b86").then(i)}},{name:"v-14ad9962",path:"/v2.0.0/contents/erisim-belirteci.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-14ad9962").then(i)}},{name:"v-24f9d8c6",path:"/v2.0.0/contents/gkd.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-24f9d8c6").then(i)}},{name:"v-2b71dd9d",path:"/v2.0.0/contents/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-2b71dd9d").then(i)}},{name:"v-c07c3efa",path:"/v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-c07c3efa").then(i)}},{name:"v-2c81f446",path:"/v2.0.0/contents/hesap-bilgisi-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-2c81f446").then(i)}},{name:"v-143b3106",path:"/v2.0.0/contents/kapsam-ve-dayanak.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-143b3106").then(i)}},{name:"v-448b4d1d",path:"/v2.0.0/contents/olay-bildirim.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-448b4d1d").then(i)}},{name:"v-29ce59bd",path:"/v2.0.0/contents/odeme-emri-baslatma-hizmeti.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-29ce59bd").then(i)}},{name:"v-bfbd2b46",path:"/v2.0.0/contents/tanim-ve-kisitlamalar.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-bfbd2b46").then(i)}},{name:"v-9f53f9d6",path:"/v2.0.0/contents/temel-prensipler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-9f53f9d6").then(i)}},{name:"v-e73a02ea",path:"/v2.0.0/deneyalani/duzenli-odeme-emri-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-e73a02ea").then(i)}},{name:"v-64fc905e",path:"/v2.0.0/contents/riza-durumlari.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-64fc905e").then(i)}},{name:"v-7b0a82c6",path:"/v2.0.0/deneyalani/hesap-bilgisi-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-7b0a82c6").then(i)}},{name:"v-48365a59",path:"/v2.0.0/deneyalani/genel-bilgiler.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-48365a59").then(i)}},{name:"v-d8bdee46",path:"/v2.0.0/deneyalani/hhs-yos-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-d8bdee46").then(i)}},{name:"v-b537e5f2",path:"/v2.0.0/deneyalani/ileri-tarihli-odeme-emri-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-b537e5f2").then(i)}},{name:"v-35eaf572",path:"/v2.0.0/deneyalani/odeme-emri-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-35eaf572").then(i)}},{name:"v-5a2e0d7d",path:"/v2.0.0/deneyalani/olay-bildirim-api.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-5a2e0d7d").then(i)}},{name:"v-aa99c1f6",path:"/v2.0.0/deneyalani/test.html",component:Nn,beforeEnter:(e,n,i)=>{yn("Layout","v-aa99c1f6").then(i)}},{path:"*",component:Nn}],Dn={title:"(HVPS) API LKE VE KURALLARI",description:" ",base:"/",headTags:[],pages:[{title:"DEME HZMETLER VER PAYLAIM SERVSLER (HVPS)",frontmatter:{},regularPath:"/",relativePath:"README.md",key:"v-90050004",path:"/",content:" DEME HZMETLER VER PAYLAIM SERVSLER (HVPS) \n API LKE VE KURALLARI   \n SRM 2.0.0 aktif srmdr. \n https://github.com/ohvps/ohvps.github.io/commits/master  adresi zerinden deiiklik aklamalar ve tarihesi incelenebilir. \n \n SRM 1.1.0 gei tarihleri u ekildedir. \n \n \n HHS/YS rolnde Sertifikasyona Geli Son Tarihi : 1 Austos 2025 \n \n \n HHS rolnde retime Gei Son Tarihi : 1 Eyll 2025 \n \n \n SRM 2.0.0 gei tarihleri u ekildedir. \n \n \n Srm Gei Tarihi : 1 Austos 2025 \n \n \n HHS(1.1.0dan 2.0.0'a geecek olan ve direkt 2.0.0a gelecek olan) Sertifikasyon Balang Tarihi :  1 Eyll 2025 \n \n \n HHS(1.1.0dan 2.0.0a geecek olan, direkt 2.0.0a gelecek olan) Yeni Srm retime Gei Balang Tarihi : 1 Ekim 2025 \n \n \n YS(1.1.0dan 2.0.0'a geecek olan ve direkt 2.0.0a gelecek olan) Sertifikasyon Balang Tarihi : 1 Ekim 2025 \n \n \n HHS(1.1.0dan 2.0.0a geecek olan) Sertifikasyon Biti Tarihi : 16 Ocak 2026 \n \n \n HHS(1.1.0dan 2.0.0a geecek olan) Yeni Srm retime Gei Son Tarihi: 1 Mart 2026 \n \n \n YS(1.1.0dan 2.0.0'a geecek olan ve direkt 2.0.0a gelecek olan) Yeni Srm retime Gei Balang Tarihi : 1 Mart 2026 \n \n \n YS(1.1.0dan 2.0.0a geecek olan) Sertifikasyon Biti Tarihi : 15 Mays 2026 \n \n \n YS(1.1.0dan 2.0.0'a geecek olan ve direkt 2.0.0a gelecek olan) Yeni Srm retime Gei Son Tarihi : 1 Haziran 2026 \n \n \n Eski Srmn(1.1.0) Kaldrlma Tarihi : 1 Haziran 2026\n \n \n \n NEML BLGLENDRME : 31 Aralk 2025 tarihinde gei zorunluluu olan HHSlerin 1 Austos 2025 tarihinden sonra Srm 2.0.0 sertifikasyonuna gelmesi durumunda en ge 31 Aralk 2025 tarihine kadar sertifikasyon srecini tamamlayarak retime gemeleri gerekmektedir. \n YSlerin sadece kendilerinin destekledikleri API srmn destekleyen HHSleri listelemesi gerekmektedir. \n 1.1.0 srm iin hesap bilgisi rzas ve deme emri rzas oluturmak isteyen YS kurumu iin YOS API ierisinde apiBilgileri olarak \"ODS\" tanm HHS tarafndan kontrol edilmelidir. YS'n ilgili tanm olmamas halinde rza isteinde \"TR.OHVPS.Resource.APIVersionNotSupported\" hatas verilmelidir. \n Srm Ynetimi  blmnden tarih bilgilerinin aklamalarna ulalabilir. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n "},{title:"Dijital Czdanlardan TR Karekod ile deme",frontmatter:{},regularPath:"/dijital-cuzdan.html",relativePath:"dijital-cuzdan.md",key:"v-61b42a93",path:"/dijital-cuzdan.html",headers:[{level:2,title:"1.      Dijital Czdana Kart Ekleme Ak",slug:"_1-dijital-cuzdana-kart-ekleme-aks"},{level:2,title:"2. Uyum Tarihi",slug:"_2-uyum-tarihi"}],content:" Dijital Czdanlardan TR Karekod ile deme \n Dijital czdanlara eklenmi ve czdan sahibi kuruluun kendisinin ihra etmedii, dier Kart karan Kurulular tarafndan ihra edilmi kartlar ile TR Karekod demesi yaplabilmesi iin HHS olarak GETe balanm olan Kart karan Kurulularn,  BKM (Kartl demeler) TR Karekod Teknik lke ve Kurallar Rehberinde  yer alan 5.2 maddelerindeki belirtilen aklar iin BKM Karekod Ynlendirme Sistemi (KYS) entegrasyonu yapmas gerekmektedir.  \n Bu sayede Kart karan Kurulular, otorizasyon ncesinde ilemin POSta Kart PINi ile dorulanmasn veya mterinin telefonunda ykl olan Kart karan Kurulua ait mobil uygulamaya anlk bildirim gndererek dorulanmasn salayabilecektir. HHS olarak GETe balanm olan Kart karan Kurulular iin de bu dorulama aklarndan en az birini hayata geirmesi zorunludur. \n 1.      Dijital Czdana Kart Ekleme Ak \n Dijital Czdanlardan deme yaplabilmesi iin kullanclarn ilk olarak kart Dijital Czdana eklemesi gerekmektedir. Dijital Czdana eklenecek olan karta ait bilgiler kullanc tarafndan czdana girilmektedir. Kart bilgilerinin Dijital Czdana eklenmesinin ardndan kart hamili iki faktrl dorulama yntemi (GO Gvenli de, 3D Secure  vb.) ile dorulanmas gerekmektedir.  Kart hamilinin iki faktrl dorulanmasnn ardndan kart czdana eklenir ve eklenen bu kartlar ile deme ilemleri yaplabilir. Dijital Czdanlarla yaplabilen ilemler aada bilgi amal zetlenmitir. Bu belgenin Uyum Tarihi balnda TR Karekod ile yaplan ilemler iin kullanlacak dorulama aklarna yer verilmitir. \n \n \n Dijital czdanlar ile fiziksel maazalarda POS terminali zerinden, e-ticaret sitelerinde ise online kanallar zerinden  deme yapmak mmkndr. \n \n \n Fiziksel demelerde dijital czdan POS terminallerinde gsterilen TR Karekodu okuyarak demeyi gerekletirebilir. kinci bir yntem olarak, mobil telefonun ve dijital czdann NFC teknolojisini desteklemesi durumunda telefonun POS terminaline temassz olarak okutulmas suretiyle deme yaplabilmesi mmkndr. \n \n \n E-ticaret demelerinde web sitesinde gsterilen TR Karekodun dijital czdan ile okutulmas suretiyle deme yaplmas mmkndr. Sanal POS ilemlerinden kastedilen dijital czdanda sakl olan kart ile online kanallar zerinden bir e-ticaret demesinin yaplmasdr. \n 2. Uyum Tarihi \n Dijital czdan sahibi kurulu ile czdana eklenen kart kuruluunun farkl olmas durumunda hem fiziki POSlarda hem de sanal POSlarda TR Karekod ile deme yaplabilmesine ilikin aklar BKM (Kartl demeler) TR Karekod Teknik lke ve Kurallar Rehberinde 5.2. maddelerinde tariflenmitir. \n Bu aklarda; \n \n \n No-CVM (lave dorulama yapmadan) veya  \n \n \n Kart PIN (POS cihaznda kart ifresi girilerek) veya  \n \n \n Anlk Bildirim ile (mobil telefonda ykl olan kart karan kurulua ait uygulama zerinden ile mteri dorulamas yer almaktadr.) mteri dorulamas yer almaktadr. \n \n \n Kurulularn tercihine gre yukarda tariflenmi olan aklardan biri veya tamam kurulular tarafndan desteklenebilir. Kurulularn tercih ettii aklar iin Karekod Ynlendirme Sistemi sertifikasyonlarn tamamlanmas gerekmektedir. Yukarda tariflenmi aklarda grlecei zere kart karan kurulular otorizasyon ncesinde kendi risk deerlendirmesini yaparak No cvm ilave bir dorulama yntemine gerek kalmadan da ilemleri sonlandrlmasn isteyebilmektedir. \n ** 31.12.2023 tarihinden nce HHS olarak GETe balanm olan Kart karan Kurulularn  BKM (Kartl demeler) TR Karekod Teknik lke ve Kurallar Rehberinde  yer alan madde 5.2de tarifli ak/aklar iin Karekod Ynlendirme Sistemi sertifikasyonunun tamamlanarak en ge  30 Haziran 2024  tarihinde retime gemi olmas zorunludur. \n Nezdinde deme hesab bulunduran Kart karan dier tm deme Hizmeti Salayclarn da GETe balant salamalar sonras ilk 6 ay ierisinde KYS sertifikasyonunu tamamlamas gerekmektedir.** \n"},{frontmatter:{},regularPath:"/pages/contact.html",relativePath:"pages/contact.md",key:"v-64dca03d",path:"/pages/contact.html",content:" Trkiye Cumhuriyeti Merkez Bankas\nohvps@tcmb.gov.tr\n \n"},{title:"Ska Sorulan Sorular",frontmatter:{},regularPath:"/sorulan-sorular.html",relativePath:"sorulan-sorular.md",key:"v-6465b33d",path:"/sorulan-sorular.html",content:" Ska Sorulan Sorular \n 1) HVPS kapsamnda Hesap Bilgisi Hizmeti ve deme Emri Balatma Hizmetini kullanabilmemiz iin hangi artlarn salanmas beklenmektedir? \n \n Hesap Hizmeti Salayclar(HHS) ve Yetkilendirilmi deme Hizmeti salayclarnn(YS) HVPS kapsamnda salmas gereken artlar iin TCMBnin yaynlad kanun ve ynetmeliklerin incelenmesi gerekmektedir. lgili linkte yer alan  https://ohvps.github.io/uyum-tarihleri.html  referans adreslerinin incelenmesini neririz. \n TCMB tarafndan lisans sreciniz balatldnda gelitirmelerinizde yardmc olmak adna BKM bavuru yapan Kurum/Kurululara test hesab tanmlanmakta ve ilgili alanlara yetki alman iin gerekli ynlendirme yaplmaktadr. \n HVPS kapsamnda;\n \n Lisans srecini yrten Kurum/Kurulularn BKM tarafndan BKM HVPS Teknik Sertifikasyon Onay Belgesi almas gerekmektedir. \n Lisans almas gerekmeyen Kurum/Kurulularn retime gemeden nce BKM HVPS Teknik Sertifikasyon Onay Belgesi almas gerekmektedir. \n \n \n \n 2) BKM HVPS Teknik Sertifikasyon Onay Belgesi nedir, nasl alnr? \n \n BKM HVPS Teknik Sertifikasyon Onay Belgesi,  https://ohvps.github.io/ da yaynlanan teknik artlarn yerine getirilecek ekilde gelitirme yaplmas ve Trip/Tripsit zerinden paylalan sertifikasyon senaryolarnn test ortamnda simulator zerinden koularak onaya gnderilmesi sonras BKM tarafndan yaplan kontrollerin olumlu olmas sonucunda verilen belgedir. Teknik sertifikasyon belgesi alnabilmesi iin katlmclarn ncelikle sertifikasyona gelmeleri gerekmektedir. Sertifikasyon srecine ait detayl bilgiler Tripsit> BKM Online> HVPS> Dokmanlar mens altnda yer almaktadr. \n \n 3) Elektronik Para Kurulular ve deme Kurulular olarak HHS olma zorunluluumuz var mdr? \n \n TCMB tarafndan yaynlanan kanun ve ynetmeliklerde bu bilgi yer almaktadr. Kanun, ynetmelik, tebli vb. aadaki sayfadan ulaabilirsiniz. \n \n https://www.tcmb.gov.tr/wps/wcm/connect/25571f4f-72ac-4f4b-ab59-2d683fcbc271/Y%C3%B6netmelik.pdf?MOD=AJPERES&CACHEID=ROOTWORKSPACE-25571f4f-72ac-4f4b-ab59-2d683fcbc271-pntoxwf  55. Sayfa \n \n Elektronik Para Kurulular ve deme Kurulularnn HHS uyum tarihleri,  https://ohvps.github.io/uyum-tarihleri.html , adresinde yer almaktadr. \n \n 4) EPK ve/veya K olarak HHS ve YS sertifikasyonuna ayn anda gelme zorunluluumuz bulunmakta mdr? \n \n API dokmannda da belirtildii zere Banka rolndeki HHSler HHS olmadan YS olamazlar. Ancak EPK/Klar iin byle bir zorunluluk bulunmamaktadr. Ek olarak, API ilke ve kurallar dokmannda bulunan tm hizmetlerin (HHSler mevcut kanallarnda bu hizmetleri sunuyorsa ak bankaclk kapsamnda da sunmalar gerekmektedir.) HHSler tarafndan sunulmas gerekmektedir. YSler hangi lisans alacaklarsa HBH ve BH hizmetleri ayr ayr ya da beraber olacak ekilde sertifikasyona gelebilirler. \n \n 5) deme Hizmetleri Veri Paylam Servisleri API lke ve Kurallarna nereden eriebiliriz? \n \n https://ohvps.github.io/ adresinden eriebilirsiniz. \n \n 6) HVPS API srm gei tarihlerine nereden ulaabiliriz? \n \n https://ohvps.github.io/  adresinden ulaabilirsiniz. \n \n 7) Yatrm Bankas olarak sertifikasyona gelmemiz gereken son tarih bilgisi nedir? \n \n https://ohvps.github.io/uyum-tarihleri.html  uyum tarihleri paylalmtr. Buradan sizin iin belirtilen tarih araln baz alabilirsiniz. \n \n 8) Henz Ak Bankaclk kapsamnda herhangi bir almada bulunmam/ yeni sertifikasyona gelecek olan bir banka olarak sertifikasyona geleceimiz son tarih bilgisi konusunda bizlere destek olabilir misiniz? \n \n https://ohvps.github.io/uyum-tarihleri.html  uyum tarihleri paylalmtr. Buradan sizin iin belirtilen tarih araln baz alabilirsiniz. \n \n 9) Simlatrn mobil uygulamas bulunmakta mdr? Var ise uygulamay nasl indirebiliriz? \n \n Evet, BOSS mobil uygulamamz bulunmaktadr. Trip/Tripsit > BKM Online > HVPS > Dokmanlar ksmndan admlar takip ederek indirebilirsiniz.\nAyrca Trip / Tripsit > Dokmanlar blmndeki  SMLATR KULLANIMI VE SERTFKASYON SRE KILAVUZU  bu belgenin de sreler iin incelenmesi gerektii tavsiye edilmektedir. \n \n 10) HVPS APIlarnn entegrasyonu iin hangi admlar ile ilerlemeliyiz? \n \n \n HVPS API gelitirmeleri iin BKM olarak simlator ortam sunulmaktadr. Simlatr ortamna eriim iin test entegrasyonu salanmaldr. Entegrasyon iin aadaki admlar takip edilmelidir. \n \n Yeni Kayt ve Gncelleme ilemine dair sreler  https://pys-preprod.bkm.com.tr   adresi zerinden yaplacaktr. Mevcut durumda PYS giri yetkisi olan katlmclar Tripsit'e giri yaptklar kullanc ad ve ifresi ile giri yapabilir. \n lgili adrese eriimler ak olup katlmclar Tripsite  https://tripsit.bkm.com.tr  giri yaptklar kullanc ad ve ifresi ile girebilecektir. \n HHS, YS test ortam tanmlarna ait menler iin yetki alnmas gerekmektedir. lgili yetkiler iin kurumunuza zg olan sper kullancdan yetki talep edilmelidir. Sper kullanc sreleri ile PYS zerinde ilgili hizmetlerin yetkilerine dair dokmanlar Trip/Tripsit > BKM Online > HVPS ierisinde yer almaktadr.\n \n Ek-1: Merkezi Kullanc Ynetim Sistemi Uygulama Kurallar-ubat 2025 \n Ek-2: Parametre Ynetim Sistemi Ak Bankaclk YS ve HHS Yetki Talebi Klavuzu \n \n \n \n Kurumunuza ait en az iki sper kullanc bulunmaktadr. Sper kullancnz zerinden yetki talebinde bulunabilirsiniz. Yetki talebi verildikten sonra kurumunuzdaki dier sper kullanc tarafndan isteiniz onaylanmaktadr. Eer kurumunuza ait sper kullanclarnz bulunmuyor ise destek@bkm.com.tre mail atlarak yetki talep edilmelidir. \n \n \n 11) stemci sertifikas talebini nereden yapabiliriz? \n \n stemci Sertifikas Talep Ekran  sadece yetkili kii tarafndan seilerek gnderilmelidir. Yetkili kii Trip/Tripsit > BKM Online > HVPS > Dokmanlar mens altndan ulaabilir. \n \n 12) Mesaj imzalama sreleri nasl olmaldr? \n \n https://ohvps.github.io/v2.0.0/contents/ekler.html#ek-5-mesaj-imzalama-ak%C4%B1s%C4%B1  detayl bilgiye eriebilirsiniz. \n \n 13) Sertifikasyona gelmeden nce yaplmas gerekenleri paylaabilir misiniz? \n \n HHS rolnde sertifikasyona gelmeden nce  tm hizmetler iin Test Otomasyon altrlarak baarsz senaryolar dzeltilmelidir.\n \n Ekranlarda gsterilmesi gerekli tm alanlar Trip/Tripsit > HVPS > Dokmanlar > HVPS Srm 2.0 Sertifikasyon Senaryolar Aktarm Toplants dokmannda yer almaktadr. lgili dokman incelenerek ekran tasarmlar tasarlanmaldr. Dokmanda ekranda gsterilmesi gereken zorunlu alanlar belirtilmektedir. Ekranlarda istenilen artlar yerine getirildii srece ekran tasarmlar kurum/kurulularn insiyatifine braklmtr. \n \n \n YS rolnde ise  Ekranlarda gsterilmesi gerekli tm alanlar Trip/Tripsit > HVPS > Dokmanlar > HVPS Srm 2.0 Sertifikasyon Senaryolar Aktarm Toplants dokmannda yer almaktadr. ncelenerek ekran tasarmlar tasarlanmaldr. Dokmanda ekranda gsterilmesi gereken zorunlu alanlar belirtilmektedir. Zorunlu alanlarn tek ekranda gsterilmesine gerek bulunmamaktadr. Ekranlarda istenilen artlar yerine getirildii srece ekran tasarmlar kurum/kurulularn insiyatifine braklmtr. \n Sertifikasyon onay iletilmeden en az bir ay ncesinde sertifikasyon slot talebi ekranndan slot tarihi alnmaldr. Sertifikasyon slot talebi ekranna  https://sertifikasyon-preprod.bkmtest.com.tr/certification-slots  adresinden eriim salayabilirsiniz.\nAlm olduunuz slot tarihinden en az  i gn ncesinde sistem zerinden sertifikasyon onay iletmeniz beklenmektedir. \n Sertifikasyon kontrolleri sonrasnda sizlere geri bildirimlerde bulunulur. Tm revizeler tamamlandktan sonra sertifikasyon onay verilir ve retime gei iin planlama yaplr. \n \n 14) Kurum/Kurulu olarak mobil kanallardan mterimize hizmet vermemekteyiz. Bu kapsamda sertifikasyonda sadece web aklarn iletebilir miyiz? \n \n Sertifikasyon srecinde mobil ve web sertifikasyonlar ayr iletilmektedir. Bu kapsamda mevcut durumda hangi kanal zerinden mterilere hizmet sunuluyorsa sadece o hizmet kapsamnda sertifikasyona gelebilirsiniz. \n \n 15) Bireysel segmentte mobil ve web kanallarnda hizmetimiz bulunurken Kurumsal mteri zelinde sadece web kanalnda hizmetimiz bulunmaktadr. Bu kapsamda Kurumsal mteriler iin sadece web akn destekleyebilir miyiz? \n \n Sertifikasyon srecinde mobil ve web sertifikasyonlar ayr iletilmektedir. Bu kapsamda mevcut durumda hangi servisi destekleniyorsa ya da hangi kanal zerinden mterilere hizmet sunuluyorsa sadece o hizmet kapsamnda sertifikasyona gelebilirsiniz. \n \n 16) Sertifikasyon onay istei oluturmak iin nasl bir yol izlemeliyiz? \n \n Tm seritifkasyon sreleri ile ilgili bilgiler Tripsit>BKM Online> HVPS > dokmanlar mens altnda paylalmaktadr. Bu srele ilgili yine destek alabileceiniz Sertifikasyon Merkezi > HVPS Sertifikasyon Bilgilendirme mens altnda sertifikasyon sreci ile ilgili video kayd bulunmaktadr. Gerekli video kaydna  https://sertifikasyon-preprod.bkmtest.com.tr/certification-ohvps-info link zerinden eriim salayabilirsiniz.\nBu alanlardaki belgeleri ve video kaytlarn inceleyerek destek alabilirsiniz. Simlatr zerinden sertifikasyon senaryolarnn kapsam d hari hepsinin tiklenerek onaya gnderilmesi gerekmektedir. \n \n 17) Sertifikasyon slot tarihine yetiememe durumu ile karlalalrsa nasl ilerlemeliyiz? \n \n Sertifikasyon slot tarihine yetiilemedii durumda bir sonraki uygun sertifikasyon tarihinin katlmc tarafndan tekrar talep edilmesi gereklidir. \n \n 18) Sertifikasyon iin koulmas gereken senaryolara nereden ulaabiliriz? \n \n Aadaki link zerinden eriim salayabilirsiniz.\n https://sertifikasyon-preprod.bkmtest.com.tr/certification-rules \n \n 19) Sertifikasyon senaryolarnn hepsi koulmal mdr? Bireysel ve kurumsal iin ayr sertifikasyona gelinebilir mi? \n \n Kapsam d olduunuz tm senaryolar hari hepsi koulmaldr. \n HHS Sertifikasyonlar iin bireysel ve kurumsal birlikte koularak gnderilmelidir. YS sertifikasyonlar iin hangi mteri segmentine hizmet verilecekse ilgili mteri segmenti iin ayr olarak sertifikasyona gelinebilir. \n Mobil ve Web Kanallar iin ayn altyap (backend-arkayz) kullanlyor ise sertifikasyonda web ve mobilin tek bir sertifikasyonda koulmas gerekmektedir. Detaylar  SMLATR KULLANIMI VE SERTFKASYON SRE KILAVUZU unda yer almaktadr. \n \n 20) Sertifikasyon senaryolar koulurken nelere dikkat edilmelidir? Ekranlar nasl olmaldr? \n \n Sertifikasyon iin  https://ohvps.github.io/  adresinde yaynlanan API lke ve Kurallar dokmanndaki teknik gereksinimleri yerine getirmeniz beklenmektedir. \n Web/mobil ekranlar iin sertifikasyonda iletilmesi gereken zorunlu alanlar bulunmaktadr. Bu alanlar iin Trip/Tripsit > BKM Online > HVPS >Dokmanlar mens altnda yer alan Mteri Deneyim Dokmann inceleyebilirsiniz. Ekranlarda istenilen artlar yerine getirildii srece ekran tasarmlar kurum/kurulularn insiyatifine braklmtr.\nSertifikasyona gelmeden nce ekranlar son kullancya gsterilecek ekilde hazrlanmaldr. \n \n 21) Sertifikasyon onay istei nasl oluturabiliriz? \n \n Tripsit >BOSS> Sertifikasyon Onay Oluturma seilerek sertifikasyon ekranna eriim salanr. Sertifikasyon Onay stei Oluturma ekran ile katlmclar ilgili APIye ait sertifikasyon senaryolar kapsamndaki ilemlerini tamamladktan sonra sertifikasyon isteklerini bu ekran zerinden iletebilirler. Bu ekran zerinden ekran grnts ekleme, senaryonun kapsam dna alnmas gibi ilemler yaplabilmektedir. Sertifikasyon sonular da yine bu ekran zerinden takip edilebilir.\nDetaylar  SMLATR KULLANIMI VE SERTFKASYON SRE KILAVUZU unda yer almaktadr.  Bu srele ilgili yine destek alabileceiniz video kayd bulunmaktadr. \n \n 22) Sertifikasyon onay istei oluturdum. Balatld statsnde kald. Yardmc olabilir misiniz? \n \n Sertifikasyon talebinde bulunulduunda seilen tarih aralndaki log kaytlar ekilerek otomatik olarak altrld statsne gemektedir. Sizin altrdnz tarih aralnda log kayd olup olmad kontrol edilmelidir. HHS senaryolar koulurken X-Group-ID seiminin yapld kontrol edilmelidir. \n \n 23) Sertifikasyon onay istei oluturdum. Senaryolar tiklenmedi. Kontrol edebilir misiniz? \n \n Sertifikasyon onay oluturulduktan sonra ilgili sertifikasyon id iin Detay seilmeli ve senaryonun neden tiklenmedii Hata Gr kolonundan kontrol edilmelidir. \n \n 24) HVPS Simlatrlerini kullanarak gelitirmelerimizi tamamladk. retim ortamna gei iin neler yaplmas gerekir? \n \n retim ortamna ait entegrasyon iin gerekli bilgilere aadaki dokmanlardan ulaabilirsiniz.\nTrip/Tripsit  BKM Online  HVPS dokmanlar ierisinde yer almaktadr.\nBKM Geit - HVPS Uygulama Kurallar_Ver1.11\nDokman ierisinde zellikle incelenmesi gereken ilgili balklar:\n \n \n \n Katlmc Gereksinimleri \n \n \n \n \n Entegrasyon Admlar \n \n \n \n \n retime Gei \n \n \n \n \n \n retim ortam YS ve HHS BKM GET entegrasyonlar https://pys.bkm.com.tr adresi zerinden yaplacaktr.\nlgili adrese eriimler ak olup katlmclar Tripe ( https://trip.bkm.com.tr ) giri yaplan kullanc ad ve ifresi ile girilebilecektir.\nHHS ve YS tanmlarna ait menler iin yetki alnmas gerekmektedir. lgili yetkiler iin kurumunuza zg olan Superuser kullanclardan yetki talep edilmelidir.\nSuperuser sreleri ile PYS zerinde ilgili hizmetlerin yetkilerine dair dokmanlar Trip/Tripsit  BKM Online  HVPS dokmanlar ierisinde yer almaktadr.\nEk-1: Merkezi Kullanc Ynetim Sistemi Uygulama Kurallar-ubat 2025\nEk-2: Parametre Ynetim Sistemi Ak Bankaclk YS ve HHS Yetki Talebi Klavuzu \n 25) HVPS APIlarna ait swagger dosyas bulunmakta mdr? \n \n Evet bulunmaktadr. HVPS > HHS/YS Simlatr ekranna gidilerek alan sayfada istenilen API seilir ve Swagger Dokmann ndir seilerek indirebilir. \n \n 26) HVPS API lke ve Kurallar dokmannda yaplan deiiklikleri nereden grebiliriz? \n \n https://ohvps.github.io/  adresine gidildiinde ana sayfada yer alan  https://github.com/ohvps/ohvps.github.io/commits/master  adresi zerinden deiiklik aklamalar ve tarihesi incelenebilir. \n \n 27) Gelitirmeler srasnda dokman ile simlatr arasnda fark grldnde hangisi dorudur? Nasl ilerlemeliyiz? \n \n Simlatr ortam katlmclarn API gelitirmelerini test edebilmesi iin oluturulmu sandbox ortamdr. Baz gelitirmeler katlmclarn test edebilmesi iin simlatr tarafnda esnek braklmtr. Bu yzden her zaman dokman dikkate alnmaldr. Simlatrn gelitirilmesi iin farkll bizlere iletebilirsiniz. \n \n 28) Ak Bankaclk kanal ayarlar her kullancya default olarak ak m olmaldr? \n \n Ak Bankaclk mteriye bir kanal olarak sunuluyorsa mterinin kanal ayarn ap kapatabilecei bir ekran olmas gerekmektedir. retim ortamna ilk kldnda default olarak ak olmaldr. Mteri dilerse kendi kapatabilmelidir.   https://ohvps.github.io/v1.1.0/contents/temel-prensipler.html  temel prensipler bal altndan inceleyebilirsiniz. \n \n 29) Sadece web uygulamamz zerinden HVPS APIlarn kullanmak istiyoruz. Sorun olur mu? \n \n HHS olunan rolde tarayc tabanl ynlendirme yaplmas zorunlu olmakla beraber 1 Ekim 2023 itibaryla HHSnin uygulamas varsa uygulama tabanl ynlendirme hizmeti vermesi de zorunludur. \n \n 30) Daha nce sorulan katlmc sorularna nereden ulaabiliriz? \n \n Trip/Tripsit > BKM Online > HVPS > Dokmanlar mens altndan ulaabilirsiniz. \n \n 31) HVPS retim ortam katlmclarnn iletiim adreslerine nereden ulaabiliriz? \n \n Trip/Tripsit > BKM Online > HVPS > letiim Listesi altndan bulabilirsiniz. Bu menye eriim salayamyorsanz  destek@bkm.com.tr  adresinden yetki talep edebilirsiniz. \n \n 32) Sertifikasyon iin yeni srm olan V 2.0.0 srmne gelmek zorunda myz? Eski srm ile sertifikasyona gelebilir miyiz? \n \n 1 Eyll 2025 tarihinden sonra sertifikasyon talebinde bulunan tm katlmclarn V 2.0.0 aktif srmne gelme zorunluluu bulunmaktadr.\nMevcutta 1.1.0 srm ile retim ortamnda hizmet veren katlmclarn V 2.0 iin hangi tarihlerde sertifikasyona gelecei ve retime gei yapaca bilgisi  https://ohvps.github.io/  linkinde yer almaktadr. \n \n 33) Srm 2.0 sertifikasyonunu almak iin Srm 1.1 sertifikasyonunu almak gerekiyor mu? Ak bankaclk sistemine 2.0 versiyonu ile dahil olunabilir mi? \n \n HVPS kapsamnda ilk kez sertifikasyona gelecek olan kurumlar aktif srm olan 2.0 srm ile sertifikasyona gelmeleri yeterlidir. Sertifikasyon senaryolar listeleme ekrannda versiyon gncelleme seeneini semeden hizmet verecek kanal ve mteri baznda senaryolar listlemeli ve ilgili senaryolar koarak sertifikasyona gelmelidir. \n \n 34) Ayrk GKD bilgilendirme mesaj kullancya iletilmezse sreci nasl ynetebiliriz? \n \n \n Mterinin ne ekilde bilgilendirilecei HHS inisiyatifindedir. Aada paylam olduumuz linkte detayl bilgi yer almaktadr. Linkte yer alan detaya istinaden HHS olarak ilemi red etmeniz uygundur. YS olarak ise hata alm bir ayrk GKD ilemini ynlendirmeli aka evirip tekrar iletebilirsiniz. \n https://ohvps.github.io/v2.0.0/contents/gkd.html#_5-2-ayr%C4%B1k-guclu-kimlik-dogrulama \n \n \n 35) Ayrk GKD sadece mobil uygulamaya m bildirim gnderilebilir? Sms ierisinde webe ynlenecek universal link verebilir mi? \n \n Ayrk GKD srecinde HHS tarafnda sadece mobil uygulama zerinden GKD yaplmaldr. HKnn web uygulamasna ynlendirme yapmamas gerekmektedir. SMS iletilecekse sms ierisindeki universal link sadece mobile ynlendirilmelidir.  https://ohvps.github.io/v2.0.0/contents/gkd.html#_5-2-ayr%C4%B1k-guclu-kimlik-dogrulama  adresinden detayl inceleyebilirsiniz. \n \n 36) Mevcut sistemimizde GSM birden fazla mteride tanmldr. Bu noktada Ayrk GKD Tek seferlik deme aknda hangi mteriye bildirim gnderilmesi gerektiini ayrt edemeyeceimizden sorun oluturmaktadr. Bu nedenle GSM iin muafiyet talep edilebilir mi? \n \n Mevcut durumda ilgili cep numarasna nasl bildirim gnderiliyorsa ayn yntem izlenebilir. (Yetkili kii atamas yaplabilir vs.) \n \n 37) Hesap Bilgisi Hizmeti ve deme Emri Balatma Hizmeti aklarnda default olarak ynlendirmeli ak tercih edilebilir mi? Yoksa ayrk GKD sunan HHSler iin, YSn de ayrk GKDyi tercih etmesi zorunlu mudur? \n \n YSn kendi insiyatifindedir.  https://ohvps.github.io/v2.0.0/contents/gkd.html#_5-2-ayr%C4%B1k-guclu-kimlik-dogrulama  detayl bilgiye eriebilirsiniz. \n \n 38) Kurumumuzun YS olduu durumda kar HHS Ayrk GKD'yi desteklese dahi kullancda HHS'ye ait mobil uygulama olmad takdirde nasl ilerlememiz beklenmektedir? \n \n https://ohvps.github.io/v2.0.0/contents/gkd.html#_5-2-ayr%C4%B1k-guclu-kimlik-dogrulama  adresinden detayl senaryolar inceleyebilirsiniz. \n \n 39) YS olduumuz durumda ayrk GKD kimlik dorulama web akndan balayabilir mi yoksa mobil uygulamada olma zorunluluu var mdr? \n \n Her iki kanaldan ilem balatlabilmektedir. \n \n 40) Yeni srm (V 2.0) kapsamnda Olay Bildirim Servislerinin kullanlmas zorunlu mudur? \n \n Olay Dinleme APInn (ODS) servis olarak sunulmas HHS ve YSler iin zorunludur. Olay Abonelik Servislerinin (OAS) kullanm YS insiyatifindedir. YS, Ayrk GKD yntemi kullanacaksa ise AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin de abonelik oluturulmas gerekir.  https://ohvps.github.io/v2.0.0/contents/olay-bildirim.html  detayl inceleyebilirsiniz. \n \n 41) Sertifikasyon senaryolar ierisinde yer alan sistem olay dinlemeyi nasl test edebiliriz? Bu konuda ynlendirebilir misiniz? \n \n Kullanm olduunuz YS simlatr iin Tripsit zerinden gncelleme yaplmas salanarak HHS tarafna sistem olay dinleme kayd oluturabilirsiniz. \n \n 42) HVPS API kullanmlar iin cretlendirme olacak mdr? cretlendirme kapsamnda nasl bir yol haritas izlenecektir? \n \n Sorgulama ynteminin ne ekilde devam edecei YS'n inisiyatifindedir. API sorgulamalar zerinden cret alnmaya devam edecektir. Olay bildirimi ile YS'lerin api sorgulamas arasnda bir balant olmamakla beraber TCMB'nin belirledii tarihten itibaren cretlendirme devreye alnacaktr. \n TCMB'nin daha evvel bilgi verdii cretlendirme ierii ile ilgili detaylar nmzdeki gnlerde Trip>HVPS dokmanlar altnda yer alan HVPS Uygulama Kurallar Dokmannda detaylandrlacaktr. \n \n 43) Olay Bildirim devreye alndktan sonra bankalarn sorgulamalar devam edebilecek mi, o sorgulamalardan cret alnabilir mi? \n \n Sorgulama ynteminin ne ekilde devam edecei YS'n inisiyatifindedir. API sorgulamalar zerinden cret alnmaya devam edecektir. Olay bildirim ile YS'lerin api sorgulamas arasnda bir balant olmamakla beraber TCMB'nin belirledii tarihten itibaren cretlendirme devreye alnacaktr. \n \n 44) Sertifikasyonu tamamlayarak retim ortamna gei yaptktan sonra hizmet vermeyi durdurabilir miyiz? Evet ise, ne kadar sre ile hizmet vermeyebiliriz? \n \n HHS olunan rolde hizmet durdurulmas gibi bir durum sz konusu deildir. \n \n 45) BKM Ak Bankaclk Deney Alan Nedir? \n \n Ak Bankaclk Deney Alan, HVPS (deme Hizmetleri Veri Paylam Servisleri) kapsamndaki ak bankaclk hizmetlerinin katlmclar (HHS ve YS) ve katlmc olmayan kurulular ve finansal teknoloji giriimleri tarafndan belirli erevelerde deneyebilecei, test amal kullanlan ak simlatrlerin bulunduu bir test ortamdr. lgili alana  https://ohvps.github.io/v2.0.0/deneyalani/genel-bilgiler.html  linkinden eriebilirsiniz. \n \n 46) Ak Bankaclk Kurumsal Bankaclk tarafnda tzel kiilerin hesaplarnn yetkilendirilmesi (mnferit/mterek) nasl yaplmal, nereden bilgi alabilirim? \n \n Tzel taraftaki Mteri yetkileri iin BKM tarafnda bir ynlendirme yaplamamaktadr. Banka iinde bu kiilerin neye yetkisi varsa HVPS kapsamnda da ayn mteri deneyimini yanstacak ekilde zm retmeniz beklenir. \n \n 47) FAST katlmcs olan kurumlarn HHS olma zorunluluu bulunmakta mdr? Nezdinde deme hesab bulunduran kurulular HVPS kapsamnda HHS olarak hizmet verme zorunluluu bulunuyor mu? \n \n HVPS API ilke ve Kurallar dokmannda da ifade edildii zere, Ynetmelik ve Teblide yaplan 28 Mart 2025 tarihli deiiklik itibaryla;\n \n FAST Sistemine katlmc olan deme hizmeti salayclarnn 31 Aralk 2025 tarihine kadar teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.) \n \n \n \n 48) HHS 1.1 srm tamamlanamadysa, yalnzca HHS 2.0 iin hazrlanan senaryolar altrmak yeterli olur mu? \n \n S1.1 ile retim ortamnda hizmet verilmiyor ise sertifikasyon senaryolarn listelerken versiyon gncelleme semeden (en batan tm senaryolar koulacaktr) S2.0 sertifikasyonuna gelinmelidir. \n \n 49) Test otomasyon admn sertifikasyon ncesi test sreci olarak adlandrabilir miyiz? Bu adm zorunlu bir admdr m? \n \n HHS'lerin S2.0 sertifikasyonunu geebilmeleri iin test otomasyon admn baarl bir ekilde tamamlamalar beklenmektedir. Sertifikasyon Onay stei altrldktan sonra onaya gnderme aamasnda altrlan test otomasyon id bilgileri talep edilmektedir. \n \n 50) Slot (zaman dilimi) iinde yaplan incelemeler sonucunda sertifikasyon baarsz olursa ve yeniden koulmas istenirse, yeni bir slot alnmas gerekir mi? Yeni bir slot bulunamazsa ne tr bir yol izlenmelidir? \n \n Revize sreleri kapsamnda tekrardan slot alnmasna gerek yoktur. Sadece ilk kez sertifikasyon onay gnderilecek durum iin slot alnmas gereklidir. \n \n 51) Sertifikasyon senaryolar ve test otomasyon testleri slot tarih aralnda m ncesinde mi koulacaktr? \n \n Slot tarihi seritifikasyon kontrollerinin gerekletirilecei tarih olup bu kapsamda slot tarihinden nce sertifikasyon onay ve test otomasyon koumu gerekletirilmelidir. \n \n 52) Demo kontrolleri iin nce sertifikasyon onay alnmas m gerekmektedir? \n \n Demo, retim ortamnda gerekletirilen; sistemlerinizin baarl alp almadnn kontrol yaplan uygulamadr. Bu kapsamda, nce sertifikasyon onay alnmas arttr. \n \n 53) deme emri test otomasyonu senaryosunda KOLAS ya da Ayrk GKD desteklemeyen bir katlmc ne yapmal? \n \n HHS'lerin FAST katlmc olma art bulunduu iin KOLAS desteklenmesi beklenmektedir. Eer mobil uygulamanz var ise yine Ayrk GKD desteklenmesi gerekiyor. Bu artlarn dnda farkl bir durumunuz var ise desteklemediiniz aklar otomasyonda komayabilirsiniz. \n \n 54) Kurum olarak mevcut yapmzda kart hizmeti vermediimiz durum iin kartlarla ilgili senaryolar ve admlar atlayabilir miyiz? \n \n HHS olarak ilgili hizmet desteklenmiyor ise kapsam d aklamas girerek kapsam dna alabilirsiniz. YS olarak dilediiniz hizmet ve zellik iin sertifikasyona gelebilirsiniz. \n \n 55) Kurumsal bir firmayz bireysel hesaplarmz bulunmamaktadr. Buna istinaden sertifikasyon isteimizi kurumsal/web olarak talep ettik ancak HHS olarak bireysel mteriler iinde bir sre komal myz? \n \n Mevcutta HHS rol iin hangi kanal ve mteri tipi zerinden hizmet veriliyorsa ak bankaclk kapsamnda da ilgili hizmetler verilmelidir. YS rol iin herhangi bir zorunluluk bulunmamaktadr. \n \n 56) leri tarihli deme ve dzenli deme hizmetleri zorunlu mudur? Bu hizmetlerden muaf olunabilir mi? \n \n HHS olarak mevcut durumda kendi kanallarnzdan vermi olduunuz hizmetleri HVPS kapsamnda da vermek zorundasnz. \n \n 57) Mevcut olmayan bir zellii sonradan eklersek nasl sertifikasyona gelmemiz gerekecek? rnein sonradan kurumsal eklemesi yapld. \n \n Sadece ilgili senaryolar iin tekrar sertifikasyona gelmeniz beklenmektedir. \n \n 58) HHS olarak banka olmayan bir kurulu sertifikasyona girdiinde deme servislerinde Kolas ve QR ile deme gibi yntemleri muaf olabilir mi? \n \n Kurumunuzun mevcut yapsnda ilgili servisler desteklenmiyor ise kapsam dna alabilirsiniz. \n \n 59) YS olarak daha nce mobil sreleri devreye almadmz durumda 2.0.0 kapsamnda da muaf olabilir miyiz? S2.0 kapsamnda mobil zorunlu mudur? \n \n YSler iin kanal zorunluluu bulunmamaktadr. Sertifikasyona dilediiniz kanaldan gelebilirsiniz. \n \n 60) YS olarak alnacak kart bilgileri ve hareketleri iin uygulamamzda kullancya bir kart grseli gstermek zorunda myz? Kart grseli gstermesek olmaz m? \n \n Kart grseli iin belirlenmi olan standartlar bulunmaktadr. Sertifikasyon dokmanlarndan ilgili bilgiye eriebilirsiniz. \n \n 61) Asl kart sahibi ek karta da rza verebilir mi? \n \n \n HHS ekranlarnda kart seimi yaplarak rza verilirken asl kart seilmeden ilgili asl karta bal sanal ve ek kartlarn ayrca seilerek rza verilmesine izin verilmemelidir. HHS mevcut kanallarnda ek ve sanal kart hareketlerini asl karttan ayrt etmeden mterisine gsteriyor ise asl kart seimi ile birlikte asl karta bal sanal ve/veya ek kart seimini zorunlu klmaldr. Asl kart hamili dnda bir kii iin ek kart kartld durumda ek kart sahibi HHS'de asl kart grmeyecek olduundan sadece kendisine kartlan ek kart listelenecek ve seerek rza vermesi salanacaktr. Ek kart hamilinin asl kart hamilinden farkl olduu durumda asl karta ait bir rza olmasa da ek karta rza verilebilir. \n Detayl bilgi iin  https://ohvps.github.io/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-9-adim-4-kart-bilgilerinin-sorgulanmas%C4%B1 . \n \n \n 62) YS ortamnda ayn anda hem hesap hem de kart rza izni verilebiliyor mu? Rza izinleri 1-6 ve ek olarak 7-9 gibi ayr gruplar halinde mi sunuluyor; bu izinler ayr ayr m gnderilmeli? \n \n Hesap ve kart izinleri alnmak isteniyor ise ayn anda hesap rza istei verilmelidir. YS olarak sadece hesap ya da kart hizmeti de sunabilirsiniz. \n \n 63) Hesaba rza verilip karta verilmedii durumda HHS rolnde rza altnda tm kartlar grntlenecek midir? \n \n Hayr, sadece hesap iin izin trleri iletildi ise HHS tarafndan sadece hesaplar listelenmelidir. YS zerinden iletilen izin trleri kapsamnda hesaplar listelemelidir. \n \n 64) Hesap bilgisi gncelleme aknda, daha nce hesap rzas vermi bir mteri ayn ilem srasnda kartlara da rza verebilir mi? \n \n Evet, belirttiiniz ekilde yaplabilmektedir. Ancak mteriye mevcut rzadaki bilgiler default gsterilmeli; mteri istedii kartlar da ekleyebilmelidir. \n \n 65) Hem Hesap zni Hem de kart iznini veren bir kullanc kart zelinde iznini kaldrdnda / yenilediinde hesap izni de kaldrlacak m? Yoksa hesap izni devam edecek mi? \n \n Hesaplar ve kartlar iin tek hesap bilgi rzas zerinden izin verilmektedir. Kullanc sadece kartlara iznini kaldrr, hesap iin devam etmesini istiyor ise hesap izinleri devam edecektir. \n \n 66) Kart numarasnn deitii durumda (Kayp/alnt sebebiyle A kartnn B kart numarasna dnd durum) mterinin kartna verdii rza devam etmeli mi? \n \n Kart ref ID deimedii srece mevcut rza devam etmelidir. \n \n 67) Talimat Durumu statleri servisten mi dnmektedir, dier HHSlerden bu bilgi alnacak mdr? \n \n T'de deme durumu yer almaktadr. DT'de de deme plan ierisinde deme durumu yer almaktadr. API dokmann inceleyebilirsiniz. \n \n 68) Kart Detay servisindeki kalanToplamTaksitTutari parametresi iin kredi kart mevcut yapmzda YP (yabanc para) ilemlerde taksitli ilem bulunmad durumda ilgili alanda dnlmesi gereken bilgi nedir? \n \n YP'de taksit zmnn olmamas durumunda bu alann 0 olarak dnmesi beklenecektir. \n \n 69) Dzenli tekrarl demelerde deme plan ierisinde bulunan herhangi bir tekil deme, dzenli deme rzasndan bamsz ekilde dzenlenebilecek midir? \n \n HHS'ler deme plannda gncelleme yaplabilir; gncelleme yapld bilgisi olay bildirimi ile YSe iletilmelidir. \n \n 70) Kart hareketleri raporunda Dnem Taksit Tutar ifadesi, ilgili dneme giren taksitli ilemlerin toplamn m ifade etmektedir? \n \n lgili dnem deeri ierisindeki toplam taksit tutar bilgisi iletilmelidir. \n \n 71. Kart durumu \"Pasif\" olacak kartlar iin hangi durumlar dahil etmeliyiz? Blokeli olan ve geici kapal olan kartlar da \"pasif\" olarak m deerlendirilmelidir? \n \n Tekrar aktif/ak hale gelme ihtimali olan kartlar pasif kart olarak deerlendirilmelidir. \n \n 72) Dzenli deme Emri iin YS ekranndan kullancdan hangi bilgiler alnmaldr? Tutar, tarih veya transfer skl (Haftalk/Aylk) seilecek midir? Yoksa tm bilgiler HHS zerinden mi YS'lere gelecek? \n \n Talimat tutar dahil talimata dair tm bilgiler HHS ekranlarndan alnacak olup, HHS ekranlarndan gncelleme yaplabilecektir. \n \n"},{title:"DEME HZMETLER VER PAYLAIM SERVSLER (HVPS)",frontmatter:{},regularPath:"/surum-yonetimi.html",relativePath:"surum-yonetimi.md",key:"v-22024c43",path:"/surum-yonetimi.html",content:" DEME HZMETLER VER PAYLAIM SERVSLER (HVPS) \n API LKE VE KURALLARI SRM YNETM  \n OHVPS API lke ve Kurallar dokmanndaki srm bilgileri aadaki kurallara gre belirlenmektedir. \n \n \n Srmler 3 basamakl kodla belirlenir. Srm deiiklikleri basamak srasna gre Major deiiklikler, Minr deiiklikler ve Patch deiiklikleri olarak sralanr. rnein  Srm 1.0.0 zerinde yaplacak major deiiklik Srm 2.0.0 olarak ifade edilirken, Minr deiiklik Srm 1.1.0 olarak ifade edilir. Patch deiiklik ise Srm 1.1.1 olarak ifade edilir. \n \n \n Major deiiklikler: \na. Srmn 1. basama proje kapsamndaki major deiiklikleri ifade eder. Bu major deiiklikler ; \n Kredi kart aklar, tekrarl ilem aklar gibi kapsama yeni aklarn eklenmi olmas, \n  Eski hizmetlerin alamaz hale getirilmesi, \n API desenlerinde deiiklik olmas ve geriye ynelik destein sona ermesidir. \nb. Major deiiklikler, ncelikle API standartlarnn taslak srmne eklenir. Paralelinde simlatr gelitirmelerine balanr.  Simlatrde ilgili deiikliin hayata geirilecei tarih ayrca katlmclarla paylalr. \nc. Major deiiklikler snrl bir set ya da tm set ile sertifikasyona tabiidir. \nd. Simlatr tek bir major ya da minr srm destekler. \ne. Simlatrn destekledii srm zerinden sertifikasyon yaplr. \nf. API Standartlarnda major  Srm Gei Tarihinin  duyurusu TCMB tarafndan yaplr. \ng. Katlmclarn  HHS/YS Yeni Srm retime Gei Son Tarihi  yine TCMB tarafndan belirlenir ve duyurulur. Bu tarihe kadar katlmclarn sertifikasyonlarnn tamamlanmas beklenir. \n \n \n Minr deiiklikler:    \na. Srmn 2. basama proje kapsamndaki minr deiiklikleri ifade eder. Bu minr deiiklikler ; \n Kural deiiklikleri, \n API desenlerinde olabilecek opsiyonel alan deiiklikleri, \n Sral veri trlerine yeni deerlerin eklenmesi, \n GKD srecinde deiiklik yaplmas, \n API desenlerinde deiiklik olmas ve geriye ynelik destein devam etmesi, \n Yeni bir endpoint eklenmesidir. \nb. Deiiklik kapsam TCMB tarafndan belirlenir. \nc. Bu basamakta yaplan deiikliklerin tmnn sertifikasyona tabi olmas gerekir. Ancak deiikliin boyutuna gre snrl bir set ya da tm deiiklik seti ile sertifikasyon senaryolar oluturulur. \nd. Geriye dnk destek bittii noktada srm deeri artar. \ne. Major ve minr deiikliklerin srm ynetimi ayn akla iletilir. \n \n \n Patch deiiklikler: \n a. Srmn 3. basama proje kapsamndaki patch deiiklikleri ifade eder. API desenlerinde bir deiiklik yaratmayan i kural deiiklii rnek olabilir. \n b. Patch deiiklikler sonras katlmclarn yeniden sertifikasyon yapmalar gerekmemektedir. \n \n \n lk defa sertifikasyona gelecek kurumlar en son aktif srm ile sertifikasyona gelir. \n \n \n API Endpointlerde yaplacak major ve minor deiiklikler, endpointin pathi ierisinde yer alr. Detayl bilgi  3.5.\tKaynak URI Yol Yaps  adresinde yer alr.  \n \n \n Srm geilerinde kullanlan tarih bilgileri u ekildedir: \n \n \n \n Srm Gei Tarihi  : \n \n Yeni API Standart srmnn yaynland tarih bilgisidir.\n \n API Standartlar taslak srm, gncel srm haline getirilir. \n Simlatrde yaplan gncellemeler development ortamndan, katlmclarn kullanmnda olan Tripsit ortamna aktarlr. \n Tripsit ortamnda katlmclar hem simlatr hem de kendi uygulama testlerine balayabilir. \n \n \n \n Sertifikasyona Balang Tarihi  : \n \n HHS ve YS'ler iin ayr olarak iletilecek tarih bilgisidir. \n \n HHS Yeni Srm retime Gei Son Tarihi / YS Yeni Srm retime Gei Balang Tarihi   : \n \n Bu tarihe kadar HHS'lerin sertifikasyonu tamamlayp baar ile gemesi gerekir. Bu tarihten nce sertifikasyonu tamamlayan HHS'ler retime geer. \n Bu tarih HHS'lerin retime geii iin tanmlanm son tarih olduu iin, bu tarihte tm HHS'ler retime gemi olacaktr. YS'ler bu tarihten itibaren retime geie balar. \n BKM tarafndan yaplmas gerekecek API srm deiiklii varsa bu tarihte yayna alnr.(HHS-YS API gibi) \n \n YS Yeni Srm retime Gei Son Tarihi  : \n \n YS'lerin sertifikasyon sreci, YS Yeni Srm retime Gei Balang Tarihinden, YS Yeni Srm retime Gei Son Tarihine kadar srer. \n Mevcut YS'ler yeni srm en ge bu tarihte retim ortamna alr. \n \n Eski Srmn Kaldrlma Tarihi  : \n \n HHS'ler; HHS Yeni Srm retime Gei Son Tarihi ile Eski Srmn Kaldrlma Tarihi arasnda iki servis srmn de desteklemek zorundadr. \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n "},{title:"DEME HZMETLER VER PAYLAIM SERVSLER (HVPS) UYUM TARHLER",frontmatter:{},regularPath:"/uyum-tarihleri.html",relativePath:"uyum-tarihleri.md",key:"v-81b8a67a",path:"/uyum-tarihleri.html",content:" DEME HZMETLER VER PAYLAIM SERVSLER (HVPS) UYUM TARHLER \n Hesap Hizmeti Salayclar ve Yetkili deme Hizmeti Salayclarn HVPS standartlarna uyumu iin tarihler, deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelik ile deme ve Elektronik Para Kurulularnn Bilgi Sistemleri le deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Teblide belirlenmitir. \n Ynetmeliin 59 uncu maddesinin beinci fkrasnda belirlenen ykmllkler, nezdinde deme hesab bulunduran ve bu hesaplar iin mterilerine dorudan evrim ii eriim imkn salayan hesap hizmeti salayclarndan \n \n Fonlarn Anlk ve Srekli Transferi (FAST) Sistemine katlmc olan deme hizmeti salayclar ile \n FAST Sistemine katlmc olmayan kurululardan her yl ayrca hesaplanmak zere deme hacmi bakmndan ilk on arasnda yer alanlar\niin geerlidir. \n \n Kapsamda yer alan Hesap Hizmeti Salayclar iin Ynetmelik ve Teblide HVPS uyum tarihleri aadaki ekilde belirlenmitir: \n \n \n FAST Sistemine katlmc olmayan deme hizmeti salayclarnn, katlmc olmalar halinde, katlmc olduklar tarihten itibaren 6 ay ierisinde teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \n \n FAST Sistemine katlmc olmayan deme ve elektronik para kurulularndan her yl ayrca hesaplanmak zere bir nceki takvim ylnda gerekleen ilemlere gre deme hacmi bakmndan ilk on arasnda yer alan ve; \n \t    Nezdinde bulunan deme hesaplar iin mterilerine dorudan evrim ii eriim imkn salayan kurulularn, iinde bulunulan yln sonuna kadar teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \tNezdinde bulunan deme hesaplar iin mterilerine dorudan evrim ii eriim imkn salamayan kurulularn ise, iinde bulunulan yl sonuna kadar evrim ii eriim imkn salamalar halinde evrim ii eriim imkn saladklar tarihten itibaren 6 ay ierisinde teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \n \n Ynetmelik ve Teblide yaplan 28 Mart 2025 tarihli deiiklik itibaryla; \n \tFAST Sistemine katlmc olan deme hizmeti salayclarnn 31 Aralk 2025 tarihine kadar teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \tFAST Sistemine katlmc olmayan ve 2024 takvim yl deme hacmi bakmndan ilk on arasnda yer alan kurululardan; \n \n \n Nezdinde bulunan deme hesaplar iin mterilerine dorudan evrim ii eriim imkn salayanlarn 31 Aralk 2025 tarihine kadar teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \n \n Nezdinde bulunan deme hesaplar iin mterilerine dorudan evrim ii eriim imkn salamayanlarn 2025 yl sonuna kadar evrim ii eriim imkn salamalar halinde evrim ii eriim imkn saladklar tarihten itibaren 6 ay ierisinde teknik sertifikasyonlarn baaryla tamamlayarak GETe balant salamalar gerekmektedir (HHSleri ilgilendirmektedir.). \n \n \n FAST Sistemine katlmc olmayan ve 2024 takvim yl deme hacmi bakmndan ilk 10 arasnda yer alan kurulular aadaki gibidir: \n \n \n \n Kurulu Kod \n Kurulu Unvan \n \n \n \n \n 0855 \n Elekse Elektronik Para ve deme Kuruluu A.. \n \n \n 0853 \n UPT deme Hizmetleri ve Elektronik Para A.. \n \n \n 0850 \n BPN deme ve Elektronik Para Hizmetleri A.. \n \n \n 0830 \n D deme Elektronik Para ve deme Hizmetleri A.. \n \n \n 0852 \n N Kolay deme ve Elektronik Para Kuruluu A.. \n \n \n 0863 \n Paytr deme ve Elektronik Para Kuruluu A.. \n \n \n \n \n \n \n \n 6493 Sayl Kanunun Geici 3 nc maddesinin nc fkras uyarnca TCMBye faaliyet izni bavurusunda bulunmu olup faaliyet izni sreci devam edenler ile TCMBden faaliyet izni alm olan Kurululara teknik gereklilikleri belirlenmi veri paylam hizmetleri, standart olmayan servislerle 30 Haziran 2024 tarihine kadar sunulabilir. (HHSleri ilgilendirmektedir.) \n \n \n 6493 Sayl Kanunun Geici 3 nc maddesinin nc fkras uyarnca TCMBye faaliyet izni bavurusunda bulunmu olup faaliyet izni deerlendirme sreci devam edenler, teknik gereklilikleri belirlenmi veri paylam hizmetlerini, 30 Haziran 2024 tarihine kadar standart olmayan servisleri kullanarak verebilir. (YSleri ilgilendirmektedir.) \n \n \n 5411 sayl Kanun kapsamndaki bankalar ile teknik gereklilikleri belirlenmi veri paylam  hizmetlerini sunmak zere TCMBden izin alm olan kurulular (YSler), TCMB deme Sistemlerinde 2020 yl ierisinde gerekletirilen hesaba deme ilemleri asndan, toplam adedine gre ilk on katlmc arasnda yer almayan deme hizmeti salayclar nezdinde bulunan deme hesaplar ile ilgili olarak, teknik gereklilikleri belirlenmi veri paylam servisleri hizmetlerini 30 Haziran 2024 tarihine kadar standart olmayan servisleri kullanarak verebilir. (YSleri ilgilendirmektedir.) \n \n \n Teknik gereklilikleri henz belirlenmemi veri paylam servisi hizmetleri, gereklilikler belirleninceye kadar standart olmayan servisler kullanlarak verilmeye devam edilir. Banka tarafndan teknik ve operasyonel gerekliliklerin belirlenmesinin ardndan bu hizmetler iin de en ge bir yl ierisinde uyum salanarak, hizmetler sz konusu gerekliliklere uygun olarak yrtlmeye balanr. \n \n \n Referanslar: \n 6493 Sayl deme ve Menkul Kymet Mutabakat Sistemleri, deme Hizmetleri ve Elektronik Para Kurulular Hakknda Kanun   \n deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelik   \n deme ve Elektronik Para Kurulularnn Bilgi Sistemleri le deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebli \n"},{title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",frontmatter:{},regularPath:"/v1.0.1/contents/ekler.html",relativePath:"v1.0.1/contents/ekler.md",key:"v-48317b86",path:"/v1.0.1/contents/ekler.html",headers:[{level:2,title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",slug:"ek-1-istek-cevap-mesajlarnda-kullanlacak-nesne-yaplar"},{level:2,title:"EK-2: Sral Veri Trleri",slug:"ek-2-sral-veri-turleri"},{level:2,title:"EK-3: stemci Sertifikalarnn Tanm ve Ynetimi",slug:"ek-3-istemci-sertifikalarnn-tanm-ve-yonetimi"},{level:2,title:"EK-4: Sunucu Sertifikalar",slug:"ek-4-sunucu-sertifikalar"},{level:2,title:"EK-5: Mesaj mzalama Ak",slug:"ek-5-mesaj-imzalama-aks"},{level:3,title:"mzalama Kurallar (YS)",slug:"imzalama-kurallar-yos"},{level:2,title:"EK-6: HHS/YS API Mimarisi",slug:"ek-6-hhs-yos-api-mimarisi"}],content:' EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar \n Ak Bankaclk simlatr uygulamas zerinde swagger dkmanlarnn gncel srmlerine eriim salanabilir. \n EK-2: Sral Veri Trleri \n \n \n \n Kod \n Aklama \n \n \n \n \n TR.OHVPS.DataCode.KimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) Y , YKN , N11 P , PNO , AN7..9 \n \n \n TR.OHVPS.DataCode.KurumKimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) V , VKN , N10 \n \n \n TR.OHVPS.DataCode.OhkTur \n Kod: B: Bireysel  K: Kurumsal \n \n \n TR.OHVPS.DataCode.KolasTur \n Mterinin sorgulama istedii Kolay Adres Tipi deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr: T: Telefon Numaras E: E-Posta K: TCKN V: VKN Y: YKN P: Pasaport Numaras \n \n \n TR.OHVPS.DataCode.KareKodAksTur \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  01: FAST katlmcsndan dinamik dorulamal hizmet alnan iyeri demesi 02: FAST katlmcsndan statik dorulamal iyeri demesi 03: Kiiden kiiye demeler \n \n \n TR.OHVPS.DataCode.OdemeKaynak \n I: nternet bankaclndan gnderilen demelerde kullanlr. A: Otomatik para makineleri (ATM) ile gnderilen demelerde kullanlr. T: Telefon bankacl ile gnderilen demelerde kullanlr. K: Kiosklar araclyla gnderilen demelerde kullanlr. S: ubeden girilen demelerde kullanlr. M: Mobil uygulamadan gnderilen demelerde kullanlr. D: Yukardakiler dndaki deme kaynaklarndan gnderilen demelerde kullanlr.  O: Ak bankaclk aracl ile gnderilen demelerde kullanlr. \n \n \n TR.OHVPS.DataCode.OdemeAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi \n \n \n TR.OHVPS.DataCode.OdemeDurumu \n demenin durumunu gsterir. Alabilecei deerler: 01: Gerekleti (deme ilgili deme sistemine iletildi ve alc hesabna ulat.)  02: Gnderildi (deme ilgili deme sistemine iletildi ancak alc hesabna ulatna dair teyit alnmad.)lemin son durumunun teyidi iin YS sorgulama yapmaldr. 03- Gereklemedi (demenin ilgili deme sistemine iletiminde veya ilenmesi srasnda hata, zaman am, sistemin gn sonu ilemlerine balamas vb. durum olutu ve deme gereeklemedi veya iade edildi.) 04- Onayda bekliyor (deme emri alnd. oklu onay aknn tamamlanmas bekleniyor.) 05- leme Alnd ( deme emri alnd. ) YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu 02-Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS sorgulama yapmaldr. \n \n \n TR.OHVPS.DataCode.IslemAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Dier \n \n \n TR.OHVPS.DataCode.RizaDurumu \n B: Yetki Bekleniyor Y: Yetkilendirildi K: Yetki Kullanld E: Yetki deme Emrine Dnt S: Yetki Sonlandrld I :Yetki Iptal \n \n \n TR.OHVPS.DataCode.GkdTur \n GKD yaplmasn gerekli bulduu durumda HHS, YSn belirledii yntemi dikkate alarak kendi belirledii GKD yntemini bildirir: Y: Ynlendirmeli GKD A: Ayrk GKD \n \n \n TR.OHVPS.DataCode.RizaTip \n H: Hesap Bilgisi Rzas O: deme Emri Rzas \n \n \n TR.OHVPS.DataCode.IzinTur \n 01: Temel Hesap Bilgisi 02: Ayrntl Hesap Bilgisi 03: Bakiye Bilgisi 04: Temel lem (Hesap Hareketleri) Bilgisi 05: Ayrntl lem Bilgisi \n \n \n TR.OHVPS.DataCode.OdemeSistemi \n lemin ynlendirildii deme Sistemine gre aadaki deerlerden birini alabilir: H: Havale F: FAST E: EFT (PS) deerlerinden birini alabilir. \n \n \n TR.OHVPS.DataCode.IslemTuru \n Hesap hareketleri (ilemler) sorgusunda dnlen lem Tr (islTur) parametresi aadaki deerlerden birini alabilir: HAVALE EFT FAST PARA_YATIRMA PARA_CEKME YABANCI_PARA_HAVALE YATIRIM_HESABINA_AKTARIM YATIRIM_HESABINDAN_AKTARIM KURUM_FATURA_ODEMESI CEK SENET SIGORTA_ODEMESI UCRET_KOMISYON_FAIZ SGK_ODEMESI VERGI_ODEMESI DOVIZ_ALIM DOVIZ_SATIM KREDI_ODEMESI KREDI_KULLANIM KK_ODEMESI KK_NAKIT_AVANS SANS_OYUNU UYE_ISYERI_ISLEMLERI HGS_OGS_ISLEMLERI DOGRUDAN_BORCLANDIRMA_SISTEMI DIGER \n \n \n TR.OHVPS.DataCode.HspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.KolasHspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.HspTip \n Hesap eidini belirtir: VADESIZ VADELI KREDILI MEVDUAT HESABI POS CEK YATIRIM \n \n \n TR.OHVPS.DataCode.HspDrm \n Hesabn durumunu belirtir: AKTIF PASIF KAPALI \n \n \n TR.OHVPS.DataCode.YetTip \n Alabilecei deerlere gre hangi belirtecin dneceine karar verilir. yet_kod yenileme_belirteci \n \n \n TR.OHVPS.DataCode.BrcAlc \n lemin hesab borlandrd ya da alacaklandrd bilgisidir. B : Bor A : Alacak \n \n \n TR.OHVPS.DataCode.RizaIptDtyKod \n 01 :Yeni Rza Talebi ile ptal 02 :Kullanc stei ile HHS zerinden ptal 03 :Kullanc stei ile YS zerinden ptal 04 :Sre Am : Yetki Bekleniyor 05 :Sre Am : Yetkilendirildi 06 :Sre Am : Yetki demeye Dnmedi 07 :GKD iptali : Ayn rza no ile mkerrer arm 08 :GKD iptali : Rzano ile TCKN uyumamas 09 :GKD iptali : Uygun rn bulunmuyor 10 :GKD iptali : HHS Ak Bankaclk kanal ileme kapal 11 :GKD iptali : Hesap Yetki Sorunu 12 :GKD iptali : HK HHS mterisi deil 13 :GKD iptali : HK HHS kontrollerini aamad 14 :GKD iptali : Baarsz GKD 15 :GKD iptali : HK istei ile GKDden vazgeildi 16 :GKD iptali : Dier \n \n \n TR.OHVPS.DataCode.PSUInitiated \n E : Evet H : Hayr \n \n \n TR.OHVPS.DataCode.HHSYOSSrlmKrtr \n kod : Kod,unv : Unvan \n \n \n TR.OHVPS.DataCode. SrlmYon \n A: Azalan deerle sralama Y: Artan deerle sralama \n EK-3: stemci Sertifikalarnn Tanm ve Ynetimi \n YS rol ile gelen katlmclar BKM API Geidi eriimlerini kendileri ile BKM tarafndan nden paylalacak olan istemci sertifikalarn kullanarak salayacaklardr. \n Bu sertifikalar BKM bnyesinde oluturulacak ve eriimde bulunacak olan kuruma zel olarak hazrlanacaktr. Hazrlanan istemci sertifikalar gvenli FTP veya e-posta aracl ile nden ilgili kiiler ile paylalacaktr. \n Sertifika dorulama ilemi API Geidi zerinde yaplacak olup, istemci tarafnda web isteinin ilgili sertifika ile ilikilendirilerek oluturulmas gerekecektir. \n Uzun dnemli olarak hazrlanacak olan sertifikalar test, sertifikasyon ve retim ortamlarnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii bu aamalarda  snanacaktr. \n BKM API Geidi zmnn test ve retim ortamlar ayrmnda istemci sertifikalar, HHS Listeleme API eriimleri ve  Sertifikasyon balantlar ekil 15-HHS/YS API Mimarisi Diagramnda resmedilmitir. \n OpenSSL ile CSR (Certificate Signing Request) Oluturma \nAadaki komut ile 2048-bit RSA private key ve CSR oluturulur. \nopenssl req -new -newkey rsa:2048 -nodes -keyout PRIVATEKEY.key -out CSR.csr \n CSR ile ilgili detay bilgilerin giriinde; \nOrganization Unit Name (OU) olarak BKM tarafndan size iletilen clientId deeri, \nCommon Name (CN) olarak 4 karakterli yosKod deeri, \nDier alanlar iin de kurum bilgilerinize gre giri yaplr. \n Tm bilgilerin girilmesinden sonra CSR dosyas imzalanmak zere BKM ye iletilir. \n EK-4: Sunucu Sertifikalar \n Sunucu sertifikalarnn endpoint bilgisini (Fqdn) ierecek ve global bir Certification Authority tarafndan imzalanm olarak sunulmas gerekmektedir.\nrnein; entegrasyon formu ierinde yer alan URL bilgisinin (test.xbank.com.tr) sertifika ierisinde tanml olmas ve bu sertifikann global bir CA rnein Verisign tarafndan imzalanm olarak sunulmas gerekmektedir. \n EK-5: Mesaj mzalama Ak \n Dijital imzalama yaps, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini salamak amacyla kurgulanmtr.\nBu kapsamda imzalama ak aadaki gibi olmaldr: \n \n HHS ya da YS ncelikle zel ve ak anahtarlarn oluturmaldr. Bu anahtarlar oluturmak iin aada openssl kullanlarak oluturma rnei paylalmtr.  Bu anahtarlardan zel olan anahtar mesaj imzalamak iin kullanlacak olup, ak anahtar ise mesaj dorulamak amacyla mesajn alcs tarafndan kullanlacaktr. \n \n private_key.pem ve public_key.pem dosyasinin ierikleri kod tarafnda kullanlacaktr. \n --private.pem => zel anahtarn ismi\nopenssl genrsa -out private.pem 2048 \n --public_key.pem => Ak anahtarn ismi\nopenssl rsa -in private.pem -pubout -outform PEM -out public_key.pem \n --private_key.pem => zel anahtarn PCKS8 formatna evrilmesi (Java asndan PCKS8 formatnda olma ihtiyac nedeniyle) openssl pkcs8 -topk8 -inform PEM -in private.pem -out private_key.pem -nocrypt \n \n \n Ak ve zel anahtarlar oluturulduktan sonra Ak Anahtar BKM ile paylalr. BKM bu ak anahtar dier katlmclarn ulaabilmesi ve alabilmesi iin bir Anahtar Deposu yaklam ile bnyesinde tutar. lgili anahtar iletebilmek ve alabilmek iin kullanlacak HHS/YOS API ye eriim detaylar EK-6 blmnde detayl olarak paylalmtr.  Eer kurumun ilgili anahtar iftinin yenilenme durumu sz konusu ise yenilemenin hemen ardndan ak anahtar yeni bir imzalama yaplmadan nce mutlaka BKM ile paylalmaldr. \n \n \n mzal mesaj aacak olan kurum mesaj imzalayan kurumun ak anahtarn her sorguda yeniden almak durumunda deildir. Belirli periyodlarda kendi ortamndaki anahtar yenileyerek sistemi iletebilir. Ancak imzalayan kurum anahtar ifti yenilemesi yaptnda BKM ile ak anahtarn paylasa dahi imzal mesaj dorulayacak taraf eski ak anahtar ile dorulama yapmaya alt iin hata alacaktr. Bu ilk hata durumunda hzlca BKM zerinden yeni anahtar alp mesaj tekrar dorulamay denemelidir. Eer yine hata alyor ise dorulama ilemini hata statsne almaldr. Bu sebeple anahtar yenileyen kurum yeni ak anahtarn yeni bir mesaj imzalama yapmadan nce mutlaka BKM ile paylamaldr. \n mzalama Kurallar (YS) \n Bir YS zerinden balayan ak rnek olarak paylalmtr. \n \n \n YS, mesaj imzalama gerektiren her API isteinin HTTP gvdesini (request body) kendi zel anahtar ile ifreleyerek imza bilgisini oluturur. \n \n \n Ardndan bu imza verisini, gnderecei mesajn istek balnda yer alan X-JWS-Signature alannda gndermelidir. \n \n \n X-JWS-Signature alannda gnderilecek olan bilgi aadaki yntem ile oluturulmaldr. \n \n \n Bu alana yazlacak olan bilgi JWT formatnda oluturulmaldr. \n \n \n Bir JWT, header-payload-signature alanlarndan olumaktadr. \n \n Header alannda JWTyi imzalamak iin kullanlacak algoritma belirtilmelidir.  Standartlar kapsamnda RS256 kullanlacaktr. \n Payload ksmnda zel olarak oluturulacak olan body claim alanna istek gvdesi (request body) verisinin SHA256 hash deeri karl yazlmaldr. \n JSON payload oluturulurken RFC 7519 baz alnmaldr. "iss" (Issuer) Claim, "exp" (Expiration Time) Claim, "iat" (Issued At) Claim, body Claim alanlarnn gnderilmesi zorunludur. ^RFC7519 \na.\t"iss" (Issuer) Claim : Kurumunuza zel bilgidir. \nb.\t"exp" (Expiration Time) Claim: Saniye cinsinden (Unix time) imzann son geerli olduu tarih. \nc.\t"iat" (Issued At) Claim : Saniye cinsinden (Unix time) imzann oluturulduu tarih \nd.\tbody Claim : istek gvdesi (request body) verisinin SHA256 hash deeri karl. \n Signature alannda da zel anahtar ile imzalanm olan imza ierii yer alacaktr. \n \n X-JWS-Signature:   JWS imzasn ieren stbilgi. Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n rnek X-JWS-Signature Payload Deeri \n { \n"iss": "https://apigw.bkm.com.tr", \n"exp": 1646832405, \n"iat": 1646746005, \n"body": "c543072f97a761a1d891dc81acc380bc1e6f61ca6541bd93ebfdece338457922" \n} \n \n \n \n \n YS, istei gnderir. Sadece mesajn btnln ve doruluunu teyit amac ile istek gvdesi (request body) SHA256 hash deeri imzalanarak X-JWS-Signature alannda bu imza iletilir. stein gvde (request body) ksm ak ve ifresiz olarak gnderilmektedir. \n \n \n HHS, istei alr, talebi gerekletirmeden nce ald API isteklerinin imzasn dorulamaldr. X-JWS-Signature alanndaki JWT aadaki admlarla dorulanmaldr. \n \n Header ksmndaki algoritmanin RS256 olduu kontrol edilir. \n Gnderen kurumun ak anahtar ile JWT verify (dorulama) ilemi yaplr. \n Yukardaki ilemlerin doruluunun ardndan JWTnin payload ksmndaki body claim alanndaki bilginin, istein gvde verisinin SHA256 hash deerlerinin ayn olduu kontrol edilir. \n \n \n \n Yukardaki ilemler ile doruluu teyit edilmi olan istein talebi gerekletirir. \n \n \n Eer istek dorulanamyor ise gnderen kurumun ak ve zel anahtar ifti yenilenmi olabilir. \n \n \n BKM HHS API  zerinden ilgili kurumun bilgilerini (kurum kodu vs) kullanarak kurumun detay bilgileri eker ve kendi ortamnda yeniler. \n \n \n Ardndan imzay tekrar ak anahtar ile dorulayarak kontroller gerekletirilir. (Eer halen dorulama ilemi baarsz ise bu istek iin hata ak altrlr.  TR.OHVPS.Resource.InvalidSignature  kodu ile hata retilebilir.) \n \n \n mza bilgisinin beklendii (x-jws-signature) servislerde, bu bilginin iletilmedii durumlarda  TR.OHVPS.Resource.MissingSignature  hatas retilebilir. \n \n \n HHS istei iledikten sonra cevab olutururken de yukardaki aklar ile gnderecei cevab imzalamaldr. \n EK-6: HHS/YS API Mimarisi \n HHS/YS API Uygulama Mimarisinde Test ve retim ortamlarnda aadaki alanda yer almaktadr. \n \n ekil 15: HHS/YS API Mimarisi \n'},{title:"POST /erisim-belirteci",frontmatter:{},regularPath:"/v1.0.1/contents/erisim-belirteci.html",relativePath:"v1.0.1/contents/erisim-belirteci.md",key:"v-23bd824f",path:"/v1.0.1/contents/erisim-belirteci.html",content:' POST /erisim-belirteci \n STEK: \n YS erisim-belirteci eriim adresini 2 amala kullanr: \n \n \n Bir nceki admdan ald rizaNo, rizaTip (deme emri balatma hizmetinde O, hesap bilgisi hizmetinde H) ve GKD sonras dnlen yetKod bilgilerini kullanarak HHS nezdinde ErisimBelirteci nesnesi oluturmak zere istekte bulunur. YSn istekte bulunabilmesi iin GKD admnn baarl bir ekilde tamamlanmas rizaDrm bilgisinin yetkilendirildi olmas gerekir. Eriim Belirteci nesnesi ile rzas nesnesi (deme Emri Rzas veya Hesap Bilgisi Rzas) arasndaki iliki rza numaras zerinden salanr. \n \n \n Ald eriim belirtecinin Geerlilik Sresinin dolduu durumda, yenileme belirteci karlnda yeni bir eriim belirteci almas gerekmektedir. \n \n \n POST /erisim-belirteci isteinin (REQUEST) gvdesinde (BODY)  ErisimBelirteciIstegi nesnesi (Tablo-23) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda ErisimBelirteci nesnesi (Tablo 24) oluturulur veya (Yenileme Belirteci iin) gncellenir. Rza durumu Yetki Kullanld olarak gncellenir. \n Tablo 23: ErisimBelirteciIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Tipi \n rizaTip \n AN1 \n Z \n O veya H (TR.OHVPS.DataCode.RizaTip) \n \n \n Yetki Tipi \n yetTip \n AN1..50 \n Z \n yet_kod yada yenileme_belirteci deerini alabilir.  (TR.OHVPS.DataCode.YetTip) \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n K \n GKD ileminden dnen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. yetTip = yet_kod ise zorunludur. \n \n \n Yenilenme Belirteci \n yenilemeBelirteci \n AN1..4096 \n K \n Eriim belirtecinin yenilenmesi amacyla kullanlr. yetTip = yenileme_belirteci ise kullanm zorunludur. \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan erisimBelirteci nesnesinde (Tablo-19) bulunan eriim belirteci deeri deme emrinin balatlmas esnasnda kullanlr. \n Tablo 24: "ErisimBelirteci" nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Eriim Belirteci \n erisimBelirteci \n AN1..4096 \n Z \n Yetkilendirme Kodu karlnda HHS tarafndan dnlen ve sonraki hesap bilgisi ve deme emri servislerine eriimde kullanlan bilgidir. \n \n \n Geerlilik Sresi \n gecerlilikSuresi \n N1..9 \n Z \n Eriim Belirtecini saniye cinsinden geerlilik sresidir.  Eriim belirteci geerli olduu son tarih ; Hesap Bilgisi Rzas iin 30 gn olmaldr. Eriimin Geerli Olduu Son Tarih 30dan kk ise bu sre deeri ile snrldr. deme Balatma Rzas iin 5 dakika olmaldr. \n \n \n Yenileme Belirteci \n yenilemeBelirteci \n AN1..4096 \n Z \n Eriim belirtecinin yenilenmesi amacyla kullanlr. \n \n \n Yenileme Belirteci Geerlik Sresi \n yenilemeBelirteciGecerlilikSuresi \n N1..9 \n Z \n Yenileme belirtecinin saniye cinsinden geerlilik sresidir. Yenileme belirtecinin geerli olduu son tarih ; Hesap Bilgisi iin Eriimin Geerli Olduu Son Tarih ile snrl olmaldr. Bu tarih geldii zaman Hesap Bilgisi Rza Durumunu Yetki Sonlandrld statsne ekilmesi gerekir. deme Balatma iin Rza Oluturma Zamanndan 15 gn sonras olmaldr. 15 gn sresi sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. leri vadeli ilemler bu kapsamda deildir.  deme emri 5 dakika iinde gerekletirilmelidir. Gereklemediinde 4.2.8 blmnde aktarlan rza stat gncellemesi yaplmaldr. \n \n \n \n erisim-belirteci erisim noktasndan alnan elde edilen erisimBelirteci ilikilendirilii nesne veya ilem iin gnderilen POST istei balnda x-access-token alannda iletilir.\nYenilenme Belirteci (refreshToken) kullanlarak Eriim Belirteci (accessToken) alndnda, dnen yanttaki Yenileme Belirteci ve Yenileme Belirteci Geerlik Sresi deimez. \n Eriim Belirteci API arm srasnda rza durumlar kontrol edilmelidir. Bu kontrollerin nasl yaplmas gerektii 4-Rza Durumlar blmnde aktarlmtr. \n'},{title:"5.\tGl Kimlik Dorulama",frontmatter:{},regularPath:"/v1.0.1/contents/gkd.html",relativePath:"v1.0.1/contents/gkd.md",key:"v-822cf8c6",path:"/v1.0.1/contents/gkd.html",headers:[{level:2,title:"5.1.\tYnlendirmeli Gl Kimlik Dorulama",slug:"_5-1-yonlendirmeli-guclu-kimlik-dogrulama"},{level:2,title:"5.2.\tAyrk Gl Kimlik Dorulama",slug:"_5-2-ayrk-guclu-kimlik-dogrulama"},{level:2,title:"5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi",slug:"_5-3-yonlendirme-bildirim-adresleri-ve-durum-kodu-parametresi"},{level:2,title:"5.4\tHealthcheck API",slug:"_5-4healthcheck-api"},{level:2,title:"5.5  Gl Kimlik Dorulama Kontrolleri",slug:"_5-5-guclu-kimlik-dogrulama-kontrolleri"}],content:" 5.\tGl Kimlik Dorulama \n Mteri iin gl kimlik dorulama, HKnn (mterinin) kimliinin dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntemi tanmlar. \n deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebli uyarnca hesap bilgisi hizmetinde mterinin onaynn alnmas esnasnda ve deme emri balatma hizmetinde her bir deme emri balatma ileminde  HHS tarafndan mteriye gl kimlik dorulama (GKD) uygulanmas esastr.  Buna gre: \n \n \n Hesap bilgisi hizmetinde HKnn onaynn alnmas esnasnda  Tebliin 26 nc maddesinin 1 inci fkras uyarnca  HHS tarafndan HKya GKD uygulanr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 2 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanr ve ilem dorulama kodu ile HKnn onay alnr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 3 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanmasna ilikin istisna veya ilave gvenlik nlemleri ibu API lke ve Kurallar belgesinde tanmlanr. \n \n \n HHS, gl kimlik dorulama srecinde HKnin sahip olduu bileen snf olarak SMS OTP ya da SMS ile ilem dorulama kodu kullanabilir. \n \n \n HHS, aadaki hallerde veya  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre tek bileen ile kimlik dorulama yapabilir. \n \n demenin gndereni ve alcsnn ayn olmas, \n Daha nce tanmlanm gvenli alclar listesine deme yaplmas, \n HKnin talimatna istinaden gerekletirilen dzenli bir deme olmas. \n \n \n \n Tek bileen ile kimlik dorulama yaplan bu ilemlerle ilgili olarak gerekletirilen ilemin mteri tarafndan yapldn ispat etme ykmll HHSye ait olur. \n \n \n lem Dorulamada  Tebliin 3 nc maddesinin birinci fkras  bendindeki  ilem bilgisi tanmna uygun olarak aadaki bilgiler ile  Tebliin 3 nc maddesinin birinci fkras hh bendinde  tanmlanan ileme zel retilmi ilem dorulama kodu birlikte kullanlr. \n \n Alc Unvan (Kolas aknda maskeli olarak)  (deme emri balatma hizmeti) \n Tutar (deme emri balatma hizmeti) \n Referans bilgisi (8 karakterden kk ise alann tm deeri, byk ise ilk 4 ve son 4 hanesi) \n \n leme ait yukardaki bilgilerden en az biri deitii zaman  Tebliin 3 nc maddesinin birinci fkras hh bendinde  belirtildii gibi yeni bir ilem dorulama kodu retilecek ekilde ak kurgulanmaldr. \n \n \n lem dorulama kodunun gnderilmesinden HHS sorumludur. HHS,  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre ilem dorulama kodu kullanmakszn HKnn onayn alabilir. lem dorulama kodu kullanlmayan ilemlerle ilgili olarak gerekletirilen ilemin HK tarafndan yapldn ispat etme ykmll HHSye aittir. \n \n \n HVPS API standart kapsamnda iki adet Gl Kimlik Dorulama (GKD) yntemi kullanlacaktr: \n \n Ynlendirmeli (Redirect) GKD Yntemi \n Ayrk (Decoupled) GKD Yntemi \n \n \n \n HHS asgari olarak tarayc tabanl Ynlendirmeli GKD yntemini desteklemek zorundadr. \n \n \n ereve szleme kapsamnda olmayan tek seferlik deme ilemleri sadece Ynlendirmeli GKD yntemi ile gerekletirilebilir. \n 5.1.\tYnlendirmeli Gl Kimlik Dorulama \n Ynlendirmeli GKD Ynteminde, mteri kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir. \n Mteri HHSye (uygulama veya web arayz vastasyla) ynlendirildikten sonra mterinin gl kimlik dorulamas adm adm ve dorudan HHS ile mteri arasnda yrtlr. GKDnin tamamlanmasndan sonra mteri tekrar YS uygulamasna ynlendirilir. \n Ynlendirmeli GKD Yntemi iin st dzey rnek i ak aadaki admlardan oluur: \n \n YS, GKD iin HHS tarafndan tanmlanan arayze (tarayc ya da uygulama) ynlendirme yapar. \n Mteri, YS arayznden ayrlr, ynlendirildii HHS arayz zerinde kimlik dorulama ilemlerini gerekletirir. \n GKD tamamlandktan sonra mteri, YS arayzne tekrar ynlendirilir ve ilem sonucu grntlenir. \n \n Ynlendirmeli GKD iin temel gereklilikler unlardr: \n \n deme hizmeti (hesap bilgisi veya deme emri balatma hizmeti) tarayc ya da uygulama tabanl bir ekilde sunulabilir. Bu nedenle,  YS ve HHSlerin Ynlendirmeli GKD iin asgari olarak tarayc tabanl ynlendirme akn desteklemeleri gerekmektedir. \n ereve szleme (S) kapsamnda olmayan tek seferlik deme ilemleri sadece Ynlendirmeli GKD yntemi ile gerekletirilebilir. \n \n Tarayc Tabanl Ynlendirme \n HHSnin web arayzne, \n \n HHSnin mobil uygulamasnn olmad, \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) sunduu mobil cihazda HHS uygulamasnn ykl olmad, \ndurumlarda ynlendirme yaplr. \n \n YSn mobil uygulamas varsa mobil cihazda uygulamadan taraycya, YSn mobil uygulamas yoksa deme hizmetinin sunduu cihazda (Kiisel Bilgisayar veya Mobil Cihaz) tarayc zerinden ynlendirme yaplr. \n Uygulama Tabanl Ynlendirme \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) YSn mobil uygulamas ile kullanyorsa, ayn mobil cihazda HHSnin mobil uygulamasnn yklenmi olmas durumunda, HK dorulamasnn HHS mobil uygulamas tarafndan yaplmas iin uygulama tabanl ynlendirme yaplr. Bylece HK, deme hizmetine eriim iin HHSnin mobil kanalna eriim srasnda kulland dorulama yntemini ile dorulanabilir. \n Tablo 5: Ynlendirmeli Gl Kimlik Dorulama Kanallar \n \n \n \n Dorulama Yntemi \n YS Olas Ortam \n HHS Olas Ortam \n \n \n \n \n Tarayc Tabanl Ynlendirme \n Kiisel Bilgisayar (masast, dizst)/Mobil Cihaz \n Kiisel Bilgisayar (masast, dizst) / Mobil Cihaz \n \n \n Uygulama Tabanl Ynlendirme \n Mobil Cihaz \n Mobil Cihaz \n 5.2.\tAyrk Gl Kimlik Dorulama \n Ayrk GKD Yntemi i ak, Ynlendirmeli GKD Ynteminin ilem akna benzer. Fark, HHS'nin, evrimii arayznden bamsz olan herhangi bir uygulama veya cihaz araclyla deme ilemi ayrntlarn ieren bir anlk bildirim (push notification) gndererek mteriden kimlik dorulamas istemesidir. Ayrk GKD Yntemine dayal bir ilem iin (ok basitletirilmi) st dzey rnek bilgi ak u ekildedir: \n \n Mteri, YS arayznde ilemini balatr. \n YS, talebini mteriye ait TCKN, VKN, YKN gibi tekil tanmlayc kimlik numaras bilgisi ierecek ekilde HHSye iletilir. \n HHS tekil tanmlayc bilgisini kullanarak farkl bir cihaz veya uygulama zerinden mteriye anlk bildirim gnderir ve dorulama yaplmasn salar. Bu ekilde HHS kendi mobil uygulamasna eriim iin kullanlan dorulama yntemini aynen kullanabilecektir. \n YS, herhangi bir yere ynlendirme yapmadan ilemin sonucunu bekler, mteri YS arayznden ayrlmaz (arayz ayn kalr). \n Kimlik dorulama sonras, YS arayznde ilem sonucu grntlenir. \n 5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi \n CSRF Ataklarndan korunmak iin ve YS uygulamasnn bir nceki durumunu restore edebilmesi iin; YS tarafndan iletilen ynlendirme ve bildirim adreslerine , Oauth2 standartlarndaki state parametresine edeer,   durum kodu (drmKod)  parametresinin eklenmesi gerekmektedir. Durum kodu parametresi YS tarafndan retilen, tekil ve kolay tahmin edilemeyen bir deer olmaldr. Rza istei gnderimi aamasnda oluturulmaldr. YS uygulamasnda uygun bir yerde saklanmaldr (cookie, session, local storage gibi) . \n Durum kodu, rza isteindeki ynlendirme adresine parametre olarak eklenir.  GKD sreci sonrasnda yetki kodu ile birlikte bu bilgi, HHS tarafndan YSe iletilir. YS saklad deer ile parametre olarak gelen deerin eitliini kontrol eder. Ayn ise eriim belirteci almak zere ak ilerletir. Farkl ise ilemi keser. \n 5.4\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr. \n Baarl yantta Http 200 kodu dnlmelidir. \nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Koullu  / stee Bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir. \n 5.5  Gl Kimlik Dorulama Kontrolleri \n HK, GKD iin HHS uygulamasna ynlendirildiinde, HHSnin eitli kontroller yaparak ilemin doruluunu teyit etmesi gerekmektedir. Yaplmas gereken kontrollere ait temel senaryolar aadaki tabloda belirtilmitir. Bu senaryolar baz alnarak HHSler tarafndan zenginletirilebilir. \n Zorunlu olarak belirtilen hata durumlarnn HHSler tarafndan gereklenmesini ve uygun hata kodlarnn YSe iletilmesi; ileride oluabilecek mutabakatlama sorunlarn ortadan kaldrabilecek, yaplacak raporlamalar kapsamnda sistem ve sre iyiletirmelerine katk salayacak, son kullanc asndan da alnan hataya ynelik bilgilendirici ierik salayacaktr. \n Hata aklamalar; hata koduna uygun ya da uyumlu olmak kaydyla, HHS ve YS tarafndan farkl ekillerde sunulabilir. \n GKD Srasnda yaplmas gereken kontroller \n \n \n \n Rza ptal Detay Kodu \n HHS hata aklamas* \n Ys ekrannda listelenecek rnek mesaj metni* \n rnek Senaryo \n Zorunlu / Opsiyonel \n \n \n \n \n 07 \n Rza durumunun \"Yetkilendirildi\" , \"Yetki Kullanld\" olduu durum \n Yetki Hatas \n HK,  GKD ilemi tamamlandktan sonra  YS ekrannda ileri- geri yaparak ya da HK'nn ynlendirme adresini kopyalayarak taraycya yaptrmas ile tekrar HHS'ye ynlendirir. Bu durumda HHS bu hata mesajn iletir. \n Zorunlu \n \n \n 08 \n Rzano ile kimlik bilgileri uyumazl. \n leminiz gerekletirilememitir. \n YS tarafndan balatlan rza ierisinde yer alan kimlik bilgisi (TCKN) ile HHS'de GKD yaplan HK'nn bilgilerinin uyumad durumda \n Zorunlu \n \n \n 09 \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) \n Gsterilebilecek hesap/kart bulunamamtr. \n HK'nn uygun statl hesabnn olmad durumda \n Zorunlu \n \n \n 10 \n Ak bankaclk kanalnz ileme kapaldr. \n Ak bankaclk kanalnz ileme kapaldr. \n Ak bankacl ayr bir kanal olarak tanmlam HHS'lerde, HK'nn ilemlerini AB kanalna kapatmas durumunda \n Opsiyonel \n \n \n 11 \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu \n Yetkiniz bulunmamaktadr. \n 1- Kurumsal firma kullanclarnn hesaplar zerinde ilem yetkisinin olmamas durumunda 2- Bireysel ortak hesaplarda hesap kst bulunuyorsa (para kna izin verilmedii durum) \n Zorunlu \n \n \n 12 \n HK'nn ilgili HHS mterisi olmad durum \n Yetkiniz bulunmamaktadr. \n Tek seferlik demelerde rza isteinde HK kimlik bilgileri bulunmamaktadr. Dier aklarda rza isteinde mteri olma kontrol yaplabilir. \n Zorunlu \n \n \n 13 \n HHSnin HK iin yapt kontrollerin baarsz olduu durum \n Yetkiniz bulunmamaktadr \n HHS'nin, HK iin i sistemlerinde yapt kontrollerin baarsz olmas. rnein: Mterinin henz bankaclk hizmet szlemesi gibi Internet ubesi zerinde ilem yapmasn engelleyen eksikleri olmas durumunda veya kurumsal kullancda vekalet sresinin dolmas/eksik dokman olmas durumunda kanal zerinde ilem yapamad durum \n Zorunlu \n \n \n 14 \n Baarsz GKD \n Yetkiniz bulunmamaktadr \n 1-HK'nn GKD iin gerekli 2FA bilgilerini salayamamas   2- HHS risk algsna gre 12 nolu hata kodunu dnmek yerine 14 nolu hata kodunu da YSe dnebilir. \n Zorunlu \n \n \n 15 \n HK istei ile GKDden vazgeildii durum (r: HHS ekrannda yer alan VAZGE butonuna basm olabilir. ) \n Mteri ilemden vazgemitir. \n 1- HHS ekrannda yer alan VAZGE butonuna baslmas durumu (Hem HK login olmadan nce hem de GKD sonras (rza verme ncesi) VAZGE butonu olabilir.)  2-Mteri Banka login ekrannda herhangi bir aksiyon almadan beklemitir ve HHS GKD zaman am sresi 5 dakikadan ksadr. \n Zorunlu \n \n \n 16 \n Dier \n leminiz gerekletirilememitir. \n - \n Opsiyonel \n \n \n \n GKD srasnda iletilen rza no eer HHSnin sisteminde bulunamazsa durumu gncellenecek bir rza no da olmayacaktr. HHS kendi nyznde bu duruma uygun bir mesaj gsterebilir. YSe de Dier hata kodu ile bu durumu iletebilir. \n"},{title:"7.\tHesap Bilgisi Hizmeti",frontmatter:{},regularPath:"/v1.0.1/contents/hesap-bilgisi-hizmeti.html",relativePath:"v1.0.1/contents/hesap-bilgisi-hizmeti.md",key:"v-5b1695dd",path:"/v1.0.1/contents/hesap-bilgisi-hizmeti.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Hesap Bilgisi Hizmeti in Eriim Adresleri",slug:"hesap-bilgisi-hizmeti-icin-erisim-adresleri"},{level:2,title:"ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas:",slug:"adim-0-ohk-nn-hesap-bilgilerine-erisim-icin-talepte-bulunmas"},{level:2,title:"7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas",slug:"_7-1-adim-1-hesap-bilgisi-rzasnn-hazrlanmas"},{level:3,title:"POST /hesap-bilgisi-rizasi",slug:"post-hesap-bilgisi-rizasi"},{level:3,title:"Baarl stek:",slug:"basarl-istek"},{level:3,title:"Baarl Yant:",slug:"basarl-yant"},{level:2,title:"zinler",slug:"izinler"},{level:2,title:"7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi",slug:"_7-2-adim-2-hesap-bilgisi-hizmeti-rzasnn-tesisi"},{level:2,title:"7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas (stee Bal)",slug:"_7-3-adim-2-1-hesap-bilgisi-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali",slug:"_7-4-adim-2-2-hesap-bilgisi-rzasnn-iptali"},{level:2,title:"7.5 ADIM 3: Hesap Bilgilerinin Alnmas",slug:"_7-5-adim-3-hesap-bilgilerinin-alnmas"},{level:2,title:"7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas",slug:"_7-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanmas"},{level:2,title:"7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas",slug:"_7-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanmas"},{level:2,title:"7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas",slug:"_7-8-adim-3-5-ve-3-6-islemlerin-sorgulanmas"},{level:2,title:"7.9\tHealthcheck API",slug:"_7-9healthcheck-api"},{level:3,title:"Baarl Yant:",slug:"basarl-yant-2"}],content:" 7.\tHesap Bilgisi Hizmeti  \n Genel Bilgiler \n Hesap bilgisi sorgulama iin HBHS tarafndan mteri rzas tesisinin HHS tamamlanm olmas gerekir. Mteri rzas tesisi tamamlandktan sonra, HBHS sorgulamak istedii hesaba ait verileri ilgili eriim adresi zerinden sorgular. \n \n \n ekil 10: Hesap Bilgisi Hizmeti st Dzey Ak \n ekil-10da sunulan hesap bilgisi hizmeti 5 temel aktan oluur: \n 0.\tMterinin hesap bilgilerine eriim iin talepte bulunmas:  HK BHS mobil uygulama ya da web sitesinden hesap bilgilerine eriim ilemini balatr. \n 1.\tHesap Bilgisi mteri rzasnn hazrlanmas: \n HBHS, hesap bilgilerine eriim iin mteri rzas tesisi amacyla HHSdeki hesap bilgisi rzas eriim adresine bir POST isteinde bulunur ve bir hesap bilgisi rzas nesnesi oluturur. HHS hesap bilgisi rzas nesnesi iin biricik tanmlayac dner (RzaNo). Hesap bilgisi rzas, mterinin HBHSnin hesap bilgilerine eriim izin verdii alanlar ierir: \n \n zinler - eriim iin izin verilen veri kmelerinin listesi. \n Eriimin Geerli Olduu Son Tarih - HBHS'nin mterinin hesap bilgilerine eriebilecei istee bal seilebilen son tarih. \n lem Sorgulama Balang Zaman  Mteri rzasnn tesisinden itibaren geriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n lem Sorgulama Biti Zaman - Mteri rzasnn tesisinden itibaren ileriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n \n 2.\tHesap bilgisi hizmeti mteri rzasnn tesisi: \n HHS, Hesap Bilgisi Rzas servisi ile HK zelinde Yetki bekleniyor statsnde bir rza nesnesi hazrlar. HHS, GKDnin baaryla tamamlanmas sonrasnda hesap bilgisi rzas nesnesinin yetkilendirildiini belirtmek iin Rza Durumunu Rza Yetkilendirildi olarak gnceller. Nesne yetkilendirildikten sonra HHS nesne ile bir eriim belirteci (access token) ilikilendirir, Rza Durumunu Yetki Kullanld yapar ve bu belirteci HBHSye geri dner.  Bylece mteri rza tesisi salanm olur. \n Hesap bilgisi iin mteri rzasna ilikin temel ilkeler unlardr: \n \n 1 HK'nn 1 YS iin 1HHS'de Yetki Bekleniyor, Yetkilendirildi, Yetki Kullanld statsnde 1 rzas olabilir. \n Mteri rzasnn ayrntlar HK ile HBHS arasnda belirlenir. Bu nedenle mteri rzasnn ayrntlar HHS ekrannda deitirilmemelidir. \n HK, hesap eriim izni ayrntlarn yalnzca bir btn olarak yetkilendirebilir veya geri alabilir. \n Mteri rzas tesisi esnasnda, mteri HHS arayznde eriim iin yetkilendirecek hesaplar seer. \n \n 2.1\tHesap bilgisi rzasnn sorgulanmas:  Mteri rzas  GET/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak sorgulanr. \n 2.2\tHesap bilgisi mteri rzasnn iptali:  Mteri rzas  DELETE/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak iptal edilir. \n 3.\tHesap bilgilerinin alnmas:  Hesap bilgileri ilgili kaynaa (hesaplar, bakiye, ilemler) GET istei yaplarak gerekletirilir. HBHS, mteri rzasnn tesisinden sonrasnda (geerli bir eriim belirticine sahip olduunda) ncelikle  GET/hesaplar  ars yapacaktr. \n Hesap Bilgisi Hizmeti in Eriim Adresleri \n Etki Alan (Scope) =hesap_bilgisi \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n hesap-bilgisi-rizasi \n POST \n /hesap-bilgisi-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n HesapBilgisiRizasiIstegi \n HesapBilgisiRizasi \n \n \n 2 \n erisim-belirteci  (GKD iin) \n POST \n POST/erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n HesapBilgisiRizasi \n \n \n 2.2 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n \n \n \n \n \n \n 3.1 \n hesaplar \n GET \n /hesaplar \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n HesapBilgileri(birden ok hesap) \n \n \n 3.2 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n HesapBilgileri(tek  hesap) \n \n \n 3.3 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n BakiyeBilgileri(tek  hesap) \n \n \n 3.4 \n bakiye \n GET \n /bakiye \n  \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n BakiyeBilgileri(birden ok hesap) \n \n \n 3.5 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n IslemBilgileri (tek hesap) \n \n \n \n Tablo 11: Hesap Bilgisi Hizmeti in Eriim Adresleri \n ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas: \n HK, HBHS uygulamasnda (web arayz/mobil uygulama) hesap bilgilerine eriim iin talepte bulunur. \n 7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas \n Bu API ars HBHS'nin HHS'de yeni bir HesapBilgisiRizasi nesnesi oluturmasn ve nesneye erimek iin benzersiz bir rza numaras ({RizaNo}) dnlmesini salar. \n API arsnn baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas yeterlidir.\nBaaryla oluturulan hesap bilgisi rza kaynann rza durumu Yetki Bekleniyor olarak dzenlenir.\nHK daha nce ald rzaya ilikin eriim tarihleri, izin trlerini ve hesap bilgilerini gncellemek isterse, HBHS nce HHS nezdindeki rzay iptal etmeli ve sonrasnda yeni bir rza talebinde bulunmaldr.\n \n \n ekil 11: Hesap Bilgisi Mteri Rzasnn Hazrlanmas \n \n POST /hesap-bilgisi-rizasi isteinin (REQUEST) gvdesinde (BODY)  HesapBilgisiRizasIstegi nesnesi (Tablo-12) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda HesapBilgisiRizasi (Tablo-13) nesnesi oluturulur. \n  POST /hesap-bilgisi-rizasi \n Baarl stek: \n STEK: \n HBHS, bu API eriim adresinden HHSye yeni bir HesapBilgisiRizasi oluturulmas iin istekte bulunur: \n \n HBHS, HKnn hesap bilgilerine ynelik rza balatma istei olduunu HHSye bildirir. \n HBHS, HKnn, HBHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk ve uzunluk kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan HBHS bilgilerinin ierisinde yer alan ynlendirme ve bildirim adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde iletilen kimlik bilgileri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Zorunlu) \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlar ile ilgili Tablo 12de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, benzersiz RizaNo ile HesapBilgisiRizasi nesnesi oluturur ve HBHSye dner. \n HHS, HesapBilgisiRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlarnda zaman aralklar mteri deneyimi penceresinden deerlendirilerek ay cinsinden belirtilmitir. Bu konuda aadaki gibi oluabilecek u rneklere dikkat edilmesi gerekmektedir. \n Bugn : 31.08.2019 \nBugn + 6 Ay : 29.02.2020 \nBugn : 30.08.2020 \nBugn + 6 Ay : 28.02.2021 \n Tablo 12: HesapBilgisiRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Hata durumunda TR.OHVPS.Connection.InvalidASPSP hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda TR.OHVPS.Connection.InvalidTPP hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr.   Yetkilendirme yntemi, HBHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur.  YS Ynlendirmeli GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak ynlendirme adresini iletmelidir. Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunludur.  YS Ayrk GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak bildirim adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, ayrk GKD sonras bu alanda belirtilen adrese otorizasyon kodunu (authentication code) iletir. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr.   TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n \n >zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih.   Mteri YS ekranndan bu deeri belirleyebilir.   Varsaylan deer : Rza verilen tarih + 6 ay   Alabilecei maksimum deer : Rza tarihi + 6 ay    Alabilecei minimum deer : Rza tarihi + 1 gn   rnein 23/09/2021de minimum 24/09/2021 seilebilir. Bu durumda izin 24/09/2021 23:59:59da bitecek ekilde olmaldr. \n Bu alanda bir deer bulunmad durumda HHS hata dnmelidir. \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gemie dnk en fazla 12 ay olabilir, daha eski olmamas gerekir.   Varsaylan deeri rza verilen tarih (ilem zaman)  12 aydr.   HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.   Minimum tarihi : Rzann verili tarihi  - 12 ay    Maksimum tarih: Rzann verili tarihi +  12 ay    zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve  lem Sorgulama Balang Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gelecee dnk en fazla 12 ay sonras olabilir, daha ileri bir tarih olmamas gerekir.   Varsaylan deeri: Rza verilen tarih + 12 aydr.  HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.  Minimum tarihi : Rzann verili tarihi   12 ay  Maksimum tarihi :  Rzann verili tarihi + 12 ay   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. Eer dolu gnderilirse HHS tarafndan uygun hata mesaj iletilmelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve lem Sorgulama Biti Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez.   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n Baarl Yant: \n Tablo 13: HesapBilgisiRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu sral veri tipini deerlerinden birini alr. rn; hesap bilgi rzasnn tesisine dair ilk istek mesajna dnte B: Yetki Bekleniyor deerini almas beklenir. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir. \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n K \n HHS, HBHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr.  TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n HHS, mteri uygulama / taraycsn bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n HHS, ayrk GKD sonras bu alanda belirtilen YS adresine otorizasyon kodunu (authentication code) iletir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.  HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir. Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n > zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HBHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei balang zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei biti zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n > Ayrnt Bilgi \n ayrBlg \n Kompleks: AyrintiBilgi \n  \n \n \n \n > HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n zinler \n Bir hesap bilgisi mteri rzas kayna arsna yant olarak dndrlen verileri snrlamak iin izin kodlar kullanlr: \n \n Temel Hesap Bilgisi \n Ayrntl Hesap Bilgisi \n Bakiye Bilgisi \n Temel lem (Hesap Hareketleri) Bilgisi \n Ayrntl lem Bilgisi \n \n HKya sunulacak seimler ve kurallar aadaki gibi olmaldr. \n \n \n \n Seim \n Kural \n \n \n \n \n Temel Hesap Bilgisi \n HK seimine sunulmamaldr. Deitirilemez ekilde seili gsterilmelidir. \n \n \n Ayrntl Hesap Bilgisi \n HK seim yapabilir. \n \n \n Bakiye Bilgisi \n HK seim yapabilir. \n \n \n Temel lem (Hesap Hareketleri)  Bilgisi \n HK seim yapabilir. \n \n \n Ayrntl lem Bilgisi \n HK seim yapabilir. Ayrntl lem Bilgisi seimi Temel lem Bilgisi seimini kapsar. (Ayrntl lem bilgisi seildiinde Temel lem Bilgisi de seili olmaldr.) \n \n \n \n Aadaki durumlarda, izin kombinasyonlarna izin verilmez. HHS, bu hesap eriim onaylarn 400 (Hatal stek) yant koduyla reddetmelidir: \n \n zin dizisinin herhangi bir izin tr iermemesi durumu, \n zin dizisinde HHS tarafndan desteklenmeyen bir izin kodunun yer almas durumu \n 7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi \n \n \n ekil 12: Hesap Bilgisi HK Rzasnn Tesisi \n Rza tesisinin baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas ve ardndan mterinin HHS tarafndan ynlendirmeli veya ayrk GKD ile dorulanmas gerekir. HHS'de oluturulan ve rza durumu Yetki Bekleniyor olan bir hesap bilgisi rzas, GKD sonras Yetkilendirildi statsne gncellenir. HBHS, eriim salayaca hesaplar hesap bilgisi rzasnn tesisinden nce seer. \n \n \n Ynlendirmeli dorulama aknda, HBHS HKy HHSye ynlendirir. \n \n \n HBHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n \n \n HHS, HK iin GKD srecini iletir. \n HKy dorularsa, \n \n \n HK HBHS zerinden ilem yaplmasna izin verecei hesap seimini yapar. HBHS zerinden HKnn verdii izin bilgilerini ve eriim izninin biti tarihi bilgilerini, HHS bilgilendirme amal HKya gsterir. \n \n \n HHS hesap bilgisiri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n HHS, HKy olumlu ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=H&drmKod=zzz\n \n \n \n HKy dorulayamazsa, \n \n \n HHS, hesap bilgisi rza kaynann durumunu Yetki ptal olarak gnceller. \n \n \n HHS, HKy olumsuz ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I &rizaNo=yy&rizaTip=H&rizaIptDtyKod=11&drmKod=zzz\n \n \n \n \n \n \n \n Ayrk dorulama aknda, HHS, HKnn hesap bilgisi hizmetini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister. \n \n Ayrk ak HBHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek hesap bilgisi rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, deme hizmeti kullancsn dorular. \n HK verdii izin tipi dahilinde bilgileri paylalacak olan hesaplar seer. \n HHS, hesap bilgisi rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS,  hesap bilgisi rzasnn durumunu Yetki Kullanld olarak gnceller. Rza tesisi salanm olur. \n 7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas (stee Bal) \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HK, HHS zerinden rza iptali yapm olabilir veya HKnn verdii rza sresi dolmu olabilir.  Bu durumlarda HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir HesapBilgisiRizasi kaynann durumunu, istee bal olarak alabilir. \n Servis baarl yantnda Tablo 13de belirtilen HesapBilgisiRizasi nesnesini dnmektedir. \n Durum \nHesapBilgisiRizasi kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki Sonlandrld \n Yetki ptal \n 7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali \n \n \n \n ekil 13: Hesap Bilgisi Mteri Rzasnn Geri Alnmas \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \n DELETE /hesap-bilgisi-rizasi ars, bir HBHS'nin nceden oluturulmu bir hesap eriim rzasn (yetkili olsun veya olmasn) silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, HBHS zerinden bu rzasn kaldrmak isteyebilir. \nBu API ars, mterinin HBHS zerinden hesap bilgisi rzasn iptal etmesine ve HHS nezdindeki hesap bilgisi rzas nesnesinin silinmesini salar. \nMterinin HBHSnin veri eriim iznini iptal etmesi durumunda HBHS, HHSde mevcut olan HesapBilgisiRizasi kaynan pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \nars aracl ile yerine getirilir. HBHS ayrca, sisteminden Hesap Eriim zni kaynaklarn da temizlemelidir. \nSz konusu silme ilemi, kaytlarn statsnn pasife ekilmesi ile gerekletirilmelidir. Sz konusu kaytlar, denetim izlerinin oluturulmas ve saklanmasna ilikin ikincil dzenleme hkmleri kapsamnda gvenli ekilde tutulmaldr. \nServis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr. \nHK rzas baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal olarak gncellenir ve gnclZmn zaman damgas vurularak gncellenir. \nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir: \nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (HBHS) \n 7.5 ADIM 3: Hesap Bilgilerinin Alnmas \n    \n \n   \n ekil 14: Hesap Bilgilerinin Alnmas \n STEK: \nMteri rzas tesis edilmi kullanc iin HBHS API eriim adresinden HHSye eriilebilir hesap bilgilerini GET istei ile sorgular: \n \n RizaDurumu Yetki Kullanld ise ileme balanr. RizaDurumu farkl bir deerde ise TR.OHVPS.Resource.ConsentMismatch hatasnn iletilmesi gerekir. \n GET verisinin modele gre kontrol yaplr (rnein: Alan kontrolleri) \n \n GET verisinin mantksal kontrolleri yaplr. \n 7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas \n GET /hesaplar ve GET /hesaplar/{hspRef} \n Bu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bilgilerinin sorgulanr. Hesap bilgisi iin daha nce tanmlanm izin trne gre (Temel Hesap Bilgisi veya Detayl Hesap Bilgisi) yantnda dnlen HesapBilgileri nesnesinin ierii deiir.  Tablo 15te HesapBilgileri nesnesinin ierii verilmitir. \n Hesap Bilgisi Sorgu rnei (Tm Hesaplar) =  /hesaplar \nHesap Bilgisi Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef} \nlem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 14: Hesap Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numaras \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 15: HesapBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzas nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Hesap Temel \n hspTml \n Kompleks: HesapTemel \n Z \n Temel Hesap Bilgileri (Temel Hesap Bilgisi varsaylan izin tr olduundan Hesap Temel nesnesi zorunlu olarak yantta bulunur) \n \n \n > Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n > Hesap Numaras \n hspNo \n AN26 \n K \n Eer varsa deme hesabna ait IBAN bilgisi \n \n \n > Hesap Sahibi Unvan \n hspShb \n AN3..140 \n Z \n Hesap sahibi ya da hesap sahiplerinin ad-soyad, ticari unvan \n \n \n > ube Ad \n subeAdi \n AN3..50 \n K \n Eer varsa deme hesabnn bal olduu ubenin ad \n \n \n > Ksa Ad \n kisaAd \n AN3..50 \n K \n Eer hesap sahibi hesaba ait bir ad tanmladysa, tanmlanan hesap ad \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi. \n \n \n > Hesap Tr \n hspTur \n AN1 \n Z \n Hesabn tr (bireysel veya ticari). TR.OHVPS.DataCode.HspTur srali veri deerlerinden birini alr. \n \n \n > Hesap Tipi \n hspTip \n AN1..32 \n Z \n Hesabn tipi (VADESZ, KREDL vb.).TR.OHVPS.DataCode.HspTip sral veri deerlerinden birini alr. \n \n \n >Hesap rn Ad \n hspUrunAdi \n AN1..140 \n  \n HHS tarafndan atanm olan rn ad bilgisidir. HBHS tarafndan HKya gsterilmesi kullanm kolayl salayacaktr. \n \n \n > Hesap Durumu \n hspDrm \n AN5..50 \n Z \n Hesabn durumunu belirtir. TR.OHVPS.DataCode.HspDrm sral veri trlerinden birini alr. \n \n \n Hesap Detay \n hspDty \n Kompleks: HesapDetay \n K \n Detay Hesap Bilgileri (Temel Hesap Bilgisine ek olarak Detay Hesap Bilgisi izin tr de seilmise Hesap Detay nesnesi koullu olarak yantta bulunur) \n \n \n > Al Tarihi \n hspAclsTrh \n ISODateTime \n Z \n Belirtilen hesabn al tarihi. \n 7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas \n GET /bakiye ve GET /hesaplar/{hspRef}/bakiye \nBu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bakiyesi sorgulanr. \nstek arsna dnlen BakiyeBilgileri nesnesi Tablo 17de verilmitir. \nlem Sorgu rnei (Belirli Bir Hesap)=  /bakiye?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 16: BakiyeBilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 17: BakiyeBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n Bakiye \n bky \n Kompleks:Bakiye \n Z \n \n \n \n > Hesap Bakiye Tutar \n bkyTtr \n N1..18 \n Z \n Hesabn bakiyesi.  rnein 1,20 TRY iin tutar alannda 120 deeri iletilir \n \n \n > Blokeli Tutar \n blkTtr \n N1..18 \n K \n Varsa hesapta blokeli tutar bilgisi.  rnein 1,20 TRY iin tutar alannda 120 deeri iletilir \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n > Bakiye letilme Zaman \n bkyZmn \n ISODateTime \n Z \n Bakiyenin iletildii zaman bilgisi. \n \n \n > KrediliHesap \n krdHsp \n Kompleks: KrediliHesap \n K \n \n \n \n >> Kredili Mevduat Hesab Bakiyesi \n kulKrdTtr \n N1..18 \n Z \n Kullanlabilir kredili mevduat tutar. Kredili bir hesap ise zorunlu. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir \n \n \n >> Kredi Dahil Gstergesi \n krdDhlGstr \n AN1 \n Z \n Kredili bir hesap ise zorunlu. Bakiye tutarnn kullanlabilir kredi tutar dahil edilerek ya da edilmeden iletildiini gsterir.  0: Kredi tutar dahil edilmeden bakiye bilgisi iletilmesi durumu 1: Kredi tutar dahil edilerek bakiye bilgisi iletilmesi durumu \n 7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas \n GET /hesaplar/{hspRef}/islemler \n Belirli bir hesaba ilikin ilem bilgileri Tablo 1daki istek parametrelerine gre sorgulanr. \nlem bilgisi iin daha nce tanmlanm izin trne gre yantta dnen IslemBilgileri nesnesinin (Temel lem Bilgisi veya Temel lem Bilgisi ve Detayl lem Bilgisi) ierii deiir. \nlemler servisi hem HKnn talebi ile YS uygulamas zerinden arlabilecei gibi, YSn HKsz balatabilecei otomatik arlar ile de yant dnebilmektedir. \nHHS, ilemin sistemsel yaplp yaplmadn, istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir.\nHKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \nYS, otomatik yapaca sorgularda; \n \n Bireysel HKlar iin hesap baznda gnde en fazla 4 adet sorgulama yapabilir. \n Kurumsal HKlar iin hesap baznda saatte en fazla 12 adet sorgulama yapabilir. \n \n HHS, tutaca saya bilgisi ile bu saylar kontrol ederek daha fazla sorgulama yaplmasna izin vermeyebilir. \n Ayn istek parametreleri ile yaplan sorgu sonucunda dnecek toplam kayt says 100 atnda, sayfalama yntemi ile HHSnin cevap dnmesi beklenmektedir.  Her bir sayfa iin ilemler servisi tekrar arlsa da, bu arm HHSnin tuttuu saya deerini arttrmaz. HHSnin tutaca sayan kontrol parametreleri YS kodu, hesap numaras ya da referans olmaldr. Sayfa no parametresi varsa ve 1'den byk ise ilem sayacn arttrmamaldr. \n HKnn YS uygulamas zerinden tetikledii ilemlerde ise;\nbireysel HKlar  iin en fazla 1 aylk,\nkurumsal HKlar iin ise en fazla 1 haftalk bir pencere aralnda sorgulama yaplabilir. \n YS, otomatik yapaca sorgularda hem bireysel hem de kurumsal HKlar iin 24 saatlik bir pencere aralnda sorgulama yapabilir. \n lem Sorgu rnei (Belirli Bir Hesap)=  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-02T23:59:59+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A \n Tablo 18: lem Listesi Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n lem Sorgulama Balang Zaman \n hesapIslemBslTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin balang tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. HK tarafndan tetiklenen sorgularda;hesapIslemBslTrh ve hesapIslemBtsTrh aras fark bireysel HKlar iin en fazla 1 ay,kurumsal HKlar iin ise en fazla 1 hafta olabilir. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;son 24 saat sorgulanabilir. Bu yzden hesapIslemBtsTrh-24 saatten daha uzun bir aralk sorgulanamaz olmaldr. stek balnda yer alan PSU-Initiated alan E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n \n \n lem Sorgulama Biti Zaman \n hesapIslemBtsTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin biti tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;leri vadeli ilem emirleri dahil olmad iin; lem Sorgulama Biti Zaman, her zaman, sorgulama zaman damgasn iletecek ekilde (datetime (now)) iletilmelidir. \n \n \n En Dk lem Tutar \n minIslTtr \n N1..18 \n  \n Sorgulanacak ilemlerin alabilecei en dk ilem tutar.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n En Yksek lem Tutar \n mksIslTtr \n N1..18 \n  \n Sorgulanacak ilemlerin alabilecei en yksek ilem tutar.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Bor Alacak Gstergesi \n brcAlc \n AN1 \n  \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Hesaba bor yaratan ilem.A: Hesaba alacak yaratan ilem.{B,A} \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {islGrckZaman} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini islGrckZaman olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 19: IslemBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans Numaras \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n Islemler \n isller \n Kompleks:Islem[Array] \n K \n Hesaba ilikin hareketler varsa lemler nesnesi dizisi olarak dnlr. lemler nesnesi Temel lem Bilgileri ve Detay lem Bilgileri nesnesinden meydana gelir. zin tr varsaylan olarak Temel lem Bilgilerini ierir. Detay lem Bilgileri izin tr de seildi ise Temel lem Bilgilerine ek olarak Detay lem Bilgileri de gnderilir. \n \n \n > Temel lem Bilgileri \n islTml \n Kompleks:IslemTemel \n Z \n Temel lem Bilgileri varsaylan olarak dnlr. \n \n \n >> lem Numaras \n islNo \n AN3..50 \n Z \n Hesap hareketinin oluturulmas srasnda atanan ve bor (veya alacak) hareketini tekilletiren HHS baznda tekil tanmlaycdr. Bu deer tek bana tekil olabilecei gibi birden fazla deerin bir araya getirilmesiyle de tekillii salanm olabilir. Bu deerin en azndan hesap numaras (hesNo) baznda tekil olmas beklenir. Genellikle kullanlan rnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp,dekont numaras \n \n \n >> lem Referans Numaras \n refNo \n AN3..50 \n Z \n lemi utan uca tanmlayan tekil tanmlaycdr. Bor ve alacak hareketinden oluan bir veya birden fazla ilemler btn iin atanm olan ve bu btn tekilletiren (bir biri ile ilikisini tutan) deerdir.Bu deer hem YSten gelen deer olabilir (deme ilemlerinde kullanlan kkodRef ya da refBlg alan) hem de HHS iinde takip edilmek iin retilmi bir deer olabilir. HHS sisteminde 2 deerin de bulunmas durumunda;refNo alann doldurmak iin, HHSnin YSten gelen deere ncelik vermesi beklenmektedir. YSten gelen veri rnei: Sipari Numaras, Fatura Numaras, Karekod Referans vb. HHSte retilen veri rnei: Masrafl havale ileminde hem havale ileminin hem de masraf ileminin ayn referans numarasna sahip olmas da rnek olarak gsterilebilir. \n \n \n >> lem Tutar \n islTtr \n N1..18 \n Z \n lem tutar. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n >> lem Gerekleme Zaman \n islGrckZaman \n ISODateTime \n Z \n lemin gerekleme zaman. \n \n \n >> lem Kanal \n kanal \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeKaynak sral veri tr deerlerinden birini alr. \n \n \n >> Borlandrma Alacaklandrma Gstergesi \n brcAlc \n AN1 \n Z \n TR.OHVPS.DataCode.BrcAlc sral veri tr deerlerinden birini alr. lemin hesab bor ya da alacaklandrd bilgisidir. \n \n \n >> lem Tr \n islTur \n AN3..50 \n Z \n HHSnin ileme ait ilikilendirdii ilem tr deeri. TR.OHVPS.DataCode.IslemTuru sral veri tr deerlerinden birini alr. \n \n \n >> lem Amac \n islAmc \n AN2 \n Z \n TR.OHVPS.DataCode.IslemAmaci srali veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> deme Sistemi No \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. FAST ilemleri iin MesRefBlg deeri atanr. deme Hizmeti kullancsna ilemin takibi iin gsterilebilir. \n \n \n > Detay lem Bilgileri \n islDty \n Kompleks: IslemDetay \n K \n Detay lem Bilgileri dizi olarak gnderilmelidir. \n \n \n >> lem Aklamas \n islAcklm \n AN1..150 \n Z \n HHS tarafndan atanan ilem aklamas.HHS kendi ilem hareketlerine yanstt aklamay buraya yanstmaldr. \n \n \n >> Kar Taraf \n krsTrf \n Kompleks:  KarsiTaraf \n K \n Kullanm ilem baznda deimektedir. rnek: FAST ileminde kar taraf alcnn bilgileridir. Vergi demesinde kurum IBAN bilgisi mteriye gsterilemeyebileceinden bu alann bo gelmesi HHS insiyatifindedir. \n \n \n >>> Kar Maskeli IBAN \n krsMskIBAN \n AN26 \n K \n lgili hesap hareketinin kar tarafnn maskeli IBAN bilgisi. \n \n \n >>> Kar Maskeli Unvan \n krsMskUnvan \n AN3..140 \n K \n lgili hesap hareketinin kar tarafnn maskeli ad-soyad ya da ticari unvan bilgisi. \n 7.9\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr \n Baarl yantta Http 200 kodu dnlmelidir. \n Baarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n"},{title:"HHS ve YS API",frontmatter:{},regularPath:"/v1.0.1/contents/hhs-yos-api.html",relativePath:"v1.0.1/contents/hhs-yos-api.md",key:"v-4888cd9d",path:"/v1.0.1/contents/hhs-yos-api.html",headers:[{level:2,title:"HHS API",slug:"hhs-api"},{level:2,title:"YOS API",slug:"yos-api"},{level:2,title:"Healthcheck API",slug:"healthcheck-api"}],content:' HHS ve YS API \n HHS API, HHSlerin detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. HHS API iin hhs_read scope bilgisi kullanlr. \n Production ortamnda HHS / YOS API ierisinde sisteme dahil olmu, sertifikasyonu baar ile tamamlam paydalar listelenecektir. HHS tarafndan desteklenen API srmleri listelenecektir. \n YSler HHS APIsini sorgulayabilir ancak YS APIsini sorgulayamazlar. \nBenzer ekilde HHSler YS APIsini sorgulayabilir, HHS APIsini sorgulayamazlar. \n HHS API \n GET /hhs/{hhsKod} \n lem Sorgu rnei =  /hhs    bu sorgu yntemi ile tm HHSlerin dizi eklinde verileri listelenir. \nlem Sorgu rnei =  /hhs/2001    bu sorgu yntemi ile gnderilmi olan hhsKoduna ait bilgiler listelenir. Ya da 404 Not Found hatas alr. \nHHS ve YS API Tablo 20deki istek parametrelerine gre sorgulanabilir. \nlem Sorgu rnei (Belirli Bir Hesap) =  /hhs?srlmKrtr=kod&srlmYon=A \n Tablo 20: HHS ve YS API Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {kod, unv} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, sralama kriteri unv olarak belirlenmelidir. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 21: HHS Bilgileri Sorgulama Yant Hhs nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n hhs kodu \n kod \n AN4 \n Z \n HHS nin kod bilgisi \n \n \n hhs unvan \n unv \n AN3..140 \n Z \n HHS nin unvan bilgisi \n \n \n hhs markas \n marka \n AN1..140 \n Z \n HK\'nn kolaylkla alglayabilecei ksa unvan bilgisi. HHS tarafndan belirlenecektir. \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n HHSnin mesaj imzalama iin paylat ak anahtar \n \n \n HHS Api Bilgileri \n apiBilgileri \n Kompleks: HhsApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :obh, hbh,gkd \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s2.0 s1.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n HHSye ait logo bilgileri. Logotur = Original  formatndaki logonun minimumda gnderimi zorunludur. \n \n \n >logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur alabilecei deerler  ORIGINAL , WHITE_OVERLAY , BLACK_OVERLAY , GRAY_OVERLAY \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n HHS tarafnda tutulan ve YSlerle paylalacak olan url adres bilgisidir. \n \n \n \n Hem YOS hem de HHS API iin geerli olacak; logo gnderiminde dikkat edilmesi gerekenler u ekilde tariflenmitir: \n \n Logolarn ham dosya yerine kurumun yaynlayaca bir URL zerinden sunulmas gerekmektedir. (rn: logoURL  =  https://kurumadi.com.tr/logo.png) Logo BKM tarafnda host edilmeyecektir.) \n PNG formatnda (PNG-24) olmaldr. \n 72 DPI znrlkte olmaldr. \n 500 x 500 boyutlarnda, yatayda veya dikeyde tama paysz tam oturacak, snr boyutlarn gemeyecek ve ortalanm yerleime sahip olmaldr. \n Logo arka plan renkli olmamal, arka plan transparan olmaldr. \n YS uygulamasnda gsterim esnasnda logolarn hzl yklenmesi ve dk veri tketmesi asndan; logo boyutu 250 KBn altnda olmaldr. \n Drt adet logo tr belirlenmitir. Bu 4 tr iin de logo dnlmesi zorunludur. \n Logo urlin public eriilebilir url olmas gereklidir. \n \n YS API, YS statsundeki kurumlarn detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. YS API iin yos_read scope bilgisi kullanlr. \n YS API yantnda, listelenen ynlendirme ve bildirim adresleri bulunmaktadr. HHS, ilem annda iletilen yonAdr ya da bldrAdr alanlarnda gnderilen adreslere yetKod deerini iletmelidir. YS API ierisinde yer alan adresleri, rza isteinde gnderilen adreslerin doruluunu kontrol etme amacyla kullanlmaldr. Bu nedenle YS API ierisinde listelenen adreslerin hostname seviyesinde yer almas yeterlidir. \n YOS API \n GET /yos/{yosKod} \n lem Sorgu rnei =  /yos    bu sorgu yntemi ile tm yos lerin dizi eklinde verileri listelenir. \n lem Sorgu rnei =  /yos/2501    bu sorgu yntemi ile gnderilmi olan yosKoduna ait bilgiler listelenir ya da 404 Not Found hatas alr.\nYS API Tablo 20deki istek parametrelerine gre sorgulanabilir.\nlem Sorgu rnei (Belirli Bir Hesap)=  /yos?srlmKrtr=kod&srlmYon=A \n Tablo 22: YOS Bilgileri Sorgulama Yant Yos nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Ys kodu \n kod \n AN4 \n Z \n YS\'n kod bilgisi \n \n \n Ys unvan \n unv \n AN3..140 \n Z \n YS unvan bilgisi \n \n \n Ys markas \n marka \n AN1..140 \n Z \n HK\'nn kolaylkla alglayabilecei ksa unvan bilgisi. YS tarafndan belirlenecektir. \n \n \n YS rolleri \n roller \n Array[AN4] \n Z \n YSun rollerini belirten deer. rnek: [ "obhs", "hbhs" ]  - obhs - deme Bilgisi Hizmet Salayc Rol  - hbhs - Hesap Bilgisi Hizmet Salayc Rol \n \n \n Adresler \n adresler \n Kompleks:Adres[Array] [1..N] \n Z \n --- \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerlerinden birini alr. Adres detaylarnn hangi GKD trne ait olduunu belirtir. \n \n \n >Adres Detaylar \n adresDetaylari \n adresDetaylari\tKompleks: AdresDetayi[Array] [1..N] \n Z \n \n \n \n >>Temel Adres \n tmlAdr \n AN1..1024 \n Z \n yetYntm deeri Y olarak iletildiinde Ynlendirmeli GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. yetYntm deeri A olarak iletildiinde Ayrk GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. Riza isteklerinde bu deer ile uyumluluu kontrol edilmelidir. rnek: https://example.com https://example2.com/path deepLink://example/test deepLink://example2/test \n \n \n >>Aklama \n aciklama \n AN1..1024 \n  \n YSn gnderdii adrese ynelik vermek istedii aklama rnek: WEB bireysel , WEB kurumsal  , APP \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n YSn mesaj imzalama iin paylat ak anahtar \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n YOSe ait logo bilgileri. Logotur = Original formatndaki logonun minimumda gnderimi zorunludur. \n \n \n >logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur alabilecei deerler  ORIGINAL , WHITE_OVERLAY , BLACK_OVERLAY , GRAY_OVERLAY \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n YS tarafnda tutulan ve HHSlerle paylalacak olan url adres bilgisidir. rnek: https://via.placeholder.com/150?text=0001 \n Healthcheck API \n GET /health \n HHS ve YS API iin health servisleri aadaki servislerle kontrol edilebilir. \n Baarl yantta Http 200 kodu dnlecektir\nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n'},{frontmatter:{},regularPath:"/v1.0.1/contents/tanim-ve-kisitlamalar.html",relativePath:"v1.0.1/contents/tanim-ve-kisitlamalar.md",key:"v-1178fa5d",path:"/v1.0.1/contents/tanim-ve-kisitlamalar.html",content:"  1.\tTanm ve Ksaltmalar   \n Tablo 1: Tanm ve Ksaltmalar \n \n \n \n Ksaltma \n Tanm \n Aklama \n ngilizce Aklama \n ngilizce Ksaltma \n \n \n \n \n S \n ereve Szleme \n deme hizmeti salaycs ile mteri arasnda tekil veya sreklilik arz eden deme ilemlerinin yrtlmesine ve mmkn olan durumlarda deme hesabnn almasna ilikin usul ve esaslar belirleyen szleme \n \n \n \n \n EPK \n Elektronik Para Kuruluu \n Kanun kapsamnda elektronik para ihra etme yetkisi verilen tzel kii \n Electronic Money Institution \n EMI \n \n \n FAST \n Fonlarn Anlk ve Srekli Transferi \n TCMB tarafndan iletilen Fonlarn Anlk ve Srekli Transferi Sistemi \n \n \n \n \n FAST TR-Karekod \n FAST-TR Karekod Teknik lke ve Kurallar Rehberi \n TR Karekodun FAST Sistemi araclyla gerekleecek ilemlerde kullanlmasna ilikin detayl teknik ilke ve kurallarn ieren dokman \n \n \n \n \n GKD \n Gl Kimlik Dorulama \n Kimlik dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntem \n Strong Customer Authentication \n SCA \n \n \n B \n lem Bilgisi \n Gerekletirilen ileme ilikin ilem zamann, ilemin niteliini ve deme ilemi iin deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve demenin gndereni ile alcsn veya toplu deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve gndereni ile alclarn ieren bilgi \n \n \n \n \n DK \n lem Dorulama Kodu \n Kimlik dorulama yntemlerinden biriyle kendisini sisteme tantan bir mterinin gerekletirmek istedii ileme zg olmak ve belirli bir geerlilik sresi iinde ilem onaynda kullanlmak zere oluturulan, finansal sonu dorunan ilemlerde kiiye onay annda ilgili ilem bilgisi (B) ile birlikte gsterilen, alc veya tutarn deimesiyle geersiz hale gelen bilgi \n Authentication Code \n AC \n \n \n KOLAS \n Kolay Adresleme Servisi \n Fon transferlerinde hesap numaras ile ad soyad yerine kullanlan ve belirli bir hesap ile eletirilmi telefon numaras, e-posta adresi, T.C. Kimlik Numaras (TCKN), Vergi Kimlik Numaras (VKN), Yabanc Kimlik Numaras veya Pasaport Numaras gibi Kolay Adres bilgilerinin kaydedilmesini, gncellenmesini ve sorgulamasn salayan katman servis \n \n \n \n \n HBHS \n Hesap Bilgisi Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (g) bendinde tanmlanan deme hizmetini (hesap bilgisi hizmetini) sunan tzel kii \n Account Information Service Provider \n AISP \n \n \n HHS \n Hesap Hizmeti Salaycs \n Nezdinde deme hesab bulunan deme hizmeti salaycs \n Account Servicing Payment Service Provider \n ASPSP \n \n \n BHS \n deme Emri Balatma Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (f) bendinde tanmlanan deme hizmetini (deme emri balatma hizmetini) sunan tzel kii \n Payment Initiation Service Provider \n PISP \n \n \n DK \n deme Kuruluu \n deme hizmeti salamak ve gerekletirmek iin Kanun kapsamnda yetkilendirilmi tzel kii \n Payment Institution \n PI \n \n \n H \n deme Hesab \n deme hizmeti kullancs adna alan ve deme ileminin yrtlmesinde kullanlan hesap \n Payment Account \n PA \n \n \n HK \n deme Hizmeti Kullancs (Mteri) \n Gnderen, alc veya her ikisi sfatyla belirli bir deme hizmetinden faydalanan gerek veya tzel kii \n Payment Service User \n PSU \n \n \n HS \n deme Hizmeti Salaycs \n 5411 sayl Kanun kapsamndaki bankalar, EPK, DK ve Posta ve Telgraf Tekilat Anonim irketi(PTT) \n Payment Service Provider \n PSP \n \n \n HVPS \n deme Hizmetleri Veri Paylam Servisleri \n Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri \n \n \n \n \n PS \n Perakende deme Sistemi \n TCMB tarafndan iletilen, ilemlerin Trk Liras zerinden gerekletii Mteriler Aras Trk Liras Aktarm Sistemi \n \n \n \n \n TR-Karekod \n TR-Karekod lke ve Kurallar \n Ulusal karekod (TR Karekod) ilke ve kurallarnn belirlendii belge \n \n \n \n \n YS \n Yetkili deme Hizmeti Salaycs \n deme emri balatma hizmeti ve/veya hesap bilgisi hizmeti sunan tzel kii \n Third Party Payment Service Providers \n TPP \n \n \n \n"},{title:"2.Kapsam ve Dayanak",frontmatter:{},regularPath:"/v1.0.1/contents/kapsam-ve-dayanak.html",relativePath:"v1.0.1/contents/kapsam-ve-dayanak.md",key:"v-7e81b77d",path:"/v1.0.1/contents/kapsam-ve-dayanak.html",content:" 2.Kapsam ve Dayanak \n 12 Kasm 2019da gncellenen  6493 sayl deme ve Menkul Kymet Mutabakat Sistemleri, deme Hizmetleri ve Elektronik Para Kurulular Hakknda Kanun un (Kanun) 12nci maddesine yeni eklenen ve  deme Hizmetleri Direktifi 2 'de (Payment Services Directive 2, PSD2) bulunan iki yeni deme hizmeti aadaki gibi tanmlanmtr (ekil-1: deme Hizmetleri Veri Paylam Servisleri): \n \n deme Emri Balatma Hizmeti : HKnn istei zerine baka bir deme hizmeti salaycsnda bulunan  deme hesabyla  ilgili sunulan deme emri balatma hizmeti [Madde 12, birinci fkra, (f) bendi] \n Hesap Bilgisi Hizmeti : HKnn onaynn alnmas kouluyla, HKnn deme hizmeti salayclar nezdinde bulunan bir veya daha fazla  deme hesabna  ilikin konsolide edilmi bilgilerin evrim ii platformlarda sunulmas hizmeti [Madde 12, birinci fkra, (g) bendi] \n \n   \n ekil 1: deme Hizmetleri Veri Paylam Servisleri (HVPS)- tantm \n Kanunun 14/A maddesinin ikinci fkrasna gre , Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetleri ile ilgili ilemlerin yrtlmesine ilikin usul ve esaslar ile taraflarca uyulmas gereken teknik ve operasyonel gereklilikler ikincil dzenlemeler uyarnca Trkiye Cumhuriyet Merkez Bankas (TCMB) tarafndan belirlenir. Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri  deme hizmetleri veri paylam servisleri (HVPS)  olarak adlandrlmaktadr. \n deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelikin (Ynetmelik) 59uncu maddesinin birinci fkras uyarnca hazrlanan bu belgede sz konusu deme hizmetlerini sunacak deme hizmeti salaycsnn, deme hesabnn bulunduu deme hizmeti salaycsnn, varsa ilgili dier taraflarn ve bu hizmetlerin sunulmas iin taraflar arasnda kurulacak balantnn teknik ve operasyonel gereklilikleri aklanmaktadr. \n Dzenlemeler kapsamnda yetkilendirilen nc taraf hizmet salaycs  (Yetkili deme Hizmeti Salaycs, YS) , deme hizmeti kullanclarnn  Hesap Hizmeti Salayclar (HHS)  nezdindeki deme hesaplarna ulaarak deme emri balatma ve hesap bilgisi salama hizmetlerinden (deme hizmetleri veri paylam servislerinden) faydalanmasna araclk eder. deme hizmetleri veri paylam servisleri kapsamnda iki tip YS bulunmaktadr:  1) Hesap Bilgisi Hizmeti Salaycs (HBHS) ve 2) deme Emri Balatma Hizmeti Salaycs (BHS). \n Hesap Bilgisi Hizmeti Salaycs (HBHS) HKnn farkl Hesap Hizmeti Salayclar (HHS) nezdindeki hesaplarnn bilgilerini derleyerek evrim ii platformlarda  toplu ekilde  sunar. deme Emri Balatma Hizmeti Salaycs (BHS) ise talebi zerine HKnn HHSde bulunan deme hesabndan deme ilemi balatr. \n HVPSnin st dzey gsterimi ekil-2de verilmitir. \n   \n ekil 2: deme Hizmetleri Veri Paylam Servisleri (HVPS) -st dzey gsterim \n deme Hizmetleri Veri Paylam Servislerinin HHSler tarafndan  BKM API Geidi  vastasyla sunulduu uygulama mimarisi ise ekil-3te sunulmutur. \n  \n ekil 3: HVPS'nin BKM API Geidi vastasyla sunumu \n"},{title:"6.\tdeme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v1.0.1/contents/odeme-emri-baslatma-hizmeti.html",relativePath:"v1.0.1/contents/odeme-emri-baslatma-hizmeti.md",key:"v-01c649bd",path:"/v1.0.1/contents/odeme-emri-baslatma-hizmeti.html",headers:[{level:3,title:"deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"6.1.\tADIM 0 - deme Emri Balatma Istei",slug:"_6-1-adim-0-odeme-emri-baslatma-istegi"},{level:2,title:"6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas",slug:"_6-2-adim-1-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi",slug:"_6-3-adim-2-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_6-4-adim-2-1-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"6.5.\tADIM 3- deme Emrinin Oluturulmas",slug:"_6-5-adim-3-odeme-emrinin-olusturulmas"},{level:2,title:"6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal)",slug:"_6-6-adim-3-1-odeme-emri-sorgusu-istege-bagl"},{level:3,title:"GET /odeme-emri/{odemeEmriNo}",slug:"get-odeme-emri-odemeemrino"},{level:2,title:"6.7\tHealthcheck API",slug:"_6-7healthcheck-api"},{level:3,title:"GET /health",slug:"get-health"}],content:" 6.\tdeme Emri Balatma Hizmeti \n deme emri balatma ilemi havale, FAST ya da PS demesiyle sonulanabilir. deme ileminin amac kiiden kiiye para transferi, e-ticaret demesi gibi farkl deme trleri olabilir. demenin amacna gre BHSnin iletecei veri setinde farkllamalar olabilir. \n deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n deme Emri Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden deme emrini balatr. \n deme Emri Rza Hazrlanmas:  BHS, deme Emri Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n deme Emrinin Balatlmas:  BHS, deme emrini HHSye iletir. \n deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay Sorgular:  BHS, deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n \n \n ekil 4: deme Emri Balatma Hizmeti st Dzey  Ak \n deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. \n Tablo 6: deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n odeme-emri-rizasi \n POST \n POST /odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n OdemeEmriRizasiIstegi \n OdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n POST/erisim-belirteci /odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n odeme-emri-rizasi \n GET \n GET /odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n OdemeEmriRizaYaniti \n \n \n 3 \n odeme-emri \n POST \n POST /odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n OdemeEmriIstegi \n OdemeEmri \n \n \n 3.1 \n odeme-emri \n GET \n GET /odeme-emri/{odemeEmriNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n OdemeEmri \n 6.1.\tADIM 0 - deme Emri Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) deme emri balatma ilemine onay verir. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas \n   \n ekil 5: deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak deme emri rza kaynann oluturulmasn (odemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi mi? \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahip mi? \n stekte bulunulan HHS kodu doru mu? \n \n \n \n POST baarl olursa, HHS, deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren odemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir OdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme ve bildirim adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde eer kimlik bilgileri iletilmi ise; bu veri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Koullu Zorunlu) \n HHS kimlik bilgisi ile gnderen unvannn uyumlu olduunun kontrol eder. (Zorunlu) \n Gnderen Hesap Numaras ile ilgili Tablo7de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, deme iin benzersiz RizaNo ile OdemeEmriRizasi nesnesi oluturur ve BHSye dner. \n HHS, OdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \nBu aamada HKnn HHS tarafndan tanmlanm ve istein veri alannda gnderen hesaba (borlandrlacak hesaba) ilikin bir bilgisinin olmas gerekmez. \nHesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n \n POST /odeme-emri-rizasi  isteinin (REQUEST) gvdesinde (BODY)  odemeEmriRizasiIstegi nesnesi (Tablo-7) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda odemeEmriRizasi (Tablo-8) nesnesi oluturulur. \n  BAARILI STEK: \n Tablo 7: OdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  YS Ynlendirmeli GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak ynlendirme adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. YSn iletecei adrestir.  YS Ayrk GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak bildirim adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, ayrk GKD sonras bu alanda belirtilen adrese otorizasyon kodunu (authentication code) iletir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n HHS geerli bir para birimi olduu kontrol eder. \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n  \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  TR.OHVPS.Business.InvalidContent  hatas verilmelidir. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir.  Kontrol baarsz olduunda  TR.OHVPS.Business. InvalidAccount  hatas YSe iletilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn unvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr.  FAST-TR Karekod dndaki i yeri demelerinde; yine Unvan alannda iyeri ad bilgisi gnderilmelidir. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden birini alr. \n HHS geerli bir deme Kayna kodu kullanldn kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK iin biricik olarak oluturan referans bilgisi  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tKarekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr. \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir.  4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmriRizasi nesnesi Tablo-8deki parametrelerden oluur: \n Tablo 8: OdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr. \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n >> Unvan \n unv \n AN3..140 \n  \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatt kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden birini alr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK iin biricik olarak oluturan referans bilgisi  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tKarekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisidir. Bu alan ileri vadeli demeler iin dnlmtr. lk fazda doldurulmasna gerek olmad dnlmektedir. \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil 6: deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn deme emrini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK -bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: odemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle,  OdemeEmriRizasi  nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr. HHS,  ADIM 2 -deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  OdemeEmriRizasi  nesnesine iler. \n GET /odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  OdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n Durum \n OdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /odeme-emri-rizasi/{RizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-8de yer alan parametreleri ieren OdemeEmriRizasi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta OdemeEmriRizasi nesnesi gncellenir ve BHS  GET /odeme-emri-rizasi/{RizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren OdemeEmriRizasi nesnesini ekmelidir. \n ereve szleme kapsamnda olmayan tek seferlik deme ilemlerinde, Kimlik Tr ve Kimlik Verisi bilgilerinin deme emri rzas srasnda gnderimi zorunlu deildir. Baarl GKD sonras, yani eriim belirteci alndnda, deme emri olumadan nce, YSn deme emri rzasn sorgulayarak bu bilgileri almas ve deme emrini olutururken Kimlik Tr ve Kimlik Verisi alanlarn dolu olarak gndermesi beklenmektedir.  Ancak rza durumu Yetki Bekleniyor - B, Yetkilendirildi - Y ve Yetki ptal - I statlerinde ise, deme emri rzas sorgulamasnda, HHSnin Kimlik Tr ve Kimlik Verisi bilgisini YS ile paylamamas gerekmektedir. \n 6.5.\tADIM 3- deme Emrinin Oluturulmas \n   \n ekil 8: deme Emrinin Oluturulmas \n POST /odeme-emri \n \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS OdemeEmri kaynan oluturur. \n deme emri (OdemeEmri) uygun deme kaynana POST istei yaplarak balatlr.\n \n POST HHS tarafndan ilenir: RizaDurumu Yetki Kullanld ise ileme balanr. \n POST /odeme-emri-rizasi ile POST /odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr.POST verisindeki Gnderen Hesap Numaras ve Alc Hesap Numarasnn ayn bankaya aitse HAVALE deilse FAST veya PS i akna geilir. \n POST verisinin modele gre kontrol yaplr (alan kontrolleri) \n POST verisinin mantksal kontrolleri yaplr (IBAN kontrol, apraz alan kontroller) \n OdemeEmriDurumu Gerekleti / Gnderildi / Gereklemedi olarak gncellenir. \n \n \n POST baarl olursa, ierisinde OdemeEmriNo ve OdemeEmriDurumu deikenleri de bulunan OdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine Dnt olarak gncellenir. \n \n BAARILI STEK: \n Tablo 9: OdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n deme Emri Rizas Nesnesindeki Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n deme Emri Rizas Nesnesindeki lem Tutar verisi ile ayn olmaldr. HHS ilem tutar deme mesajnda (Havale/FAST/PS) aynen tanmak durumundadr. \n Ttr \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda deme emrinde iletilen maskeli bilgi ile HHSnin kendi deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n demeye zel Referans Bilgisi alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK iin biricik olarak oluturan referans bilgisi -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras -\tKarekod aknda, FAST Karekod Veri Organizasyonundaki -\t62-01: alannda tanml Fatura Numaras -\t62-06: alannda tanml Mteri Numaras verilerinden biri kullanlr. \n deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. FAST:  KareKod ile balatlan ilemlerde FAST A01 mesajndaki Karekod Referans (KrkdRef) alanna karlk gelir. Bu durumda, FAST A01 mesaj alanlar FAST Mesaj Yaps ve lem Trleri belgesin uygun ekilde oluturulur: KareKod (KrKd) blmndeki Karekod Ak Tr (KrkdAksTur) ve Karekod Referans (KrkdRef) alanlar doldurulmaldr.  Kiiden kiiye fon aktarmlarnda ve e-ticaret ilemelerinde Referans Bilgisi (RefBlg) alan doldurulur. \n FAST (KrkdRef) ve (RefBlg) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatt kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK iin biricik olarak oluturan referans bilgisi  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tKarekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n FAST (KrkdRef) ve (RefBlg) \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n FAST/PS Acklm \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Sistemi verisi ile ayn olmaldr. \n \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n deme Emri Rizas Nesnesindeki BHS Masraf Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n deme Emri Rizas Nesnesindeki BHS Masraf Tutar verisi ile ayn olmaldr. \n \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n deme Emri Rizas Nesnesindeki HHS Masraf Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n deme Emri Rizas Nesnesindeki HHS Masraf Tutar verisi ile ayn olmaldr. \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr. \n \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n \n \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: OdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Emir Bilgileri \n emrBlg \n Kompleks: EmirBilgileri \n Z \n \n \n \n > deme Emri Numaras \n odmEmriNo \n AN1..128 \n Z \n deme Emri nesnesinin UID'sidir. OdemeEmrine likin sorgular bu ID zerinden yaplr. \n \n \n > deme Emri Zaman \n odmEmriZmn \n ISODateTime \n Z \n deme emrinin FAST, PS, havale gibi gerekletirilecei ilgili deme sistemine iletilme tarihi. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden birini alr. \n \n \n >> deme Durumu \n odmDrm \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK iin biricik olarak oluturan referans bilgisi  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tKarekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> deme Sistem Numaras \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. FAST ilemleri iin MesRefBlg deeri atanr. deme Hizmeti kullancsna ilemin takibi iin gsterilebilir. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n N1..18 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir. \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal) \n   \n ekil 9: deme Emri Sorgusu \n GET /odeme-emri/{odemeEmriNo} \n BHS, bu eriim adresi araclyla deme emrini sorgulayabilir. \n BAARILI YANIT: \n GET /odeme-emri/{odemeEmriNo} yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren OdemeEmri nesnesi dner. \n 6.7\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr \n Baarl yantta Http 200 kodu dnlmelidir. \n Baarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n"},{title:"4. Rza Durumlar",frontmatter:{},regularPath:"/v1.0.1/contents/riza-durumlari.html",relativePath:"v1.0.1/contents/riza-durumlari.md",key:"v-7301a6d1",path:"/v1.0.1/contents/riza-durumlari.html",headers:[{level:2,title:"4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri",slug:"_4-1-hesap-bilgisi-hizmeti-rza-durum-degisiklikleri"},{level:2,title:"4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri",slug:"_4-2-odeme-bilgisi-hizmeti-rza-durum-degisiklikleri"}],content:" 4. Rza Durumlar \n HK, deme Emri Balatma Hizmetine ya da Hesap Bilgisi Hizmetine mteri rzasnn tesisi ile balar. HKnn YS uygulamas zerinden yapt ilemler neticesinde rza durumlar deiebilir.\nRzann alabilecei durum kodlar u ekilde belirlenmitir. \n B: Yetki Bekleniyor   lk rza talebinde \n Y: Yetkilendirildi   Baarl GKD sonras yetKod retildiinde \n K: Yetki Kullanld   Eriim Belirteci alndnda \n E: Yetki deme emrine dnt   BHS iin \n S: Yetki Sonlandrld \nHBHS iin : Eriimin Geerli Olduu Son Tarih geldiinde \nBHS iin : Yenileme belirteci Son Tarihi geldiinde \n I :Yetki ptal \nRza iptal durumu ise gerek raporlama gerekse mteri deneyimi perspektifinden doru   bilgilendirmeler yaplabilmesi asndan aadaki gibi detay kodlar ile zenginletirilmitir: \n \n Rza ptal Detay Kodu: \n \n \n \n 01 :\tYeni Rza Talebi ile ptal \n 02 :\tKullanc stei ile HHS zerinden ptal \n 03 :\tKullanc stei ile YS zerinden ptal \n 04 :\tSre Am : Yetki Bekleniyor \n 05 :\tSre Am : Yetkilendirildi \n 06 :\tSre Am : Yetki demeye Dnmedi \n 07 :\tGKD iptali : Ayn rza no ile mkerrer arm \n 08 :\tGKD iptali : Rzano ile TCKN uyumamas \n 09 :\tGKD iptali : Uygun rn bulunmuyor \n 10 :\tGKD iptali : HHS Ak Bankaclk kanal ileme kapal \n 11 :\tGKD iptali : Hesap Yetki Sorunu \n 12 :\tGKD iptali : HK HHS mterisi deil \n 13 :\tGKD iptali : HK HHS kontrollerini aamad \n 14 :\tGKD iptali : Baarsz GKD \n 15 :\tGKD iptali : HK istei ile GKDden vazgeildi \n 16 :\tGKD iptali : Dier \n \n \n 4.1 ve 4.2 blmlerinde detaylandrlan rza durum deiikliklerinde rza iptal detay kodlar kullanlmtr. \n rnein B I/01 denildiinde Yetki Bekleniyor rza durumundan Yetki ptal rza durumuna Rza ptal Detay Kodu da 01 yani Yeni Rza Talebi ile ptal olarak gncellenmelidir ifade edilmitir. \n HK verdii rza srasnda setii hesaplarndan biri kapatlrsa, dier hesaplara ait bilgileri grmeye devam eder. Ancak HKnn hesabna ait bilgilerinin YS'e iletilmesini istemedii durumda, rzasn tamamen iptal ederek yeni hesap listesi ile yeni rza vermesi gerekmektedir. Yani hesap kapanmas nedeniyle rza geerliliini yitirmez. HK'nn proaktif olarak bu hesab rzadan karmas durumunda rza iptali olur. \n Rza iptal edilmedii ve geerli olduu srece kapal hesaplar iin dier evrimii kanallarda uygulanan yntem izlenmelidir. Dier evrimii kanallarda kapal hesaplara ilikin bilgi dnlmyor ise HVPS'den de dn yaplmaz. HKnn rza onay verdii ak hesaplarnn tm HHS tarafnda kapatld durumda, yine ayn ekilde HHS evrimii kanallarnda koyduu kurallara gre bu hesaplarnn YS uygulamasnda gsterilmesine karar verir. \n Hesap kapama ve ticari kullanclarn hesaplar zerindeki yetki deiiklikleri HHS'nin i sistemleri tarafndan yaplan kontrollerle ynetilir. Buradaki deiiklikler ile HHS sistemsel olarak rza iptali gerekletiremez. HK izni ve onay dahilinde rza iptal gerekletirilmesi gerekmektedir. \n 4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri \n Kural : Bir HK'nn, bir YS iin, bir HHS'de Y, K, B rza durumlarnda tek bir rzas olabilir.\nBir HK hem kiisel olarak hem de bir kurumun kullancs olabilir. Bu durumda kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n Hesap Bilgisi Rzas istei HHSye iletilir. \na.\tHHS HK'ya ait ieride rza var m kontrol eder. Eer yoksa  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \nb.\tEer ieride rza varsa \n i. Rza durumu Yetki Bekleniyor - B ise; \n    HHS, sistemde Yetki Bekleniyor - B rza durumuna sahip kayt olduu iin, ncelikle eski kayd Yetki ptal - I durumuna getirir.  Rza ptal Detay Kodu Yeni Rza Talebi ile iptal olmaldr.  B  I / 01  Sonrasnda,  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \n  ii. Rza durumu Yetkilendirildi - Y veya Yetki Kullanld - K ise; \nHK'nn halihazrda verilmi bir rzas vardr. HHS, nce mevcut rzann iptalinin yaplmas gerektiine dair hata dner.  TR.OHVPS.Resource.ConsentMismatch \n  iii.\tRza durumu Yetki Sonlandrld - S  ise Yetki Bekleniyor - B durumunda yeni rza no oluturur. \n  iv.\tRza durumu Yetki ptal - I ise  Yetki Bekleniyor - B  durumunda yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda Rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.  B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Taraycy kapatm olabilir) Rza Yetki Bekleniyor - B rza durumunda kalr.  5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B rza durumundaki kaytlar Yetki ptal  : Yetki Bekleniyor Sre Am olarak gncellenir.   B  I / 04  Bkz. 9. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine  rizaIptDtyKod  deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HK'nn ilgili HHS mterisi olmad durum Yetki Bekleniyor  Yetki ptal  B  I / 12 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 13 \n \n \n HK kendini dorulayamam olabilir. Baarsz GKD Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 15 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 16 \n \n \n \n \n \n \n HK, hesaplarnda/izin trlerinde/Eriimin Geerli Olduu Son Tarih bilgilerinden bir ya da birden fazlasnda gncelleme yapmak iin YS ekranna girer. \n \n \n a.\tYS nce Rza ptal API'sini arr. Sonra yeni deerlerle yeni bir rza isteinde bulunur. Tekrar GKD gerekir. \n b.\tYS rza iptal yapmadan yeni rza alma akna balarsa 1.b ak devreye girer. \n c.\tRza gncelleme ilerleyen srmlerde ele alnacaktr. \n \n \n Eriim Belirteci API \n a. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B ya da Yetki Kullanld - K  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n Sorgulama: HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir hesap bilgisi-rizasi kaynann durumunu, istee bal olarak alabilir. Rza numaras ile sorgulama yaplr. \n \n \n Hesap Bilgisi Rzasnn ptali: HBHS zerinden ya da HHS zerinden yaplan rza iptallerinde Rza durumu  Yetki ptal - I olarak gncellenir. Rza numaras ile iptal salanr. \n a. HHS zerinden rza iptali yapm olabilir.  Rza durumu sorgulanr. \n Rza numaras Yetki Bekleniyor - B ve Yetkilendirildi - Y ve Yetki Kullanld - K durumlarnda ise Yetki ptal durumuna getirilir. Rza gnclzmn timestamp ile gncellenir.\nHHS, Rza iptalinde ayn zamanda eriim belirtecini de invalid hale getirmelidir. \n B  I / 02 \n Y  I / 02 \n K  I / 02 \n b.\tYS zerinden yaplacak iptal ileminde yine Y ve B ve K rza durumlarnda ise iptal edilebilir. \n B  I / 03 \n Y  I / 03 \n K  I / 03 \n Rza durumu Yetki Sonlandrld - S  ise iptal gereklemez. Rza durumunuz iptal etmeye uygun deildir. hatas HK'ya yanstlr.  TR.OHVPS.Resource.ConsentMismatch \n \n \n HKnn verdii rza sresi dolmu olabilir.\nEriimin Geerli Olduu Son Tarih geldiinde Rza durumu Yetki Kullanlddan Yetki Sonlandrld durumuna ekilmelidir.   K  S \n \n \n Hesaplar, Bakiye ve lemler servislerinde eriim belirteci kontrol ve sonrasnda rza kontrol yaplmaldr.\nGeerli bir eriim belirteci yok ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda Hesaplar, Bakiye ve lemler servislerini armamas beklenir. HHS'nin bu rza durumlar ile yaplm arlar olduunda  TR.OHVPS.Resource.ConsentRevoked  hatasn dnmesi gereklidir. \n Rza durumu Yetki Kullanld - K dnda ise  TR.OHVPS.Resource.ConsentMismatch  hatas verilmelidir. \n Rza durumu Yetki Kullanld - K ise servis aklarna devam edilir. \n Rza sorgulama API'sinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound hatas  verilmelidir. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor durumunda kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor   Rza ptal  / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi durumunda kalan kaytlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am: Yetkilendirildi  B  I / 05 \nYukarda bahsedilen, YS Sre Am nedeniyle rza iptal durum gncellemelerini yapmadan nce HHSyi sorgulayarak rza durumunu renmeli ve sre am dnda bir kodu varsa ayn kodla kendi sistemini gncellemelidir. \nEriimin Geerli Olduu Son Tarih geldiinde rza durumu Yetki Kullanlddan Yetki Sonlandrldya gncellenir.  K  S \n 4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri \n Kural : Bir HK'nn bir YS iin bir HHS'de istedii kadar rzas olabilir. \n Kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n deme Emri Rzas istei HHSye iletilir. eride rza olup olmamasna baklmakszn  Yetki Bekleniyor - B  rza durumu ile yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.   B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Browser kapatm olabilir)\nRza durumu Yetki Bekleniyor'dur. 5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B durumundaki kaytlar Rza ptal : Yetki Bekleniyor Sre Am olarak gncellenir. Bkz. 8. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine rizaIptDtyKod deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HK'nn ilgili HHS mterisi olmad durum Yetki Bekleniyor  Yetki ptal  B  I / 12 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 13 \n \n \n HK, kendini dorulayamam olabilir. Baarsz GKD Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 15 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 16 \n \n \n \n \n \n \n GKD muafiyeti olduunda YS HHSden arka planda onay alr. Bu onay srasnda rza durumu  Yetkilendirildi  yaplr.  B  Y \n \n \n Eriim Belirteci API \na. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B , Yetki Kullanld - K  ya da Yetki deme emrine dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K veya Yetki deme Emrine Dnt  E olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n deme Balatma API nce eriim belirteci ve sonrasnda rza kontol yaplarak gerekletirilmelidir \n \n ncelikle Eriim Belirteci kontrol yaplmaldr. Geerli bir Eriim Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n Rza durumu Yetki Bekleniyor - B , Yetkilendirildi - Y, Yetki deme Emrine Dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n Rza durumu Yetki Kullanld - K olduunda deme emri gerekletirilir.  Rza durumu Yetki Kullanld - K'dan Yetki deme Emrine Dnt  E yaplmaldr.   K E \n \n \n \n Sorgulama: GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlarda, deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle, demeEmriRizasi nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr.\nRza sorgulama, deme Emri Sorgulama API'lerinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n \n \n deme Emri Rzasnn ptali bulunmamaktadr. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor'da kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor  Rza ptal / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi'de kalan kaytlar durumlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am : Yetkilendirildi  B  I / 05 \n 5 dakikadan uzun sredir Yetki kullanld'da kalan kaytlar durumlar gncellenir.\nYetki kullanld  Rza ptal / Sre Am : Yetki demeye Dnmedi  B  I / 06 \n Yenileme belirteci Son Tarih geldiinde rza durumu Yetki deme emrine dntden Yetki Sonlandrld'ya gncellenir. \n E  S \n \n \n GKD muafiyeti sadece deme balatma servislerinde bulunmaktadr. \n \n \n"},{title:"3. Temel Prensipler",frontmatter:{},regularPath:"/v1.0.1/contents/temel-prensipler.html",relativePath:"v1.0.1/contents/temel-prensipler.md",key:"v-432b5bd6",path:"/v1.0.1/contents/temel-prensipler.html",headers:[{level:2,title:"3.1 Genel",slug:"_3-1-genel"},{level:2,title:"3.2.\tstem (ar) ve Oturum",slug:"_3-2-istem-cagr-ve-oturum"},{level:2,title:"3.3.\tRESTful API",slug:"_3-3-restful-api"},{level:2,title:"3.4.\tSrm Ynetimi",slug:"_3-4-surum-yonetimi"},{level:2,title:"3.5.\tKaynak URI Yol Yaps",slug:"_3-5-kaynak-uri-yol-yaps"},{level:2,title:"3.6.\tKarakter Kodlama",slug:"_3-6-karakter-kodlama"},{level:2,title:"3.7.\tVeri Format",slug:"_3-7-veri-format"},{level:2,title:"3.8.\tstemci Sertifika Ynetimi",slug:"_3-8-istemci-sertifika-yonetimi"},{level:2,title:"3.9.\tYetkilendirme Trleri",slug:"_3-9-yetkilendirme-turleri"},{level:2,title:"3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar",slug:"_3-10-istek-cevap-mesajlarnda-kullanlan-nesne-yaplar"},{level:2,title:"3.11. Sayfalandrma ve Filtreleme",slug:"_3-11-sayfalandrma-ve-filtreleme"},{level:2,title:"3.12. Mesaj mzalama",slug:"_3-12-mesaj-imzalama"},{level:2,title:"3.13. Durum Kodu",slug:"_3-13-durum-kodu"},{level:2,title:"3.14. Gereksinimlerinin Snflandrlmas",slug:"_3-14-gereksinimlerinin-snflandrlmas"},{level:2,title:"3.15. stek Bal",slug:"_3-15-istek-baslg"},{level:2,title:"3.16. Yant Bal",slug:"_3-16-yant-baslg"},{level:2,title:"3.17. Idempotency Kurallar",slug:"_3-17-idempotency-kurallar"},{level:2,title:"3.18. HTTP Durum Kodlar",slug:"_3-18-http-durum-kodlar"},{level:2,title:"3.19. Maskeleme Kurallar",slug:"_3-19-maskeleme-kurallar"},{level:2,title:"3.20. Fonksiyonel Olmayan Gereksinimler",slug:"_3-20-fonksiyonel-olmayan-gereksinimler"}],content:' 3. Temel Prensipler  \n Bu blmde deme Hizmetleri Veri Paylam Servisleri (Hesap Bilgisi Hizmeti, deme Emri Balatma Hizmeti) iin tanmlanan temel prensipler aklanmaktadr. \n 3.1 Genel \n \n \n HHSler Ynetmeliin 59. maddesinin beinci fkras ve deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebliin (Tebli) 23. maddesinin birinci fkras uyarnca, deme hizmetleri veri paylam servislerini BKM API Geidi araclyla HBHS ve BHSye sunmakla ykmldr. \n \n \n Tebliin 23. maddesinin ikinci fkras uyarnca deme emri balatma hizmetinde ak iletiim servisinin taraflar BHS ile HHSdir. \n \n \n Tebliin 23. maddesinin nc fkras uyarnca hesap bilgisi hizmetinde ak iletiim servisinin taraflar HBHS ile HHSdir. \n \n \n Ynetmeliin 60. maddesinin birinci fkras uyarnca mteri, deme emri balatma hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Ynetmeliin 61. maddesinin birinci fkras uyarnca mteri, hesap bilgisi hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Tebliin 25. maddesi uyarnca HHS ve YS (BHS ve HBHS) arasnda balant utan uca gvenli bir ekilde salanr. Bu amala iletim katmannda TLS (asgari 1.2 srm) ile ifreli iletiim salanr. \n \n \n Tebliin 23. maddesinin drdnc fkras uyarnca HHS tarafndan sunulan deme hizmetleri veri paylam servislerini kullanan yetkilendirilmi deme hizmeti salayclarnn TCMB tarafndan ilgili deme hizmeti iin yetkilendirilmi olduu kontrol edilir. \n \n \n Tebliin 25. maddesinin beinci fkras uyarnca zaman damgas, 15/1/2004 tarihli 5070 sayl Elektronik mza Kanunu kapsamnda tanmlanan zaman damgasna dayanr. \n \n \n API alan isimleri Trke olarak tanmlanmtr. Ancak API bal (header) alanndaki alan isimleri zelinde, API Geitleri tarafndan otomatik olarak tannabilmesi gzetilerek, ngilizce isimlendirme tercih edilmitir. \n 3.2.\tstem (ar) ve Oturum \n \n \n Her istek biricik istek numaras ve HKl ilemler iin zaman damgas ierir. Birden fazla istek ieren ilem YS tarafndan belirlenen arya zg talep kimlii (istek numaras: x-request-id) ve ilem akna zg talep kimlii (ilem grup numaras: x-group-id) deerleri kullanlarak HHS tarafndan bir oturum yaklam ile srdrlr (Bknz. 3.15 stek Bal). \n \n \n Oturum takibi ise ilem grup numaras ile yaplr. lem grup numaras da HKl ilemler iin zaman damgas ile birlikte ilgili tm ilem verilerini ierecek ekilde kayt altna alnr. \n \n \n rnein, bir deme emri balatma ilemi birden fazla istekten oluur. Her istek yukarda belirtildii gibi biricik istek numaras ve HKl ilemler iin zaman damgas ierir. Ancak ilemin oturum btnl ilem grup numaras ile salanr. \n \n \n Taraflar atklar oturumu ilem btnln salayacak sre ierisinde ak tutar ve ilem biter bitmez kapatr. \n 3.3.\tRESTful API \n APIler, dnya leinde yaygn bir ekilde kullanlan Temsili Durum Transferi (Representational State Transfer, REST) mimari tarz ve JavaScript Nesne Notasyonu (JavaScript Object Notation, JSON) veri formatlarna uygun olarak gelitirilir. En st seviye Veri Tanmlama Dili (Data Description Language) ve en iyi uygulama rnekleri iin  ^JSON emas  temel alnr. \n 3.4.\tSrm Ynetimi \n API sonraki aamalarda doabilecek gereksinimleri ve daha karmak kullanm durumlarn karlamak iin srmler halinde gelitirilir ve bu durum tasarm srasnda gz nnde bulundurulur. \n API v1.0 srmnde ; \n \n Kapsamdaki deme hesaplar : Vadesiz TL, yabanc para hesaplar (gerek ve tzel kiilere ait deme hesaplar), Kredili Mevduat Hesab \n Tekil deme (Virman/Havale/FAST/Mterileraras TL Aktarm Sistemi)\n \n Virman ve havale ilemleri kapsamnda yabanc para transferi yaplabilir. \n \n \n Hesap bilgisi hizmetleri\n \n Temel veya ayrntl hesap bilgisi \n Bakiye \n Gerekleen ilemler iin Hesap hareketleri \n \n \n Karekodlu demelerdeki 01, 02 ve 03 ak trleri\nyer almaktadr. \n \n Her srm deiikliinde bir nceki srm belirli bir sre desteklenecektir. Dier bir ifadeyle, sadece belirli bir sre iin mevcut ve bir nceki srm ayn anda eriilebilir olacaktr. \n 3.5.\tKaynak URI Yol Yaps \n YSlerin balatt arlarda URI yolu aadaki yapy takip eder: \n [hhs-yol-n-eki]/ohvps/ [kaynak-grubu]/ [srm]/ [kaynak]/[kaynak-no]/[alt-kaynak] \n Bu, aadaki unsurlardan oluur: \n \n [hhs-yol-n-eki] \nstee bal, HHS\'ye zg yol n ekini ifade eder. \nBKM API geidi zerinden yaplan arlarda BKM tarafndan belirlenen sistem ad ve yol n eki kullanlr. \n ohvps \nSabit metin ohvps (deme Hizmetleri Veri Paylam Servisleri ksaltmas) \n [kaynak-grubu] \nKaynak grubu, APIye erimek iin kullanlan deme hizmetine (HBH, BH) gre eriim adresi (end point) grubunu tanmlar (hbh veya obh). \n [srm] \nAPI srmn ifade eder (/s[ana-srm].[alt-srm]/). \n [kaynak]/[kaynak-no] \nKaynak detaylarn ifade eder. \n [alt-kaynak] \nAlt kaynak detaylarn ifade eder. \n \n HHS, tm kaynaklar iin ayn katlmc yolu n ekini ve sistem adn kullanmaldr. \n BKM APIlerine erimek isteyen uygulamalarn yetkilerine gre aadaki APIlere abone olmalar gerekmektedir: \n OBH: \n https://apigw-prod.bkm.com.tr/api/main/ohvps/obh/s1.0/odeme-emri-rizasi \n https://apigw-prod.bkm.com.tr/api/main/ohvps/obh/s1.0/odeme-emri \nHBH: \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesaplar \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesaplar/1234/islemler \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesaplar/1234/bakiye \nGKD \n https://apigw-prod.bkm.com.tr/api/main/ohvps/gkd/s1.0/erisim-belirteci \nHHS  YS API \n https://apigw-prod.bkm.com.tr/api/main/hhs-api/s1.0/hhs \n https://apigw-prod.bkm.com.tr/api/main/hhs-api/s1.0/hhs/1234 \n https://apigw-prod.bkm.com.tr/api/main/yos-api/s1.0/yos \n https://apigw-prod.bkm.com.tr/api/main/yos-api/s1.0/yos/1234 \n HHSlerin salayacaklar APIlerdeki URI evrimi rnekleri aadaki gibidir. \n \n https://xbank.com.tr/api-portal/ohvps/obh/s1.0/odeme-emri \n https://apigw-prod.bkm.com.tr/api/main/ohvps/obh/s1.0/odeme-emri  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesap-bilgisi-rizasi  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.1/hesaplar   (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar/1234 \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.1/hesaplar/1234  (BKM API) \n \n BKM API Geidi zerinden yaplan arlarda, istek balnda bulunan x-aspsp-code (istein iletildii Hesap Hizmeti Salaycsnn kodu) deerine gre HHS APIde standart olarak tanmlanm olan basePath bilgisine servis uzants eklenerek HHSye ynlendirme yaplr. \n rnein, istek balnda  xbank n kodu varsa, YS tarafndan yaplan \n https://apigw-prod.bkm.com.tr/api/main/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \nars BKM API Geidi tarafndan karlanarak \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \nadresine ynlendirilir. \n Bu rnekte,  https://xbank.com.tr/api-portal  basePath bilgisi HHS tarafndan HHS APIye girilen deerdir. \n 3.6.\tKarakter Kodlama \n API istekleri ve yantlarnda UTF-8 karakter kodlamas kullanlr. Bu, JSON iin varsaylan karakter kodlamasdr. \n Ancak, bir HHS\'nin kendi uygulamalar ve deme balatt deme sistemi (FAST vb.)  baz UTF-8 karakterlerini kabul etmeyebilir. HHS, UTF-8 kodlamas ieren bir mesaj ileyemez ve reddederse, HTTP 400 (Hatal stek) durum kodu ile yant vermelidir. \n 3.7.\tVeri Format \n \n Ak bankaclk kapsamndaki zaman damgas, ISO 8601 standartna uygun olarak yerel saat bilgisini ve timezone bilgisini de ierecek ekilde " yyyy-MM-ddTHH:mm:ssXXX " formattaki haliyle hazrlanmaldr. \n \n rnek:  "timestamp": "2021-05-30T20:34:15+03:00" \nyyyy : 4 hane yl \nMM : Baa 0 eklenmi, toplam 2 hane ay \ndd    : Baa 0 eklenmi, toplam 2 hane gn \nHH    : Baa 0 eklenmi, toplam 2 hane saat (0-23 aras deer alabilir.) \nmm : Baa 0 eklenmi, toplam 2 hane dakika \nss    : Baa 0 eklenmi, toplam 2 hane saniye \nXXX : ISO 8601 Time zone \n \n JWT veri paketlerinde kullanlan zaman damgalar, 1 Ocak 1970 Saat 00:00:00 (UTC) anndan itibaren geen saniye says deerini (Unix Time) kullanr. \n Bir HHS, tarihi yanl biimlendirilmi bir istek aldnda, 400 (Hatal stek) durum kodu ve ilgili hata kodu ile yant verir. \n Tm tutar alanlar tam say olarak, para birimleri ise ISO4217deki 3 harfli kodla iletilir. Tutar alan, tutara ilikin para biriminin ISO4217de tanml olan tam saydan sonraki uzunluuna gre formatlanarak okunmaldr. rnein 1,20 TRY iin tutar alannda 120 deeri iletilir, para birimi TRY olduu iin son iki basaman kuru olduu sonucuna ulalacaktr. 12000 Japon Yeni iin, ISO4217de JPY para biriminin ondalk ksm olmadndan tutar alannda 12000 deeri iletilir. \n Sral veri tipleri byk kk harfe duyarldr. \n Altn para birimi ISO4217ye uygun biimde XAU cinsinde ve virglden sonra 2 basamak olacak ekilde iletilmelidir. rnein ierisinde "13,5 gr" altn olan hesap iin bakiye 1350 gnderilmelidir. \n 3.8.\tstemci Sertifika Ynetimi \n HVPS kapsamnda YS ve HHSlerin gvenli bir ekilde tanmlanmas amacyla elektronik sertifikalar kullanlr. \n HVPS kapsamnda taraflarn gvenli bir ekilde tanmlamas, utan uca gvenli iletiim, mesaj ifreleme ve mesaj imzalama ilevleri 15/1/2004 tarihli ve 5070 sayl Elektronik mza Kanununda aklanan elektronik sertifikalar kullanlarak salanr. Elektronik sertifikada Trkiye Cumhuriyet Merkez Bankas tarafndan verilen kurulu kodu ve kuruluun trne dair bilgiler bulunur. \n BKM API Geidi zerinden yaplan eriimlerde YS ve HHSlere nceden datlm olan istemci sertifikalar kullanlarak taraflarn (sunucu) kimliklerinin dorulanmas salanacaktr. stemci sertifikalar hem test hem de retim ortamnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii sertifikasyon srecinde de snanacaktr. Sz konusu sertifikalarn datm prosedrleri ve kullanmlara ynelik aklamalar EK-3te yer verilmitir. \n 3.9.\tYetkilendirme Trleri \n BKM API Geidi zerinden yaplan arlarda iki temel yetkilendirme tr kullanlr: \n 1.\tstemci Kimlik Bilgileri:  Mteri onaynn gerekmedii, sadece YSn tanmlanp doruland API arlarnda kullanlr. YSn yetkilendirilmi olduu ve faaliyet izninin yapt hizmet arsna uygun olduu kontrol edilir.  Bu amala, YSlere clientId ve clientSecret tahsis edilecektir. YSler ilgili clientId ve clientSecret ile sadece yetkilendirilmi olduklar servislere eriebileceklerdir. YSler kendilerine BKM tarafndan sunulacak APIyi, kendi clientID ve clientSecret deerleri ile sorgulayarak stemci Kimlik Bilgileri belirtecini (access token) elde edeceklerdir.\nHHSler de BKM API geidi zerindeki YS APIsini sorgulama maksad ile BKM API Geidine geldiklerinde, kendilerine atanm olan clientID ve clientSecret bilgileri ile yetki kontrolleri yaplr.\nHHSler kendilerinden alnacak username ve password deerleri kullanlarak oluturulacak basic authentication metodu ile servislerini sunacaklardr. \n 2.\tYetkilendirme Kodu:  YSn dorulanmasnn yansra mterinin GKD ile dorulanmas gereken API arlarnda kullanlr. Mteri dorulanarak yetkilendirme kodu oluturulmas HHSnin yetkilendirme arayzne ynlendirilir. GKDnin baaryla tamamlanmas sonrasnda yetkilendirme kodu YSe dnlr. YS daha sonra HHSnin  eriim belirteci  (access token) eriim adresini (EK-3: POST /erisim-belirteci) armak suretiyle yetkilendirme kodunu bir eriim belirteci (access token) ile deitirerek ilgili kaynaklar kullanabilir. \n deme emri balatma ve hesap bilgisi hizmetlerinde hangi yetkilendirme trlerinin kullanlaca bilgisi, ilgili balklardaki eriim adresleri (endpoints) tablolarnda yer almaktadr. \n erisim-belirteci  erisim noktasndan elde edilen  erisimBelirteci  ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda  x-access-token  alannda iletilir.\nBelirli bir sre iin tanmlanan eriim belirteci (access token) deerinin yenileme belirteci (refresh token) ile yenilenmesi gerekir. \n Eriim adreslerinde kullanlan yetkilendirme tr ilgili eriim adresi tablolarnda belirtilmitir. \n 3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar \n stek ve Cevap mesajlarnda kullanlacak olan nesneler tm elemanlarn kapsayacak ekilde Ek-1 de listelenmitir. Tm listelenen elemanlar asndan (U nokta mesaj yaplarnn belirtildii tablolarda belirtildii zere) alann Zorunlu (z) veya stee Bal () olma durumlarna gre baz alanlar gnderilebilir veya gnderilmeyebilir. \n 3.11. Sayfalandrma ve Filtreleme \n Sayfalandrma \n arya dnlen kaynak nesnesi ierisindeki kaytlar bir sayfalandrma yaps ile arlacak ekilde istek oluturulur. \n Oluturulacak istein ierisinde parametreler ile filtreleme, sayfa bana gsterilecek kayt says ve hangi sayfann nyzde gsterilecei bilgileri eriim noktasna iletilir ve ilgili kaytlar cevap olarak alnr. \n Filtreleme \n HHS, birden ok kayt dnlmesi gereken GET arlarnda snrl filtreleme destei salamaldr. Filtre parametreleri her zaman kaynak nesnesinin belirli alanlarna zgdr ve nesne iin tanmlanan kurallara uymaldr. \n 3.12. Mesaj mzalama \n Elektronik imzalar, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini destekler. mzalarn kaynak baznda hangi istek ve yantlara uyguland belirlidir. \n API yalnzca TLS\'ye dayanrsa, dijital kaytlar ve inkr edilemezlik kantlarn tutmak zor olur. Bu nedenle, TLS\'ye dayanmayan bir inkr edilemezlik zm olarak API isteinin HTTP balnda bir JWS kullanlarak salanabilir. \n HTTP isteinin gvdesinin hash fonksiyonu (SHA256) ile zeti alnacaktr. Elde edilen zet, asimetrik anahtarlar destekleyen bir algoritma kullanlarak imzalanacak ve JWS elde edilecektir. \n Bir istek, YS\'nin zel anahtar ile imzalanacak ve bu istee karlk gelen yant, HHS\'nin zel anahtar tarafndan imzalanacaktr. \n Tm API istekleri ve yantlar imzalanmaz. Mesaj imzalamann zorunlu olup olmad, desteklenip desteklenmedii her API zelinde belirlenir. \n Anahtar Deposu \n HHS\'ler ve YS\'ler tarafndan gvenilen bir Gven Otoritesi (Trust Anchor), taraflar iin bir genel anahtar deposu salamaktan sorumludur. \n Gven Otoritesi, taraflardan herhangi birisinin oluturduu bir anahtar iftinin ak blmn saklayan merkezi bir dizin (BKM tarafndan tutulan merkezi kayt sistemi vb.) olacaktr. \n Mesajlar dorulamak iin taraflarn genel anahtarlarnn paylalmas iin BKM bir servis salayacaktr. HHS API olarak adlandrlm olan bu servis ile HHS ve YS listelerine ulalabildii gibi dorulama ilemi iin ihtiya duyulacak olan genel anahtarlara da bu servis zerinden eriilebilinecektir. \n lgili Mesaj ifreleme iin genel ak, Ek-5 blmnde detaylaryla paylalmaktadr. \n 3.13. Durum Kodu \n APIler, iki farkl amaca hizmet eden iki durum kodu kullanr: \n \n HTTP Durum Kodu, API arsnn (kaynaktaki HTTP ilemi) sonucunu yanstr. \n Baz kaynak payloadlarndaki Durum alan, kaynaklarn durumunu yanstr. \n 3.14. Gereksinimlerinin Snflandrlmas \n Eriim adreslerinin ve alanlarn kullanm Zorunlu(Z), stee Bal() veya Koullu(K) olabilir. Kullanmlara ilikin durumlar ve kullanmn (K) koullu olduu duruma ilikin aklamalar ilgili tablolarda belirtilmitir. \n stek ve yantta kullanlacak balk isimleri, ilgili RFC dokmanlarnda ve aadaki tabloda yer ald ekilde kullanlacaktr.  Uygulamaya zellemi balklar "X-" ile balayacaktr. Balk isimlerinde yer alacak ksaltmalar (rn. PSU, ASPSP gibi) tamam byk harfle yazlacak ekilde tanmlanacaktr. Balk isimleri byk  kk harfe duyarl olmamaldr. rnein x-request-id ya da X-Request-ID olarak gnderilmi olan bir istek bal deikeni, sunucu tarafnda hata vermeyecek ekilde ilenebilmelidir. \n 3.15. stek Bal \n Tablo 2: stek Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n POST \n GET \n DELETE \n \n \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras.   rnek: deme emri balatma i aknn her admda farkl x-request-id deeri kullanlr.   arlarn ayn yant dnmesinin beklendii durumlarda (idempotent ilemlerde) ayn deer ile ar yaplr. \n Z \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras.  Ayn rza noya ait tm isteklerde ayn x-group-id bilgisi deeri gnderilmelidir. rnek: deme emri balatma/hesap bilgisi i aknn her admnda ayn x-group-id deeri kullanlr. \n Z \n Z \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder: application/json  (Baka bir deere ayarlanrsa, HHS, 415 Desteklenmeyen Ortam Tr (Unsupported Media Type) ile yant vermelidir) \n  \n - \n - \n \n \n X-ASPSP-Code \n AN4 \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n Z \n \n \n PSU-Auth-Date \n ISODateTime \n HKnn YS zerinde en son oturum at saat. [RFC7231] rnein:  auth-date: Tue, 11 Sep 2012 19:43:31 GMT \n  \n  \n  \n \n \n PSU-IP-Adress \n AN7..15 \n HK YS zerinde oturum amsa, ilemi balatt cihazn IP adresi. \n  \n  \n  \n \n \n PSU-IP-Port \n AN1..5 \n HK YS zerinde oturum amsa, ilemi balatt cihazn Port adresi. \n  \n  \n  \n \n \n PSU-GEO-Location \n AN1..36 \n HKnn ilemi balatt cihazn konum bilgisi. RFC2426 standartna uygun olarak paylalmaldr. rnein  GEO:"<enlem >, <boylam>GEO:52.506931,13.144558 \n  \n  \n  \n \n \n PSU-User-Agent \n AN 1.. 255 \n HKnn ilemi balatt cihazn salad user-agent bilgisi. (Tarayc, versiyon, iletim sistemi bilgileri) \n  \n  \n  \n \n \n PSU-Timestamp \n ISODateTime \n HKnn ilemi balatt cihazn tarih saat ieren zaman bilgisi. \n  \n  \n  \n \n \n PSU-Device-ID \n AN5..40 \n HK ilemi mobil uygulama araclyla balattysa, kullanlan mobil uygulama ilk yklendiinde oluturulan tekil cihaz veya uygulama belirteci. HK cihaznn UUID deeri kullanlabilir. \n  \n  \n  \n \n \n PSU-Device-Data \n AN1..1024 \n HKnn ilemi balatt mobil cihaza ait veriler.  rnek alanlar:   - Platform - (Android, iOS, Windows 10 Mobile)  - Device Model   - OS Name   - OS Version - Locale - Time zone \n  \n  \n  \n \n \n PSU-Initiated \n AN1 \n lemin HK tarafndan balatlmas durumunda E , sistem tarafndan balatld durumda H deerini almas beklenir.   lemler servisinde yaplacak sistemsel sorgulardaki ilem limitlerini kontrol amacyla kullanlr. \n Z \n Z \n Z \n \n \n Authorization \n AN1..4096 \n YS ile BKM API Gateway arasndaki otorizasyon iin kullanlan token bilgisidir.  Yekilendirme trlerinden stemci Kimlik Bilgilerini adresler. \n Z \n Z \n Z \n \n \n X-Access-Token \n AN1..4096 \n HKnn GKD srecinde dorulanmas sonrasnda kullanlan eriim simgesi. Yetkilendirme trlerinden Yetkilendirme Kodu (GKD)nu adresler. \n  \n  \n  \n \n \n X-JWS-Signature \n AN1..4096 \n Payload gvdesinin ayrlm bir JWS imzasn ieren stbilgi.  Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n K (Kullanlan API ve methoda gre kullanlr.) \n K \n K \n 3.16. Yant Bal \n Tablo 3: Yant Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n Kullanm Durumu \n \n \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras    lgili istek balndaki bilgi geri dnlr. \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras. lgili istek balndaki bu deer geri dnlr. \n Z \n \n \n X-ASPSP-Code \n AN4 \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n \n \n X-TPP-Code \n AN4 \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder:  application/json \n  \n \n \n X-JWS-Signature \n AN1..4096 \n JWS imzasn ieren stbilgi. Bu baln hangi yantlar iin kullanlmas gerektii ilgili endpoint iin belirtilmitir. \n K \n \n \n Retry-After \n AN 1..255 \n YSn bir istei yeniden denemeden nce beklemesi gereken sreyi (saniye cinsinden) gsterir. HHS, 429 HTTP durum kodu (Too Many Requests) ile dnd yantlarn balnda bu bilgiyi dnmelidir. \n K \n \n \n x-total-count \n N 1..18 \n Hesaplar, lemler ve Bakiye servislerinde sayfalama kullanld durumda, sorgu sonucu dnecek toplam kayt says bilgisi, bu alanda HHS isteine bal olarak gnderilebilir. \n  \n \n \n Link \n 1..4096 \n Link alannn oklu sayfa yaps olmas durumunda gnderilmesi zorunludur.  Sayfalama yaps kullanldnda gelen yantta birden fazla sayfa var ise; nceki, sonraki, ilk, son sayfalara gitmek iin gerekli referanslar link headernda aadaki rnekteki gibi doldurulabilir.  x-total-count alannn gnderimi istee bal olduu iin; Link ierisindeki son sayfa bilgisi  (last) istee bal hale getirilmitir. nceki( prev) ve Sonraki (next) admlarnn uygun olan her durumda yer almas zorunludur. lk sayfada nceki seenei olmamal, son sayfada ise Sonraki seenei olmamaldr.    </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=6&syfKytSayi=100>; rel="next",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=4&syfKytSayi=100>; rel="prev",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=14&syfKytSayi=100>; rel="last",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=0&syfKytSayi=100>; rel="first" \n K \n 3.17. Idempotency Kurallar \n YSn aadaki durumlarda ayn istek numaras (x-request-id) ve ayn veri gvdesiyle ary tekrarlamas; HHSnin de bu durumlarda ayn yant dnmesi gereklidir. \n \n HHSnin yant kesinti/arza nedeniyle YSe ulamaz ve zaman am sz konusu olmas, \n HK, YS uygulamas zerinden ift tklama ile mkerrer defa HHS APIlerini arlmas,\n(API kontrollerinden nce YS uygulamasnn, ift tklama kontrol yapmas nerilmektedir.) \n YS, yant almasna ramen ileyemeden kaybedilmesi, \n \n durumlarnda HHS aadaki kurallar iletir: \n \n HHS gelen istek numarasn ve veri gvdesini birletirerek checksum deeri retir. \nchesksum deeri x-request-id|request.body nin hash algoritmalarndan (CRC32,MD5 vb)  geirilerek retilebilir. \n HHS bu checksum deeri ile YSe dnm olduu yant 5 dk boyunca saklar.  Saklama yntemi olarak veri taban veya nbellek aralar kullanlabilir. \n YS ayn istek numaras ve ayn veri gvdesi ile yeni bir ar yaptnda, ayn checksum deeri retilecei iin 5dk boyunca bu deere karlk gelen yant dner. \n 5 dk sonrasnda istek numaras veya veri gvdesi deimemi olsa dahi bu HHS tarafndan yeni istek olarak kabul edilir. \n \n Aadaki Public Post ilemleri iin bu kural setinin iletilmesi gerekmektedir: \n 1- deme emri rzas oluturma \n2- Eriim belirteci oluturma \n3- deme emri \n4- Hesap bilgisi rzas oluturma \n 3.18. HTTP Durum Kodlar \n RFC 2616\'da belirlenmi olan durum kodlar (status code) gnderilen istein durumunu YSa standart bir ekilde ifade eder. Eer bir hata varsa hatay, gnderilen istek baarl bir ekilde ilem grdyse ona ilikin durumu aktarr. Durum kodlar genel olarak 5 kategoridedir. \n \n 1xx Bilgi \n 2xx Baarl \n 3xx Ynlendirme \n 4xx stemci Hatas \n 5xx Sunucu Hatas \n \n Sral (Enumarated) Hata Tipleri: \n \n TR.OHVPS.Resource \n \n \tInvalidFormat \n \tConsentMismatch \n \tNotFound \n \tInvalidSignature \n \tMissingSignature \n \tMethodNotAllowed \n \tNotAcceptable \n \tUnsupportedMediaType \n \tConsentRevoked \n \n \n \n TR.OHVPS.Business \n \n \tInvalidContent \n \tInvalidAccount \n \n \n \n TR.OHVPS.Connection \n \n \tInvalidCertificate \n \tExceededRate \n \tInvalidTPP \n \tInvalidASPSP \n \tInvalidToken \n \tInvalidTPPRole \n \n \n \n TR.OHVPS.Server \n \n \tInternalError \n \tServiceUnavailable \n \n \n TR.OHVPS.Resource.InvalidFormat hatas alnd durumda; fieldErrors nesnesi ierisinde verilecek hata kodlar : \n \n TR.OHVPS.Field \n \n \tMissing \n \tInvalid \n \n \n Veri Tipi rnei: \n { \n   "id" :   "2b5f0fb2-730b-11e8-adc0-fa7ae01bbebc" , \n   "path" :   "/ohvps/s1.1/obh/odeme-emri-rizasi" , \n   "timestamp" :   "2020-06-13T18:24:38" , \n   "httpCode" :   400 , \n   "httpMessage" :   "Bad Request" , \n   "moreInformation" :   "Resource Schema validation error" , \n   "moreInformationTr" :   "ema kontrolleri baarsz" , \n    "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" , \n   \n   "fieldErrors" :   [ \n            { \n                  "objectName" :   "odemeEmriRizasi" , \n                  "field" :   "kmlkNo" , \n                  "messageTr" :   "boyut \'6\' ile \'30\' arasnda olmal" , \n                  "message" :   "size must be between \'6\' and \'30\'" , \n                  "code" :   "TR.OHVPS.Field.Invalid" \n               } , \n               { \n                  "objectName" :   "odemeEmriRizasi" , \n                   "field" :   "prBrm" , \n                   "messageTr" :   "bo deer olamaz" , \n                   "message" :   "must not be null" , \n                   "code" :   "TR.OHVPS.Field.Missing" \n               } ] \n } \n \n Veri Tipi rnei: \n Zorunlu header alanlarndan biri ya da birka eksik olarak gnderilirse aadaki gibi bir hata dn gerekleebilir. \n \n { \n     "httpCode" :   "400" , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "One or more required API parameters are missing in the API request." \n } \n\n \n Tablo 4: HTTP Durum Kodlar \n \n \n \n HTTP Durum \n stek Sonucu ve Aklamalar \n POST \n GET \n DELETE \n \n \n \n \n 200 OK \n stek Baaryla Tamamland. Kaynak gncellemek iin yaplan (rnein, PUT) ve baaryla tamamlanan isteklerinde kullanlr. \n H \n H \n H \n \n \n 201 Created \n stek Baarl Oldu. Kaynak yaratma istei (rnein, POST /deme-emri-rizasi) baaryla sonuland. \n E \n H \n H \n \n \n 204 No Content \n Silme ilemi baaryla tamamland. Kaynak silme istei (rnein,  DELETE /hesap-rizasi/{RizaNo} ) baaryla sonuland. \n H \n H \n E \n \n \n 400 Bad Request \n stekte bozuk, eksik veya uyumlu olmayan JSON gvdesi, URL parametreleri veya balk alanlar var.  stekle balatlan ilem yapsal bozukluk, eksik veya tutarsz veri veya HHS tarafndaki kontrollerin hatal sonulanmas nedeniyle hata ile sonulanr ve hataya ilikin veriler hata nesnesi ierisinde dnlr. \n E \n E \n E \n \n \n 401 Unauthorized \n Yetkilendirme bal eksik, hatal veya geersiz olduundan istek yetkilendirilmediinde ve eriim reddedildiinde http 401 kodu dnlmelidir. \n E \n E \n E \n \n \n 403 Forbidden \n Eriim belirtecinin veya rzann kapsam uyumuyor. YS bir hesaba/ilem kaynana erimeye alr ve YS, istenen kaynaa erimek iin geerli izinlere sahip bir rzas yoktur.  rnein; hesap bilgisi rzas bakiye izni almamtr ancak /bakiyeler adresinden istekte bulunmutur. \n \n \n \n \n \n 404 Not Found \n **HHS geerli bir API eriim adresini salamyorsa, o URL\'ye gelen istekler iin 404 (Bulunamad) ile yant vermelidir.**YS, uygulama esaslarnda tanmlanmayan bir kaynak iin bir URL\'ye erimeye alrsa (rnein, GET /yurtdisi-odeme), HHS, 404 (Bulunamad) ile yant vermeyi seebilir. \n E \n E \n E \n \n \n 405 Method Not Allowed \n YS, desteklenmeyen bir yntemle kaynaa erimeye alt. \n E \n E \n E \n \n \n 406 Not Acceptable \n stek, geersiz bir karakter kmesi ieriyor. \n E \n E \n E \n \n \n 415 Unsupported Media Type \n stek gvdesi hedef kaynakta bu yntem tarafndan desteklenmeyen bir biimde oluturulduu iin ilem reddedildi \n E \n H \n H \n \n \n 429 Too Many Requests \n Belirli bir sre iinde ok fazla talepte bulunulduu iin ilem reddedildi.  HHSler adil kullanm politikalarn aan talepleri kstlayabilir. \n E \n E \n E \n \n \n 500 Internal Server Error \n API sunucu / servis katmannda sorun olutu. lem baarsz. \n E \n E \n E \n \n \n 503 Service Unavailable \n Hizmet srm kullanmdan kaldrld.  Bir API\'nin kullanmdan kaldrld ve artk bir HHS tarafndan operasyonel olarak desteklenmedii durumlarda, URI yolu hala etkin olabilir ve API isteklerini kabul edebilir.  Bu durumda, YS\'n API srmnn evrimd olduunun farknda olmas iin 503 Hizmet Kullanlamyor dnmesi nerilir. \n E \n E \n E \n \n \n \n Hata rnekleri: \n 400 Bad Request \n TR.OHVPS.Business.InvalidContent  hatas HHS tarafndan yaplacak i kural kontrollerinin baarsz olduu durumda verilmelidir. \n TR.OHVPS.Resource.InvalidFormat  hatas ema validasyonu, alan uzunluk ve varlk kontrollerinin baarsz olduu durumda verilmelidir. \n httpCode :   400 \nhttpMessage :  Bad Request\nmoreInformation :  Resource Schema validation error\nmoreInformationTr :  ema Kontrolleri Baarsz \nerrorCode :   "TR.OHVPS.Resource.InvalidFormat" \n\nfieldErrors :   \n         code :   { "TR.OHVPS.Field.Invalid" , \n                     "TR.OHVPS.Field.Missing" } \n\n \n rn; GET /odeme-emri/22289 ars durumunda 22289 geerli bir deme kayna deilse, HHS, 400 koduyla cevap vermelidir. \n { \n   "id" :   "2b5f0fb2-730b-11e8-adc0-fa7ae01bbebc" , \n   "path" :   "/ohvps/s1.1/obh/odeme-emri-rizasi" , \n   "timestamp" :   "2020-06-13T18:24:38" , \n   "httpCode" :   400 , \n   "httpMessage" :   "Bad Request" , \n   "moreInformation" :   "Resource Schema validation error" , \n   "moreInformationTr" :   "ema kontrolleri baarsz" , \n    "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" , \n   \n   "fieldErrors" :   [ \n { \n "objectName" :   "odemeEmriRizasi" , \n "field" :   "kmlkNo" , \n "messageTr" :   "boyut \'6\' ile \'30\' arasnda olmal" , \n "message" :   "size must be between \'6\' and \'30\'" , \n "code" :   "TR.OHVPS.Field.Invalid" \n } , \n { \n "objectName" :   "odemeEmriRizasi" , \n  "field" :   "prBrm" , \n  "messageTr" :   "bo deer olamaz" , \n  "message" :   "must not be null" , \n  "code" :   "TR.OHVPS.Field.Missing" \n } \n ] \n } \n\n\nerrorCode :   "TR.OHVPS.Connection.InvalidTPP" \nmoreInformation :  Invalid TPP Code\nmoreInformationTr :  Geersiz Ys Kodu \n\nerrorCode :   "TR.OHVPS.Connection.InvalidASPSP" \nmoreInformation :  Invalid ASPSP Code\nmoreInformationTr :  Geersiz HHS Kodu \n\nerrorCode :   "TR.OHVPS.Connection. InvalidTPPRole" \nmoreInformation :  Invalid TPP Role \nmoreInformationTr :  Hatal Ys Rol \n \n 401 Unauthorized \n YS, sresi dolmu bir eriim belirteci kullandnda, HHS 401 (Yetkisiz) http kodu ile aadaki hata kodunu dnmelidir.  Aadaki nedenlerden herhangi biri nedeniyle bir Eriim Belirtecinin sresi dolduunda bu durum ortaya kabilir: \n \n Rzann sresi doldu (Son Kullanma Tarihi geti) \n Eriim Belirtecinin pheli kullanm veya sahtekarlk phesi \n Rzada belirlenen gn saysnn am\nBu hata, mteriden doru izinlerle yeniden kimlik dorulamas isteyerek zlebilir. \n \n errorCode :   " TR.OHVPS.Connection.InvalidToken " \nmoreInformation :  Invalid Token\nmoreInformationTr :  Geersiz Token \n \n 403 Forbidden \n httpCode :   403 \nhttpMessage :  Forbidden\n\nerrorCode :   "TR.OHVPS.Resource.Forbidden" \nmoreInformation :  Insufficient rights\nmoreInformationTr :  zin verilmedi.\n \n 404 Not Found \n httpCode :   404 \nhttpMessage :  Not Found\n\nerrorCode :   "TR.OHVPS.Resource.NotFound" \nmoreInformation :  Resource not found\nmoreInformationTr :  Kayt bulunamad\n \n 405 Method Not Allowed \n httpCode :   405 \nhttpMessage :  Method  Not Found\n\nerrorCode :   "TR.OHVPS.Resource.MethodNotAllowed" \nmoreInformation :  Method Not Allowed\nmoreInformationTr :  stek yaplan URL iin izin verilmeyen metot \n \n 406 Not Acceptable \n httpCode :   406 \nhttpMessage :  Not Acceptable\n\nerrorCode :   " TR.OHVPS.Resource.NotAcceptable" \nmoreInformation :  Accept Headers not supported\nmoreInformationTr :  Desteklenmeyen kabul balklar \n \n 415 Unsupported Media Type \n httpCode :   415 \nhttpMessage :  Unsupported Media Type\n\nerrorCode :   " TR.OHVPS.Resource.UnsupportedMediaType" \nmoreInformation :  Content type not supported\nmoreInformationTr :  Desteklenmeyen ierik tipi \n \n 429 Too Many Requests \n httpCode :   429 \nhttpMessage :  Too Many Requests\n\nerrorCode :   " TR.OHVPS.Connection.ExceededRate" \nmoreInformation :  The rate limit has been exceeded for the plan or operation being used\nmoreInformationTr :  Planda tanmlanm olan ar limiti ald\n \n 500 Internal Server Error \n httpCode :   500 \nhttpMessage :  Internal Server Error\n\nerrorCode :   "TR.OHVPS.Server.InternalError" \nmoreInformation :  Unexpected condition was encountered\nmoreInformationTr :  Beklenmedik bir durumla karlald. \n \n 503 Service Unavailable \n httpCode :   503 \nhttpMessage :  Service Unavailable\n\nerrorCode :   "TR.OHVPS.Server.ServiceUnavailable " \nmoreInformation :  API is currently unable to handle the request\nmoreInformationTr :  API u anda istei ileyemiyor \n 3.19. Maskeleme Kurallar \n Maskeli olarak iletilmesi gereken verilerin maskeleme kurallar u ekildedir: \n \n IBAN verileri Hesap Numaras : lk 4 ve son 4 karakteri ak, dier karakterler maskeli olmaldr. rnek: TR54******************4812 \n Ad-Soyad / Ticari Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr.\nrnein: FATH SERKAN EREN ifadesi FA *** SE**** ER**** eklinde gsterilmelidir. \n Tabela Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr. rnein BANKALARARASI KART MERKEZ ANONM RKET ifadesi BA *** KA**** ME**** AN**** **** eklinde gsterilmelidir. \n YSten girilen unvan ve iban bilgileri deme emri rzas ve deme emri yantnda ak dnlr, Kolas aknda deme emri rzas yant ve deme emri istek ve yantnda maskeli tanr. \n 3.20. Fonksiyonel Olmayan Gereksinimler \n \n \n HHSlerin sunuyor olduklar servisleri en fazla 3000 ms iinde yant dnecek ekilde tasarlamaldr. \n \n \n YS tarafndan kullancnn balatmad otomatize sorgular iin aadaki limitler belirlenmitir. \n \n YS, Bireysel HKlar iin hesap baznda gnde en fazla 4 adet sorgulama yapabilir. \n YS, Kurumsal HKlar iin hesap baznda saatte en fazla 12 adet sorgulama yapabilir \nDier taraftan kullancnn balatt Hesap Bilgisi Hizmeti kapsamndaki sorgular HHS tarafndan belirlenen st rate limitler dahilinde tanmlanabilir. \n \n \n \n HHSlerin sunuyor olduklar servislere sistemin gvenlik ve srekliliini salamak adna rate limit koyma ihtiyalar olur ise, standartlar ve ihtiyalara uygun ekilde bir konfigrasyon yapabilirler. r: YS - Kullanc baznda gnde X sorgu v.b.\nstein kullanc tarafndan balatld Request Header ierisinde yer alan Payment Service User (PSU) alanlarndan anlalabilir. \n \n \n HHSler ayn zamanda servislerin ayakta olup olmadna ynelik olarak bir healthcheck servisi kurmaldr.  HHSlerin bu servis ile tm network ve veritaban ya da servislerinin ihtiya duyduklar altyapsal eriimleri modellemeli ve bu servisi BKM ile paylamalar beklenmektedir. Bu servis dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr. \n \n \n Sunulan her API iin /health endpointi ile aadaki bilgileri vermeleri beklenmektedir. \n GET /{api ismi}/{versiyon}/health \n rnek: \n GET /obh/s1.0/health \n GET /hbh/s1.0/health \n GET /gkd/s1.0/health \n HHS ve YS API iin health servisleri aadaki servislerle kontrol edilebilir. \n GET /hhs-api/s1.0/health \n GET /yos-api/s1.0/health \n Baarl yantta Http 200 kodu dnlmelidir. \nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Koullu  / stee Bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir. \n \n \n \n Health servisinden yant alnamamas, hata almas ya da status DOWN gelmesi durumunda API Gatewayden istek HHS tarafna iletilmeyecektir. \n \n \n HVPS servisleri ile ilgili olarak HHSler, BKM tarafndan dzenli olarak sorgulanacaktr, eriilebilirlik ve kullanm oranlar takip edilecektir. \n \n \n HHSlerin servislerini eriim yzdeleri asndan yl baznda %99.75 orannda ayakta olmalarn salayacak ekilde kurgulamalar gerekmektedir. \n \n \n'},{title:"POST /erisim-belirteci",frontmatter:{},regularPath:"/v1.0.2/contents/erisim-belirteci.html",relativePath:"v1.0.2/contents/erisim-belirteci.md",key:"v-485bbe8d",path:"/v1.0.2/contents/erisim-belirteci.html",content:" POST /erisim-belirteci \n STEK: \n YS erisim-belirteci eriim adresini 2 amala kullanr: \n \n \n Bir nceki admdan ald rizaNo, rizaTip (deme emri balatma hizmetinde O, hesap bilgisi hizmetinde H) ve GKD sonras dnlen yetKod bilgilerini kullanarak HHS nezdinde ErisimBelirteci nesnesi oluturmak zere istekte bulunur. YSn istekte bulunabilmesi iin GKD admnn baarl bir ekilde tamamlanmas rizaDrm bilgisinin yetkilendirildi olmas gerekir. Eriim Belirteci nesnesi ile rzas nesnesi (deme Emri Rzas veya Hesap Bilgisi Rzas) arasndaki iliki rza numaras zerinden salanr. \n \n \n Ald eriim belirtecinin Geerlilik Sresinin dolduu durumda, yenileme belirteci karlnda yeni bir eriim belirteci almas gerekmektedir. \n \n \n POST /erisim-belirteci isteinin (REQUEST) gvdesinde (BODY)  ErisimBelirteciIstegi nesnesi (Tablo-23) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda ErisimBelirteci nesnesi (Tablo 24) oluturulur veya (Yenileme Belirteci iin) gncellenir. Rza durumu Yetki Kullanld olarak gncellenir. \n Eriim Belirteci POST ilemi sonucunda HTTP 200 dnlmesi gerekmektedir. \n Tablo 23: ErisimBelirteciIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Tipi \n rizaTip \n AN1 \n Z \n O veya H (TR.OHVPS.DataCode.RizaTip) \n \n \n Yetki Tipi \n yetTip \n AN1..50 \n Z \n yet_kod yada yenileme_belirteci deerini alabilir.  (TR.OHVPS.DataCode.YetTip) \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n K \n GKD ileminden dnen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. yetTip = yet_kod ise zorunludur. \n \n \n Yenilenme Belirteci \n yenilemeBelirteci \n AN1..4096 \n K \n Eriim belirtecinin yenilenmesi amacyla kullanlr. yetTip = yenileme_belirteci ise kullanm zorunludur. \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan erisimBelirteci nesnesinde (Tablo-19) bulunan eriim belirteci deeri deme emrinin balatlmas esnasnda kullanlr. \n Tablo 24: \"ErisimBelirteci\" nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Eriim Belirteci \n erisimBelirteci \n AN1..4096 \n Z \n Yetkilendirme Kodu karlnda HHS tarafndan dnlen ve sonraki hesap bilgisi ve deme emri servislerine eriimde kullanlan bilgidir. \n \n \n Geerlilik Sresi \n gecerlilikSuresi \n N1..9 \n Z \n Eriim Belirtecini saniye cinsinden geerlilik sresidir.  Eriim belirteci geerli olduu son tarih ; Hesap Bilgisi Rzas iin en fazla 30 gn olmaldr. Eriimin Geerli Olduu Son Tarih(erisimIzniSonTrh); Eriim Belirteci Geerlilik Sresi'nden kk ise Eriimin Geerli Olduu Son Tarih deeri ile snrldr. deme Balatma Rzas iin 5 dakika olmaldr. \n \n \n Yenileme Belirteci \n yenilemeBelirteci \n AN1..4096 \n Z \n Eriim belirtecinin yenilenmesi amacyla kullanlr. \n \n \n Yenileme Belirteci Geerlik Sresi \n yenilemeBelirteciGecerlilikSuresi \n N1..9 \n Z \n Yenileme belirtecinin saniye cinsinden geerlilik sresidir. Yenileme belirtecinin geerli olduu son tarih ; Hesap Bilgisi iin Eriimin Geerli Olduu Son Tarih ile snrl olmaldr. Bu tarih geldii zaman Hesap Bilgisi Rza Durumunu Yetki Sonlandrld statsne ekilmesi gerekir. deme Balatma iin Rza Oluturma Zamanndan 15 gn sonras olmaldr. 15 gn sresi sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. leri vadeli ilemler bu kapsamda deildir.  deme emri 5 dakika iinde gerekletirilmelidir. Gereklemediinde 4.2.8 blmnde aktarlan rza stat gncellemesi yaplmaldr. \n \n \n \n erisim-belirteci erisim noktasndan elde edilen erisimBelirteci, ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda x-access-token alannda iletilir. \n Yenilenme Belirteci (refreshToken) kullanlarak Eriim Belirteci (accessToken) alndnda, dnen yanttaki Yenileme Belirteci Geerlik Sresi (yenilemeBelirteciGecerlilikSuresi) geen sre eksiltilerek, kalan zamann saniye cinsinden hesaplanmasyla iletilmelidir. \n Yenileme Belirteci ile Eriim Belirteci gncellendiinde, HHS'den dnen yenilemeBelirteci deeri deiebilir, YS bu gncel anahtar saklamal ve sonraki erisimBelirteci isteini yenilenmi olan yenilemeBelirteci ile yapmaldr. \n Eriim Belirteci API arm srasnda rza durumlar kontrol edilmelidir. Bu kontrollerin nasl yaplmas gerektii 4-Rza Durumlar blmnde aktarlmtr. \n Yenileme belirteci karlnda yeni bir eriim belirteci alnmas srasnda hata alnmas durumunda, HHS'nin dnd hata yantnda httpCode = 401 ve errorCode = \"TR.OHVPS.Connection.InvalidToken\" geldii durumda, YS tarafndan HHS'ye ilgili rza iin sistemsel olarak iptal istei gnderilmelidir. \n"},{title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",frontmatter:{},regularPath:"/v1.0.2/contents/ekler.html",relativePath:"v1.0.2/contents/ekler.md",key:"v-bc107546",path:"/v1.0.2/contents/ekler.html",headers:[{level:2,title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",slug:"ek-1-istek-cevap-mesajlarnda-kullanlacak-nesne-yaplar"},{level:2,title:"EK-2: Sral Veri Trleri",slug:"ek-2-sral-veri-turleri"},{level:2,title:"EK-3: stemci Sertifikalarnn Tanm ve Ynetimi",slug:"ek-3-istemci-sertifikalarnn-tanm-ve-yonetimi"},{level:2,title:"EK-4: Sunucu Sertifikalar",slug:"ek-4-sunucu-sertifikalar"},{level:2,title:"EK-5: Mesaj mzalama Ak",slug:"ek-5-mesaj-imzalama-aks"},{level:3,title:"mzalama Kurallar (YS)",slug:"imzalama-kurallar-yos"},{level:2,title:"EK-6: HHS/YS API Mimarisi",slug:"ek-6-hhs-yos-api-mimarisi"}],content:' EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar \n Ak Bankaclk simlatr uygulamas zerinde swagger dkmanlarnn gncel srmlerine eriim salanabilir. \n EK-2: Sral Veri Trleri \n \n \n \n Kod \n Aklama \n \n \n \n \n TR.OHVPS.DataCode.KimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) Y , YKN , N11 P , PNO , AN7..9 \n \n \n TR.OHVPS.DataCode.KurumKimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) V , VKN , AN10 \n \n \n TR.OHVPS.DataCode.OhkTur \n Kod: B: Bireysel  K: Kurumsal \n \n \n TR.OHVPS.DataCode.KolasTur \n Mterinin sorgulama istedii Kolay Adres Tipi deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr: T: Telefon Numaras E: E-Posta K: TCKN V: VKN Y: YKN P: Pasaport Numaras \n \n \n TR.OHVPS.DataCode.KareKodAksTur \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  01: FAST katlmcsndan dinamik dorulamal hizmet alnan iyeri demesi 02: FAST katlmcsndan statik dorulamal iyeri demesi 03: Kiiden kiiye demeler \n \n \n TR.OHVPS.DataCode.OdemeKaynak \n I: nternet bankaclndan gnderilen demelerde kullanlr. A: Otomatik para makineleri (ATM) ile gnderilen demelerde kullanlr. T: Telefon bankacl ile gnderilen demelerde kullanlr. K: Kiosklar araclyla gnderilen demelerde kullanlr. S: ubeden girilen demelerde kullanlr. M: Mobil uygulamadan gnderilen demelerde kullanlr. D: Yukardakiler dndaki deme kaynaklarndan gnderilen demelerde kullanlr.  O: Ak bankaclk aracl ile gnderilen demelerde kullanlr. \n \n \n TR.OHVPS.DataCode.OdemeAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi \n \n \n TR.OHVPS.DataCode.OdemeDurumu \n demenin durumunu gsterir. Alabilecei deerler: 01: Gerekleti (deme ilgili deme sistemine iletildi ve alc hesabna ulat.)  02: Gnderildi (deme ilgili deme sistemine iletildi ancak alc hesabna ulatna dair teyit alnmad.)lemin son durumunun teyidi iin YS sorgulama yapmaldr. 03- Gereklemedi (demenin ilgili deme sistemine iletiminde veya ilenmesi srasnda hata, zaman am, sistemin gn sonu ilemlerine balamas vb. durum olutu ve deme gereeklemedi veya iade edildi.) 04- Onayda bekliyor (deme emri alnd. oklu onay aknn tamamlanmas bekleniyor.) 05- leme Alnd ( deme emri alnd. ) YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu 02-Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS sorgulama yapmaldr. \n \n \n TR.OHVPS.DataCode.IslemAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Dier \n \n \n TR.OHVPS.DataCode.RizaDurumu \n B: Yetki Bekleniyor Y: Yetkilendirildi K: Yetki Kullanld E: Yetki deme Emrine Dnt S: Yetki Sonlandrld I :Yetki Iptal \n \n \n TR.OHVPS.DataCode.GkdTur \n GKD yaplmasn gerekli bulduu durumda HHS, YSn belirledii yntemi dikkate alarak kendi belirledii GKD yntemini bildirir: Y: Ynlendirmeli GKD A: Ayrk GKD \n \n \n TR.OHVPS.DataCode.RizaTip \n H: Hesap Bilgisi Rzas O: deme Emri Rzas \n \n \n TR.OHVPS.DataCode.IzinTur \n 01: Temel Hesap Bilgisi 02: Ayrntl Hesap Bilgisi 03: Bakiye Bilgisi 04: Temel lem (Hesap Hareketleri) Bilgisi 05: Ayrntl lem Bilgisi \n \n \n TR.OHVPS.DataCode.OdemeSistemi \n lemin ynlendirildii deme Sistemine gre aadaki deerlerden birini alabilir: H: Havale F: FAST E: EFT (PS) deerlerinden birini alabilir. \n \n \n TR.OHVPS.DataCode.IslemTuru \n Hesap hareketleri (ilemler) sorgusunda dnlen lem Tr (islTur) parametresi aadaki deerlerden birini alabilir: HAVALE EFT FAST PARA_YATIRMA PARA_CEKME YABANCI_PARA_HAVALE YATIRIM_HESABINA_AKTARIM YATIRIM_HESABINDAN_AKTARIM KURUM_FATURA_ODEMESI CEK SENET SIGORTA_ODEMESI UCRET_KOMISYON_FAIZ SGK_ODEMESI VERGI_ODEMESI DOVIZ_ALIM DOVIZ_SATIM KREDI_ODEMESI KREDI_KULLANIM KK_ODEMESI KK_NAKIT_AVANS SANS_OYUNU UYE_ISYERI_ISLEMLERI HGS_OGS_ISLEMLERI DOGRUDAN_BORCLANDIRMA_SISTEMI DIGER \n \n \n TR.OHVPS.DataCode.HspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.KolasHspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.HspTip \n Hesap eidini belirtir: VADESIZ VADELI KREDILI_MEVDUAT_HESABI POS CEK YATIRIM \n \n \n TR.OHVPS.DataCode.HspDrm \n Hesabn durumunu belirtir: AKTIF PASIF KAPALI \n \n \n TR.OHVPS.DataCode.YetTip \n Alabilecei deerlere gre hangi belirtecin dneceine karar verilir. yet_kod yenileme_belirteci \n \n \n TR.OHVPS.DataCode.BrcAlc \n lemin hesab borlandrd ya da alacaklandrd bilgisidir. B : Bor A : Alacak \n \n \n TR.OHVPS.DataCode.RizaIptDtyKod \n 01 :Yeni Rza Talebi ile ptal 02 :Kullanc stei ile HHS zerinden ptal 03 :Kullanc stei ile YS zerinden ptal 04 :Sre Am : Yetki Bekleniyor 05 :Sre Am : Yetkilendirildi 06 :Sre Am : Yetki demeye Dnmedi 07 :GKD iptali : Ayn rza no ile mkerrer arm 08 :GKD iptali : Rzano ile TCKN uyumamas 09 :GKD iptali : Uygun rn bulunmuyor 10 :GKD iptali : HHS Ak Bankaclk kanal ileme kapal 11 :GKD iptali : Hesap Yetki Sorunu 12 :GKD iptali : HK HHS kontrollerini aamad 13 :GKD iptali : HK istei ile GKDden vazgeildi 14 :GKD iptali : Fraud phesi 99 :GKD iptali : Dier \n \n \n TR.OHVPS.DataCode.PSUInitiated \n E : Evet H : Hayr \n \n \n TR.OHVPS.DataCode.HHSYOSSrlmKrtr \n kod : Kod,unv : Unvan \n \n \n TR.OHVPS.DataCode.SrlmYon \n A: Azalan deerle sralama Y: Artan deerle sralama \n \n \n TR.OHVPS.DataCode.ZmnAralik \n 0 : Kayt Yok  1 : 0-2 saat 2 : 2-24 saat  3 : 1-3 gn   4 : 3-15 gn\t  5 : 15 gn ve st \n \n \n TR.OHVPS.DataCode.VarYok \n 0 : Kayt Yok   1 : Kayt Var \n \n \n TR.OHVPS.DataCode.HHSDurumu \n A : Ak. retim Ortamnda HHSnin aktif bir ekilde hizmet vermesi durumu.  Y : Yaygnlatrma. retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi durumu.    G : Geici Hizmet Veremiyor. HHS servislerinde teknik bir sorun olmas nedeniyle HHSnin hizmet verememesi durumu.  K: Kapal. HHSnin hizmet vermeme durumu. \n EK-3: stemci Sertifikalarnn Tanm ve Ynetimi \n Tm katlmclarn BKM API Geidine eriebilmesi iin, BKM tarafndan yaplan istemci sertifika dorulamasndan gemesi gerekmektedir. stemci sertifikas retilmeden nce katlmclarn CSR retme akn tamamlamas gerekmektedir. \n OpenSSL ile CSR (Certificate Signing Request) Oluturma \nAadaki komut ile 2048-bit RSA private key ve CSR oluturulur. \nopenssl req -new -newkey rsa:2048 -nodes -keyout PRIVATEKEY.key -out CSR.csr \n CSR ile ilgili detay bilgilerin giriinde; \nCommon Name (CN) olarak 4 karakterli hhsKod ya da yosKod deeri ile, \ndier alanlar iin de kurum bilgileriniz ile giri yaplr. \n Tm bilgilerin girilmesinden sonra oluan private key dosyas kurumunuzda saklanr.\nCSR dosyas ise istemci sertifika retmek zere kullanlr. Bu aamada takip edilmesi gereken admlar u ekildedir: \n Katlmclarn, TRIP ortam zerinden, BKM Tarafndan yetki verilmi kullanclarnn grebilecei "stemci Sertifika Talebi" men admna giri yapmalar beklenir. Alan ekranda,"CSR Dosyas Ykleme" alan ierisine, katlmcnn retmi olduu csr dosyas yklenir. Yaklak 1 dakika ierisinde kuruma zel olarak retilmi olan client sertifikas indirilmeye hazr hale gelecektir. "ndir" butonu ile client sertifika indirilir. stemci tarafnda web isteinin ilgili sertifika ile ilikilendirilerek oluturulmas gerekmektedir. \n Uzun dnemli olarak hazrlanacak olan sertifikalar sertifikasyon ve retim ortamlarnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii bu aamalarda snanacaktr. \n BKM API Geidi zmnn test ve retim ortamlar ayrmnda istemci sertifikalar, HHS Listeleme API eriimleri ve Sertifikasyon balantlar ekil 15-HHS/YS API Mimarisi Diagramnda resmedilmitir. \n EK-4: Sunucu Sertifikalar \n Sunucu sertifikalarnn endpoint bilgisini (Fqdn) ierecek ve global bir Certification Authority tarafndan imzalanm olarak sunulmas gerekmektedir.\nrnein; entegrasyon formu ierinde yer alan URL bilgisinin (test.xbank.com.tr) sertifika ierisinde tanml olmas ve bu sertifikann global bir CA rnein Verisign tarafndan imzalanm olarak sunulmas gerekmektedir. \n Hizmet salayc olan HHS\'ler tarafndan sunucu sertifikalar uygulanmaldr. \n EK-5: Mesaj mzalama Ak \n Dijital imzalama yaps, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini salamak amacyla kurgulanmtr.\nBu kapsamda imzalama ak aadaki gibi olmaldr: \n \n HHS ya da YS ncelikle zel ve ak anahtarlarn oluturmaldr. Bu anahtarlar oluturmak iin aada openssl kullanlarak oluturma rnei paylalmtr.  Bu anahtarlardan zel olan anahtar mesaj imzalamak iin kullanlacak olup, ak anahtar ise mesaj dorulamak amacyla mesajn alcs tarafndan kullanlacaktr. \n \n private_key.pem ve public_key.pem dosyasinin ierikleri kod tarafnda kullanlacaktr. \n --private.pem => zel anahtarn ismi\nopenssl genrsa -out private.pem 2048 \n --public_key.pem => Ak anahtarn ismi\nopenssl rsa -in private.pem -pubout -outform PEM -out public_key.pem \n --private_key.pem => zel anahtarn PCKS8 formatna evrilmesi (Java asndan PCKS8 formatnda olma ihtiyac nedeniyle) openssl pkcs8 -topk8 -inform PEM -in private.pem -out private_key.pem -nocrypt \n \n \n Ak ve zel anahtarlar oluturulduktan sonra Ak Anahtar BKM ile paylalr. BKM bu ak anahtar dier katlmclarn ulaabilmesi ve alabilmesi iin bir Anahtar Deposu yaklam ile bnyesinde tutar. lgili anahtar iletebilmek ve alabilmek iin kullanlacak HHS/YOS API ye eriim detaylar EK-6 blmnde detayl olarak paylalmtr.  Eer kurumun ilgili anahtar iftinin yenilenme durumu sz konusu ise yenilemenin hemen ardndan ak anahtar yeni bir imzalama yaplmadan nce mutlaka BKM ile paylalmaldr. \n \n \n mzal mesaj aacak olan kurum mesaj imzalayan kurumun ak anahtarn her sorguda yeniden almak durumunda deildir. Belirli periyodlarda kendi ortamndaki anahtar yenileyerek sistemi iletebilir. Ancak imzalayan kurum anahtar ifti yenilemesi yaptnda BKM ile ak anahtarn paylasa dahi imzal mesaj dorulayacak taraf eski ak anahtar ile dorulama yapmaya alt iin hata alacaktr. Bu ilk hata durumunda hzlca BKM zerinden yeni anahtar alp mesaj tekrar dorulamay denemelidir. Eer yine hata alyor ise dorulama ilemini hata statsne almaldr. Bu sebeple anahtar yenileyen kurum yeni ak anahtarn yeni bir mesaj imzalama yapmadan nce mutlaka BKM ile paylamaldr. \n \n \n PSU-Fraud-Check alan iin de JWT formatnda kt hazrlanmas beklenmektedir. rnek bir PSU-Fraud-Check payload deeri aadaki gibidir; \n {"AnomalyFlag": "0", \n"LastPasswordChangeFlag": "1", \n"FirstLoginFlag": "1", \n"DeviceFirstLoginFlag": "1", \n"BlacklistFlag": "0", \n"MalwareFlag": "0", \n"UnsafeAccountFlag": "0", \n"exp": 1663424479, \n"iat": 1663338079, \n"iss": "[https://apigw.bkm.com.tr|https://apigw.bkm.com.tr/]" } \n mzalama Kurallar (YS) \n Bir YS zerinden balayan ak rnek olarak paylalmtr. \n \n \n YS, mesaj imzalama gerektiren her API isteinin HTTP gvdesini (request body) kendi zel anahtar ile ifreleyerek imza bilgisini oluturur. \n \n \n Ardndan bu imza verisini, gnderecei mesajn istek balnda yer alan X-JWS-Signature alannda gndermelidir. \n \n \n X-JWS-Signature alannda gnderilecek olan bilgi aadaki yntem ile oluturulmaldr. \n \n \n Bu alana yazlacak olan bilgi JWT formatnda oluturulmaldr. \n \n \n Bir JWT, header-payload-signature alanlarndan olumaktadr. \n \n Header alannda JWTyi imzalamak iin kullanlacak algoritma belirtilmelidir.  Standartlar kapsamnda RS256 kullanlacaktr. \n Payload ksmnda zel olarak oluturulacak olan body claim alanna istek gvdesi (request body) verisinin SHA256 hash deeri karl yazlmaldr. \n JSON payload oluturulurken RFC 7519 baz alnmaldr. "iss" (Issuer) Claim, "exp" (Expiration Time) Claim, "iat" (Issued At) Claim, body Claim alanlarnn gnderilmesi zorunludur. ^RFC7519 \na.\t"iss" (Issuer) Claim : Kurumunuza zel bilgidir. \nb.\t"exp" (Expiration Time) Claim: Saniye cinsinden (Unix time) imzann son geerli olduu tarih. Bu tarih  mevcut sunucu saatinizden 60 dakika sonra olacak ekilde kullanlmaldr. \nc.\t"iat" (Issued At) Claim : Saniye cinsinden (Unix time) imzann oluturulduu tarih. Bu tarih  mevcut sunucu saatinizden 5 dakika nce olacak ekilde kullanlmaldr. \nd.\tbody Claim : istek gvdesi (request body) verisinin SHA256 hash deeri karl. \n Signature alannda da zel anahtar ile imzalanm olan imza ierii yer alacaktr. \n \n X-JWS-Signature:   JWS imzasn ieren stbilgi. Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n rnek X-JWS-Signature Payload Deeri \n { \n"iss": "https://apigw.bkm.com.tr", \n"exp": 1646832405, \n"iat": 1646746005, \n"body": "c543072f97a761a1d891dc81acc380bc1e6f61ca6541bd93ebfdece338457922" \n} \n \n \n \n \n YS, istei gnderir. Sadece mesajn btnln ve doruluunu teyit amac ile istek gvdesi (request body) SHA256 hash deeri imzalanarak X-JWS-Signature alannda bu imza iletilir. stein gvde (request body) ksm ak ve ifresiz olarak gnderilmektedir. \n \n \n HHS, istei alr, talebi gerekletirmeden nce ald API isteklerinin imzasn dorulamaldr. X-JWS-Signature alanndaki JWT aadaki admlarla dorulanmaldr. \n \n Header ksmndaki algoritmanin RS256 olduu kontrol edilir. \n Gnderen kurumun ak anahtar ile JWT verify (dorulama) ilemi yaplr. \n Yukardaki ilemlerin doruluunun ardndan JWTnin payload ksmndaki body claim alanndaki bilginin, istein gvde verisinin SHA256 hash deerlerinin ayn olduu kontrol edilir. \n rnek checksum deeri   "a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571" veya   "A64B19F95EEB1FB0A0A3E2DBBC6E3D8472C52184D4543417DDC6D156FC5C5571" eklinde olabilir. ki hali de ayn deere sahiptir. Kontrollerde buna dikkat edilmesi gerekmektedir. \n \n \n \n Yukardaki ilemler ile doruluu teyit edilmi olan istein talebi gerekletirir. \n \n \n Eer istek dorulanamyor ise gnderen kurumun ak ve zel anahtar ifti yenilenmi olabilir. \n \n \n BKM HHS API  zerinden ilgili kurumun bilgilerini (kurum kodu vs) kullanarak kurumun detay bilgileri eker ve kendi ortamnda yeniler. \n \n \n Ardndan imzay tekrar ak anahtar ile dorulayarak kontroller gerekletirilir. (Eer halen dorulama ilemi baarsz ise bu istek iin hata ak altrlr.  TR.OHVPS.Resource.InvalidSignature  kodu ile hata retilebilir.) \n \n \n mza bilgisinin beklendii (x-jws-signature) servislerde, bu bilginin iletilmedii durumlarda  TR.OHVPS.Resource.MissingSignature  hatas retilebilir. \n \n \n HHS istei iledikten sonra cevab olutururken de yukardaki aklar ile gnderecei cevab imzalamaldr. \n \n \n stek yant gvdesinin SHA256 checksum deeri iin hexadecimal kt kullanlacaktr. Oluacak ktnn 64 karakter olmas beklenmektedir. Kontrol iin "^[A-Fa-f0-9]{64}$" RegEx tarifini kullanabilirsiniz. \n \n \n rnek bir gvde: \n {"katilimciBlg":{"hhsKod":"8000","yosKod":"8000"},"gkd":{"yetYntm":"Y","yonAdr":"https://boss-test.bkm.com.tr/boss/ab/yosSimulator/8000?drmKod=6021de9f-55e7-454a-94be-2044866b22e1"},"kmlk":{"kmlkTur":"M","kmlkVrs":"123456","ohkTur":"B"},"hspBlg":{"iznBlg":{"iznTur":["01","02","03","04","05"],"erisimIzniSonTrh":"2022-10-12T23:59:59+03:00","hesapIslemBslZmn":"2021-10-10T00:00:00+03:00","hesapIslemBtsZmn":"2023-10-10T23:59:59+03:00"}}}\n \n Bu gvdenin checksum\': \n a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571\n \n Bu checksum\'n iletildii x-jws-signature balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FwaWd3LmJrbS5jb20udHIiLCJleHAiOjE2NjU0NzU1NjIsImlhdCI6MTY2NTM4OTE2MiwiYm9keSI6ImE2NGIxOWY5NWVlYjFmYjBhMGEzZTJkYmJjNmUzZDg0NzJjNTIxODRkNDU0MzQxN2RkYzZkMTU2ZmM1YzU1NzEifQ.Q65PI_1fTEzzBMirvmJvXgVX3orhhZ4_UqujtGdHkU7me-1ymIjvPrzy3kfyER1pedFb7HDCBuPvYoqjX8eUnpiiZsxfzCiEa0McIhoFeUOggq-O8VihItp8bLr2DWwQ9JHN1-WXB2mL31KAKFAL1VY9-DXuAdT-RfE_SLYsl2ycmNy4ti4XvfDvvlE56ZsieFZ727VuwR8wi7F0kKDc6UhjaMF9xcUeAM1fxX-bmcOaOo1NZGC0vvgjNZKz_OJrN-q8VhWYnQPiJ7wY7S9IG8bHIkBImKSVf8LuOEvl8u0BZzADLH1iOBd9x2l1plyI_NLPTrnOqhWhKlljkkJBCg\n \n Eer PSU-Fraud-Check iin balk gnderilecekse, yine JWT formatnda imza retilmelidir. rnek bir psu-fraud-check balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJBbm9tYWx5RmxhZyI6IjAiLCJMYXN0UGFzc3dvcmRDaGFuZ2VGbGFnIjoiMSIsIkZpcnN0TG9naW5GbGFnIjoiMSIsIkRldmljZUZpcnN0TG9naW5GbGFnIjoiMSIsIkJsYWNrbGlzdEZsYWciOiIwIiwiTWFsd2FyZUZsYWciOiIwIiwiVW5zYWZlQWNjb3VudEZsYWciOiIwIiwiZXhwIjoxNjY1NDc1NTU2LCJpYXQiOjE2NjUzODkxNTYsImlzcyI6Imh0dHBzOi8vYXBpZ3cuYmttLmNvbS50ciJ9.DhUh_nsXDuNIrvsQ3KOhOXdVcJg6fTDVW8K1oea8kLtmb7n-_hJHY3mWX5zzobu-Vh2VvFzIxPhHtol6gLHFktmIMiQ9TDHb_mRZFXgJB4ToNfqc3Fy9mi5bS8By2IYi1HxDaCStstaZDaunzXfHCtqybfZXyk6teDrf-iIf6lqX9Keo7GZO-Y7mP7C13-c_QwyNKrZK4TZwUQbecRqXYn1DcEHM7kukQHTar_hKBWkXPmNpScY0J2rKksr4ejR1uLhdQm-Pdwoe9y6qrNEB79vMLBkRNtbuV0vc1GYHp_YKkzBKBI_58uuB2GD9877CsrcRnHMQb88xpxiPKh6-ew\n EK-6: HHS/YS API Mimarisi \n HHS/YS API Uygulama Mimarisinde Test ve retim ortamlarnda aadaki alanda yer almaktadr. \n \n ekil 15: HHS/YS API Mimarisi \n'},{title:"5.\tGl Kimlik Dorulama",frontmatter:{},regularPath:"/v1.0.2/contents/gkd.html",relativePath:"v1.0.2/contents/gkd.md",key:"v-d80dcb06",path:"/v1.0.2/contents/gkd.html",headers:[{level:2,title:"5.1.\tYnlendirmeli Gl Kimlik Dorulama",slug:"_5-1-yonlendirmeli-guclu-kimlik-dogrulama"},{level:2,title:"5.2.\tAyrk Gl Kimlik Dorulama",slug:"_5-2-ayrk-guclu-kimlik-dogrulama"},{level:2,title:"5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi",slug:"_5-3-yonlendirme-bildirim-adresleri-ve-durum-kodu-parametresi"},{level:2,title:"5.4\tHealthcheck API",slug:"_5-4healthcheck-api"},{level:2,title:"5.5  Gl Kimlik Dorulama Kontrolleri",slug:"_5-5-guclu-kimlik-dogrulama-kontrolleri"}],content:" 5.\tGl Kimlik Dorulama \n Mteri iin gl kimlik dorulama, HKnn (mterinin) kimliinin dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntemi tanmlar. \n deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebli uyarnca hesap bilgisi hizmetinde mterinin onaynn alnmas esnasnda ve deme emri balatma hizmetinde her bir deme emri balatma ileminde  HHS tarafndan mteriye gl kimlik dorulama (GKD) uygulanmas esastr.  Buna gre: \n \n \n Hesap bilgisi hizmetinde HKnn onaynn alnmas esnasnda  Tebliin 26 nc maddesinin 1 inci fkras uyarnca  HHS tarafndan HKya GKD uygulanr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 2 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanr ve ilem dorulama kodu ile HKnn onay alnr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 3 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanmasna ilikin istisna veya ilave gvenlik nlemleri ibu API lke ve Kurallar belgesinde tanmlanr. \n \n \n HHS, gl kimlik dorulama srecinde HKnin sahip olduu bileen snf olarak SMS OTP ya da SMS ile ilem dorulama kodu kullanabilir. \n \n \n HHS, aadaki hallerde veya  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre tek bileen ile kimlik dorulama yapabilir. \n \n demenin gndereni ve alcsnn ayn olmas, \n Daha nce tanmlanm gvenli alclar listesine deme yaplmas, \n HKnin talimatna istinaden gerekletirilen dzenli bir deme olmas. \n \n \n \n Tek bileen ile kimlik dorulama yaplan bu ilemlerle ilgili olarak gerekletirilen ilemin mteri tarafndan yapldn ispat etme ykmll HHSye ait olur. \n \n \n lem Dorulamada  Tebliin 3 nc maddesinin birinci fkras  bendindeki  ilem bilgisi tanmna uygun olarak aadaki bilgiler ile  Tebliin 3 nc maddesinin birinci fkras hh bendinde  tanmlanan ileme zel retilmi ilem dorulama kodu birlikte kullanlr. \n \n Alc Unvan (Kolas aknda maskeli olarak)  (deme emri balatma hizmeti) \n Tutar (deme emri balatma hizmeti) \n Referans bilgisi (8 karakterden kk ise alann tm deeri, byk ise ilk 4 ve son 4 hanesi) \n \n leme ait yukardaki bilgilerden en az biri deitii zaman  Tebliin 3 nc maddesinin birinci fkras hh bendinde  belirtildii gibi yeni bir ilem dorulama kodu retilecek ekilde ak kurgulanmaldr. \n \n \n lem dorulama kodunun gnderilmesinden HHS sorumludur. HHS,  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre ilem dorulama kodu kullanmakszn HKnn onayn alabilir. lem dorulama kodu kullanlmayan ilemlerle ilgili olarak gerekletirilen ilemin HK tarafndan yapldn ispat etme ykmll HHSye aittir. \n \n \n HVPS API standart kapsamnda iki adet Gl Kimlik Dorulama (GKD) yntemi kullanlacaktr: \n \n Ynlendirmeli (Redirect) GKD Yntemi \n Ayrk (Decoupled) GKD Yntemi \n \n \n \n HHS asgari olarak tarayc tabanl Ynlendirmeli GKD yntemini desteklemek zorundadr. \n \n \n ereve szleme kapsamnda olmayan tek seferlik deme ilemleri sadece Ynlendirmeli GKD yntemi ile gerekletirilebilir. \n 5.1.\tYnlendirmeli Gl Kimlik Dorulama \n Ynlendirmeli GKD Ynteminde, mteri kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir. \n Mteri HHSye (uygulama veya web arayz vastasyla) ynlendirildikten sonra mterinin gl kimlik dorulamas adm adm ve dorudan HHS ile mteri arasnda yrtlr. GKDnin tamamlanmasndan sonra mteri tekrar YS uygulamasna ynlendirilir.Ynlendirmenin ayn sayfada HTTP 302 yant koduyla yaplmas gerekmektedir. \n Ynlendirmeli GKD Yntemi iin st dzey rnek i ak aadaki admlardan oluur: \n \n YS, GKD iin HHS tarafndan tanmlanan arayze (tarayc ya da uygulama) ynlendirme yapar. \n Mteri, YS arayznden ayrlr, ynlendirildii HHS arayz zerinde kimlik dorulama ilemlerini gerekletirir. \n GKD tamamlandktan sonra mteri, YS arayzne tekrar ynlendirilir ve ilem sonucu grntlenir. \n \n Ynlendirmeli GKD iin temel gereklilikler unlardr: \n \n deme hizmeti (hesap bilgisi veya deme emri balatma hizmeti) tarayc ya da uygulama tabanl bir ekilde sunulabilir. Bu nedenle,  YS ve HHSlerin Ynlendirmeli GKD iin asgari olarak tarayc tabanl ynlendirme akn desteklemeleri gerekmektedir. \n ereve szleme (S) kapsamnda olmayan tek seferlik deme ilemleri sadece Ynlendirmeli GKD yntemi ile gerekletirilebilir. \n \n Tarayc Tabanl Ynlendirme \n HHSnin web arayzne, \n \n HHSnin mobil uygulamasnn olmad, \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) sunduu mobil cihazda HHS uygulamasnn ykl olmad, \ndurumlarda ynlendirme yaplr. \n \n YSn mobil uygulamas varsa mobil cihazda uygulamadan taraycya, YSn mobil uygulamas yoksa deme hizmetinin sunduu cihazda (Kiisel Bilgisayar veya Mobil Cihaz) tarayc zerinden ynlendirme yaplr. \n Uygulama Tabanl Ynlendirme \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) YSn mobil uygulamas ile kullanyorsa, ayn mobil cihazda HHSnin mobil uygulamasnn yklenmi olmas durumunda, HK dorulamasnn HHS mobil uygulamas tarafndan yaplmas iin uygulama tabanl ynlendirme yaplr. Bylece HK, deme hizmetine eriim iin HHSnin mobil kanalna eriim srasnda kulland dorulama yntemini ile dorulanabilir. \n Tablo 5: Ynlendirmeli Gl Kimlik Dorulama Kanallar \n \n \n \n Dorulama Yntemi \n YS Olas Ortam \n HHS Olas Ortam \n \n \n \n \n Tarayc Tabanl Ynlendirme \n Kiisel Bilgisayar (masast, dizst)/Mobil Cihaz \n Kiisel Bilgisayar (masast, dizst) / Mobil Cihaz \n \n \n Uygulama Tabanl Ynlendirme \n Mobil Cihaz \n Mobil Cihaz \n 5.2.\tAyrk Gl Kimlik Dorulama \n Ayrk GKD Yntemi i ak, Ynlendirmeli GKD Ynteminin ilem akna benzer. Fark, HHS'nin, evrimii arayznden bamsz olan herhangi bir uygulama veya cihaz araclyla deme ilemi ayrntlarn ieren bir anlk bildirim (push notification) gndererek mteriden kimlik dorulamas istemesidir. Ayrk GKD Yntemine dayal bir ilem iin (ok basitletirilmi) st dzey rnek bilgi ak u ekildedir: \n \n Mteri, YS arayznde ilemini balatr. \n YS, talebini mteriye ait TCKN, VKN, YKN gibi tekil tanmlayc kimlik numaras bilgisi ierecek ekilde HHSye iletilir. \n HHS tekil tanmlayc bilgisini kullanarak farkl bir cihaz veya uygulama zerinden mteriye anlk bildirim gnderir ve dorulama yaplmasn salar. Bu ekilde HHS kendi mobil uygulamasna eriim iin kullanlan dorulama yntemini aynen kullanabilecektir. \n YS, herhangi bir yere ynlendirme yapmadan ilemin sonucunu bekler, mteri YS arayznden ayrlmaz (arayz ayn kalr). \n Kimlik dorulama sonras, YS arayznde ilem sonucu grntlenir. \n 5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi \n CSRF Ataklarndan korunmak iin ve YS uygulamasnn bir nceki durumunu restore edebilmesi iin; YS tarafndan iletilen ynlendirme ve bildirim adreslerine , Oauth2 standartlarndaki state parametresine edeer,   durum kodu (drmKod)  parametresinin eklenmesi gerekmektedir. Durum kodu parametresi YS tarafndan retilen, tekil ve kolay tahmin edilemeyen bir deer olmaldr. Rza istei gnderimi aamasnda oluturulmaldr. YS uygulamasnda uygun bir yerde saklanmaldr (cookie, session, local storage gibi) . \n Durum kodu, rza isteindeki ynlendirme adresine parametre olarak eklenir.  GKD sreci sonrasnda yetki kodu ile birlikte bu bilgi, HHS tarafndan YSe iletilir. YS saklad deer ile parametre olarak gelen deerin eitliini kontrol eder. Ayn ise eriim belirteci almak zere ak ilerletir. Farkl ise ilemi keser. \n 5.4\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr. \n Baarl yantta Http 200 kodu dnlmelidir. \nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Koullu  / stee Bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir. \n 5.5  Gl Kimlik Dorulama Kontrolleri \n HK, GKD iin HHS uygulamasna ynlendirildiinde, HHSnin eitli kontroller yaparak ilemin doruluunu teyit etmesi gerekmektedir.\nYaplmas gereken kontrollere ait temel senaryolar aadaki tabloda belirtilmitir. Bu senaryolar baz alnarak HHSler tarafndan zenginletirilebilir. \n Aadaki tabloda yer alan 07-13 aras Rza ptal Detay Kodlarnn olutuu senaryolar, HHS uygulamasnda yaplan kullanc dorulama ncesi ve sonras olarak iki admda incelenmelidir. \n HHS tarafnda, kullanc dorulama ncesinde yaplan kontroller neticesinde verilemeyen rzalar iin 04 : Sre Am : Yetki Bekleniyor iptal kodu atanr. HHS'nin YS uygulamasna 04 kodunu iletmesi beklenmez. YS zaman am neticesinde rza statsn sorgulayarak renir. \nKullanc dorulandktan sonra rza verilemiyorsa ilgili hata kodunun YS'e iletilmesi beklenmektedir. Kullanc dorulama sonras YS'e iletilen rza iptal detay kodu ile HHS veri modelinde tutulan rza ile ilikili rza iptal detay kodu, ayn deeri alacak ekilde gncellenmelidir. YS, HHS tarafndan kendine iletilen rza iptal detay kodunu kendi veri modelinde gncellemelidir. \n Zorunlu olarak belirtilen hata durumlarnn HHSler tarafndan gereklenmesi ve uygun hata kodlarnn YSe iletilmesi; ileride oluabilecek mutabakatlama sorunlarn ortadan kaldrabilecek, yaplacak raporlamalar kapsamnda sistem ve sre iyiletirmelerine katk salayacak, son kullanc asndan da alnan hataya ynelik bilgilendirici ierik salayacaktr. \n Hata aklamalar; hata koduna uygun ya da uyumlu olmak kaydyla, HHS ve YS tarafndan farkl ekillerde sunulabilir. \n GKD Srasnda yaplmas gereken kontroller \n \n \n \n Rza ptal Detay Kodu \n HHS hata aklamas* \n Ys ekrannda listelenecek rnek mesaj metni* \n rnek Senaryo \n Zorunlu / Opsiyonel \n \n \n \n \n 07 \n Rza mevcut ve durumu \"Yetkilendirildi\" veya \"Yetki Kullanld\" \n Yetki Hatas \n HK,  kullanc dorulama ilemi tamamlandktan sonra  YS ekrannda ileri - geri yaparak ya da HK'nn ynlendirme adresini kopyalayarak taraycya yaptrmas ile tekrar HHS'ye ynlendirir. Bu durumda HHS bu rza iptal detay kodunu iletir. HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 08 \n Rzano ile kimlik bilgileri uyumazl. \n lem gerekletirilememitir. \n YS tarafndan balatlan rza ierisinde yer alan kimlik bilgisi (rn:TCKN) ile HHS'de baarl kimlik dorulama yaplan HK'nn bilgilerinin uyumad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 09 \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) \n Gsterilebilecek hesap/kart bulunamamtr. \n HHS, kullanc dorulama yaptktan sonra, HK'nn uygun statl hesabnn olmad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 10 \n HK'nn Ak Bankaclk kanal ileme kapal \n HK'nn Ak Bankaclk kanal ileme kapal \n Ak bankacl ayr bir kanal olarak tanmlam HHS'lerde,  HK kullanc dorulama yaptktan sonra yaplan kontrollerde, HK'nn ilemlerini AB kanalna kapatm olmas durumunda   HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 11 \n HK'nn HHS'deki hesaplarnda yeterli yetkisinin olmamas \n Yetki hatas \n 1- Kurumsal firma kullanclarnn hesaplar zerinde ilem yetkisinin olmamas durumunda   2- Bireysel ortak hesaplarda hesap kst bulunuyorsa (para kna izin verilmedii durum)  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 12 \n HHSnin,  HK zelinde yapt kontrollerin baarsz olmas \n Yetki hatas \n HHS'nin, kullanc dorulama sonras HK iin i sistemlerinde yapt kontrollerin baarsz olmas. rnein: Mterinin henz bankaclk hizmet szlemesi gibi Internet ubesi zerinde ilem yapmasn engelleyen eksikleri olmas durumunda veya kurumsal kullancda vekalet sresinin dolmas/eksik dokman olmas durumunda kanal zerinde ilem yapamad durum  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 13 \n HK istei ile GKDden vazgeilmesi \n Mteri ilemden vazgemitir. \n HHS ekrannda yer alan VAZGE butonuna baslmas durumu (HK,HHS uygulamasnda kullanc dorulama yaptktan sonra VAZGE butonu olabilir.) \n Zorunlu \n \n \n 14 \n GKD ptali: Fraud phesi \n lem gerekletirilememitir. \n HHS Fraud phesi nedeniyle ilemin devamna izin vermez. HHS'nin, fraud kontrollerinin deme balatma hizmeti iin yapmas ve 14- GKD ptali: Fraud phesi ile rza iptalini gerekletirmelidir. HBH servislerinde HHS'nin rza iptal kodu 14 ile ilemi kesmesi HHS'nin kendi insiyatifindedir yani opsiyoneldir. \n Koullu \n \n \n 99 \n Dier \n lem gerekletirilememitir. \n Oluabilecek dier senaryolar. \n Zorunlu \n \n \n \n GKD srasnda iletilen rza no eer HHSnin sisteminde bulunamazsa durumu gncellenecek bir rza no da olmayacaktr. HHS kendi nyznde bu duruma uygun bir mesaj gsterebilir. YSe de Dier hata kodu ile bu durumu iletebilir. \n"},{title:"2.Kapsam ve Dayanak",frontmatter:{},regularPath:"/v1.0.2/contents/kapsam-ve-dayanak.html",relativePath:"v1.0.2/contents/kapsam-ve-dayanak.md",key:"v-3539d41d",path:"/v1.0.2/contents/kapsam-ve-dayanak.html",content:" 2.Kapsam ve Dayanak \n 12 Kasm 2019da gncellenen  6493 sayl deme ve Menkul Kymet Mutabakat Sistemleri, deme Hizmetleri ve Elektronik Para Kurulular Hakknda Kanun un (Kanun) 12nci maddesine yeni eklenen ve  deme Hizmetleri Direktifi 2 'de (Payment Services Directive 2, PSD2) bulunan iki yeni deme hizmeti aadaki gibi tanmlanmtr (ekil-1: deme Hizmetleri Veri Paylam Servisleri): \n \n deme Emri Balatma Hizmeti : HKnn istei zerine baka bir deme hizmeti salaycsnda bulunan  deme hesabyla  ilgili sunulan deme emri balatma hizmeti [Madde 12, birinci fkra, (f) bendi] \n Hesap Bilgisi Hizmeti : HKnn onaynn alnmas kouluyla, HKnn deme hizmeti salayclar nezdinde bulunan bir veya daha fazla  deme hesabna  ilikin konsolide edilmi bilgilerin evrim ii platformlarda sunulmas hizmeti [Madde 12, birinci fkra, (g) bendi] \n \n   \n ekil 1: deme Hizmetleri Veri Paylam Servisleri (HVPS)- tantm \n Kanunun 14/A maddesinin ikinci fkrasna gre , Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetleri ile ilgili ilemlerin yrtlmesine ilikin usul ve esaslar ile taraflarca uyulmas gereken teknik ve operasyonel gereklilikler ikincil dzenlemeler uyarnca Trkiye Cumhuriyet Merkez Bankas (TCMB) tarafndan belirlenir. Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri  deme hizmetleri veri paylam servisleri (HVPS)  olarak adlandrlmaktadr. \n deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelikin (Ynetmelik) 59uncu maddesinin birinci fkras uyarnca hazrlanan bu belgede sz konusu deme hizmetlerini sunacak deme hizmeti salaycsnn, deme hesabnn bulunduu deme hizmeti salaycsnn, varsa ilgili dier taraflarn ve bu hizmetlerin sunulmas iin taraflar arasnda kurulacak balantnn teknik ve operasyonel gereklilikleri aklanmaktadr. \n Dzenlemeler kapsamnda yetkilendirilen nc taraf hizmet salaycs  (Yetkili deme Hizmeti Salaycs, YS) , deme hizmeti kullanclarnn  Hesap Hizmeti Salayclar (HHS)  nezdindeki deme hesaplarna ulaarak deme emri balatma ve hesap bilgisi salama hizmetlerinden (deme hizmetleri veri paylam servislerinden) faydalanmasna araclk eder. deme hizmetleri veri paylam servisleri kapsamnda iki tip YS bulunmaktadr:  1) Hesap Bilgisi Hizmeti Salaycs (HBHS) ve 2) deme Emri Balatma Hizmeti Salaycs (BHS). \n Hesap Bilgisi Hizmeti Salaycs (HBHS) HKnn farkl Hesap Hizmeti Salayclar (HHS) nezdindeki hesaplarnn bilgilerini derleyerek evrim ii platformlarda  toplu ekilde  sunar. deme Emri Balatma Hizmeti Salaycs (BHS) ise talebi zerine HKnn HHSde bulunan deme hesabndan deme ilemi balatr. \n HVPSnin st dzey gsterimi ekil-2de verilmitir. \n   \n ekil 2: deme Hizmetleri Veri Paylam Servisleri (HVPS) -st dzey gsterim \n deme Hizmetleri Veri Paylam Servislerinin HHSler tarafndan  BKM API Geidi  vastasyla sunulduu uygulama mimarisi ise ekil-3te sunulmutur. \n  \n ekil 3: HVPS'nin BKM API Geidi vastasyla sunumu \n"},{title:"7.\tHesap Bilgisi Hizmeti",frontmatter:{},regularPath:"/v1.0.2/contents/hesap-bilgisi-hizmeti.html",relativePath:"v1.0.2/contents/hesap-bilgisi-hizmeti.md",key:"v-f0808a06",path:"/v1.0.2/contents/hesap-bilgisi-hizmeti.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Hesap Bilgisi Hizmeti in Eriim Adresleri",slug:"hesap-bilgisi-hizmeti-icin-erisim-adresleri"},{level:2,title:"ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas:",slug:"adim-0-ohk-nn-hesap-bilgilerine-erisim-icin-talepte-bulunmas"},{level:2,title:"7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas",slug:"_7-1-adim-1-hesap-bilgisi-rzasnn-hazrlanmas"},{level:3,title:"POST /hesap-bilgisi-rizasi",slug:"post-hesap-bilgisi-rizasi"},{level:3,title:"Baarl stek:",slug:"basarl-istek"},{level:3,title:"Baarl Yant:",slug:"basarl-yant"},{level:2,title:"zinler",slug:"izinler"},{level:2,title:"7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi",slug:"_7-2-adim-2-hesap-bilgisi-hizmeti-rzasnn-tesisi"},{level:2,title:"7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas",slug:"_7-3-adim-2-1-hesap-bilgisi-rzasnn-sorgulanmas"},{level:2,title:"7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali",slug:"_7-4-adim-2-2-hesap-bilgisi-rzasnn-iptali"},{level:2,title:"7.5 ADIM 3: Hesap Bilgilerinin Alnmas",slug:"_7-5-adim-3-hesap-bilgilerinin-alnmas"},{level:2,title:"7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas",slug:"_7-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanmas"},{level:2,title:"7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas",slug:"_7-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanmas"},{level:2,title:"7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas",slug:"_7-8-adim-3-5-ve-3-6-islemlerin-sorgulanmas"},{level:2,title:"7.9\tHealthcheck API",slug:"_7-9healthcheck-api"},{level:3,title:"Baarl Yant:",slug:"basarl-yant-2"}],content:" 7.\tHesap Bilgisi Hizmeti  \n Genel Bilgiler \n Hesap bilgisi sorgulama iin HBHS tarafndan mteri rzas tesisinin HHS tamamlanm olmas gerekir. Mteri rzas tesisi tamamlandktan sonra, HBHS sorgulamak istedii hesaba ait verileri ilgili eriim adresi zerinden sorgular. \n \n \n ekil 10: Hesap Bilgisi Hizmeti st Dzey Ak \n ekil-10da sunulan hesap bilgisi hizmeti 5 temel aktan oluur: \n 0.\tMterinin hesap bilgilerine eriim iin talepte bulunmas:  HK BHS mobil uygulama ya da web sitesinden hesap bilgilerine eriim ilemini balatr. \n 1.\tHesap Bilgisi mteri rzasnn hazrlanmas: \n HBHS, hesap bilgilerine eriim iin mteri rzas tesisi amacyla HHSdeki hesap bilgisi rzas eriim adresine bir POST isteinde bulunur ve bir hesap bilgisi rzas nesnesi oluturur. HHS hesap bilgisi rzas nesnesi iin biricik tanmlayac dner (RzaNo). Hesap bilgisi rzas, mterinin HBHSnin hesap bilgilerine eriim izin verdii alanlar ierir: \n \n zinler - eriim iin izin verilen veri kmelerinin listesi. \n Eriimin Geerli Olduu Son Tarih - HBHS'nin mterinin hesap bilgilerine eriebilecei istee bal seilebilen son tarih. \n lem Sorgulama Balang Zaman  Mteri rzasnn tesisinden itibaren geriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n lem Sorgulama Biti Zaman - Mteri rzasnn tesisinden itibaren ileriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n \n 2.\tHesap bilgisi hizmeti mteri rzasnn tesisi: \n HHS, Hesap Bilgisi Rzas servisi ile HK zelinde Yetki bekleniyor statsnde bir rza nesnesi hazrlar. HHS, GKDnin baaryla tamamlanmas sonrasnda hesap bilgisi rzas nesnesinin yetkilendirildiini belirtmek iin Rza Durumunu Rza Yetkilendirildi olarak gnceller. Nesne yetkilendirildikten sonra HHS nesne ile bir eriim belirteci (access token) ilikilendirir, Rza Durumunu Yetki Kullanld yapar ve bu belirteci HBHSye geri dner.  Bylece mteri rza tesisi salanm olur. \n Hesap bilgisi iin mteri rzasna ilikin temel ilkeler unlardr: \n \n 1 HK'nn 1 YS iin 1HHS'de Yetki Bekleniyor, Yetkilendirildi, Yetki Kullanld statsnde 1 rzas olabilir. \n Mteri rzasnn ayrntlar HK ile HBHS arasnda belirlenir. Bu nedenle mteri rzasnn ayrntlar HHS ekrannda deitirilmemelidir. \n HK, hesap eriim izni ayrntlarn yalnzca bir btn olarak yetkilendirebilir veya geri alabilir. \n Mteri rzas tesisi esnasnda, mteri HHS arayznde eriim iin yetkilendirecek hesaplar seer. \n \n 2.1\tHesap bilgisi rzasnn sorgulanmas:  Mteri rzas  GET/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak sorgulanr. \n 2.2\tHesap bilgisi mteri rzasnn iptali:  Mteri rzas  DELETE/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak iptal edilir. \n 3.\tHesap bilgilerinin alnmas:  Hesap bilgileri ilgili kaynaa (hesaplar, bakiye, ilemler) GET istei yaplarak gerekletirilir. HBHS, mteri rzasnn tesisinden sonrasnda (geerli bir eriim belirticine sahip olduunda) ncelikle  GET/hesaplar  ars yapacaktr. \n Hesap Bilgisi Hizmeti in Eriim Adresleri \n Etki Alan (Scope) =hesap_bilgisi \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n hesap-bilgisi-rizasi \n POST \n /hesap-bilgisi-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n HesapBilgisiRizasiIstegi \n HesapBilgisiRizasi \n \n \n 2 \n erisim-belirteci  (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n HesapBilgisiRizasi \n \n \n 2.2 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n \n \n \n \n \n \n 3.1 \n hesaplar \n GET \n /hesaplar \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n HesapBilgileri(birden ok hesap) \n \n \n 3.2 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n HesapBilgileri(tek  hesap) \n \n \n 3.3 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n BakiyeBilgileri(tek  hesap) \n \n \n 3.4 \n bakiye \n GET \n /bakiye \n  \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n BakiyeBilgileri(birden ok hesap) \n \n \n 3.5 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n IslemBilgileri (tek hesap) \n \n \n \n Tablo 11: Hesap Bilgisi Hizmeti in Eriim Adresleri \n ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas: \n HK, HBHS uygulamasnda (web arayz/mobil uygulama) hesap bilgilerine eriim iin talepte bulunur. \n 7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas \n Bu API ars HBHS'nin HHS'de yeni bir HesapBilgisiRizasi nesnesi oluturmasn ve nesneye erimek iin benzersiz bir rza numaras ({RizaNo}) dnlmesini salar. \n API arsnn baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas yeterlidir.\nBaaryla oluturulan hesap bilgisi rza kaynann rza durumu Yetki Bekleniyor olarak dzenlenir.\nHK daha nce ald rzaya ilikin eriim tarihleri, izin trlerini ve hesap bilgilerini gncellemek isterse, HBHS nce HHS nezdindeki rzay iptal etmeli ve sonrasnda yeni bir rza talebinde bulunmaldr.\n \n \n ekil 11: Hesap Bilgisi Mteri Rzasnn Hazrlanmas \n \n POST /hesap-bilgisi-rizasi isteinin (REQUEST) gvdesinde (BODY)  HesapBilgisiRizasIstegi nesnesi (Tablo-12) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda HesapBilgisiRizasi (Tablo-13) nesnesi oluturulur. \n  POST /hesap-bilgisi-rizasi \n Baarl stek: \n STEK: \n HBHS, bu API eriim adresinden HHSye yeni bir HesapBilgisiRizasi oluturulmas iin istekte bulunur: \n \n HBHS, HKnn hesap bilgilerine ynelik rza balatma istei olduunu HHSye bildirir. \n HBHS, HKnn, HBHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk ve uzunluk kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan HBHS bilgilerinin ierisinde yer alan ynlendirme ve bildirim adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde iletilen kimlik bilgileri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Zorunlu) \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlar ile ilgili Tablo 12de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, benzersiz RizaNo ile HesapBilgisiRizasi nesnesi oluturur ve HBHSye dner. \n HHS, HesapBilgisiRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlarnda zaman aralklar mteri deneyimi penceresinden deerlendirilerek ay cinsinden belirtilmitir. Bu konuda aadaki gibi oluabilecek u rneklere dikkat edilmesi gerekmektedir. \n Bugn : 31.08.2019 \nBugn + 6 Ay : 29.02.2020 \nBugn : 30.08.2020 \nBugn + 6 Ay : 28.02.2021\nBugn : 30.09.2022 \nBugn + 3 Ay : 30.12.2022\nBugn : 14.07.2022 \nBugn + 3 Ay : 14.10.2022 \n Tablo 12: HesapBilgisiRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Hata durumunda TR.OHVPS.Connection.InvalidASPSP hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda TR.OHVPS.Connection.InvalidTPP hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr.   Yetkilendirme yntemi, HBHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur.  YS Ynlendirmeli GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak ynlendirme adresini iletmelidir. Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunludur.  YS Ayrk GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak bildirim adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, ayrk GKD sonras bu alanda belirtilen adrese otorizasyon kodunu (authentication code) iletir. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr.   TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n \n >zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih.   Mteri YS ekranndan bu deeri belirleyebilir.   Varsaylan deer : Rza verilen tarih + 6 ay   Alabilecei maksimum deer : Rza tarihi + 6 ay    Alabilecei minimum deer : Rza tarihi + 1 gn   rnein 23/09/2021de minimum 24/09/2021 seilebilir. Bu durumda izin 24/09/2021 23:59:59da bitecek ekilde olmaldr. \n Bu alanda bir deer bulunmad durumda HHS hata dnmelidir. \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gemie dnk en fazla 12 ay olabilir, daha eski olmamas gerekir.   Varsaylan deeri rza verilen tarih (ilem zaman)  12 aydr.   HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.   Minimum tarihi : Rzann verili tarihi  - 12 ay    Maksimum tarih: Rzann verili tarihi +  12 ay    zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve  lem Sorgulama Balang Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gelecee dnk en fazla 12 ay sonras olabilir, daha ileri bir tarih olmamas gerekir.   Varsaylan deeri: Rza verilen tarih + 12 aydr.  HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.  Minimum tarihi : Rzann verili tarihi   12 ay  Maksimum tarihi :  Rzann verili tarihi + 12 ay   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. Eer dolu gnderilirse HHS tarafndan uygun hata mesaj iletilmelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve lem Sorgulama Biti Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez.   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n Baarl Yant: \n Tablo 13: HesapBilgisiRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu sral veri tipini deerlerinden birini alr. rn; hesap bilgi rzasnn tesisine dair ilk istek mesajna dnte B: Yetki Bekleniyor deerini almas beklenir. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir. \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n K \n HHS, HBHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr.  TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n HHS, mteri uygulama / taraycsn bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n HHS, ayrk GKD sonras bu alanda belirtilen YS adresine otorizasyon kodunu (authentication code) iletir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.  HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir. Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n > zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HBHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei balang zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei biti zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n > Ayrnt Bilgi \n ayrBlg \n Kompleks: AyrintiBilgi \n  \n \n \n \n > HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n zinler \n Bir hesap bilgisi mteri rzas kayna arsna yant olarak dndrlen verileri snrlamak iin izin kodlar kullanlr: \n \n Temel Hesap Bilgisi \n Ayrntl Hesap Bilgisi \n Bakiye Bilgisi \n Temel lem (Hesap Hareketleri) Bilgisi \n Ayrntl lem Bilgisi \n \n HKya sunulacak seimler ve kurallar aadaki gibi olmaldr. \n \n \n \n Seim \n Kural \n \n \n \n \n Temel Hesap Bilgisi \n HK seimine sunulmamaldr. Deitirilemez ekilde seili gsterilmelidir. \n \n \n Ayrntl Hesap Bilgisi \n HK seim yapabilir. \n \n \n Bakiye Bilgisi \n HK seim yapabilir. \n \n \n Temel lem (Hesap Hareketleri)  Bilgisi \n HK seim yapabilir. \n \n \n Ayrntl lem Bilgisi \n HK seim yapabilir. Ayrntl lem Bilgisi seimi Temel lem Bilgisi seimini kapsar. (Ayrntl lem bilgisi seildiinde Temel lem Bilgisi de seili olmaldr.) \n \n \n \n Aadaki durumlarda, izin kombinasyonlarna izin verilmez. HHS, bu hesap eriim onaylarn 400 (Hatal stek) yant koduyla reddetmelidir: \n \n zin dizisinin herhangi bir izin tr iermemesi durumu, \n zin dizisinde HHS tarafndan desteklenmeyen bir izin kodunun yer almas durumu \n 7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi \n \n \n ekil 12: Hesap Bilgisi HK Rzasnn Tesisi \n Rza tesisinin baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas ve ardndan mterinin HHS tarafndan ynlendirmeli veya ayrk GKD ile dorulanmas gerekir. HHS'de oluturulan ve rza durumu Yetki Bekleniyor olan bir hesap bilgisi rzas, GKD sonras Yetkilendirildi statsne gncellenir. HBHS, eriim salayaca hesaplar hesap bilgisi rzasnn tesisinden nce seer. \n \n \n Ynlendirmeli dorulama aknda, HBHS HKy HHSye ynlendirir. \n \n \n HBHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n \n \n HHS, HK iin GKD srecini iletir. \n HKy dorularsa, \n \n \n HK HBHS zerinden ilem yaplmasna izin verecei hesap seimini yapar. HBHS zerinden HKnn verdii izin bilgilerini ve eriim izninin biti tarihi bilgilerini, HHS bilgilendirme amal HKya gsterir. \n \n \n HHS hesap bilgisiri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n HHS, HKy olumlu ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=H&drmKod=zzz\n \n \n \n HKy dorulayamazsa, \n \n \n HHS, hesap bilgisi rza kaynann durumunu Yetki ptal olarak gnceller. \n \n \n HHS, HKy olumsuz ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I &rizaNo=yy&rizaTip=H&rizaIptDtyKod=11&drmKod=zzz\n \n \n \n \n \n \n \n Ayrk dorulama aknda, HHS, HKnn hesap bilgisi hizmetini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister. \n \n Ayrk ak HBHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek hesap bilgisi rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, deme hizmeti kullancsn dorular. \n HK verdii izin tipi dahilinde bilgileri paylalacak olan hesaplar seer. \n HHS, hesap bilgisi rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS,  hesap bilgisi rzasnn durumunu Yetki Kullanld olarak gnceller. Rza tesisi salanm olur. \n 7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HK, HHS zerinden rza iptali yapm olabilir veya HKnn verdii rza sresi dolmu olabilir.  Bu durumlarda HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir HesapBilgisiRizasi kaynann durumunu, istee bal olarak alabilir. \n Servis baarl yantnda Tablo 13de belirtilen HesapBilgisiRizasi nesnesini dnmektedir. \n Durum \nHesapBilgisiRizasi kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki Sonlandrld \n Yetki ptal \n 7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali \n \n \n \n ekil 13: Hesap Bilgisi Mteri Rzasnn Geri Alnmas \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \n DELETE /hesap-bilgisi-rizasi ars, bir HBHS'nin nceden oluturulmu bir hesap eriim rzasn (yetkili olsun veya olmasn) silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, HBHS zerinden bu rzasn kaldrmak isteyebilir. \nBu API ars, mterinin HBHS zerinden hesap bilgisi rzasn iptal etmesine ve HHS nezdindeki hesap bilgisi rzas nesnesinin silinmesini salar. \nMterinin HBHSnin veri eriim iznini iptal etmesi durumunda HBHS, HHSde mevcut olan HesapBilgisiRizasi kaynan pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \nars aracl ile yerine getirilir. HBHS ayrca, sisteminden Hesap Eriim zni kaynaklarn da temizlemelidir. \nSz konusu silme ilemi, kaytlarn statsnn pasife ekilmesi ile gerekletirilmelidir. Sz konusu kaytlar, denetim izlerinin oluturulmas ve saklanmasna ilikin ikincil dzenleme hkmleri kapsamnda gvenli ekilde tutulmaldr. \nServis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr. \nHK rzas baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal olarak gncellenir ve gnclZmn zaman damgas vurularak gncellenir. \nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir: \nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (HBHS) \n 7.5 ADIM 3: Hesap Bilgilerinin Alnmas \n    \n \n   \n ekil 14: Hesap Bilgilerinin Alnmas \n STEK: \nMteri rzas tesis edilmi kullanc iin HBHS API eriim adresinden HHSye eriilebilir hesap bilgilerini GET istei ile sorgular: \n \n RizaDurumu Yetki Kullanld ise ileme balanr. RizaDurumu farkl bir deerde ise TR.OHVPS.Resource.ConsentMismatch hatasnn iletilmesi gerekir. \n GET verisinin modele gre kontrol yaplr (rnein: Alan kontrolleri) \n \n GET verisinin mantksal kontrolleri yaplr. \n 7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas \n GET /hesaplar ve GET /hesaplar/{hspRef} \n Bu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bilgilerinin sorgulanr. Hesap bilgisi iin daha nce tanmlanm izin trne gre (Temel Hesap Bilgisi veya Detayl Hesap Bilgisi) yantnda dnlen HesapBilgileri nesnesinin ierii deiir.  Tablo 15te HesapBilgileri nesnesinin ierii verilmitir. \n Hesap Bilgisi Sorgu rnei (Tm Hesaplar) =  /hesaplar \nHesap Bilgisi Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef} \nlem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 14: Hesap Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numaras \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 15: HesapBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzas nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Hesap Temel \n hspTml \n Kompleks: HesapTemel \n Z \n Temel Hesap Bilgileri (Temel Hesap Bilgisi varsaylan izin tr olduundan Hesap Temel nesnesi zorunlu olarak yantta bulunur) \n \n \n > Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n > Hesap Numaras \n hspNo \n AN26 \n K \n Eer varsa deme hesabna ait IBAN bilgisi \n \n \n > Hesap Sahibi Unvan \n hspShb \n AN3..140 \n Z \n Hesap sahibi ya da hesap sahiplerinin ad-soyad, ticari unvan \n \n \n > ube Ad \n subeAdi \n AN3..50 \n K \n Eer varsa deme hesabnn bal olduu ubenin ad \n \n \n > Ksa Ad \n kisaAd \n AN3..50 \n K \n Eer hesap sahibi hesaba ait bir ad tanmladysa, tanmlanan hesap ad \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi. \n \n \n > Hesap Tr \n hspTur \n AN1 \n Z \n Hesabn tr (bireysel veya ticari). TR.OHVPS.DataCode.HspTur srali veri deerlerinden birini alr. \n \n \n > Hesap Tipi \n hspTip \n AN1..32 \n Z \n Hesabn tipi (VADESZ, KREDL vb.).TR.OHVPS.DataCode.HspTip sral veri deerlerinden birini alr. \n \n \n >Hesap rn Ad \n hspUrunAdi \n AN1..140 \n  \n HHS tarafndan atanm olan rn ad bilgisidir. HBHS tarafndan HKya gsterilmesi kullanm kolayl salayacaktr. \n \n \n > Hesap Durumu \n hspDrm \n AN5..50 \n Z \n Hesabn durumunu belirtir. TR.OHVPS.DataCode.HspDrm sral veri trlerinden birini alr. \n \n \n Hesap Detay \n hspDty \n Kompleks: HesapDetay \n K \n Detay Hesap Bilgileri (Temel Hesap Bilgisine ek olarak Detay Hesap Bilgisi izin tr de seilmise Hesap Detay nesnesi koullu olarak yantta bulunur) \n \n \n > Al Tarihi \n hspAclsTrh \n ISODateTime \n Z \n Belirtilen hesabn al tarihi. \n 7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas \n GET /bakiye ve GET /hesaplar/{hspRef}/bakiye \nBu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bakiyesi sorgulanr. \nstek arsna dnlen BakiyeBilgileri nesnesi Tablo 17de verilmitir. \n Hesap bakiyelerinin gsterilmesi srasnda aada verilen rnekler gznnde bulundurulmaldr. \n rnek 1 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  -1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 2 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  2000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 3 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 4 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  3000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n lem Sorgu rnei (Belirli Bir Hesap)=  /bakiye?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 16: BakiyeBilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 17: BakiyeBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n Bakiye \n bky \n Kompleks:Bakiye \n Z \n \n \n \n > Hesap Bakiye Tutar \n bkyTtr \n AN1..25 \n Z \n Hesabn bakiyesi. Bloke tutar dlmeden iletilmelidir.   Tutar alan regex patterni u ekildedir:  '^-?\\d{1,18}$|^-?\\d{1,18}\\.\\d{1,5}$' \n \n \n > Blokeli Tutar \n blkTtr \n AN1..24 \n K \n Varsa hesapta blokeli tutar bilgisi.     Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n > Bakiye letilme Zaman \n bkyZmn \n ISODateTime \n Z \n Bakiyenin iletildii zaman bilgisi. \n \n \n > KrediliHesap \n krdHsp \n Kompleks: KrediliHesap \n K \n \n \n \n >> Kredili Mevduat Hesab Bakiyesi \n kulKrdTtr \n AN1..24 \n Z \n Kredili mevduat tutar. Kredili bir hesap ise zorunlu.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Kredi Dahil Gstergesi \n krdDhlGstr \n AN1 \n Z \n Kredili bir hesap ise zorunlu. Bakiye tutarnn kredi tutar dahil edilerek ya da edilmeden iletildiini gsterir.   0: Kredi tutar dahil edilmeden bakiye bilgisi iletilmesi durumu   1: Kredi tutar dahil edilerek bakiye bilgisi iletilmesi durumu \n 7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas \n GET /hesaplar/{hspRef}/islemler \n Belirli bir hesaba ilikin ilem bilgileri Tablo 1daki istek parametrelerine gre sorgulanr. \nlem bilgisi iin daha nce tanmlanm izin trne gre yantta dnen IslemBilgileri nesnesinin (Temel lem Bilgisi veya Temel lem Bilgisi ve Detayl lem Bilgisi) ierii deiir. \nlemler servisi hem HKnn talebi ile YS uygulamas zerinden arlabilecei gibi, YSn HKsz balatabilecei otomatik arlar ile de yant dnebilmektedir. \nHHS, ilemin sistemsel yaplp yaplmadn, istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir.\nHKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \nYS, otomatik yapaca sorgularda; \n \n Bireysel HKlar iin hesap baznda gnde en fazla 4 adet baar ile sonulanan sorgulama yapabilir. \n Kurumsal HKlar iin hesap baznda saatte en fazla 12 adet baar ile sonulanan sorgulama yapabilir. \n \n HHS, tutaca saya bilgisi ile bu saylar kontrol ederek daha fazla sorgulama yaplmasna izin vermeyebilir. \n Ayn istek parametreleri ile yaplan sorgu sonucunda dnecek toplam kayt says 100 atnda, sayfalama yntemi ile HHSnin cevap dnmesi beklenmektedir.  Her bir sayfa iin ilemler servisi tekrar arlsa da, bu arm HHSnin tuttuu saya deerini arttrmaz. HHSnin tutaca sayan kontrol parametreleri YS kodu, hesap numaras ya da referans olmaldr. Sayfa no parametresi varsa ve 1'den byk ise ilem sayacn arttrmamaldr. \n HKnn YS uygulamas zerinden tetikledii ilemlerde ise;\nbireysel HKlar  iin en fazla 1 aylk,\nkurumsal HKlar iin ise en fazla 1 haftalk bir pencere aralnda sorgulama yaplabilir. \n YS, otomatik yapaca sorgularda hem bireysel hem de kurumsal HKlar iin 24 saatlik bir pencere aralnda sorgulama yapabilir. \n Hesap kapal olduu durumda hesap hareketlerini iletmek istemeyen HHS'lerin  TR.OHVPS.Business.InvalidAccount  hatas vermeleri beklenir. \n lem Sorgu rnei (Belirli Bir Hesap)=  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-02T23:59:59+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A \n Tablo 18: lem Listesi Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n lem Sorgulama Balang Zaman \n hesapIslemBslTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin balang tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. HK tarafndan tetiklenen sorgularda;hesapIslemBslTrh ve hesapIslemBtsTrh aras fark bireysel HKlar iin en fazla 1 ay,kurumsal HKlar iin ise en fazla 1 hafta olabilir. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;son 24 saat sorgulanabilir. Bu yzden hesapIslemBtsTrh-24 saatten daha uzun bir aralk sorgulanamaz olmaldr. stek balnda yer alan PSU-Initiated alan E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n \n \n lem Sorgulama Biti Zaman \n hesapIslemBtsTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin biti tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;leri vadeli ilem emirleri dahil olmad iin; lem Sorgulama Biti Zaman, her zaman, sorgulama zaman damgasn iletecek ekilde (datetime (now)) iletilmelidir. \n \n \n En Dk lem Tutar \n minIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en dk ilem tutar.      Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n En Yksek lem Tutar \n mksIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en yksek ilem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Bor Alacak Gstergesi \n brcAlc \n AN1 \n  \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Hesaba bor yaratan ilem.A: Hesaba alacak yaratan ilem.{B,A} \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {islGrckZaman} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini islGrckZaman olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 19: IslemBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans Numaras \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. \n \n \n Islemler \n isller \n Kompleks:Islem[Array] \n K \n Hesaba ilikin hareketler varsa lemler nesnesi dizisi olarak dnlr. lemler nesnesi Temel lem Bilgileri ve Detay lem Bilgileri nesnesinden meydana gelir. zin tr varsaylan olarak Temel lem Bilgilerini ierir. Detay lem Bilgileri izin tr de seildi ise Temel lem Bilgilerine ek olarak Detay lem Bilgileri de gnderilir. \n \n \n > Temel lem Bilgileri \n islTml \n Kompleks:IslemTemel \n Z \n Temel lem Bilgileri varsaylan olarak dnlr. \n \n \n >> lem Numaras \n islNo \n AN3..50 \n Z \n Hesap hareketinin oluturulmas srasnda atanan ve bor (veya alacak) hareketini tekilletiren HHS baznda tekil tanmlaycdr. Bu deer tek bana tekil olabilecei gibi birden fazla deerin bir araya getirilmesiyle de tekillii salanm olabilir. Bu deerin en azndan hesap numaras (hesNo) baznda tekil olmas beklenir. Genellikle kullanlan rnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp,dekont numaras \n \n \n >> lem Referans Numaras \n refNo \n AN3..50 \n Z \n lemi utan uca tanmlayan tekil tanmlaycdr. Bor ve alacak hareketinden oluan bir veya birden fazla ilemler btn iin atanm olan ve bu btn tekilletiren (bir biri ile ilikisini tutan) deerdir.Bu deer hem YSten gelen deer olabilir (deme ilemlerinde kullanlan kkodRef ya da refBlg alan) hem de HHS iinde takip edilmek iin retilmi bir deer olabilir. HHS sisteminde 2 deerin de bulunmas durumunda;refNo alann doldurmak iin, HHSnin YSten gelen deere ncelik vermesi beklenmektedir. YSten gelen veri rnei: Sipari Numaras, Fatura Numaras, Karekod Referans vb. HHSte retilen veri rnei: Masrafl havale ileminde hem havale ileminin hem de masraf ileminin ayn referans numarasna sahip olmas da rnek olarak gsterilebilir. \n \n \n >> lem Tutar \n islTtr \n AN1..24 \n Z \n lem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n >> lem Gerekleme Zaman \n islGrckZaman \n ISODateTime \n Z \n lemin gerekleme zaman. \n \n \n >> lem Kanal \n kanal \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeKaynak sral veri tr deerlerinden birini alr. \n \n \n >> Borlandrma Alacaklandrma Gstergesi \n brcAlc \n AN1 \n Z \n TR.OHVPS.DataCode.BrcAlc sral veri tr deerlerinden birini alr. lemin hesab bor ya da alacaklandrd bilgisidir. \n \n \n >> lem Tr \n islTur \n AN3..50 \n Z \n HHSnin ileme ait ilikilendirdii ilem tr deeri. TR.OHVPS.DataCode.IslemTuru sral veri tr deerlerinden birini alr. \n \n \n >> lem Amac \n islAmc \n AN2 \n Z \n TR.OHVPS.DataCode.IslemAmaci srali veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> deme Sistemi No \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. \n \n \n > Detay lem Bilgileri \n islDty \n Kompleks: IslemDetay \n K \n Detay lem Bilgileri dizi olarak gnderilmelidir. \n \n \n >> lem Aklamas \n islAcklm \n AN1..150 \n Z \n HHS tarafndan atanan ilem aklamas.HHS kendi ilem hareketlerine yanstt aklamay buraya yanstmaldr. \n \n \n >> Kar Taraf \n krsTrf \n Kompleks:  KarsiTaraf \n K \n Kullanm ilem baznda deimektedir. rnek: FAST ileminde kar taraf alcnn bilgileridir. Vergi demesinde kurum IBAN bilgisi mteriye gsterilemeyebileceinden bu alann bo gelmesi HHS insiyatifindedir. \n \n \n >>> Kar Maskeli IBAN \n krsMskIBAN \n AN26 \n K \n lgili hesap hareketinin kar tarafnn maskeli IBAN bilgisi. \n \n \n >>> Kar Maskeli Unvan \n krsMskUnvan \n AN3..140 \n K \n lgili hesap hareketinin kar tarafnn maskeli ad-soyad ya da ticari unvan bilgisi. \n 7.9\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr \n Baarl yantta Http 200 kodu dnlmelidir. \n Baarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n"},{title:"6.\tdeme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v1.0.2/contents/odeme-emri-baslatma-hizmeti.html",relativePath:"v1.0.2/contents/odeme-emri-baslatma-hizmeti.md",key:"v-1ef8939d",path:"/v1.0.2/contents/odeme-emri-baslatma-hizmeti.html",headers:[{level:3,title:"deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"6.1.\tADIM 0 - deme Emri Balatma Istei",slug:"_6-1-adim-0-odeme-emri-baslatma-istegi"},{level:2,title:"6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas",slug:"_6-2-adim-1-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi",slug:"_6-3-adim-2-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_6-4-adim-2-1-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"6.5.\tADIM 3- deme Emrinin Oluturulmas",slug:"_6-5-adim-3-odeme-emrinin-olusturulmas"},{level:2,title:"6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal)",slug:"_6-6-adim-3-1-odeme-emri-sorgusu-istege-bagl"},{level:3,title:"GET /odeme-emri/{odemeEmriNo}",slug:"get-odeme-emri-odemeemrino"},{level:2,title:"6.7\tHealthcheck API",slug:"_6-7healthcheck-api"},{level:3,title:"GET /health",slug:"get-health"}],content:" 6.\tdeme Emri Balatma Hizmeti \n deme emri balatma ilemi havale, FAST ya da PS demesiyle sonulanabilir. deme ileminin amac kiiden kiiye para transferi, e-ticaret demesi gibi farkl deme trleri olabilir. demenin amacna gre BHSnin iletecei veri setinde farkllamalar olabilir. \n deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n deme Emri Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden deme emrini balatr. \n deme Emri Rza Hazrlanmas:  BHS, deme Emri Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n deme Emrinin Balatlmas:  BHS, deme emrini HHSye iletir. \n deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay Sorgular:  BHS, deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n \n \n ekil 4: deme Emri Balatma Hizmeti st Dzey  Ak \n deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. \n Tablo 6: deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n odeme-emri-rizasi \n POST \n /odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n OdemeEmriRizasiIstegi \n OdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n OdemeEmriRizaYaniti \n \n \n 3 \n odeme-emri \n POST \n /odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal stek ve Yant \n OdemeEmriIstegi \n OdemeEmri \n \n \n 3.1 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n OdemeEmri \n 6.1.\tADIM 0 - deme Emri Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) deme emri balatma ilemine onay verir. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas \n   \n ekil 5: deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak deme emri rza kaynann oluturulmasn (odemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi mi? \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahip mi? \n stekte bulunulan HHS kodu doru mu? \n \n \n \n POST baarl olursa, HHS, deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren odemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir OdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme ve bildirim adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde eer kimlik bilgileri iletilmi ise; bu veri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Koullu Zorunlu) \n HHS kimlik bilgisi ile gnderen unvannn uyumlu olduunun kontrol eder. HHS'ler EFT/FAST ilemlerinde kabul ettikleri kontrol kriterleri ile ileme izin verebilirler. (Zorunlu) \n Gnderen Hesap Numaras ile ilgili Tablo7de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, deme iin benzersiz RizaNo ile OdemeEmriRizasi nesnesi oluturur ve BHSye dner. \n HHS, OdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \nBu aamada HKnn HHS tarafndan tanmlanm ve istein veri alannda gnderen hesaba (borlandrlacak hesaba) ilikin bir bilgisinin olmas gerekmez. \nHesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n \n POST /odeme-emri-rizasi  isteinin (REQUEST) gvdesinde (BODY)  odemeEmriRizasiIstegi nesnesi (Tablo-7) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda odemeEmriRizasi (Tablo-8) nesnesi oluturulur. \n Tek Seferlik deme \nTek seferlik deme ak YS'ten HHS'ye giden istekte, gnderen kimlik bilgilerinin olmad durumda gerekleir. Gnderen kimlik bilgisi olmadnda, KOLAS sorgusu yaplamayacandan tr, HHS tarafndan TR.OHVPS.Business.InvalidContent hatas dnlmelidir. \nTek seferlik deme ak hem iyeri demelerinde hem de kiiden kiiye para transferlerinde kullanlabilen bir aktr.\nAadaki senaryolar tek seferlik demeye rnek olarak gsterilebilir. \nyeri demesi ak rnei: Bir e-ticaret sitesinde, ye olmadan alveri yaplmas ve demenin YS tarafndan kimlik bilgisi olmadan balatlmas \nKiiden kiiye para transferi ak rnei: QR veya dier yntemler ile alc bilgilerinin gnderici ile paylalmas ve YS zerinden gnderici bilgileri olmadan alcya para transferi yaplmas iin rza verilmesi \n  BAARILI STEK: \n Tablo 7: OdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  YS Ynlendirmeli GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak ynlendirme adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. YSn iletecei adrestir.  YS Ayrk GKD yntemi ile ak destekliyorsa, yetYntm deikeninden bamsz olarak bildirim adresini iletmelidir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, ayrk GKD sonras bu alanda belirtilen adrese otorizasyon kodunu (authentication code) iletir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n HHS geerli bir para birimi olduu kontrol eder. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n  \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  TR.OHVPS.Business.InvalidContent  hatas verilmelidir. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir.  Kontrol baarsz olduunda  TR.OHVPS.Business. InvalidAccount  hatas YSe iletilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn unvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr.  FAST-TR Karekod dndaki i yeri demelerinde; yine Unvan alannda iyeri ad bilgisi gnderilmelidir. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n Tek seferlik demelerde ( kimlik bilgileri bo iletildiinde) KOLAS nesnesi dolu iletiliyorsa; HHS tarafndan TR.OHVPS.Business.InvalidContent hatas dnlmelidir \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n HHS, YS'n API deseninde \"O\" kodunu ilettiini kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarnda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.   -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tyeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n YS bu deeri HKy HHSye ynlendirmeden nceki ekranda gstermeli, ve HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak yine HKya gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir.  4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmriRizasi nesnesi Tablo-8deki parametrelerden oluur: \n Tablo 8: OdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n >> Unvan \n unv \n AN3..140 \n  \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisidir. Bu alan ileri vadeli demeler iin dnlmtr. lk fazda doldurulmasna gerek olmad dnlmektedir. \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil 6: deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn deme emrini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK -bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: odemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle,  OdemeEmriRizasi  nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr. HHS,  ADIM 2 -deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  OdemeEmriRizasi  nesnesine iler. \n GET /odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  OdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n Durum \n OdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /odeme-emri-rizasi/{RizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-8de yer alan parametreleri ieren OdemeEmriRizasi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta OdemeEmriRizasi nesnesi gncellenir ve BHS  GET /odeme-emri-rizasi/{RizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren OdemeEmriRizasi nesnesini ekmelidir. \n ereve szleme kapsamnda olmayan tek seferlik deme ilemlerinde, Kimlik Tr ve Kimlik Verisi bilgilerinin deme emri rzas srasnda gnderimi zorunlu deildir. Baarl GKD sonras, yani eriim belirteci alndnda, deme emri olumadan nce, YSn deme emri rzasn sorgulayarak bu bilgileri almas ve deme emrini olutururken Kimlik Tr ve Kimlik Verisi alanlarn dolu olarak gndermesi beklenmektedir.  Ancak rza durumu Yetki Bekleniyor - B, Yetkilendirildi - Y ve Yetki ptal - I statlerinde ise, deme emri rzas sorgulamasnda, HHSnin Kimlik Tr ve Kimlik Verisi bilgisini YS ile paylamamas gerekmektedir. \n 6.5.\tADIM 3- deme Emrinin Oluturulmas \n   \n ekil 8: deme Emrinin Oluturulmas \n POST /odeme-emri \n \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS OdemeEmri kaynan oluturur. \n deme emri (OdemeEmri) uygun deme kaynana POST istei yaplarak balatlr.\n \n POST HHS tarafndan ilenir: RizaDurumu Yetki Kullanld ise ileme balanr. \n POST /odeme-emri-rizasi ile POST /odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr.POST verisindeki Gnderen Hesap Numaras ve Alc Hesap Numarasnn ayn bankaya aitse HAVALE deilse FAST veya PS i akna geilir. \n POST verisinin modele gre kontrol yaplr (alan kontrolleri) \n POST verisinin mantksal kontrolleri yaplr (IBAN kontrol, apraz alan kontroller) \n OdemeEmriDurumu Gerekleti / Gnderildi / Gereklemedi olarak gncellenir. \n \n \n POST baarl olursa, ierisinde OdemeEmriNo ve OdemeEmriDurumu deikenleri de bulunan OdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine Dnt olarak gncellenir. \n \n BAARILI STEK: \n Tablo 9: OdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n deme Emri Rizas Nesnesindeki Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n deme Emri Rizas Nesnesindeki lem Tutar verisi ile ayn olmaldr. HHS ilem tutar deme mesajnda (Havale/FAST/PS) aynen tanmak durumundadr. \n Ttr \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda deme emrinde iletilen maskeli bilgi ile HHSnin kendi deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n KolasRef ( hem FAST hem de PS iin ayn) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. \n RefBlg (Hem FAST hem de PS iin ayn) \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n FAST/PS Acklm \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Sistemi verisi ile ayn olmaldr. \n \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n deme Emri Rizas Nesnesindeki BHS Masraf Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n deme Emri Rizas Nesnesindeki BHS Masraf Tutar verisi ile ayn olmaldr. \n \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n deme Emri Rizas Nesnesindeki HHS Masraf Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n deme Emri Rizas Nesnesindeki HHS Masraf Tutar verisi ile ayn olmaldr. \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n \n \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: OdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zamandr. \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. \n \n \n > Bildirim Adresi \n bldAdr \n AN1..1024 \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Emir Bilgileri \n emrBlg \n Kompleks: EmirBilgileri \n Z \n \n \n \n > deme Emri Numaras \n odmEmriNo \n AN1..128 \n Z \n odemeEmri nesnesinin UID'sidir. OdemeEmrine likin sorgular bu ID zerinden yaplr. \n \n \n > deme Emri Zaman \n odmEmriZmn \n ISODateTime \n Z \n odemeEmri nesnesinin oluturulma zamandr. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O  deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Durumu \n odmDrm \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr.      deme Durumu alan ile ilgili olarak HHSler tarafndan YSlere  OdemeEmri servisi yantnda 02:Gnderildi, 04:Onayda Bekliyor,05:leme Alnd yantlar gnderilebilir.   05:leme Alnd  durumu YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu  02:Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS deme emri sorgulamas yapmaldr.   02:Gnderildi  durumu olutuktan sonra YS tarafndan deme emri sorgulamas yaplarak deme durumunun gncel deeri renilir. Gncel deerler  01:Gerekleti,03:Gereklemedi  durumlar olabilir. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..50 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> deme Sistem Numaras \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n > BHS Masraf Tutar \n obhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > HHS Masraf Tutar \n hhsMsrfTtr \n Kompleks:Tutar \n  \n API lke ve Kurallar 1.0 srmnde bu nesnenin API deseninde gnderilmemesi gerekmektedir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi (TRY, USD, EUR vb.). \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n HHSnin ilemle ilgili HKnn borlandrlmasn belirttii masraf tutar. lem Tutar ile ayn para biriminde olmaldr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n  \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n  \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n  \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n  \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal) \n   \n ekil 9: deme Emri Sorgusu \n GET /odeme-emri/{odemeEmriNo} \n BHS, bu eriim adresi araclyla deme emrini sorgulayabilir. \n BAARILI YANIT: \n GET /odeme-emri/{odemeEmriNo} yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren OdemeEmri nesnesi dner. \n 6.7\tHealthcheck API \n GET /health \n HHSlerin sunaca bu servis, dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr \n Baarl yantta Http 200 kodu dnlmelidir. \n Baarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n"},{title:"HHS ve YS API",frontmatter:{},regularPath:"/v1.0.2/contents/hhs-yos-api.html",relativePath:"v1.0.2/contents/hhs-yos-api.md",key:"v-0ec6f57d",path:"/v1.0.2/contents/hhs-yos-api.html",headers:[{level:2,title:"HHS API",slug:"hhs-api"},{level:2,title:"YOS API",slug:"yos-api"},{level:2,title:"Healthcheck API",slug:"healthcheck-api"}],content:' HHS ve YS API \n HHS API, HHSlerin detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. HHS API iin hhs_read scope bilgisi kullanlr. \n Production ortamnda HHS / YOS API ierisinde sisteme dahil olmu, sertifikasyonu baar ile tamamlam paydalar listelenecektir. HHS tarafndan desteklenen API srmleri listelenecektir. \n YSler HHS APIsini sorgulayabilir ancak YS APIsini sorgulayamazlar. \nBenzer ekilde HHSler YS APIsini sorgulayabilir, HHS APIsini sorgulayamazlar. \n HHS API \n GET /hhs/{hhsKod} \n lem Sorgu rnei =  /hhs    bu sorgu yntemi ile tm HHSlerin dizi eklinde verileri listelenir. \nlem Sorgu rnei =  /hhs/2001    bu sorgu yntemi ile gnderilmi olan hhsKoduna ait bilgiler listelenir. Ya da 404 Not Found hatas alr. \nHHS ve YS API Tablo 20deki istek parametrelerine gre sorgulanabilir. \nlem Sorgu rnei (Belirli Bir Hesap) =  /hhs?srlmKrtr=kod&srlmYon=A \n Tablo 20: HHS ve YS API Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {kod, unv} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, sralama kriteri unv olarak belirlenmelidir. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 21: HHS Bilgileri Sorgulama Yant Hhs nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n hhs kodu \n kod \n AN4 \n Z \n HHS nin kod bilgisi \n \n \n hhs unvan \n unv \n AN3..140 \n Z \n HHS nin unvan bilgisi \n \n \n hhs markas \n marka \n AN1..140 \n Z \n HK\'nn kolaylkla alglayabilecei ksa unvan bilgisi. HHS tarafndan belirlenecektir. \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n HHSnin mesaj imzalama iin paylat ak anahtar \n \n \n HHS Api Bilgileri \n apiBilgileri \n Kompleks: HhsApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :obh, hbh,gkd \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s2.0 s1.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n HHSye ait logo bilgileri. Logotur = Original  formatndaki logonun minimumda gnderimi zorunludur. \n \n \n >logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur alabilecei deerler  ORIGINAL , WHITE_OVERLAY , BLACK_OVERLAY , GRAY_OVERLAY \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n HHS tarafnda tutulan ve YSlerle paylalacak olan url adres bilgisidir. \n \n \n Durum \n durum \n AN1 \n Z \n HHS\'nin durum bilgisidir.  TR.OHVPS.DataCode.HHSDurumu sral veri tipinde alabilecei deerler belirtilmitir. \n \n \n \n HHS API\'de; Ak, Yaygnlatrma, Geici Hizmet Veremiyor, Kapal durumlarndaki HHS\'ler listelenecektir.  \nSertifikasyon onay alan HHS\'ler, retim ortamna geite "Yaygnlatrma" durumuna sahip olabilir.  HHS\'nin, hangi YS\'ler ile "Yaygnlatrma" kontrollerini yapaca, HHS ynetiminde olacaktr. Bylece retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi ve servislerini test etmesi salanabilir olacaktr. HHS\'ler kendi kurum kontrollerini yapana kadar, "Yaygnlatrma" durumunda kalabilirler. HHS\'nin BKM\'ye yapaca talep ile, HHS "Yaygnlatrma" durumundan "Ak" durumuna geebilecektir. \nHHS\'de olas bir teknik sorun olmas durumunda, BKM - HHS koordinasyonu ile HHS durumu "Geici Hizmet Veremiyor" haline getirilecektir. Sorun giderildiinde "Ak" durumuna geri dnecektir. \n Hem YOS hem de HHS API iin geerli olacak; logo gnderiminde dikkat edilmesi gerekenler u ekilde tariflenmitir: \n \n Logolarn ham dosya yerine kurumun yaynlayaca bir URL zerinden sunulmas gerekmektedir. (rn: logoURL  =  https://kurumadi.com.tr/logo.png) Logo BKM tarafnda host edilmeyecektir.) \n PNG formatnda (PNG-24) olmaldr. \n 72 DPI znrlkte olmaldr. \n 500 x 500 boyutlarnda, yatayda veya dikeyde tama paysz tam oturacak, snr boyutlarn gemeyecek ve ortalanm yerleime sahip olmaldr. \n Logo arka plan renkli olmamal, arka plan transparan olmaldr. \n YS uygulamasnda gsterim esnasnda logolarn hzl yklenmesi ve dk veri tketmesi asndan; logo boyutu 250 KBn altnda olmaldr. \n Drt adet logo tr belirlenmitir. Bu 4 tr iin de logo dnlmesi zorunludur. \n Logo urlin public eriilebilir url olmas gereklidir. \n \n YS API, YS statsundeki kurumlarn detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. YS API iin yos_read scope bilgisi kullanlr. \n YS API yantnda, listelenen ynlendirme ve bildirim adresleri bulunmaktadr. HHS, ilem annda iletilen yonAdr ya da bldrAdr alanlarnda gnderilen adreslere yetKod deerini iletmelidir. YS API ierisinde yer alan adresleri, rza isteinde gnderilen adreslerin doruluunu kontrol etme amacyla kullanlmaldr. Bu nedenle YS API ierisinde listelenen adreslerin hostname seviyesinde yer almas yeterlidir. \n YOS API \n YS API ierisinde yer alan YS rol bilgileri ve aktiflik/pasiflik durumlar birbiriyle ilikili deildir. \n YS\'n sahip olduu bhs,hbhs rolleri iin herhangi bir fraud ya da teknik sebeplerden tr geici sreyle geri alnabilir. \n YS aktifliini korurken problem zlene kadar geici olarak alnan roller(bhs,hbhs) tekrardan aktif hale getirilir. \n GET /yos/{yosKod} \n lem Sorgu rnei =  /yos    bu sorgu yntemi ile tm yos lerin dizi eklinde verileri listelenir. \n lem Sorgu rnei =  /yos/2501    bu sorgu yntemi ile gnderilmi olan yosKoduna ait bilgiler listelenir ya da 404 Not Found hatas alr.\nYS API Tablo 20deki istek parametrelerine gre sorgulanabilir.\nlem Sorgu rnei (Belirli Bir Hesap)=  /yos?srlmKrtr=kod&srlmYon=A \n Tablo 22: YOS Bilgileri Sorgulama Yant Yos nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Ys kodu \n kod \n AN4 \n Z \n YS\'n kod bilgisi \n \n \n Ys unvan \n unv \n AN3..140 \n Z \n YS unvan bilgisi \n \n \n Ys markas \n marka \n AN1..140 \n Z \n HK\'nn kolaylkla alglayabilecei ksa unvan bilgisi. YS tarafndan belirlenecektir. \n \n \n YS rolleri \n roller \n Array[AN4] \n Z \n YSun rollerini belirten deer. rnek: [ "obhs", "hbhs" ]  - obhs - deme Bilgisi Hizmet Salayc Rol  - hbhs - Hesap Bilgisi Hizmet Salayc Rol \n \n \n Adresler \n adresler \n Kompleks:Adres[Array] [1..N] \n Z \n --- \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerlerinden birini alr. Adres detaylarnn hangi GKD trne ait olduunu belirtir. \n \n \n >Adres Detaylar \n adresDetaylari \n adresDetaylari\tKompleks: AdresDetayi[Array] [1..N] \n Z \n \n \n \n >>Temel Adres \n tmlAdr \n AN1..1024 \n Z \n yetYntm deeri Y olarak iletildiinde Ynlendirmeli GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. yetYntm deeri A olarak iletildiinde Ayrk GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. Riza isteklerinde bu deer ile uyumluluu kontrol edilmelidir. rnek: https://example.com https://example2.com/path deepLink://example/test deepLink://example2/test \n \n \n >>Aklama \n aciklama \n AN1..1024 \n  \n YSn gnderdii adrese ynelik vermek istedii aklama rnek: WEB bireysel , WEB kurumsal  , APP \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n YSn mesaj imzalama iin paylat ak anahtar \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n YOSe ait logo bilgileri. Logotur = Original formatndaki logonun minimumda gnderimi zorunludur. \n \n \n >logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur alabilecei deerler  ORIGINAL , WHITE_OVERLAY , BLACK_OVERLAY , GRAY_OVERLAY \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n YS tarafnda tutulan ve HHSlerle paylalacak olan url adres bilgisidir. rnek: https://via.placeholder.com/150?text=0001 \n Healthcheck API \n GET /health \n HHS ve YS API iin health servisleri aadaki servislerle kontrol edilebilir. \n Baarl yantta Http 200 kodu dnlecektir\nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir \n \n \n \n'},{frontmatter:{},regularPath:"/v1.0.2/contents/tanim-ve-kisitlamalar.html",relativePath:"v1.0.2/contents/tanim-ve-kisitlamalar.md",key:"v-3e221f7d",path:"/v1.0.2/contents/tanim-ve-kisitlamalar.html",content:"  1.\tTanm ve Ksaltmalar   \n Tablo 1: Tanm ve Ksaltmalar \n \n \n \n Ksaltma \n Tanm \n Aklama \n ngilizce Aklama \n ngilizce Ksaltma \n \n \n \n \n S \n ereve Szleme \n deme hizmeti salaycs ile mteri arasnda tekil veya sreklilik arz eden deme ilemlerinin yrtlmesine ve mmkn olan durumlarda deme hesabnn almasna ilikin usul ve esaslar belirleyen szleme \n \n \n \n \n EPK \n Elektronik Para Kuruluu \n Kanun kapsamnda elektronik para ihra etme yetkisi verilen tzel kii \n Electronic Money Institution \n EMI \n \n \n FAST \n Fonlarn Anlk ve Srekli Transferi \n TCMB tarafndan iletilen Fonlarn Anlk ve Srekli Transferi Sistemi \n \n \n \n \n FAST TR-Karekod \n FAST-TR Karekod Teknik lke ve Kurallar Rehberi \n TR Karekodun FAST Sistemi araclyla gerekleecek ilemlerde kullanlmasna ilikin detayl teknik ilke ve kurallarn ieren dokman \n \n \n \n \n GKD \n Gl Kimlik Dorulama \n Kimlik dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntem \n Strong Customer Authentication \n SCA \n \n \n B \n lem Bilgisi \n Gerekletirilen ileme ilikin ilem zamann, ilemin niteliini ve deme ilemi iin deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve demenin gndereni ile alcsn veya toplu deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve gndereni ile alclarn ieren bilgi \n \n \n \n \n DK \n lem Dorulama Kodu \n Kimlik dorulama yntemlerinden biriyle kendisini sisteme tantan bir mterinin gerekletirmek istedii ileme zg olmak ve belirli bir geerlilik sresi iinde ilem onaynda kullanlmak zere oluturulan, finansal sonu dorunan ilemlerde kiiye onay annda ilgili ilem bilgisi (B) ile birlikte gsterilen, alc veya tutarn deimesiyle geersiz hale gelen bilgi \n Authentication Code \n AC \n \n \n KOLAS \n Kolay Adresleme Servisi \n Fon transferlerinde hesap numaras ile ad soyad yerine kullanlan ve belirli bir hesap ile eletirilmi telefon numaras, e-posta adresi, T.C. Kimlik Numaras (TCKN), Vergi Kimlik Numaras (VKN), Yabanc Kimlik Numaras veya Pasaport Numaras gibi Kolay Adres bilgilerinin kaydedilmesini, gncellenmesini ve sorgulamasn salayan katman servis \n \n \n \n \n HBHS \n Hesap Bilgisi Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (g) bendinde tanmlanan deme hizmetini (hesap bilgisi hizmetini) sunan tzel kii \n Account Information Service Provider \n AISP \n \n \n HHS \n Hesap Hizmeti Salaycs \n Nezdinde deme hesab bulunan deme hizmeti salaycs \n Account Servicing Payment Service Provider \n ASPSP \n \n \n BHS \n deme Emri Balatma Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (f) bendinde tanmlanan deme hizmetini (deme emri balatma hizmetini) sunan tzel kii \n Payment Initiation Service Provider \n PISP \n \n \n DK \n deme Kuruluu \n deme hizmeti salamak ve gerekletirmek iin Kanun kapsamnda yetkilendirilmi tzel kii \n Payment Institution \n PI \n \n \n H \n deme Hesab \n deme hizmeti kullancs adna alan ve deme ileminin yrtlmesinde kullanlan hesap \n Payment Account \n PA \n \n \n HK \n deme Hizmeti Kullancs (Mteri) \n Gnderen, alc veya her ikisi sfatyla belirli bir deme hizmetinden faydalanan gerek veya tzel kii \n Payment Service User \n PSU \n \n \n HS \n deme Hizmeti Salaycs \n 5411 sayl Kanun kapsamndaki bankalar, EPK, DK ve Posta ve Telgraf Tekilat Anonim irketi(PTT) \n Payment Service Provider \n PSP \n \n \n HVPS \n deme Hizmetleri Veri Paylam Servisleri \n Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri \n \n \n \n \n PS \n Perakende deme Sistemi \n TCMB tarafndan iletilen, ilemlerin Trk Liras zerinden gerekletii Mteriler Aras Trk Liras Aktarm Sistemi \n \n \n \n \n TR-Karekod \n TR-Karekod lke ve Kurallar \n Ulusal karekod (TR Karekod) ilke ve kurallarnn belirlendii belge \n \n \n \n \n YS \n Yetkili deme Hizmeti Salaycs \n deme emri balatma hizmeti ve/veya hesap bilgisi hizmeti sunan tzel kii \n Third Party Payment Service Providers \n TPP \n \n \n \n"},{title:"4. Rza Durumlar",frontmatter:{},regularPath:"/v1.0.2/contents/riza-durumlari.html",relativePath:"v1.0.2/contents/riza-durumlari.md",key:"v-1be15362",path:"/v1.0.2/contents/riza-durumlari.html",headers:[{level:2,title:"4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri",slug:"_4-1-hesap-bilgisi-hizmeti-rza-durum-degisiklikleri"},{level:2,title:"4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri",slug:"_4-2-odeme-bilgisi-hizmeti-rza-durum-degisiklikleri"}],content:" 4. Rza Durumlar \n HK, deme Emri Balatma Hizmetine ya da Hesap Bilgisi Hizmetine mteri rzasnn tesisi ile balar. HKnn YS uygulamas zerinden yapt ilemler neticesinde rza durumlar deiebilir.\nRzann alabilecei durum kodlar u ekilde belirlenmitir. \n B: Yetki Bekleniyor   lk rza talebinde \n Y: Yetkilendirildi   Baarl GKD sonras yetKod retildiinde \n K: Yetki Kullanld   Eriim Belirteci alndnda \n E: Yetki deme emrine dnt   BHS iin \n S: Yetki Sonlandrld \nHBHS iin : Eriimin Geerli Olduu Son Tarih geldiinde \nBHS iin : Yenileme belirteci Son Tarihi geldiinde \n I :Yetki ptal \nRza iptal durumu ise gerek raporlama gerekse mteri deneyimi perspektifinden doru   bilgilendirmeler yaplabilmesi asndan aadaki gibi detay kodlar ile zenginletirilmitir: \n \n Rza ptal Detay Kodu: \n \n \n \n 01 :\tYeni Rza Talebi ile ptal \n 02 :\tKullanc stei ile HHS zerinden ptal \n 03 :\tKullanc stei ile YS zerinden ptal \n 04 :\tSre Am : Yetki Bekleniyor \n 05 :\tSre Am : Yetkilendirildi \n 06 :\tSre Am : Yetki demeye Dnmedi \n 07 :\tGKD iptali : Ayn rza no ile mkerrer arm \n 08 :\tGKD iptali : Rzano ile TCKN uyumamas \n 09 :\tGKD iptali : Uygun rn bulunmuyor \n 10 :\tGKD iptali : HHS Ak Bankaclk kanal ileme kapal \n 11 :\tGKD iptali : Hesap Yetki Sorunu \n 12 :\tGKD iptali : HK HHS kontrollerini aamad \n 13 :\tGKD iptali : HK istei ile GKDden vazgeildi \n 14 :\tGKD iptali : Fraud phesi \n 99 :\tGKD iptali : Dier \n \n \n 4.1 ve 4.2 blmlerinde detaylandrlan rza durum deiikliklerinde rza iptal detay kodlar kullanlmtr. \n rnein B I/01 denildiinde Yetki Bekleniyor rza durumundan Yetki ptal rza durumuna Rza ptal Detay Kodu da 01 yani Yeni Rza Talebi ile ptal olarak gncellenmelidir ifade edilmitir. \n HK verdii rza srasnda setii hesaplarndan biri kapatlrsa, dier hesaplara ait bilgileri grmeye devam eder. Ancak HKnn hesabna ait bilgilerinin YS'e iletilmesini istemedii durumda, rzasn tamamen iptal ederek yeni hesap listesi ile yeni rza vermesi gerekmektedir. Yani hesap kapanmas nedeniyle rza geerliliini yitirmez. HK'nn proaktif olarak bu hesab rzadan karmas durumunda rza iptali olur. \n Rza iptal edilmedii ve geerli olduu srece kapal hesaplar iin dier evrimii kanallarda uygulanan yntem izlenmelidir. Dier evrimii kanallarda kapal hesaplara ilikin bilgi dnlmyor ise HVPS'den de dn yaplmaz. HKnn rza onay verdii ak hesaplarnn tm HHS tarafnda kapatld durumda, yine ayn ekilde HHS evrimii kanallarnda koyduu kurallara gre bu hesaplarnn YS uygulamasnda gsterilmesine karar verir. \n Hesap kapama ve ticari kullanclarn hesaplar zerindeki yetki deiiklikleri HHS'nin i sistemleri tarafndan yaplan kontrollerle ynetilir. Buradaki deiiklikler ile HHS sistemsel olarak rza iptali gerekletiremez. HK izni ve onay dahilinde rza iptal gerekletirilmesi gerekmektedir. \n HHS'ler sunmu olduklar Rza ptal ekrann (sadece Hesap Bilgisi Rzas iin), hangi ortamlardan GKD yaplmasna izin veriliyorsa (web/mobil) ayn ortamdan HK'ya sunmaldr.  rnein bir HHS bireysel mterileri iin web ve mobil, kurumsal mteriler iin web zerinden GKD imkan sunuyor ise, minimumda bireysel mteriler iin web ve mobil ortamlarndan, kurumsal mteriler iin web ortamndan Rza ptal ekran aracl ile rza iptaline izin vermelidir. Bunun dnda ar merkezi ya da ube gibi ortamlardan sunaca Rza ptal imkan HHS inisiyatifindedir. Bahsi geen zorunluluk deme Emri Rza ptal ekran iin geerli deildir. \n Benzer ekilde YS'ler hangi ortamlardan (web/mobil) hizmet veriyorsa, ayn ortam zerinden Rza ptal ekrann sunmaldr. \n 4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri \n Kural : Bir HK'nn, bir YS iin, bir HHS'de Y, K, B rza durumlarnda tek bir rzas olabilir.\nBir HK hem kiisel olarak hem de bir kurumun kullancs olabilir. Bu durumda kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n Hesap Bilgisi Rzas istei HHSye iletilir. \na.\tHHS HK'ya ait ieride rza var m kontrol eder. Eer yoksa  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \nb.\tEer ieride rza varsa \n i. Rza durumu Yetki Bekleniyor - B ise; \n    HHS, sistemde Yetki Bekleniyor - B rza durumuna sahip kayt olduu iin, ncelikle eski kayd Yetki ptal - I durumuna getirir.  Rza ptal Detay Kodu Yeni Rza Talebi ile iptal olmaldr.  B  I / 01  Sonrasnda,  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \n  ii. Rza durumu Yetkilendirildi - Y veya Yetki Kullanld - K ise; \nHK'nn halihazrda verilmi bir rzas vardr. HHS, nce mevcut rzann iptalinin yaplmas gerektiine dair   TR.OHVPS.Resource.ConsentMismatch  hatasn dner. YS, HHS ya da YS uygulamas zerinden bu rzann iptal edilmesi gerektiine dair HK'ya bilgilendirme yapar. \n  iii.\tRza durumu Yetki Sonlandrld - S  ise Yetki Bekleniyor - B durumunda yeni rza no oluturur. \n  iv.\tRza durumu Yetki ptal - I ise  Yetki Bekleniyor - B  durumunda yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda Rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.  B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Taraycy kapatm olabilir) Rza Yetki Bekleniyor - B rza durumunda kalr.  5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B rza durumundaki kaytlar Yetki ptal  : Yetki Bekleniyor Sre Am olarak gncellenir.   B  I / 04  Bkz. 9. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine  rizaIptDtyKod  deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n HK, hesaplarnda/izin trlerinde/Eriimin Geerli Olduu Son Tarih bilgilerinden bir ya da birden fazlasnda gncelleme yapmak iin YS ekranna girer. \n \n \n a.\tYS nce Rza ptal API'sini arr. Sonra yeni deerlerle yeni bir rza isteinde bulunur. Tekrar GKD gerekir. \n b.\tYS rza iptal yapmadan yeni rza alma akna balarsa 1.b ak devreye girer. \n c.\tRza gncelleme ilerleyen srmlerde ele alnacaktr. \n \n \n Eriim Belirteci API \n a. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B ya da Yetki Kullanld - K  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n Sorgulama: HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir hesap bilgisi-rizasi kaynann durumunu, istee bal olarak alabilir. Rza numaras ile sorgulama yaplr. \n \n \n Hesap Bilgisi Rzasnn ptali: HBHS zerinden ya da HHS zerinden yaplan rza iptallerinde Rza durumu  Yetki ptal - I olarak gncellenir. Rza numaras ile iptal salanr. \n a. HHS zerinden rza iptali yapm olabilir.  Rza durumu sorgulanr. \n Rza numaras Yetki Bekleniyor - B ve Yetkilendirildi - Y ve Yetki Kullanld - K durumlarnda ise Yetki ptal durumuna getirilir. Rza gnclzmn timestamp ile gncellenir.\nHHS, Rza iptalinde ayn zamanda eriim belirtecini de invalid hale getirmelidir. \n B  I / 02 \n Y  I / 02 \n K  I / 02 \n b.\tYS zerinden yaplacak iptal ileminde yine Y ve B ve K rza durumlarnda ise iptal edilebilir. \n B  I / 03 \n Y  I / 03 \n K  I / 03 \n Rza durumu Yetki Sonlandrld - S  ise iptal gereklemez. Rza durumunuz iptal etmeye uygun deildir. hatas HK'ya yanstlr.  TR.OHVPS.Resource.ConsentRevoked \n \n \n HKnn verdii rza sresi dolmu olabilir.\nEriimin Geerli Olduu Son Tarih geldiinde Rza durumu Yetki Kullanlddan Yetki Sonlandrld durumuna ekilmelidir.   K  S \n \n \n Hesaplar, Bakiye ve lemler servislerinde eriim belirteci kontrol ve sonrasnda rza kontrol yaplmaldr.\nGeerli bir eriim belirteci yok ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda Hesaplar, Bakiye ve lemler servislerini armamas beklenir. HHS'nin bu rza durumlar ile yaplm arlar olduunda  TR.OHVPS.Resource.ConsentRevoked  hatasn dnmesi gereklidir. \n Rza durumu Yetki Kullanld - K dnda ise  TR.OHVPS.Resource.ConsentMismatch  hatas verilmelidir. \n Rza durumu Yetki Kullanld - K ise servis aklarna devam edilir. \n Rza sorgulama API'sinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound hatas  verilmelidir. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor durumunda kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor   Rza ptal  / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi durumunda kalan kaytlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am: Yetkilendirildi  B  I / 05 \nYukarda bahsedilen, YS Sre Am nedeniyle rza iptal durum gncellemelerini yapmadan nce HHSyi sorgulayarak rza durumunu renmeli ve sre am dnda bir kodu varsa ayn kodla kendi sistemini gncellemelidir. \nEriimin Geerli Olduu Son Tarih geldiinde rza durumu Yetki Kullanlddan Yetki Sonlandrldya gncellenir.  K  S \n 4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri \n Kural : Bir HK'nn bir YS iin bir HHS'de istedii kadar rzas olabilir. \n Kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n deme Emri Rzas istei HHSye iletilir. eride rza olup olmamasna baklmakszn  Yetki Bekleniyor - B  rza durumu ile yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.   B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Browser kapatm olabilir)\nRza durumu Yetki Bekleniyor'dur. 5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B durumundaki kaytlar Rza ptal : Yetki Bekleniyor Sre Am olarak gncellenir. Bkz. 8. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine rizaIptDtyKod deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n GKD muafiyeti olduunda YS HHSden arka planda onay alr. Bu onay srasnda rza durumu  Yetkilendirildi  yaplr.  B  Y \n \n \n Eriim Belirteci API \na. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B , Yetki Kullanld - K  ya da Yetki deme emrine dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K veya Yetki deme Emrine Dnt  E olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n deme Balatma API nce eriim belirteci ve sonrasnda rza kontol yaplarak gerekletirilmelidir \n \n ncelikle Eriim Belirteci kontrol yaplmaldr. Geerli bir Eriim Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n Rza durumu Yetki Bekleniyor - B , Yetkilendirildi - Y, Yetki deme Emrine Dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n Rza durumu Yetki Kullanld - K olduunda deme emri gerekletirilir.  Rza durumu Yetki Kullanld - K'dan Yetki deme Emrine Dnt  E yaplmaldr.   K E \n \n \n \n Sorgulama: GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlarda, deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle, demeEmriRizasi nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr.\nRza sorgulama, deme Emri Sorgulama API'lerinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n \n \n deme Emri Rzasnn ptali bulunmamaktadr. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor'da kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor  Rza ptal / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi'de kalan kaytlar durumlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am : Yetkilendirildi  B  I / 05 \n 5 dakikadan uzun sredir Yetki kullanld'da kalan kaytlar durumlar gncellenir.\nYetki kullanld  Rza ptal / Sre Am : Yetki demeye Dnmedi  B  I / 06 \n Yenileme belirteci Son Tarih geldiinde rza durumu Yetki deme emrine dntden Yetki Sonlandrld'ya gncellenir. \n E  S \n \n \n GKD muafiyeti sadece deme balatma servislerinde bulunmaktadr. \n \n \n"},{title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",frontmatter:{},regularPath:"/v1.1.0/contents/ekler.html",relativePath:"v1.1.0/contents/ekler.md",key:"v-cc5a0b86",path:"/v1.1.0/contents/ekler.html",headers:[{level:2,title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",slug:"ek-1-istek-cevap-mesajlarnda-kullanlacak-nesne-yaplar"},{level:2,title:"EK-2: Sral Veri Trleri",slug:"ek-2-sral-veri-turleri"},{level:2,title:"EK-3: stemci Sertifikalarnn Tanm ve Ynetimi",slug:"ek-3-istemci-sertifikalarnn-tanm-ve-yonetimi"},{level:2,title:"EK-4: Sunucu Sertifikalar",slug:"ek-4-sunucu-sertifikalar"},{level:2,title:"EK-5: Mesaj mzalama Ak",slug:"ek-5-mesaj-imzalama-aks"},{level:3,title:"mzalama Kurallar (YS)",slug:"imzalama-kurallar-yos"},{level:2,title:"EK-6: HHS/YS API Mimarisi",slug:"ek-6-hhs-yos-api-mimarisi"}],content:' EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar \n Ak Bankaclk simlatr uygulamas zerinde swagger dkmanlarnn gncel srmlerine eriim salanabilir. \n EK-2: Sral Veri Trleri \n \n \n \n Kod \n Aklama \n \n \n \n \n TR.OHVPS.DataCode.BrcAlc \n lemin hesab borlandrd ya da alacaklandrd bilgisidir. B : Bor A : Alacak \n \n \n TR.OHVPS.DataCode.EvetHayir \n E : Evet H : Hayr \n \n \n TR.OHVPS.DataCode.GkdTur \n GKD yaplmasn gerekli bulduu durumda HHS, YSn belirledii yntemi dikkate alarak kendi belirledii GKD yntemini bildirir: Y: Ynlendirmeli GKD A: Ayrk GKD \n \n \n TR.OHVPS.DataCode.HHSDurumu \n A : Ak. retim Ortamnda HHSnin aktif bir ekilde hizmet vermesi durumu.  Y : Yaygnlatrma. retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi durumu.    G : Geici Hizmet Veremiyor. HHS servislerinde teknik bir sorun olmas nedeniyle HHSnin hizmet verememesi durumu.  K: Kapal. HHSnin hizmet vermeme durumu. \n \n \n TR.OHVPS.DataCode.HHSYOSSrlmKrtr \n kod : Kod unv : Unvan \n \n \n TR.OHVPS.DataCode.HspDrm \n Hesabn durumunu belirtir: AKTIF PASIF KAPALI \n \n \n TR.OHVPS.DataCode.HspTip \n Hesap eidini belirtir: VADESIZ VADELI KREDILI_MEVDUAT_HESABI POS CEK YATIRIM \n \n \n TR.OHVPS.DataCode.HspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.IslemAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Dier \n \n \n TR.OHVPS.DataCode.IslemTuru \n Hesap hareketleri (ilemler) sorgusunda dnlen lem Tr (islTur) parametresi aadaki deerlerden birini alabilir: HAVALE EFT FAST PARA_YATIRMA PARA_CEKME YABANCI_PARA_HAVALE YATIRIM_HESABINA_AKTARIM YATIRIM_HESABINDAN_AKTARIM KURUM_FATURA_ODEMESI CEK SENET SIGORTA_ODEMESI UCRET_KOMISYON_FAIZ SGK_ODEMESI VERGI_ODEMESI DOVIZ_ALIM DOVIZ_SATIM KREDI_ODEMESI KREDI_KULLANIM KK_ODEMESI KK_NAKIT_AVANS SANS_OYUNU UYE_ISYERI_ISLEMLERI HGS_OGS_ISLEMLERI DOGRUDAN_BORCLANDIRMA_SISTEMI DIGER \n \n \n TR.OHVPS.DataCode.IzinTur \n 01: Temel Hesap Bilgisi 02: Ayrntl Hesap Bilgisi 03: Bakiye Bilgisi 04: Temel lem (Hesap Hareketleri) Bilgisi 05: Ayrntl lem Bilgisi 06: Anlk Bakiye Bildirimi \n \n \n TR.OHVPS.DataCode.KareKodAksTur \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  01: FAST katlmcsndan dinamik dorulamal hizmet alnan iyeri demesi 02: FAST katlmcsndan statik dorulamal iyeri demesi 03: Kiiden kiiye demeler \n \n \n TR.OHVPS.DataCode.KaynakTip \n HESAP_BILGISI_RIZASI  ODEME_EMRI_RIZASI   ODEME_EMRI    BAKIYE    COKLU_ISLEM_TALEBI    HHS    YOS \n \n \n TR.OHVPS.DataCode.KimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) Y , YKN , N11 P , PNO , AN7..9 \n \n \n TR.OHVPS.DataCode.KolasHspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.KolasTur \n Mterinin sorgulama istedii Kolay Adres Tipi deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr: T: Telefon Numaras E: E-Posta K: TCKN V: VKN Y: YKN P: Pasaport Numaras \n \n \n TR.OHVPS.DataCode.KurumKimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) V , VKN , AN10 \n \n \n TR.OHVPS.DataCode.LogoArkaPlan \n B :  Logolarn arka plannn beyaz olmas (Erkek Logo)   K : Logolarn arka plannn renkli/koyu olmas (Dii Logo) \n \n \n TR.OHVPS.DataCode.LogoFormat \n SVG :  Logonun svg formatnda olmasn ifade eder. Logonun 1:2 orannda olmas gerekmektedir.   PNG : Logonun png formatnda olmasn ifade eder. Logonun 500 X 1000 px olmas gerekmektedir. \n \n \n TR.OHVPS.DataCode.LogoTur \n FULL_LOGO   : Yaz ve ikon ekillerin bir arada olduu logo   ICON_LOGO : kon ekillerin olduu ( Sadece grsel olan-yazsz ) logo \n \n \n TR.OHVPS.DataCode.OdemeAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Gayrimenkul alm demesi 13: Motorlu tat alm demesi 14: Bor verme/Bor deme 15: Hediye/ba/yardm 16: Vergi/resim/har demesi 17: Tazminat/sigorta demesi 18: Avukatlk/Danmanlk/Mavirlik demesi 19: Salk demesi 20: Kripto/dijital varlk 21: ans oyunlar/bahis demesi 22: Elence/sosyal medya demesi \n \n \n TR.OHVPS.DataCode.OdemeDurumu \n demenin durumunu gsterir. Alabilecei deerler: 01: Gerekleti (deme ilgili deme sistemine iletildi ve alc hesabna ulat.)  02: Gnderildi (deme ilgili deme sistemine iletildi ancak alc hesabna ulatna dair teyit alnmad.)lemin son durumunun teyidi iin YS sorgulama yapmaldr. 03- Gereklemedi (demenin ilgili deme sistemine iletiminde veya ilenmesi srasnda hata, zaman am, sistemin gn sonu ilemlerine balamas vb. durum olutu ve deme gereeklemedi veya iade edildi.) 04- Onayda bekliyor (deme emri alnd. oklu onay aknn tamamlanmas bekleniyor.) 05- leme Alnd ( deme emri alnd. ) YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu 02-Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS sorgulama yapmaldr. \n \n \n TR.OHVPS.DataCode.OdemeKaynak \n I: nternet bankaclndan gnderilen demelerde kullanlr. A: Otomatik para makineleri (ATM) ile gnderilen demelerde kullanlr. T: Telefon bankacl ile gnderilen demelerde kullanlr. K: Kiosklar araclyla gnderilen demelerde kullanlr. S: ubeden girilen demelerde kullanlr. M: Mobil uygulamadan gnderilen demelerde kullanlr. D: Yukardakiler dndaki deme kaynaklarndan gnderilen demelerde kullanlr.  O: Ak bankaclk aracl ile gnderilen demelerde kullanlr. \n \n \n TR.OHVPS.DataCode.OdemeSistemi \n lemin ynlendirildii deme Sistemine gre aadaki deerlerden birini alabilir: H: Havale F: FAST E: EFT (PS) deerlerinden birini alabilir. \n \n \n TR.OHVPS.DataCode.OhkTur \n B: Bireysel  K: Kurumsal \n \n \n TR.OHVPS.DataCode.OhkTanimTip \n TCKN: TCKN  (ohkTanimDeger N11 olarak gnderilmelidir.)  MNO:      HHSye zel bireysel veya kurum mteri numaras (OHKTanimDeger AN1..30 olarak gnderilmelidir. )   YKN:    Yabanc Kimlik Numaras (OHKTanimDeger N11 olarak gnderilmelidir.)    PNO:    Pasaport numars (ohkTanimDeger AN7..9 olarak gnderilmelidir.)    GSM:     Cep telefonu numaras (ohkTanimDeger N10 olarak gnderilmelidir.)   IBAN:   IBAN numaras (OHKTanimDeger AN26 olarak gnderilmelidir.) \n \n \n TR.OHVPS.DataCode.OlayTip \n KAYNAK_GUNCELLENDI  AYRIK_GKD_BASARILI AYRIK_GKD_BASARISIZ HHS_YOS_GUNCELLENDI \n \n \n TR.OHVPS.DataCode.YOSDurumu \n A : Ak. retim Ortamnda YSn aktif bir ekilde hizmet vermesi durumu.   G : Geici Hizmet Veremiyor. YS servislerinde teknik bir sorun olmas nedeniyle YS\'n hizmet verememesi durumu.   K: Kapal. YS\'n hizmet vermeme durumu. \n \n \n TR.OHVPS.DataCode.PSUInitiated \n E : Evet  H : Hayr   O : Olay Bildirim \n \n \n TR.OHVPS.DataCode.RizaDurumu \n B: Yetki Bekleniyor Y: Yetkilendirildi K: Yetki Kullanld E: Yetki deme Emrine Dnt S: Yetki Sonlandrld I :Yetki Iptal \n \n \n TR.OHVPS.DataCode.RizaIptDtyKod \n 01 :Yeni Rza Talebi ile ptal 02 :Kullanc stei ile HHS zerinden ptal 03 :Kullanc stei ile YS zerinden ptal 04 :Sre Am : Yetki Bekleniyor 05 :Sre Am : Yetkilendirildi 06 :Sre Am : Yetki demeye Dnmedi 07 :GKD iptali : Ayn rza no ile mkerrer arm 08 :GKD iptali : Rzano ile TCKN uyumamas 09 :GKD iptali : Uygun rn bulunmuyor 10 :GKD iptali : HHS Ak Bankaclk kanal ileme kapal 11 :GKD iptali : Hesap Yetki Sorunu 12 :GKD iptali : HK HHS kontrollerini aamad 13 :GKD iptali : HK istei ile GKDden vazgeildi 14 :GKD iptali : Fraud phesi 99 :GKD iptali : Dier \n \n \n TR.OHVPS.DataCode.RizaTip \n H: Hesap Bilgisi Rzas O: deme Emri Rzas \n \n \n TR.OHVPS.DataCode.SrlmYon \n A: Azalan deerle sralama Y: Artan deerle sralama \n \n \n TR.OHVPS.DataCode.VarYok \n 0 : Kayt Yok   1 : Kayt Var \n \n \n TR.OHVPS.DataCode.YetTip \n Alabilecei deerlere gre hangi belirtecin dneceine karar verilir. yet_kod yenileme_belirteci \n \n \n TR.OHVPS.DataCode.ZmnAralik \n 0 : Kayt Yok  1 : 0-2 saat 2 : 2 saat 1 dakika-24 saat  3 : 1-3 gn   4 : 4-15 gn\t  5 : 16 gn ve st \n EK-3: stemci Sertifikalarnn Tanm ve Ynetimi \n Tm katlmclarn GET\'e eriebilmesi iin, BKM tarafndan yaplan istemci sertifika dorulamasndan gemesi gerekmektedir. stemci sertifikas retilmeden nce katlmclarn CSR retme akn tamamlamas gerekmektedir. \n OpenSSL ile CSR (Certificate Signing Request) Oluturma \nAadaki komut ile 2048-bit RSA private key ve CSR oluturulur. \nopenssl req -new -newkey rsa:2048 -nodes -keyout PRIVATEKEY.key -out CSR.csr \n CSR ile ilgili detay bilgilerin giriinde; \nCommon Name (CN) olarak 4 karakterli hhsKod ya da yosKod deeri ile, \ndier alanlar iin de kurum bilgileriniz ile giri yaplr. \n Tm bilgilerin girilmesinden sonra oluan private key dosyas kurumunuzda saklanr.\nCSR dosyas ise istemci sertifika retmek zere kullanlr. Bu aamada takip edilmesi gereken admlar u ekildedir: \n Katlmclarn, TRIP ortam zerinden, BKM Tarafndan yetki verilmi kullanclarnn grebilecei "stemci Sertifika Talebi" men admna giri yapmalar beklenir. Alan ekranda,"CSR Dosyas Ykleme" alan ierisine, katlmcnn retmi olduu csr dosyas yklenir. Yaklak 1 dakika ierisinde kuruma zel olarak retilmi olan client sertifikas indirilmeye hazr hale gelecektir. "ndir" butonu ile client sertifika indirilir. stemci tarafnda web isteinin ilgili sertifika ile ilikilendirilerek oluturulmas gerekmektedir. \n Uzun dnemli olarak hazrlanacak olan sertifikalar sertifikasyon ve retim ortamlarnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii bu aamalarda snanacaktr. \n GET\'in test ve retim ortamlar ayrmnda istemci sertifikalar, HHS Listeleme API eriimleri ve Sertifikasyon balantlar ekil 15-HHS/YS API Mimarisi Diagramnda resmedilmitir. \n EK-4: Sunucu Sertifikalar \n Sunucu sertifikalarnn endpoint bilgisini (Fqdn) ierecek ve global bir Certification Authority tarafndan imzalanm olarak sunulmas gerekmektedir.\nrnein; entegrasyon formu ierinde yer alan URL bilgisinin (test.xbank.com.tr) sertifika ierisinde tanml olmas ve bu sertifikann global bir CA rnein Verisign tarafndan imzalanm olarak sunulmas gerekmektedir. \n Hizmet salayc olan HHS\'ler tarafndan sunucu sertifikalar uygulanmaldr. \n EK-5: Mesaj mzalama Ak \n Dijital imzalama yaps, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini salamak amacyla kurgulanmtr.\nBu kapsamda imzalama ak aadaki gibi olmaldr: \n \n HHS ya da YS ncelikle zel ve ak anahtarlarn oluturmaldr. Bu anahtarlar oluturmak iin aada openssl kullanlarak oluturma rnei paylalmtr.  Bu anahtarlardan zel olan anahtar mesaj imzalamak iin kullanlacak olup, ak anahtar ise mesaj dorulamak amacyla mesajn alcs tarafndan kullanlacaktr. \n \n private_key.pem ve public_key.pem dosyasinin ierikleri kod tarafnda kullanlacaktr. \n --private.pem => zel anahtarn ismi\nopenssl genrsa -out private.pem 2048 \n --public_key.pem => Ak anahtarn ismi\nopenssl rsa -in private.pem -pubout -outform PEM -out public_key.pem \n --private_key.pem => zel anahtarn PCKS8 formatna evrilmesi (Java asndan PCKS8 formatnda olma ihtiyac nedeniyle) openssl pkcs8 -topk8 -inform PEM -in private.pem -out private_key.pem -nocrypt \n \n \n Ak ve zel anahtarlar oluturulduktan sonra Ak Anahtar BKM ile paylalr. BKM bu ak anahtar dier katlmclarn ulaabilmesi ve alabilmesi iin bir Anahtar Deposu yaklam ile bnyesinde tutar. lgili anahtar iletebilmek ve alabilmek iin kullanlacak HHS/YOS API ye eriim detaylar EK-6 blmnde detayl olarak paylalmtr.  Eer kurumun ilgili anahtar iftinin yenilenme durumu sz konusu ise yenilemenin hemen ardndan ak anahtar yeni bir imzalama yaplmadan nce mutlaka BKM ile paylalmaldr. \n \n \n mzal mesaj aacak olan kurum mesaj imzalayan kurumun ak anahtarn her sorguda yeniden almak durumunda deildir. Belirli periyodlarda kendi ortamndaki anahtar yenileyerek sistemi iletebilir. Ancak imzalayan kurum anahtar ifti yenilemesi yaptnda BKM ile ak anahtarn paylasa dahi imzal mesaj dorulayacak taraf eski ak anahtar ile dorulama yapmaya alt iin hata alacaktr. Bu ilk hata durumunda hzlca BKM zerinden yeni anahtar alp mesaj tekrar dorulamay denemelidir. Eer yine hata alyor ise dorulama ilemini hata statsne almaldr. Bu sebeple anahtar yenileyen kurum yeni ak anahtarn yeni bir mesaj imzalama yapmadan nce mutlaka BKM ile paylamaldr. \n \n \n PSU-Fraud-Check alan iin de JWT formatnda kt hazrlanmas beklenmektedir. rnek bir PSU-Fraud-Check payload deeri aadaki gibidir; \n {"AnomalyFlag": "0", \n"LastPasswordChangeFlag": "1", \n"FirstLoginFlag": "1", \n"DeviceFirstLoginFlag": "1", \n"BlacklistFlag": "0", \n"MalwareFlag": "0", \n"UnsafeAccountFlag": "0", \n"exp": 1663424479, \n"iat": 1663338079, \n"iss": "[https://apigw.bkm.com.tr|https://apigw.bkm.com.tr/]" } \n mzalama Kurallar (YS) \n Bir YS zerinden balayan ak rnek olarak paylalmtr. \n \n \n YS, mesaj imzalama gerektiren her API isteinin HTTP gvdesini (request body) kendi zel anahtar ile ifreleyerek imza bilgisini oluturur. \n \n \n Ardndan bu imza verisini, gnderecei mesajn istek balnda yer alan X-JWS-Signature alannda gndermelidir. \n \n \n X-JWS-Signature alannda gnderilecek olan bilgi aadaki yntem ile oluturulmaldr. \n \n \n Bu alana yazlacak olan bilgi JWT formatnda oluturulmaldr. \n \n \n Bir JWT, header-payload-signature alanlarndan olumaktadr. \n \n Header alannda JWTyi imzalamak iin kullanlacak algoritma belirtilmelidir.  Standartlar kapsamnda RS256 kullanlacaktr. \n Payload ksmnda zel olarak oluturulacak olan body claim alanna istek gvdesi (request body) verisinin SHA256 hash deeri karl yazlmaldr. \n JSON payload oluturulurken RFC 7519 baz alnmaldr. "iss" (Issuer) Claim, "exp" (Expiration Time) Claim, "iat" (Issued At) Claim, body Claim alanlarnn gnderilmesi zorunludur. ^RFC7519 \na.\t"iss" (Issuer) Claim : Kurumunuza zel bilgidir. \nb.\t"exp" (Expiration Time) Claim: Saniye cinsinden (Unix time) imzann son geerli olduu tarih. Bu tarih  mevcut sunucu saatinizden 60 dakika sonra olacak ekilde kullanlmaldr. \nc.\t"iat" (Issued At) Claim : Saniye cinsinden (Unix time) imzann oluturulduu tarih. Bu tarih  mevcut sunucu saatinizden 5 dakika nce olacak ekilde kullanlmaldr. \nd.\tbody Claim : istek gvdesi (request body) verisinin SHA256 hash deeri karl. \n Signature alannda da zel anahtar ile imzalanm olan imza ierii yer alacaktr. \n \n X-JWS-Signature:   JWS imzasn ieren stbilgi. Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n rnek X-JWS-Signature Payload Deeri \n { \n"iss": "https://apigw.bkm.com.tr", \n"exp": 1646832405, \n"iat": 1646746005, \n"body": "c543072f97a761a1d891dc81acc380bc1e6f61ca6541bd93ebfdece338457922" \n} \n \n \n \n \n YS, istei gnderir. Sadece mesajn btnln ve doruluunu teyit amac ile istek gvdesi (request body) SHA256 hash deeri imzalanarak X-JWS-Signature alannda bu imza iletilir. stein gvde (request body) ksm ak ve ifresiz olarak gnderilmektedir. \n \n \n HHS, istei alr, talebi gerekletirmeden nce ald API isteklerinin imzasn dorulamaldr. X-JWS-Signature alanndaki JWT aadaki admlarla dorulanmaldr. \n \n Header ksmndaki algoritmanin RS256 olduu kontrol edilir. \n Gnderen kurumun ak anahtar ile JWT verify (dorulama) ilemi yaplr. \n Yukardaki ilemlerin doruluunun ardndan JWTnin payload ksmndaki body claim alanndaki bilginin, istein gvde verisinin SHA256 hash deerlerinin ayn olduu kontrol edilir. \n rnek checksum deeri   "a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571" veya   "A64B19F95EEB1FB0A0A3E2DBBC6E3D8472C52184D4543417DDC6D156FC5C5571" eklinde olabilir. ki hali de ayn deere sahiptir. Kontrollerde buna dikkat edilmesi gerekmektedir. \n \n \n \n Yukardaki ilemler ile doruluu teyit edilmi olan istein talebi gerekletirir. \n \n \n Eer istek dorulanamyor ise gnderen kurumun ak ve zel anahtar ifti yenilenmi olabilir. \n \n \n BKM HHS API  zerinden ilgili kurumun bilgilerini (kurum kodu vs) kullanarak kurumun detay bilgileri eker ve kendi ortamnda yeniler. \n \n \n Ardndan imzay tekrar ak anahtar ile dorulayarak kontroller gerekletirilir. (Eer halen dorulama ilemi baarsz ise bu istek iin hata ak altrlr.  TR.OHVPS.Resource.InvalidSignature  kodu ile hata retilebilir.) \n \n \n mza bilgisinin beklendii (x-jws-signature) servislerde, bu bilginin iletilmedii durumlarda  TR.OHVPS.Resource.MissingSignature  hatas retilebilir. \n \n \n HHS istei iledikten sonra cevab olutururken de yukardaki aklar ile gnderecei cevab imzalamaldr. \n \n \n stek yant gvdesinin SHA256 checksum deeri iin hexadecimal kt kullanlacaktr. Oluacak ktnn 64 karakter olmas beklenmektedir. Kontrol iin "^[A-Fa-f0-9]{64}$" RegEx tarifini kullanabilirsiniz. \n \n \n rnek bir gvde: \n {"katilimciBlg":{"hhsKod":"8000","yosKod":"8000"},"gkd":{"yetYntm":"Y","yonAdr":"https://boss-test.bkm.com.tr/boss/ab/yosSimulator/8000?drmKod=6021de9f-55e7-454a-94be-2044866b22e1"},"kmlk":{"kmlkTur":"M","kmlkVrs":"123456","ohkTur":"B"},"hspBlg":{"iznBlg":{"iznTur":["01","02","03","04","05"],"erisimIzniSonTrh":"2022-10-12T23:59:59+03:00","hesapIslemBslZmn":"2021-10-10T00:00:00+03:00","hesapIslemBtsZmn":"2023-10-10T23:59:59+03:00"}}}\n \n Bu gvdenin checksum\': \n a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571\n \n Bu checksum\'n iletildii x-jws-signature balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FwaWd3LmJrbS5jb20udHIiLCJleHAiOjE2NjU0NzU1NjIsImlhdCI6MTY2NTM4OTE2MiwiYm9keSI6ImE2NGIxOWY5NWVlYjFmYjBhMGEzZTJkYmJjNmUzZDg0NzJjNTIxODRkNDU0MzQxN2RkYzZkMTU2ZmM1YzU1NzEifQ.Q65PI_1fTEzzBMirvmJvXgVX3orhhZ4_UqujtGdHkU7me-1ymIjvPrzy3kfyER1pedFb7HDCBuPvYoqjX8eUnpiiZsxfzCiEa0McIhoFeUOggq-O8VihItp8bLr2DWwQ9JHN1-WXB2mL31KAKFAL1VY9-DXuAdT-RfE_SLYsl2ycmNy4ti4XvfDvvlE56ZsieFZ727VuwR8wi7F0kKDc6UhjaMF9xcUeAM1fxX-bmcOaOo1NZGC0vvgjNZKz_OJrN-q8VhWYnQPiJ7wY7S9IG8bHIkBImKSVf8LuOEvl8u0BZzADLH1iOBd9x2l1plyI_NLPTrnOqhWhKlljkkJBCg\n \n Eer PSU-Fraud-Check iin balk gnderilecekse, yine JWT formatnda imza retilmelidir. rnek bir psu-fraud-check balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJBbm9tYWx5RmxhZyI6IjAiLCJMYXN0UGFzc3dvcmRDaGFuZ2VGbGFnIjoiMSIsIkZpcnN0TG9naW5GbGFnIjoiMSIsIkRldmljZUZpcnN0TG9naW5GbGFnIjoiMSIsIkJsYWNrbGlzdEZsYWciOiIwIiwiTWFsd2FyZUZsYWciOiIwIiwiVW5zYWZlQWNjb3VudEZsYWciOiIwIiwiZXhwIjoxNjY1NDc1NTU2LCJpYXQiOjE2NjUzODkxNTYsImlzcyI6Imh0dHBzOi8vYXBpZ3cuYmttLmNvbS50ciJ9.DhUh_nsXDuNIrvsQ3KOhOXdVcJg6fTDVW8K1oea8kLtmb7n-_hJHY3mWX5zzobu-Vh2VvFzIxPhHtol6gLHFktmIMiQ9TDHb_mRZFXgJB4ToNfqc3Fy9mi5bS8By2IYi1HxDaCStstaZDaunzXfHCtqybfZXyk6teDrf-iIf6lqX9Keo7GZO-Y7mP7C13-c_QwyNKrZK4TZwUQbecRqXYn1DcEHM7kukQHTar_hKBWkXPmNpScY0J2rKksr4ejR1uLhdQm-Pdwoe9y6qrNEB79vMLBkRNtbuV0vc1GYHp_YKkzBKBI_58uuB2GD9877CsrcRnHMQb88xpxiPKh6-ew\n EK-6: HHS/YS API Mimarisi \n HHS/YS API Uygulama Mimarisinde Test ve retim ortamlarnda aadaki alanda yer almaktadr. \n \n ekil 15: HHS/YS API Mimarisi \n'},{title:"3. Temel Prensipler",frontmatter:{},regularPath:"/v1.0.2/contents/temel-prensipler.html",relativePath:"v1.0.2/contents/temel-prensipler.md",key:"v-03088e53",path:"/v1.0.2/contents/temel-prensipler.html",headers:[{level:2,title:"3.1 Genel",slug:"_3-1-genel"},{level:2,title:"3.2.\tstem (ar) ve Oturum",slug:"_3-2-istem-cagr-ve-oturum"},{level:2,title:"3.3.\tRESTful API",slug:"_3-3-restful-api"},{level:2,title:"3.4.\tSrm Ynetimi",slug:"_3-4-surum-yonetimi"},{level:2,title:"3.5.\tKaynak URI Yol Yaps",slug:"_3-5-kaynak-uri-yol-yaps"},{level:2,title:"3.6.\tKarakter Kodlama",slug:"_3-6-karakter-kodlama"},{level:2,title:"3.7.\tVeri Format",slug:"_3-7-veri-format"},{level:2,title:"3.8.\tstemci Sertifika Ynetimi",slug:"_3-8-istemci-sertifika-yonetimi"},{level:2,title:"3.9.\tYetkilendirme Trleri",slug:"_3-9-yetkilendirme-turleri"},{level:2,title:"3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar",slug:"_3-10-istek-cevap-mesajlarnda-kullanlan-nesne-yaplar"},{level:2,title:"3.11. Sayfalandrma ve Filtreleme",slug:"_3-11-sayfalandrma-ve-filtreleme"},{level:2,title:"3.12. Mesaj mzalama",slug:"_3-12-mesaj-imzalama"},{level:2,title:"3.13. Durum Kodu",slug:"_3-13-durum-kodu"},{level:2,title:"3.14. Gereksinimlerinin Snflandrlmas",slug:"_3-14-gereksinimlerinin-snflandrlmas"},{level:2,title:"3.15. stek Bal",slug:"_3-15-istek-baslg"},{level:2,title:"3.16. Yant Bal",slug:"_3-16-yant-baslg"},{level:2,title:"3.17. Idempotency Kurallar",slug:"_3-17-idempotency-kurallar"},{level:2,title:"3.18. HTTP Durum Kodlar",slug:"_3-18-http-durum-kodlar"},{level:2,title:"3.19. Maskeleme Kurallar",slug:"_3-19-maskeleme-kurallar"},{level:2,title:"3.20. Fonksiyonel Olmayan Gereksinimler",slug:"_3-20-fonksiyonel-olmayan-gereksinimler"},{level:2,title:"3.21. Otomatik Sorgular",slug:"_3-21-otomatik-sorgular"}],content:' 3. Temel Prensipler  \n Bu blmde deme Hizmetleri Veri Paylam Servisleri (Hesap Bilgisi Hizmeti, deme Emri Balatma Hizmeti) iin tanmlanan temel prensipler aklanmaktadr. \n 3.1 Genel \n \n \n HHSler Ynetmeliin 59. maddesinin beinci fkras ve deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebliin (Tebli) 23. maddesinin birinci fkras uyarnca, deme hizmetleri veri paylam servislerini BKM API Geidi araclyla HBHS ve BHSye sunmakla ykmldr. \n \n \n Tebliin 23. maddesinin ikinci fkras uyarnca deme emri balatma hizmetinde ak iletiim servisinin taraflar BHS ile HHSdir. \n \n \n Tebliin 23. maddesinin nc fkras uyarnca hesap bilgisi hizmetinde ak iletiim servisinin taraflar HBHS ile HHSdir. \n \n \n Ynetmeliin 60. maddesinin birinci fkras uyarnca mteri, deme emri balatma hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Ynetmeliin 61. maddesinin birinci fkras uyarnca mteri, hesap bilgisi hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Tebliin 25. maddesi uyarnca HHS ve YS (BHS ve HBHS) arasnda balant utan uca gvenli bir ekilde salanr. Bu amala iletim katmannda TLS (asgari 1.2 srm) ile ifreli iletiim salanr. \n \n \n Tebliin 23. maddesinin drdnc fkras uyarnca HHS tarafndan sunulan deme hizmetleri veri paylam servislerini kullanan yetkilendirilmi deme hizmeti salayclarnn TCMB tarafndan ilgili deme hizmeti iin yetkilendirilmi olduu kontrol edilir. \n \n \n Tebliin 25. maddesinin beinci fkras uyarnca zaman damgas, 15/1/2004 tarihli 5070 sayl Elektronik mza Kanunu kapsamnda tanmlanan zaman damgasna dayanr. \n \n \n API alan isimleri Trke olarak tanmlanmtr. Ancak API bal (header) alanndaki alan isimleri zelinde, API Geitleri tarafndan otomatik olarak tannabilmesi gzetilerek, ngilizce isimlendirme tercih edilmitir. \n \n \n HK halihazrda deme hesaplarna, evrim ii (mobil bankaclk, internet bankacl vb.) eriebilir durumda ise, HHS\'nin varsa Ak Bankaclk kanal veya yetki tanmn varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. HHSnin, Bireysel/Kurumsal/Ticari mteri ayrm yapmakszn tm mterileri iin, evrim ii kanallarda hesap hareketlerine eriim ve deme yapabilme yetkisi bulunmas durumunda, yine ayn ekilde Ak Bankaclk kanal veya yetki tanmn da varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. \n 3.2.\tstem (ar) ve Oturum \n \n \n Her istek tekil istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Birden fazla istek ieren ilem YS tarafndan belirlenen arya zg talep kimlii (istek numaras: X-Request-ID) ve rza srecine zg talep kimlii (ilem grup numaras: X-Group-ID) deerleri kullanlmaldr. Ayn rza noya ait tm isteklerde ayn X-Group-ID bilgisi deeri gnderilmelidir. \n \n \n Oturum takibi ise PSU-Session-ID ile yaplr. Oturum numaras (PSU-Session-ID) HKl ilemler iin zaman damgas (PSU-Timestamp) ile birlikte ilgili tm ilem verilerini ierecek ekilde kayt altna alnr. \n \n \n rnein, bir deme emri balatma ilemi birden fazla istekten oluur. Her istek yukarda belirtildii gibi biricik istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Ancak ilemin oturum btnl PSU-Session-ID ile salanr. \n \n \n Taraflar atklar oturumu ilem btnln salayacak sre ierisinde ak tutar ve ilem biter bitmez kapatr. \n 3.3.\tRESTful API \n APIler, dnya leinde yaygn bir ekilde kullanlan Temsili Durum Transferi (Representational State Transfer, REST) mimari tarz ve JavaScript Nesne Notasyonu (JavaScript Object Notation, JSON) veri formatlarna uygun olarak gelitirilir. En st seviye Veri Tanmlama Dili (Data Description Language) ve en iyi uygulama rnekleri iin  ^JSON emas  temel alnr. \n stek ve yant mesajlarnda, istee bal veya koullu bir alan, deer iermiyorsa, bu alan JSON payloadunda yer almamaldr. \n rnek kod blou. \n "rzBlg":{\n         "rizaNo":"aa9bd7e7-0ccd-4edc-9639-5a358dbf2335",\n         "olusZmn":"2022-11-28T12:00:21+03:00",\n         "gnclZmn":null,    --\x3e hatal\n         "rizaDrm":"K",\n         "rizaIptDtyKod":"" --\x3e hatal \n      },\n \n rnek kod blou: \n \n         "alc":{\n            "hspNo": "TR800800004162387689546019",\n            "unv": "AHMET YILMAZ", \n            "kolas":{}  --\x3e nesne gnderimi hatal\n         },\n 3.4.\tSrm Ynetimi \n API sonraki aamalarda doabilecek gereksinimleri ve daha karmak kullanm durumlarn karlamak iin srmler halinde gelitirilir ve bu durum tasarm srasnda gz nnde bulundurulur. \n API v1.0 srmnde ; \n \n Kapsamdaki deme hesaplar : Vadesiz TL, yabanc para hesaplar (gerek ve tzel kiilere ait deme hesaplar), Kredili Mevduat Hesab \n Tekil deme (Virman/Havale/FAST/Mterileraras TL Aktarm Sistemi)\n \n Virman ve havale ilemleri kapsamnda yabanc para transferi yaplabilir. \n \n \n Hesap bilgisi hizmetleri\n \n Temel veya ayrntl hesap bilgisi \n Bakiye \n Gerekleen ilemler iin Hesap hareketleri \n \n \n Karekodlu demelerdeki 01, 02 ve 03 ak trleri\nyer almaktadr. \n \n Her srm deiikliinde bir nceki srm belirli bir sre desteklenecektir. Dier bir ifadeyle, sadece belirli bir sre iin mevcut ve bir nceki srm ayn anda eriilebilir olacaktr. \n 3.5.\tKaynak URI Yol Yaps \n YSlerin balatt arlarda URI yolu aadaki yapy takip eder: \n [hhs-yol-n-eki]/ohvps/ [kaynak-grubu]/ [srm]/ [kaynak]/[kaynak-no]/[alt-kaynak] \n Bu, aadaki unsurlardan oluur: \n \n [hhs-yol-n-eki] \nstee bal, HHS\'ye zg yol n ekini ifade eder. \nBKM API geidi zerinden yaplan arlarda BKM tarafndan belirlenen sistem ad ve yol n eki kullanlr. \n ohvps \nSabit metin ohvps (deme Hizmetleri Veri Paylam Servisleri ksaltmas) \n [kaynak-grubu] \nKaynak grubu, APIye erimek iin kullanlan deme hizmetine (HBH, BH) gre eriim adresi (end point) grubunu tanmlar (hbh veya obh). \n [srm] \nAPI srmn ifade eder (/s[ana-srm].[alt-srm]/). \n [kaynak]/[kaynak-no] \nKaynak detaylarn ifade eder. \n [alt-kaynak] \nAlt kaynak detaylarn ifade eder. \n \n HHS, tm kaynaklar iin ayn katlmc yolu n ekini ve sistem adn kullanmaldr. \n BKM APIlerine erimek isteyen uygulamalarn yetkilerine gre aadaki APIlere abone olmalar gerekmektedir: \n OBH: \n https://secure.api-preprod.bkm.com.tr/ohvps/obh/s1.0/odeme-emri-rizasi \n https://secure.api-preprod.bkm.com.tr/ohvps/obh/s1.0/odeme-emri \nHBH: \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesaplar \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesaplar/1234/islemler \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesaplar/1234/bakiye \nGKD \n https://secure.api-preprod.bkm.com.tr/ohvps/gkd/s1.0/erisim-belirteci \nHHS  YS API \n https://secure.api-preprod.bkm.com.tr/hhs-api/s1.0/hhs \n https://secure.api-preprod.bkm.com.tr/hhs-api/s1.0/hhs/1234 \n https://secure.api-preprod.bkm.com.tr/yos-api/s1.0/yos \n https://secure.api-preprod.bkm.com.tr/yos-api/s1.0/yos/1234 \n HHSlerin salayacaklar APIlerdeki URI evrimi rnekleri aadaki gibidir. \n \n https://xbank.com.tr/api-portal/ohvps/obh/s1.0/odeme-emri \n https://secure.api-preprod.bkm.com.tr/ohvps/obh/s1.0/odeme-emri  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesap-bilgisi-rizasi  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar   (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar/1234 \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.1/hesaplar/1234  (BKM API) \n \n BKM API Geidi zerinden yaplan arlarda, istek balnda bulunan x-aspsp-code (istein iletildii Hesap Hizmeti Salaycsnn kodu) deerine gre HHS APIde standart olarak tanmlanm olan basePath bilgisine servis uzants eklenerek HHSye ynlendirme yaplr. \n rnein, istek balnda  xbank n kodu varsa, YS tarafndan yaplan \n https://secure.api-preprod.bkm.com.tr/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \nars BKM API Geidi tarafndan karlanarak \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.0/hesap-bilgisi-rizasi \nadresine ynlendirilir. \n Bu rnekte,  https://xbank.com.tr/api-portal  basePath bilgisi HHS tarafndan HHS APIye girilen deerdir. \n 3.6.\tKarakter Kodlama \n API istekleri ve yantlarnda UTF-8 karakter kodlamas kullanlr. Bu, JSON iin varsaylan karakter kodlamasdr. \n Ancak, bir HHS\'nin kendi uygulamalar ve deme balatt deme sistemi (FAST vb.)  baz UTF-8 karakterlerini kabul etmeyebilir. HHS, UTF-8 kodlamas ieren bir mesaj ileyemez ve reddederse, HTTP 400 (Hatal stek) durum kodu ile yant vermelidir. \n 3.7.\tVeri Format \n \n Ak bankaclk kapsamndaki zaman damgas, ISO 8601 standartna uygun olarak yerel saat bilgisini ve timezone bilgisini de ierecek ekilde " yyyy-MM-ddTHH:mm:ssXXX " formattaki haliyle hazrlanmaldr. \n \n rnek:  "timestamp": "2021-05-30T20:34:15+03:00" \nyyyy : 4 hane yl \nMM : Baa 0 eklenmi, toplam 2 hane ay \ndd    : Baa 0 eklenmi, toplam 2 hane gn \nHH    : Baa 0 eklenmi, toplam 2 hane saat (0-23 aras deer alabilir.) \nmm : Baa 0 eklenmi, toplam 2 hane dakika \nss    : Baa 0 eklenmi, toplam 2 hane saniye \nXXX : ISO 8601 Time zone \n \n \n JWT veri paketlerinde kullanlan zaman damgalar, 1 Ocak 1970 Saat 00:00:00 (UTC) anndan itibaren geen saniye says deerini (Unix Time) kullanmaldr. \n \n \n Bir HHS, tarihi yanl biimlendirilmi bir istek aldnda, 400 (Hatal stek) durum kodu ve ilgili hata kodu ile yant vermelidir. \n \n \n ISO 4217 Standartnda para birimleri ve ka basamak ondalk deer ierebilecekleri belirlenmitir. \n https://www.iso.org/iso-4217-currency-codes.html   adresinden cretsiz olarak listeye eriilebilir.  \nAPI Standartlarnda da para birimleri  ISO 4217de tanmlanm olan 3 harfli kodlarla iletilir.   Tm tutar alanlar ISO 4217\'de tanmlanm para birimlerinin ondalk basamak deerleri de gz nnde bulundurularak iletilmelidir. Tutar alanlar art ya da eksi deer alabilecei iin API deseninde tanmlanm regular expressionlar dikkate alnmaldr. \nrnein; Bakiye API\'sindeki "Kredili Mevduat Hesab Bakiyesi" alan "-100.25" ve "Para Birimi" alan "TRY" olarak iletildiinde 25 deerinin kuru olduu anlalmaldr. \ndeme Emri Rzas API\'sinde yer alan "lem Tutar" alan "104.75" TRY olarak iletildiinde "75" deerinin kuru olduu anlalmaldr. \n"12000" Japon Yeni iin, ISO 4217de JPY para biriminin ondalk ksm olmadndan "lem Tutar" alannda "12000" ve "Para Birimi" alannda "JPY" deeri  iletilmelidir. \n \n \n Altn para birimi zelinde ISO 4217ye uygun olarak "XAU" cinsinde ve 2 basamak ondalk rakam ierecek ekilde iletilmelidir. rnein ierisinde "13,50 gr" altn olan hesap iin bakiye "13.50", para birimi "XAU" olarak gnderilmelidir. \n \n \n Dier madenlerde ondalk basamak ISO 4217 standartnda tanmland gibi olmaldr. \n \n \n Sral veri tipleri byk kk harfe duyarl olmaldr. \n 3.8.\tstemci Sertifika Ynetimi \n HVPS kapsamnda YS ve HHSlerin gvenli bir ekilde tanmlanmas amacyla elektronik sertifikalar kullanlr. \n HVPS kapsamnda taraflarn gvenli bir ekilde tanmlamas, utan uca gvenli iletiim, mesaj ifreleme ve mesaj imzalama ilevleri 15/1/2004 tarihli ve 5070 sayl Elektronik mza Kanununda aklanan elektronik sertifikalar kullanlarak salanr. Elektronik sertifikada Trkiye Cumhuriyet Merkez Bankas tarafndan verilen kurulu kodu ve kuruluun trne dair bilgiler bulunur. \n BKM API Geidi zerinden yaplan eriimlerde YS ve HHSlere nceden datlm olan istemci sertifikalar kullanlarak taraflarn (sunucu) kimliklerinin dorulanmas salanacaktr. stemci sertifikalar hem test hem de retim ortamnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii sertifikasyon srecinde de snanacaktr. Sz konusu sertifikalarn datm prosedrleri ve kullanmlara ynelik aklamalar EK-3te yer verilmitir. \n 3.9.\tYetkilendirme Trleri \n BKM API Geidi zerinden yaplan arlarda iki temel yetkilendirme tr kullanlr: \n 1.\tstemci Kimlik Bilgileri:  Mteri onaynn gerekmedii, sadece YSn tanmlanp doruland API arlarnda kullanlr. YSn yetkilendirilmi olduu ve faaliyet izninin yapt hizmet arsna uygun olduu kontrol edilir.  Bu amala, YSlere clientId ve clientSecret tahsis edilecektir. YSler ilgili clientId ve clientSecret ile sadece yetkilendirilmi olduklar servislere eriebileceklerdir. YSler kendilerine BKM tarafndan sunulacak APIyi, kendi clientID ve clientSecret deerleri ile sorgulayarak stemci Kimlik Bilgileri belirtecini (access token) elde edeceklerdir.\nHHSler de BKM API geidi zerindeki YS APIsini sorgulama maksad ile BKM API Geidine geldiklerinde, kendilerine atanm olan clientID ve clientSecret bilgileri ile yetki kontrolleri yaplr.\nHHSler kendilerinden alnacak username ve password deerleri kullanlarak oluturulacak basic authentication metodu ile servislerini sunacaklardr. \n 2.\tYetkilendirme Kodu:  YSn dorulanmasnn yansra mterinin GKD ile dorulanmas gereken API arlarnda kullanlr. Mteri dorulanarak yetkilendirme kodu oluturulmas HHSnin yetkilendirme arayzne ynlendirilir. GKDnin baaryla tamamlanmas sonrasnda yetkilendirme kodu YSe dnlr. YS daha sonra HHSnin  eriim belirteci  (access token) eriim adresini (EK-3: POST /erisim-belirteci) armak suretiyle yetkilendirme kodunu bir eriim belirteci (access token) ile deitirerek ilgili kaynaklar kullanabilir. \n deme emri balatma ve hesap bilgisi hizmetlerinde hangi yetkilendirme trlerinin kullanlaca bilgisi, ilgili balklardaki eriim adresleri (endpoints) tablolarnda yer almaktadr. \n erisim-belirteci  erisim noktasndan elde edilen  erisimBelirteci  ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda  x-access-token  alannda iletilir.\nBelirli bir sre iin tanmlanan eriim belirteci (access token) deerinin yenileme belirteci (refresh token) ile yenilenmesi gerekir. \n Eriim adreslerinde kullanlan yetkilendirme tr ilgili eriim adresi tablolarnda belirtilmitir. \n 3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar \n stek ve Cevap mesajlarnda kullanlacak olan nesneler tm elemanlarn kapsayacak ekilde Ek-1 de listelenmitir. Tm listelenen elemanlar asndan (U nokta mesaj yaplarnn belirtildii tablolarda belirtildii zere) alann Zorunlu (z) veya stee Bal () olma durumlarna gre baz alanlar gnderilebilir veya gnderilmeyebilir. \n 3.11. Sayfalandrma ve Filtreleme \n Sayfalandrma \n arya dnlen kaynak nesnesi ierisindeki kaytlar bir sayfalandrma yaps ile arlacak ekilde istek oluturulur. \n Oluturulacak istein ierisinde parametreler ile filtreleme, sayfa bana gsterilecek kayt says ve hangi sayfann nyzde gsterilecei bilgileri eriim noktasna iletilir ve ilgili kaytlar cevap olarak alnr. \n Filtreleme \n HHS, birden ok kayt dnlmesi gereken GET arlarnda snrl filtreleme destei salamaldr. Filtre parametreleri her zaman kaynak nesnesinin belirli alanlarna zgdr ve nesne iin tanmlanan kurallara uymaldr. \n 3.12. Mesaj mzalama \n Elektronik imzalar, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini destekler. mzalarn kaynak baznda hangi istek ve yantlara uyguland belirlidir. \n API yalnzca TLS\'ye dayanrsa, dijital kaytlar ve inkr edilemezlik kantlarn tutmak zor olur. Bu nedenle, TLS\'ye dayanmayan bir inkr edilemezlik zm olarak API isteinin HTTP balnda bir JWS kullanlarak salanabilir. \n HTTP isteinin gvdesinin hash fonksiyonu (SHA256) ile zeti alnacaktr. Elde edilen zet, asimetrik anahtarlar destekleyen bir algoritma kullanlarak imzalanacak ve JWS elde edilecektir. \n Bir istek, YS\'nin zel anahtar ile imzalanacak ve bu istee karlk gelen yant, HHS\'nin zel anahtar tarafndan imzalanacaktr. \n Tm API istekleri ve yantlar imzalanmaz. Mesaj imzalamann zorunlu olup olmad, desteklenip desteklenmedii her API zelinde belirlenir. \n Anahtar Deposu \n HHS\'ler ve YS\'ler tarafndan gvenilen bir Gven Otoritesi (Trust Anchor), taraflar iin bir genel anahtar deposu salamaktan sorumludur. \n Gven Otoritesi, taraflardan herhangi birisinin oluturduu bir anahtar iftinin ak blmn saklayan merkezi bir dizin (BKM tarafndan tutulan merkezi kayt sistemi vb.) olacaktr. \n Mesajlar dorulamak iin taraflarn genel anahtarlarnn paylalmas iin BKM bir servis salayacaktr. HHS API olarak adlandrlm olan bu servis ile HHS ve YS listelerine ulalabildii gibi dorulama ilemi iin ihtiya duyulacak olan genel anahtarlara da bu servis zerinden eriilebilinecektir. \n lgili Mesaj ifreleme iin genel ak, Ek-5 blmnde detaylaryla paylalmaktadr. \n 3.13. Durum Kodu \n APIler, iki farkl amaca hizmet eden iki durum kodu kullanr: \n \n HTTP Durum Kodu, API arsnn (kaynaktaki HTTP ilemi) sonucunu yanstr. \n Baz kaynak payloadlarndaki Durum alan, kaynaklarn durumunu yanstr. \n 3.14. Gereksinimlerinin Snflandrlmas \n Eriim adreslerinin ve alanlarn kullanm Zorunlu(Z), stee Bal() veya Koullu(K) olabilir. Kullanmlara ilikin durumlar ve kullanmn (K) koullu olduu duruma ilikin aklamalar ilgili tablolarda belirtilmitir. \n HVPS API\'lerinin (HBH,BH,GKD) istek ve yantta kullanlacak balk isimleri, ilgili RFC dokmanlarnda ve aadaki tabloda yer ald ekilde kullanlacaktr.  Uygulamaya zellemi balklar "X-" ile balayacaktr. Balk isimlerinde yer alacak ksaltmalar (rn. PSU, ASPSP gibi) tamam byk harfle yazlacak ekilde tanmlanacaktr. Balk isimleri byk  kk harfe duyarl olmamaldr. rnein x-request-id ya da X-Request-ID olarak gnderilmi olan bir istek bal deikeni, sunucu tarafnda hata vermeyecek ekilde ilenebilmelidir. \n 3.15. stek Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "PSU-Device-Data" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n \n Tablo 2: stek Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n POST \n GET \n DELETE \n \n \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras.   rnek: deme emri balatma i aknn her admda farkl x-request-id deeri kullanlr.   arlarn ayn yant dnmesinin beklendii durumlarda (idempotent ilemlerde) ayn deer ile ar yaplr. \n Z \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras.  Ayn rza noya ait tm isteklerde ayn x-group-id bilgisi deeri gnderilmelidir. rnek: deme emri balatma/hesap bilgisi i aknn her admnda ayn x-group-id deeri kullanlr. \n Z \n Z \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder. Bu deerin application/json olarak gnderilmesi gerekmektedir.  (Baka bir deere ayarlanrsa, HHS, 415 Desteklenmeyen Ortam Tr (Unsupported Media Type) ile yant vermelidir) \n Z \n - \n - \n \n \n X-ASPSP-Code \n AN4 \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n Z \n \n \n PSU-Auth-Date \n ISODateTime \n HKnn YS zerinde en son oturum at saat. [RFC7231] rnein:  auth-date: Tue, 11 Sep 2012 19:43:31 GMT \n  \n  \n  \n \n \n PSU-IP-Adress \n AN7..15 \n HK YS zerinde oturum amsa, ilemi balatt cihazn IP adresi. \n  \n  \n  \n \n \n PSU-IP-Port \n AN1..5 \n HK YS zerinde oturum amsa, ilemi balatt cihazn Port adresi. \n  \n  \n  \n \n \n PSU-GEO-Location \n AN1..36 \n HKnn ilemi balatt cihazn konum bilgisi. RFC2426 standartna uygun olarak paylalmaldr. rnein  GEO:"<enlem >, <boylam>GEO:52.506931,13.144558 \n  \n  \n  \n \n \n PSU-User-Agent \n AN 1.. 255 \n HKnn ilemi balatt cihazn salad user-agent bilgisi. (Tarayc, versiyon, iletim sistemi bilgileri) \n  \n  \n  \n \n \n PSU-Timestamp \n ISODateTime \n HKnn ilemi balatt cihazn tarih saat ieren zaman bilgisi. \n  \n  \n  \n \n \n PSU-Device-ID \n AN5..40 \n HK ilemi mobil uygulama araclyla balattysa, kullanlan mobil uygulama ilk yklendiinde oluturulan tekil cihaz veya uygulama belirteci. HK cihaznn UUID deeri kullanlabilir. \n  \n  \n  \n \n \n PSU-Device-Data \n AN1..1024 \n HKnn ilemi balatt mobil cihaza ait veriler.  rnek alanlar:   - Platform - (Android, iOS, Windows 10 Mobile)  - Device Model   - OS Name   - OS Version - Locale - Time zone \n  \n  \n  \n \n \n PSU-Fraud-Check \n AN1..4096 \n YS\'lerin eitli gvenlik kontrollerini gerekletirerek, nemli grlen aadaki bilgileri HHS\'ler ile paylamalar gerekmektedir. Bu bilgiler nda mterinin profili oluturulmasna katk salanacaktr.   HKl ilemlerde (PSU-Initiated = E gnderildii durumlarda) gnderilmesi zorunludur.  Sistemsel yaplan API armlarmda ve HHS-YS API armlarnda gnderilmesine gerek bulunmamaktadr.  Paylalacak bilgiler u ekildedir.   FirstLoginFlag  : HK\'nn, mterilik mrnde ilgili YS sistemine (mobil ya da web uygulamas) ilk login olma sresini ifade eden deer. HK\'nn ilk yapt HBH ya da BH ilemi deil, YS sisteminde kendini aktifletirme tarih aral bilgisidir.   YS, kullancnn ilk login bilgisini tutarak sonraki ilemlerinde bu bilgiyi belirlenen format ile HHS\'ye aktaracaktr. rnein; YS\'n 7 aydr mterisi olan bir kullanc iin bu alan "5" olarak YS tarafndan beslenecektir. Burada ama; ilgili kullancnn YS\'n eski bir mterisi mi, yoksa yeni bir mterisi mi olup olmadn anlamaktr.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   DeviceFirstLoginFlag  : HK\'nn, mterilik mrnde ilem annda kulland cihazla YS uygulamasna (web ya da uygulama tabanl) ilk login olma sresini ifade eden deer. HK cihaz deiiklii yaparsa FirstLoginFlag deeri sabit kalmal  ancak DeviceFirstLoginFlag deeri deimelidir.  FirstloginFlag deeri ile HKnn YS uygulamasna ilk login tarih bilgisi ile ilgili bilgi verilirken, DeviceFirstLoginFlag ile de HKnn YS uygulamasna farkl bir cihaz aracl ile ilk login tarihinin bilgisi verilmektedir.  rnein; HK 7 aydr YS\'n mterisi olabilir, byle bir durumda FirstLoginFlag deeri "5" olacaktr. Ancak son ilemini daha nce hi kullanmad bir cihazdan yapmtr. Yeni cihazdaki login sre aral 0-2 saat aralnda  olduu iin DeviceFirstLoginFlag deeri "1" olacaktr.FirstLoginFlag deeri yine "5" olarak kalmaya devam edecektir.Bu bilgi ile YS, ilgili HHS\'ye ilk kez geliyor olsa bile; HHS, mterinin YS\' uzun sredir kullandn ama yeni bir cihazla ilemlerine devam ettiini anlayabilecektir. Bir HK, farkl cihazlar veya platformlar zerinden YS ile etkileime girebilir.  Kullanc ve YS arasnda bir oturum balatlm ise YSn tutarl ve kalc bir kimlik (device id) atamas beklenmektedir.  Device ID: Web sitesi veya mobil uygulama kullanclar iin retilen, tarayc ya da mobil uygulama tabanl benzersiz (tekil) tanmlayc deer. Mobil uygulamalar iin HKnn ilk defa ilgili cihaza aktivasyon yapt tarih bilgisi alnmaldr.   Device ID bilgileri YS uygulama ortam (web ya da uygulama tabanl) ve HK cihaz baznda tutulmaldr. YSten balatlan ilem hangi uygulama ortamna ait ise ilgili ortamala ilikili tutulan Device IDnin ilk login tarihine baklarak gncel flag deeri hesaplanmaldr.  Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   LastPasswordChangeFlag  : HK\'nn, YS (cihaz bamsz)  uygulamasna login olduu ifre bilgisinin en son deitirildii sreyi ifade eden deer. Mterinin en son ne zaman ifre deiiklii yaptn anlamak iin kullanlan alandr. Yeni mteri ve hi ifre deiiklii yapmam olabilir, byle bir durumda ilgili alan "0" olarak beslenecektir.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   BlacklistFlag  : HK\'nn herhangi bir sebeple YS\'n sakncal mteriler listesinde bulunup bulunmadn ifade eden deer.   Burada ama herhangi bir sebeple YS tarafnda yasakl olarak kaytl olan HK bilgisinin, dolandrcl nceden tespit etmek amal HHS\'ye aktarlmas olarak aklanabilir. rnein, YS tarafndan tespit edilen dolandrc kullanclara ait device id bilgisi, bu kara listede tutulur daha sonra ayn cihazla baka bir HK ilem yapacak olsa bile bu alanda ilgili bilgi "1" deeri ile HHS\'ye aktarlr. HHS\'de olmayp YS tarafnda olan bu rnekteki sakncal mteri/cihaz bilgisinin, dolayl yoldan HHS\'ye aktarlmas amalanmaktadr.  Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   MalwareFlag  : YS uygulamasnn alt cihaz zerindeki son 21 gne ait zararl yazlm tespit bilgisini ifade eden deer. rnein HK\'nn cihaznda zararl yazlm olduu ayn 1\'inde YS tarafndan tespit edildi. Zararl yazlm tespitinden 2 saat sonra YS zerinden login olan HK\'nn durumu,  "1" olarak iletilecektir. Bir gn sonra ayn 2\'sinde, yeni bir zararl yazlm tespiti yok ancak mevcut zararl yazlm aktifse alan "2" deeri ile iletilecektir. Sreler artarak 21 gne kadar TR.OHVPS.DataCode.ZmnAralik deerlerine gre iletilecektir.Son 21 gn iinde yeni bir tespit yoksa ayn 22\'sinden itibaren ilgili alan  "0" deeri ile beslenecektir. Not: Zararl yazlm, bankaclk ilemlerinin yapld uygulamalara girite kullanlan bilgilerin (ifre, kullanc kodu gibi) ele geirilmesi amacyla kullanlan bir uygulama ya da kod parac olabilir. Bu amalar dnda kullanlan (bankacla ynelik bir zararl yazlm olmayan) yazlm tespitleri iletilmemelidir. YS kanallarna her bir loginde, kullanlan cihazda bir zararl yazlm var m yok mu kontrol yaplmaldr.   Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   AnomallyFlag  : Dier pheli durumlarn varln ifade eden deer. Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   UnsafeAccountFlag : HHS tarafndan aktarlan bilgi ile son 21 gn iinde HK\'nn dolandrclk maduru olmas durumunu ifade eden deer. rnein; HHS 1, ayn 1\'inde sphe veya sahtekarlk nedeniyle bir deme ilemine izin vermedii durumda, bu bilgiyi rza iptal detay kodu ile YS\'e aktarm olur. Bu bilgiyi tutan YS, ilgili mterinin 15 dakika sonra HHS 2\'de yapt ilem iin ilgili alan "1" deeri ile besler. Bylece HHS 2, HK\'nn farkl bir HHS\'de son 15 dakika iinde pheli veya sahte bir ilemi olduunu anlayabilecektir. Ayn 22\'sinde yeni bir tespit/kayt yoksa bu alan YS tarafndan "0" olarak beslenecektir. Gnderilmesi Opsiyonel alandr.TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.     Flaglar JWT claims iine key value eklinde eklenerek gnderilecektir. EK-5: Mesaj mzalama Ak\'nda belirtilen yntemle imzalanarak oluturulan JWT PSU-Fraud-Check alanna konularak YS\'ler tarafndan HHS\'ye iletilmelidir. \n K \n K \n Z \n \n \n PSU-Initiated \n AN1 \n lemin HK tarafndan balatlmas durumunda E , sistem tarafndan balatld durumda H deerini almas beklenir.   lemler servisinde yaplacak sistemsel sorgulardaki ilem limitlerini kontrol amacyla kullanlr. \n Z \n Z \n Z \n \n \n PSU-Session-ID \n AN1..100 \n stei balatan YS tarafndan belirlenen oturuma zg talep kimlii. HK\'nn YS uygulamas zerinden kimlik dorulama mekanizmas ile bilgi sistemlerine dhil olmalarndan ilemlerini tamamlayp sistemden ayrlmalarna kadar geecek tm sreci kapsayacak ekilde ayn deeri almaldr. Tek seferlik deme gibi HKnn tannmadan balatld ilemlerde bu deer bo olarak iletilmelidir. \n  \n  \n  \n \n \n Authorization \n AN1..4096 \n YS ile BKM API Gateway arasndaki otorizasyon iin kullanlan token bilgisidir.  Yekilendirme trlerinden stemci Kimlik Bilgilerini adresler. \n Z \n Z \n Z \n \n \n X-Access-Token \n AN1..4096 \n HKnn GKD srecinde dorulanmas sonrasnda kullanlan eriim simgesi. Yetkilendirme trlerinden Yetkilendirme Kodu (GKD)nu adresler. \n  \n  \n  \n \n \n X-JWS-Signature \n AN1..4096 \n Payload gvdesinin ayrlm bir JWS imzasn ieren stbilgi.  Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n K (Kullanlan API ve methoda gre kullanlr.) \n K \n K \n 3.16. Yant Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "Link" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n \n Tablo 3: Yant Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n Kullanm Durumu \n \n \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras    lgili istek balndaki bilgi geri dnlr. \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras. lgili istek balndaki bu deer geri dnlr. \n Z \n \n \n X-ASPSP-Code \n AN4 \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n \n \n X-TPP-Code \n AN4 \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder:  application/json \n Z \n \n \n X-JWS-Signature \n AN1..4096 \n JWS imzasn ieren stbilgi. Bu baln hangi yantlar iin kullanlmas gerektii ilgili endpoint iin belirtilmitir.  Hata durumlarnda, yant gvdesi deeri dnlyor ise imzalanmal ve imza bilgisi x-jws-signature alannda iletilmelidir.  Ancak uygulama katman tarafndan yakalanamayan dolays ile imzalanamayan hata durumlarnda x-jws-signature alan HHS\'ler tarafndan bo gnderilebilir. \n K \n \n \n X-RateLimit-Limit \n N 1..18 \n stek kst uygulanan servislerde en fazla ka adet istek yaplabileceini gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n \n \n X-RateLimit-Remaining \n N 1..18 \n stek kst uygulanan servislerde ka adet istek hakk kaldn gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n \n \n X-RateLimit-Reset \n AN 1..255 \n stek kst uygulanan servislerde arm hakk bittikten sonra yeniden denemeden nce beklemesi gereken sreyi (saniye cinsinden) gsterir. HTTP 429 durum kodu (Too Many Requests) ile dnlen yantlarn balnda dnlmesi zorunludur.  YS olarak yaptnz sistemsel sorgularda; HTTP 429 durum kodu (Too Many Requests) ile dnlen yant aldnzda tekrar sorgu yapmadan nce X-RateLimit-Reset yant baln kontrol ederek, bu balktaki sre kadar bekledikten sonra yeniden sorgulama yaplmas gerekmektedir. \n K \n \n \n x-total-count \n N 1..18 \n Hesaplar, lemler ve Bakiye servislerinde sayfalama kullanld durumda, sorgu sonucu dnecek toplam kayt says bilgisi, bu alanda HHS isteine bal olarak gnderilebilir. \n  \n \n \n Link \n 1..4096 \n Link alannn oklu sayfa yaps olmas durumunda gnderilmesi zorunludur.  Sayfalama yaps kullanldnda gelen yantta birden fazla sayfa var ise; nceki, sonraki, ilk, son sayfalara gitmek iin gerekli referanslar link headernda aadaki rnekteki gibi doldurulabilir.  x-total-count alannn gnderimi istee bal olduu iin; Link ierisindeki son sayfa bilgisi  (last) istee bal hale getirilmitir. nceki( prev) ve Sonraki (next) admlarnn uygun olan her durumda yer almas zorunludur. lk sayfada nceki seenei olmamal, son sayfada ise Sonraki seenei olmamaldr.    </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=6&syfKytSayi=100>; rel="next",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=4&syfKytSayi=100>; rel="prev",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=14&syfKytSayi=100>; rel="last",  </ohvps/hbh/s1.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=0&syfKytSayi=100>; rel="first" \n K \n 3.17. Idempotency Kurallar \n YSn aadaki durumlarda ayn istek numaras (x-request-id) ve ayn veri gvdesiyle ary tekrarlamas; HHSnin de bu durumlarda ayn yant dnmesi gereklidir. \n \n HHSnin yant kesinti/arza nedeniyle YSe ulamaz ve zaman am sz konusu olmas, \n HK, YS uygulamas zerinden ift tklama ile mkerrer defa HHS APIlerini arlmas,\n(API kontrollerinden nce YS uygulamasnn, ift tklama kontrol yapmas nerilmektedir.) \n YS, yant almasna ramen ileyemeden kaybedilmesi, \n \n durumlarnda HHS aadaki kurallar iletir: \n \n HHS gelen istek numarasn ve veri gvdesini birletirerek checksum deeri retir. \nchesksum deeri x-request-id|request.body nin hash algoritmalarndan (CRC32,MD5 vb)  geirilerek retilebilir. \n HHS bu checksum deeri ile YSe dnm olduu yant 5 dk boyunca saklar.  Saklama yntemi olarak veri taban veya nbellek aralar kullanlabilir. \n YS ayn istek numaras ve ayn veri gvdesi ile yeni bir ar yaptnda, ayn checksum deeri retilecei iin 5dk boyunca bu deere karlk gelen yant dner. \n 5 dk sonrasnda istek numaras veya veri gvdesi deimemi olsa dahi bu HHS tarafndan yeni istek olarak kabul edilir. \n \n Aadaki Public Post ilemleri iin bu kural setinin iletilmesi gerekmektedir: \n 1- deme emri rzas oluturma \n2- Eriim belirteci oluturma \n3- deme emri \n4- Hesap bilgisi rzas oluturma \n 3.18. HTTP Durum Kodlar \n RFC 2616\'da belirlenmi olan durum kodlar (status code) gnderilen istein durumunu YSa standart bir ekilde ifade eder. Eer bir hata varsa hatay, gnderilen istek baarl bir ekilde ilem grdyse ona ilikin durumu aktarr. Durum kodlar genel olarak 5 kategoridedir. \n \n 1xx Bilgi \n 2xx Baarl \n 3xx Ynlendirme \n 4xx stemci Hatas \n 5xx Sunucu Hatas \n \n errorCode Alannda Kullanlabilecek Sral Hata Tipleri : \n \n TR.OHVPS.Resource \n \n \tInvalidFormat \n \tConsentMismatch \n \tNotFound \n \tInvalidSignature \n \tMissingSignature \n \tMethodNotAllowed \n \tNotAcceptable \n \tUnsupportedMediaType \n \tConsentRevoked \n \n \n \n TR.OHVPS.Business \n \n \tInvalidContent \n \tInvalidAccount \n \n \n \n TR.OHVPS.Connection \n \n \tInvalidCertificate \n \tExceededRate \n \tInvalidTPP \n \tInvalidASPSP \n \tInvalidToken \n \tInvalidTPPRole \n \n \n \n TR.OHVPS.Server \n \n \tInternalError \n \tServiceUnavailable \n \n \n TR.OHVPS.Resource.InvalidFormat hatas alnd durumda; fieldErrors nesnesi ierisinde verilecek hata kodlar : \n \n TR.OHVPS.Field \n \n \tMissing \n \tInvalid \n \n \n Veri Tipi rnei: \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "d8bd4e5f-f094-48a6-aee1-3a800e2709d9" , \n     "timestamp" :   "2022-12-22T10:33:15+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.prBrm" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.kmlk.kmlkVrs" , \n             "messageTr" :   "boyut \'1\' ile \'30\' arasnda olmal" , \n             "message" :   "size must be between 1 and 30" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n \n Tablo 4: HTTP Durum Kodlar \n \n \n \n HTTP Durum \n stek Sonucu ve Aklamalar \n POST \n GET \n DELETE \n \n \n \n \n 200 OK \n stek Baaryla Tamamland. Kaynak gncellemek iin yaplan (rnein, GET) ve baaryla tamamlanan isteklerinde kullanlr. \n H \n E \n H \n \n \n 201 Created \n stek Baarl Oldu. Kaynak yaratma istei (rnein, POST /deme-emri-rizasi) baaryla sonuland. \n E \n H \n H \n \n \n 204 No Content \n Silme ilemi baaryla tamamland. Kaynak silme istei (rnein,  DELETE /hesap-rizasi/{RizaNo} ) baaryla sonuland. \n H \n H \n E \n \n \n 400 Bad Request \n stekte bozuk, eksik veya uyumlu olmayan JSON gvdesi, URL parametreleri veya balk alanlar var.  stekle balatlan ilem yapsal bozukluk, eksik veya tutarsz veri veya HHS tarafndaki kontrollerin hatal sonulanmas nedeniyle hata ile sonulanr ve hataya ilikin veriler hata nesnesi ierisinde dnlr. \n E \n E \n E \n \n \n 401 Unauthorized \n Yetkilendirme bal eksik, hatal veya geersiz olduundan istek yetkilendirilmediinde ve eriim reddedildiinde http 401 kodu dnlmelidir. \n E \n E \n E \n \n \n 403 Forbidden \n Eriim belirtecinin veya rzann kapsam uyumuyor. YS bir hesaba/ilem kaynana erimeye alr ve YS, istenen kaynaa erimek iin geerli izinlere sahip bir rzas yoktur.  rnein; hesap bilgisi rzas bakiye izni almamtr ancak /bakiyeler adresinden istekte bulunmutur. \n \n \n \n \n \n 404 Not Found \n **HHS geerli bir API eriim adresini salamyorsa, o URL\'ye gelen istekler iin 404 (Bulunamad) ile yant vermelidir.**YS, uygulama esaslarnda tanmlanmayan bir kaynak iin bir URL\'ye erimeye alrsa (rnein, GET /yurtdisi-odeme), HHS, 404 (Bulunamad) ile yant vermeyi seebilir. \n E \n E \n E \n \n \n 405 Method Not Allowed \n YS, desteklenmeyen bir yntemle kaynaa erimeye alt. \n E \n E \n E \n \n \n 406 Not Acceptable \n stek, geersiz bir karakter kmesi ieriyor. \n E \n E \n E \n \n \n 415 Unsupported Media Type \n stek gvdesi hedef kaynakta bu yntem tarafndan desteklenmeyen bir biimde oluturulduu iin ilem reddedildi \n E \n H \n H \n \n \n 429 Too Many Requests \n Belirli bir sre iinde ok fazla talepte bulunulduu iin ilem reddedildi.  HHSler adil kullanm politikalarn aan talepleri kstlayabilir. \n E \n E \n E \n \n \n 500 Internal Server Error \n API sunucu / servis katmannda sorun olutu. lem baarsz.  5XX hata durumlarnda yant gvde deeri olmad iin mesaj imzalama yaplamaz ve x-jws-signature alan bo olarak iletilir.  Bu durumda x-jws-signature kontrol yaplmamaldr. \n E \n E \n E \n \n \n 503 Service Unavailable \n Hizmet srm kullanmdan kaldrld.  Bir API\'nin kullanmdan kaldrld ve artk bir HHS tarafndan operasyonel olarak desteklenmedii durumlarda, URI yolu hala etkin olabilir ve API isteklerini kabul edebilir.  Bu durumda, YS\'n API srmnn evrimd olduunun farknda olmas iin 503 Hizmet Kullanlamyor dnmesi nerilir. \n E \n E \n E \n \n \n \n Hata rnekleri: \n 400 Bad Request \n TR.OHVPS.Business.InvalidContent  hatas HHS tarafndan yaplacak i kural kontrollerinin baarsz olduu durumda verilmelidir. \n TR.OHVPS.Resource.InvalidFormat  hatas ema validasyonu, alan uzunluk ve varlk kontrollerinin baarsz olduu durumda verilmelidir. \n \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "7f115b9c-d7c2-4a2a-bc45-5a9891c79072" , \n     "timestamp" :   "2022-12-22T10:47:57+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.alc.unv" , \n             "messageTr" :   "boyut \'3\' ile \'140\' arasnda olmal" , \n             "message" :   "size must be between 3 and 140" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.ttr" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n\n \n Zorunlu header alanlarndan biri ya da birka eksik olarak gnderilirse aadaki gibi bir hata dn gerekleebilir. \n HHS uygulamas tarafndan dnlebilecek hata rnekleri: \n \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "2005515d-f0e6-4a07-a439-0ef3b0f56011" , \n     "timestamp" :   "2022-12-22T10:39:26+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" , \n     "fieldErrors" :   [ \n         {          \n             "field" :   "X-Request-ID" , \n             "messageTr" :   "X-Request-ID deeri bo olamaz." , \n             "message" :   "X-Request-ID cannot be null." , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] \n }  \n\n \n Business hata rnei - 1: \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "677cfd9d-77c1-4ea3-8bdf-74a6e9887177" , \n     "timestamp" :   "2022-12-22T11:05:59+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "gonUnvan wrong" , \n     "moreInformationTr" :   "Gnderen nvan hatal" , \n     "errorCode" :   "TR.OHVPS.Business.InvalidContent" \n }  \n \n Business hata rnei - 2: \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "5df3b402-3aca-4305-a35b-5af0f3184b40" , \n     "timestamp" :   "2022-12-22T11:06:47+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Sender account is disabled or not found." , \n     "moreInformationTr" :   "Gonderen hesap aktif deil veya bulunamad." , \n     "errorCode" :   "TR.OHVPS.Business.InvalidAccount" \n }  \n \n BKM API Geidi\'nde yaplan zorunlu header kontrollerinde aadaki hatalar dnebilir: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidASPSP" , \n     "moreInformation" :   "Invalid ASPSP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n BKM API Geidi tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPP" , \n     "moreInformation" :   "Invalid TPP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n BKM API Geidi tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T11:14:05+03:00" , \n     "path" :   "/ohvps/hbh/s1.0/hesap-bilgisi-rizasi" , \n     "id" :   "ee1e3ea7-a5e5-468b-bb02-314148f84e6a" , \n     "moreInformationTr" :   "Geersiz ys rol. lgili api ars iin yetkisi yok." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPPRole" , \n     "moreInformation" :   "Invalid TPP Role" , \n     "httpCode" :   403 , \n     "httpMessage" :   "Forbidden" \n }  \n\n \n 401 Unauthorized \n YS, sresi dolmu bir eriim belirteci kullandnda, HHS 401 (Yetkisiz) http kodu ile aadaki hata kodunu dnmelidir.  Aadaki nedenlerden herhangi biri nedeniyle bir Eriim Belirtecinin sresi dolduunda bu durum ortaya kabilir: \n \n Rzann sresi doldu (Son Kullanma Tarihi geti) \n Eriim Belirtecinin pheli kullanm veya sahtekarlk phesi \n Rzada belirlenen gn saysnn am\nBu hata, mteriden doru izinlerle yeniden kimlik dorulamas isteyerek zlebilir. \n \n \n { \n     "path" :   "/ohvps/gkd/s1.0/erisim-belirteci" , \n     "id" :   "ed3fd667-fc58-40ad-a982-e8937faccd15" , \n     "timestamp" :   "2022-12-22T11:17:33+03:00" , \n     "httpCode" :   401 , \n     "httpMessage" :   "Unauthorized" , \n     "moreInformation" :   "Refresh token expired or not found in database" , \n     "moreInformationTr" :   "Yenileme belirteci zaman amna uram veya veri tabannda yok" , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidToken" \n }  \n \n\n \n 403 Forbidden \n rn; YS yetkisi olmayan rol(BH/HBH) ile ilem yapmaya alt durumda 403 hatas alarak ileme devam edemez. \n { \n   "path" :   "/ohvps/hbh/s1.0/bakiye" , \n   "id" :   "3e48ea98-f889-48b9-aa6e-28aabc6cfb14" , \n   "timestamp" :   "2022-12-22T11:20:05+03:00" , \n   "httpCode" :   403 , \n   "httpMessage" :   "Forbidden" , \n   "moreInformation" :   "Forbidden" , \n   "moreInformationTr" :   "Bakiye Bilgileri iin HK izni bulunmamaktadr." , \n   "errorCode" :   "TR.OHVPS.Resource.Forbidden" \n }  \n \n 404 Not Found \n rn; GET /odeme-emri-rizasi/123456 ars durumunda 123456 geerli bir deme kayna deilse, HHS, 404 koduyla cevap vermelidir. \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi/123456" , \n     "id" :   "22f52b2d-d442-4a6a-8f39-d23eba45a34b" , \n     "timestamp" :   "2022-12-22T10:53:53+03:00" , \n     "httpCode" :   404 , \n     "httpMessage" :   "Not Found" , \n     "moreInformation" :   "Resource not found" , \n     "errorCode" :   "TR.OHVPS.Resource.NotFound" , \n     "moreInformationTr" :   "Kaynak bulunamad" \n }  \n\n \n 405 Method Not Allowed \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   405 , \n     "httpMessage" :   "Method Not Allowed" , \n     "moreInformation" :   "Method not allowed" , \n     "errorCode" :   "TR.OHVPS.Resource.MethodNotAllowed" , \n     "moreInformationTr" :   "stek yaplan URL iin izin verilmeyen metot" \n }  \n \n 406 Not Acceptable \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   406 , \n     "httpMessage" :   "Not Acceptable" , \n     "moreInformation" :   "Not Acceptable" , \n     "errorCode" :   "TR.OHVPS.Resource.NotAcceptable" , \n     "moreInformationTr" :   "Kabul edilmedi" \n }  \n \n 415 Unsupported Media Type \n stek balnda content-type, JSON dnda bir veri iletilirse bu hata verilebilir. \n \n { \n     "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n     "id" :   "63cc94b6-1b51-4648-9671-95e6e2e7e03d" , \n     "timestamp" :   "2022-12-22T11:37:12+03:00" , \n     "httpCode" :   415 , \n     "httpMessage" :   "Unsupported Media Type" , \n     "moreInformation" :   "Content type not supported" , \n     "errorCode" :   "TR.OHVPS.Resource.UnsupportedMediaType" , \n     "moreInformationTr" :   "Desteklenmeyen ierik tipi" \n }  \n \n 429 Too Many Requests \n { \n   "path" :   "/ohvps/hbh/s1.0/hesaplar/aef6061f-2978-4bb4-980d-b4c634c8055b/islemler" , \n   "id" :   "20473c5f-2f4f-4b2e-8b66-7978aec442f7" , \n   "timestamp" :   "2022-12-22T00:21:07+03:00" , \n   "httpCode" :   429 , \n   "httpMessage" :   "Too Many Requests" , \n   "moreInformation" :   "Exceeded rate" , \n   "moreInformationTr" :   "Eriim skl limiti am" , \n   "errorCode" :   "TR.OHVPS.Connection.ExceededRate" \n }  \n \n 500 Internal Server Error \n { \n   "id" :   "1b90c6dc-0277-4755-8b05-9297ddfab743" , \n   "path" :   "/ohvps/obh/s1.0/odeme-emri-rizasi" , \n   "timestamp" :   "2022-12-22T11:41:34+03:00" , \n   "httpCode" :   500 , \n   "httpMessage" :   "Internal Server Error" , \n   "moreInformation" :   "Unexpected condition was encountered." , \n   "moreInformationTr" :   "Beklenmeyen bir durumla karlald." , \n   "errorCode" :   "TR.OHVPS.Server.InternalError" \n }  \n\n \n 503 Service Unavailable \n \n   "timestamp" :   "2022-12-20T23:18:56+03:00" , \n   "path" :   "/ohvps/hbh/s1.0/hesap-bilgisi-rizasi/2a72678ee3d24de2be47887e4903a8c6" , \n   "id" :   "e76315b7-09f4-4295-b6d8-1f7fec632159" , \n   "moreInformationTr" :   "HHS u anda hizmet veremiyor." , \n   "errorCode" :   "TR.OHVPS.Server.ServiceUnavailable" , \n   "moreInformation" :   "HHS is currently unavailable" , \n   "httpCode" :   503 , \n   "httpMessage" :   "Service Unavailable" \n 3.19. Maskeleme Kurallar \n Maskeli olarak iletilmesi gereken verilerin maskeleme kurallar u ekildedir: \n \n IBAN verileri Hesap Numaras : lk 4 ve son 4 karakteri ak, dier karakterler maskeli olmaldr. rnek: TR54******************4812 \n Ad-Soyad / Ticari Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr.\nrnein: FATH SERKAN EREN ifadesi FA *** SE**** ER**** eklinde gsterilmelidir. \n Tabela Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr. rnein BANKALARARASI KART MERKEZ ANONM RKET ifadesi BA *** KA**** ME**** AN**** **** eklinde gsterilmelidir. \n YSten girilen unvan ve iban bilgileri deme emri rzas ve deme emri yantnda ak dnlr, Kolas aknda deme emri rzas yant ve deme emri istek ve yantnda maskeli tanr. \n 3.20. Fonksiyonel Olmayan Gereksinimler \n \n \n HHSlerin sunuyor olduklar servisleri en fazla 3000 ms iinde yant dnecek ekilde tasarlamaldr. \n \n \n HHS\'ler mevcut online ilem kanallarndan sunduklar eriilebilirlik ve performans kriterlerinden daha dk bir hizmet kalitesi sunmamaldr. \n \n \n HHSlerin sunuyor olduklar servislere sistemin gvenlik ve srekliliini salamak adna rate limit koyma ihtiyalar olur ise, standartlar ve ihtiyalara uygun ekilde bir konfigrasyon yapabilirler.  \n \n \n HHS rate limit tanm uyguluyor ise; YS\'ler arasnda ayrm yapmadan, adil ve makul snrlar dahilinde uygulamaldr.    \n \n \n YS tarafndan kullancnn balatmad otomatik sorgu limitleri  3.21 Otomatik Sorgular  blmnde detaylandrlmtr. HHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. Dier taraftan kullancnn balatt istekler iin uygulanacak limitler, HHS\'nin online ilem kanallarndan sunulan sorgu limitlerinden daha az olmamaldr. \n \n \n HHS\'ler, arm limitlerini aan istekler iin HTTP 429 - Too Many Request hatasn dnmelidir. rnek hata mesaj  3.18 HTTP Durum Kodlar  blmnde bulunmaktadr. Rate Limit zelinde tanmlanm parametreler olan X-RateLimit-Limit, X-RateLimit-Remaining ve X-RateLimit-Reset alanlar da   3.16 Yant Bal  blmnde aklanmtr. YS\'ler de HHS\'nin belirledii rate limit kurallarna uymakla ykmldr. \n \n \n HHSler ayn zamanda servislerin ayakta olup olmadna ynelik olarak bir healthcheck servisi kurmaldr.  HHSlerin bu servis ile tm network ve veritaban ya da servislerinin ihtiya duyduklar altyapsal eriimleri modellemeli ve bu servisi BKM ile paylamalar beklenmektedir. Bu servis dzenli olarak BKM tarafndan arlarak servislerin ayakta olup olmadklarnn kontrolnn salanmas planlanmaktadr. \n \n \n Sunulan her API iin /health endpointi ile aadaki bilgileri vermeleri beklenmektedir. \n GET /{api ismi}/{versiyon}/health \n rnek: \n GET /obh/s1.0/health \n GET /hbh/s1.0/health \n GET /gkd/s1.0/health \n HHS ve YS API iin health servisleri aadaki servislerle kontrol edilebilir. \n GET /hhs-api/s1.0/health \n GET /yos-api/s1.0/health \n Baarl yantta Http 200 kodu dnlmelidir. \nBaarl Yant: \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Koullu  / stee Bal \n Aklama \n \n \n \n \n status \n status \n AN2..20 \n Z \n UP, DOWN deerlerini alabilir. \n \n \n \n Health servisinden yant alnamamas, hata almas ya da status DOWN gelmesi durumunda API Gatewayden istek HHS tarafna iletilmeyecektir. \n \n \n HVPS servisleri ile ilgili olarak HHSler, BKM tarafndan dzenli olarak sorgulanacaktr, eriilebilirlik ve kullanm oranlar takip edilecektir. \n \n \n HHSlerin servislerini eriim yzdeleri asndan yl baznda %99.75 orannda ayakta olmalarn salayacak ekilde kurgulamalar gerekmektedir. \n 3.21. Otomatik Sorgular \n YS uygulamas, HK\'nn balatt ilemler neticesinde API arm yapabilecei gibi, sistemsel bir ekilde otomatik API arm da yapabilir. \nHHS, API armnn HK\'l ya da HK\'sz olduunu istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n HK YS uygulamasna giri yapt andan k yapt ana kadar yani HK oturumu boyunca yaplan API armlarnda, PSU-Initiated  deerinin "E" olmas gerekmektedir.  YS uygulamasnda HK oturumu boyunca,  HK\'nn bilgilerinden minimumda "bakiye" bilgisinin, uygulama arayzlerinde gncel deeri ile online sorgularla gsterimi YS\'n insiyatifindedir. \n HKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \n YS, aadaki API\'leri sistemsel bir ekilde arabilir. \nHHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. \nHHS tarafndan izin verilen sorgu saysnn zerinde yaplan bir sorgu iin HTTP 429 durum kodu (Too Many Requests) hatas dnlmelidir. Yant gvdesinde tekrar hata nesnesinin oluturulmas HHS inisiyatifindedir.  HHS yant header alannda iletilecek X-RateLimit-Reset (saniye cinsinden) deeri kadar sre sonunda\nYS\'n tekrar sorgulama yapmas beklenmektedir. \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Otomatik Sorgu Says \n \n \n \n \n 1 \n erisim-belirteci \n POST \n /erisim-belirteci \n --- \n \n \n 2 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Rza baznda gnde 4 \n \n \n 3 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Rza baznda gnde 24 \n \n \n 4 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Rza baznda gnde 4 \n \n \n 5 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n --- \n \n \n 6 \n hesaplar \n GET \n /hesaplar \n Bireysel gnde 4  Kurumsal gnde 4 \n \n \n 7 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Bireysel gnde 4 Kurumsal gnde 4 \n \n \n 8 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 9 \n bakiye \n GET \n /bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 10 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Bireysel gnde 4 Kurumsal HK - saatte 12 \n \n \n \n YS ve HHS son 24 saat ierisindeki sorgu saylarn toplayarak elde ettii sonularla limit kontrol yapmaldr (Pencere yntemi). \n lemler servisinin arm detaylarna  ^Blm 7.8  zerinden ulalabilir. \n Hesap bilgisi rzasnn YS tarafndan otomatik bir ekilde iptal edilmesi durumu  ^Blm 9 \'da aklanmtr. \n'},{title:"5.\tGl Kimlik Dorulama",frontmatter:{},regularPath:"/v1.1.0/contents/gkd.html",relativePath:"v1.1.0/contents/gkd.md",key:"v-8d4168c6",path:"/v1.1.0/contents/gkd.html",headers:[{level:2,title:"5.1.\tYnlendirmeli Gl Kimlik Dorulama",slug:"_5-1-yonlendirmeli-guclu-kimlik-dogrulama"},{level:2,title:"5.2.\tAyrk Gl Kimlik Dorulama",slug:"_5-2-ayrk-guclu-kimlik-dogrulama"},{level:3,title:"5.2.1\tStatik Model",slug:"_5-2-1statik-model"},{level:2,title:"5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi",slug:"_5-3-yonlendirme-bildirim-adresleri-ve-durum-kodu-parametresi"},{level:2,title:"5.4  Gl Kimlik Dorulama Kontrolleri",slug:"_5-4-guclu-kimlik-dogrulama-kontrolleri"}],content:" 5.\tGl Kimlik Dorulama \n Mteri iin gl kimlik dorulama, HKnn (mterinin) kimliinin dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntemi tanmlar. \n deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebli uyarnca hesap bilgisi hizmetinde mterinin onaynn alnmas esnasnda ve deme emri balatma hizmetinde her bir deme emri balatma ileminde  HHS tarafndan mteriye gl kimlik dorulama (GKD) uygulanmas esastr.  Buna gre: \n \n \n Hesap bilgisi hizmetinde HKnn onaynn alnmas esnasnda  Tebliin 26 nc maddesinin 1 inci fkras uyarnca  HHS tarafndan HKya GKD uygulanr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 2 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanr ve ilem dorulama kodu ile HKnn onay alnr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 3 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanmasna ilikin istisna veya ilave gvenlik nlemleri ibu API lke ve Kurallar belgesinde tanmlanr. \n \n \n HHS, gl kimlik dorulama srecinde HKnin sahip olduu bileen snf olarak SMS OTP ya da SMS ile ilem dorulama kodu kullanabilir. \n \n \n HHS, aadaki hallerde veya  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre tek bileen ile kimlik dorulama yapabilir. \n \n demenin gndereni ve alcsnn ayn olmas, \n Daha nce tanmlanm gvenli alclar listesine deme yaplmas, \n HKnin talimatna istinaden gerekletirilen dzenli bir deme olmas. \n \n \n \n Tek bileen ile kimlik dorulama yaplan bu ilemlerle ilgili olarak gerekletirilen ilemin mteri tarafndan yapldn ispat etme ykmll HHSye ait olur. \n \n \n lem Dorulamada  Tebliin 3 nc maddesinin birinci fkras  bendindeki  ilem bilgisi tanmna uygun olarak aadaki bilgiler ile  Tebliin 3 nc maddesinin birinci fkras hh bendinde  tanmlanan ileme zel retilmi ilem dorulama kodu birlikte kullanlr. \n \n Alc Unvan (Kolas aknda maskeli olarak)  (deme emri balatma hizmeti) \n Tutar (deme emri balatma hizmeti) \n Referans bilgisi (8 karakterden kk ise alann tm deeri, byk ise ilk 4 ve son 4 hanesi) \n \n leme ait yukardaki bilgilerden en az biri deitii zaman  Tebliin 3 nc maddesinin birinci fkras hh bendinde  belirtildii gibi yeni bir ilem dorulama kodu retilecek ekilde ak kurgulanmaldr. \n \n \n lem dorulama kodunun gnderilmesinden HHS sorumludur. HHS,  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre ilem dorulama kodu kullanmakszn HKnn onayn alabilir. lem dorulama kodu kullanlmayan ilemlerle ilgili olarak gerekletirilen ilemin HK tarafndan yapldn ispat etme ykmll HHSye aittir. \n \n \n HVPS API lke ve Kurallar kapsamnda iki adet Gl Kimlik Dorulama (GKD) yntemi kullanlacaktr: \n \n Ynlendirmeli (Redirect) GKD Yntemi \n Ayrk (Decoupled) GKD Yntemi \n \n \n \n HHS asgari olarak tarayc tabanl Ynlendirmeli GKD yntemini desteklemek zorundadr. Hem web hem mobil uygulama hizmeti bulunan katlmclar iin her iki uygulama zelinde de ynlendirme yaplmas zorunludur. Web ya da mobil uygulamalardan sadece birinin olmas durumunda ilgili uygulama zelinde ynlendirme yaplmas zorunludur. \n \n \n HHSnin mobil uygulamasnn bulunmas durumunda tarayc tabanl ynlendirmenin yannda uygulama tabanl ynlendirme yapmas zorunludur. Uygulama sahiplerinin uygulama tabanl ynlendirme iin uyumlanma son tarihleri 1 Ekim 2023tr. \n 5.1.\tYnlendirmeli Gl Kimlik Dorulama \n Ynlendirmeli GKD Ynteminde, mteri kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir. \n Mteri HHSye (app veya web arayz vastasyla) ynlendirildikten sonra mterinin gl kimlik dorulamas adm adm ve dorudan HHS ile mteri arasnda yrtlr. GKDnin tamamlanmasndan sonra mteri tekrar YS uygulamasna ynlendirilir. \n Ynlendirmeli GKD Yntemi iin st dzey rnek i ak aadaki admlardan oluur: \n \n YS, GKD iin HHS tarafndan tanmlanan arayze (tarayc ya da uygulama) ynlendirme yapar. \n Mteri, YS arayznden ayrlr, ynlendirildii HHS arayz zerinde kimlik dorulama ilemlerini gerekletirir. \n GKD tamamlandktan sonra mteri, YS arayzne tekrar ynlendirilir ve ilem sonucu grntlenir. \n \n Ynlendirmeli GKD iin temel gereklilikler unlardr: \n \n deme hizmeti (hesap bilgisi veya deme emri balatma hizmeti) tarayc ya da uygulama tabanl bir ekilde sunulabilir. Bu nedenle, YS ve HHSlerin Ynlendirmeli GKD iin asgari olarak tarayc tabanl ynlendirme akn desteklemeleri gerekmektedir. Web ya da mobil uygulamalardan sadece birinin olmas durumunda ilgili uygulama zelinde ynlendirme yaplmas zorunludur. \n \n Tarayc Tabanl Ynlendirme \n Ynlendirmeli GKD Ynteminde; rza isteine baarl yant alndktan sonra, HK, kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir.\nYS, ynlendirme akn kendi sunucusundan karlayaca bir istek ile balatmaldr. YS web arayzndeki bu yap, 302 yant kodu ve yant balndaki Location deeri ile HK taraycsn HHS adresine ynlendirmelidir. Bu sayede GKD, HHS tarafnda balayabilir. \n YS tarafndaki ynlendirme servisi iin rnek response; \n HTTP/1.1 302 Found\nLocation: {{hhsYonAdr}}\n \n HK, HHSye (uygulama veya web arayz vastasyla) ynlendirildikten sonra HK'nin gl kimlik dorulamas HHS ile HK arasnda yrtlr. GKDnin tamamlanmasndan sonra HK tekrar YS uygulamasna ynlendirilir. \n HHS, ynlendirme akn kendi sunucusundan karlayaca bir istek ile balatmaldr. HHS web/app arayzndeki bu yap, HK'nin oturumunu gvenli bir ekilde kapatmaldr. Ardndan 302 yant kodu ve yant balndaki Location deeri ile HK taraycsn YS adresine ynlendirmelidir. \n HTTP/1.1 302 Found\nLocation: {{yosYonAdr}}&rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O\n \n HHSnin web arayzne, \n \n HHSnin mobil uygulamasnn olmad, \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) sunduu mobil cihazda HHS uygulamasnn ykl olmad, \ndurumlarda ynlendirme yaplr. \n \n YSn mobil uygulamas varsa mobil cihazda uygulamadan taraycya, YSn mobil uygulamas yoksa deme hizmetinin sunduu cihazda (Kiisel Bilgisayar veya Mobil Cihaz) tarayc zerinden ynlendirme yaplr. \n Uygulama Tabanl Ynlendirme \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) YSn mobil uygulamas ile kullanyorsa, ayn mobil cihazda HHSnin mobil uygulamasnn yklenmi olmas durumunda, HK dorulamasnn HHS mobil uygulamas tarafndan yaplmas iin uygulama tabanl ynlendirme yaplr. Bylece HK, deme hizmetine eriim iin HHSnin mobil kanalna eriim srasnda kulland dorulama yntemini ile dorulanabilir. \n HHS'nin mobil uygulamas olmas durumunda hhsYonAdr olarak universal link kullanmas gerekmektedir. \n Tablo 5: Ynlendirmeli Gl Kimlik Dorulama Kanallar \n \n \n \n Dorulama Yntemi \n YS Olas Ortam \n HHS Olas Ortam \n \n \n \n \n Tarayc Tabanl Ynlendirme \n Kiisel Bilgisayar (masast, dizst)/Mobil Cihaz \n Kiisel Bilgisayar (masast, dizst) / Mobil Cihaz \n \n \n Uygulama Tabanl Ynlendirme \n Mobil Cihaz \n Mobil Cihaz \n 5.2.\tAyrk Gl Kimlik Dorulama \n Ayrk Gl Kimlik Dorulama, bir kullancnn kimliinin, bir ilem balatldktan sonra ayr bir ekilde doruland ynteme verilen addr. Bu GKD modelinde, kimlik dorulama ilem srecinden \"ayrtrlmtr\". Kullanclar, baka bir arayze ynlendirilmek yerine ( tarayc veya uygulama tabanl ynlendirme gibi), ayr bir kanal zerinden (telefonlarnda bir uygulama bildirimi gibi) ilemi dorulamalar iin bildirim alr.\nKullanc, ilemi tamamen ayr bir cihaz veya uygulama kullanarak dorulayabilir. \n lk fazda Ayrk GKD'de QRl modeller kullanlmayacaktr. \n Ayrk GKD uygulamalarnn farkl rnekleri bulunmaktadr. Ancak yaygn olan yaklam, bir web arayz ve bir mobil uygulamann kombinasyonunu kullanmay ierir. \n Mobil uygulamas bulunan HHS'ler iin Ayrk GKD desteklenmesi zorunludur.  HHSnin web olduu durumda Ayrk GKD ak uygulanmayacaktr. Mobil uygulamas bulunup mteri zelinde mobil aktiflik kontrol sreci HHS inisiyatifindedir. Ayrk GKD srecinde HHS tarafnda sadece mobil uygulama zerinden GKD yaplmaldr. HKnn web uygulamasna ynlendirme yapmamas gerekmektedir. \n YS rolnde Ayrk GKD aknn HKya sorularak balatlmasna gerek bulunmamakla beraber bu bilginin HKya sorulmas YS inisiyatifindedir. YS olarak, Ayrk GKD i aklar kapsamnda HKya ayrk GKD ncesi HHS mobil uygulamasnn varl sorularak (bildirim ayarlarnn ak olmas gerektii bilgisi de verilebilir) ilerlenebilir. Ayn zamanda Ayrk GKD ile rza srecinin balatlmas zorunlu deildir. Rza sreci balatlrken yetkilendirme yntemi YS inisiyatifindedir. \n rnek bir ak u ekildedir: \n \n lem Balatma (YS Web/Mobil Arayz):  HK bir ilemi YSn web/mobil arayznde balatr. YS uygulamas, HK'nn tekil bir kullanc kimliini rzaya ekleyerek bir rza balatma ilemini HHSye iletir. HHS, tekil kullanc kimliini kullanarak HK'nn mobil uygulamasna bir bildirim gnderir. \n Kimlik Dorulama stei (HHS Mobil Uygulama):  HK Mobil uygulama bildirimi alr ve mobil uygulama HK'ya  kimlik dorulama istei sunar. HHSnin BDDK tarafndan belirlenmi GKD yntemlerine uygun davranmas beklenmektedir. \n Kimlik Dorulama Onay (HHS Mobil Uygulama):  Mobil uygulama, HKnn kimlik dorulama giriimini dorular. Baarl olursa rza onay sonras mobil uygulama, 'Ayrk Yetkilendirme Baarl' olay bildirimini YSe gnderir. \n lem Onay (YS Web/Mobil Arayz):  YS,  HHS'den gelen 'Ayrk Yetkilendirme Baarl' olay bildirimine konu olan rzay kullanarak yetkilendirme koduna eriir. Bundan sonraki sre eriim belirteci alnmas servisi ile devam eder. \n \n Ayrk Gl Kimlik Dorulamann Olay Bildirim Servisleri ile olan Bamllklar \n Ayrk GKD srecinde; HHS'nin yetkilendirme kodunu YS'e iletmesi iin gerekli nkoul olan HK dorulamas admnn tamamlanmasn olay bildirimi ile YS'e yapmas gerekmektedir.\nBu nedenle YS'lerin eer Ayrk GKD srecini destekleyecek ise;  /olay-dinleme endpointini aarak olay bildirimi almas zorunludur. \n zetle: \n Ynlendirmeli GKD \n \n HHS mobil uygulamas olmas durumunda ynlendirme adresi olarak universalLink kullanmal. \n Bu link tanm  uygulama var ise uygulamay a yoksa webden devam et eklinde olmal. \n YSn mobilden mi webden mi geldii HHS asndan nemli deildir. HHS olarak YS hangi adresi yonAdr deerinde gndermi ise yetkilendirme sreci bittiinde o adrese ynlendirme yaplmaldr. \n \n Ayrk GKD \n \n Mobil uygulamas bulunan HHS'ler iin Ayrk GKD desteklenmesi zorunludur. HHSnin web olduu durumda Ayrk GKD ak uygulanmayacaktr. Mobil uygulamas bulunup mteri zelinde mobil aktiflik kontrol sreci HHS inisiyatifindedir. Ayrk GKD srecinde HHS tarafnda sadece mobil uygulama zerinden GKD yaplmaldr. HKnn web uygulamasna ynlendirme yapmamas gerekmektedir. \n HKnin Mobil uygulamasnn olmadn tespit edebildiiniz her durum iin rza oluturma aamasnda TR.OHVPS.Business.CustomerMobileApplicationNotFound hatas dlr. \n HHS, HKnn mobil uygulamasnn bulunmad bilgisine ulaamazsa kendisinin belirleyecei bildirim yntemlerinden biri ile HKye bilgilendirme yapar. Bildirim yntemi SMS ise HKya mobil uygulamasn atracak ekilde adres iletir, Web uygulamay atracak bir link iletilmemelidir. HK bu bildirimi dikkate almazsa/alamazsa veya HKda mobil uygulama yok ise bu durumda rza sre amndan iptal olur. \n HK mevcut bankaclk ilemlerinde bildirimi nasl gnderiyorsanz (rnein: Anlk bildirim gnderildi, alnmad, SMSe dnld gibi.) ayn ekilde bildirim gndererek HKnin uygulama zerinden rzay onaylamas beklenir. Buradaki ak HHSnin dier rnleri iin verdii mteri deneyimi ile paralel olmaldr. \n 5.2.1\tStatik Model \n YS'n HK'y tand ve HK'ya ait tanmlayc bilgileri HHS'ye aktarabildii durumda kullanlmaktadr. Buradaki HK'ya ait tanmlayc bilgiler TCKN, MNO , YKN, PNO, GSM, IBAN olarak belirlenmitir. \n Ak aadaki gibi kurgulanmtr: \n   \n \n \n HK, YS uygulamas zerinde ilem balatr. \n \n \n HK, YS uygulamas ierisinde, farkl bir ortam zerinden HHS dorulamasn gerekletirmek istediini belirtir. HK'y tanma tip ve deerleri YS HK'dan talep edebilecei gibi, YS sisteminde hali hazrda kaytl bilgilerle de ak devam ettirebilir.  \n \n \n HK, YS'n mterisi ve YS uygulamasna login ise tek seferlik deme ak balatamaz. \n \n \n YS tarafndan balatlan tek seferlik bir deme ileminin Ayrk GKD ile onaylanaca durumda;\nYSn ilgili kullancya ait HK Tanm Deer verisinin yannda ileme ait ve ilgili HK ile eletirilmi olan  ve sadece YS ile HKnn bilebilecei bir deerin daha HK tarafndan salanmas ve YS tarafndan kontrol edilerek eleen deme emrinin HHSye iletilmesi gerekmektedir. rnein; bu deer YS tarafnda yaplan tek seferlik deme ilemine ait fatura numaras. \n \n \n YS nyzde HK'dan ald ohkTanimTip ve ohkTanimDeger deerlerini kimlik tr ve kimlik deeri alanlarna atamamaldr. \n \n \n YS, ayrk GKD ile ilem balatabilecei HHS'lerin listesini HHS API'de yer alan \"ayrikGKD\"=\"E\" parametresi ile alabilir. \n \n \n YS, HK bilgileri ile rza oluturur. Rza nesnesi ierisinde yer alan GKD nesnesinde ilgili parametreler aadaki ekilde doldurulur: \n \n \n ohkTanimTip ve ohkTanimDeger parametreleri \nBu metodda; ayrikGkd nesnesi ierisindeki \"ohkTanimTip\" parametresi TR.OHVPS.DataCode.ohkTanimTip sral veri tiplerinden TCKN, MNO , YKN, PNO, GSM, IBAN deerlerinden birini alabilir. ohkTanimDeger parametresi de seilen tipe ait HK'ya ait deeri iermelidir.Rza balatma ak ierisinde kimlik bilgisinin olduu durumlarda; HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr.Kimlik alan iermeyen tek seferlik deme emri aklarnda bu kural geerli deildir. GSM ve IBAN deerleri sadece tek seferlik demelerde kullanlabilir. \n YS'ten ohkTanimTip olarak gelen IBAN bilgisi sadece HK'y tanmak iin kullanlabilir. Tanm tipi IBAN ile balatlan bir ilemde HK, baka bir IBAN ile deme balatabilir. \n Kurumsal mteriler iin kmlkTur ve kmlkVrs alanlar ohkTanimTip ve ohkTanimDeger alanlarnda gnderilmelidir. \n \n \n yetYntm parametresi \nyetYntm parametresi  Ayrk GKD  akn ifade eden \"A\" deerini almaldr.  \n \n \n \n \n rnek bir istek : \nPOST/ohvps/obh/s1.1/odeme-emri-rizasi \n RizaNesnesi \n {\n...\n  \"gkd\": {\n    \"yetYntm\": \"A\",\n     \"ayrikGkd\" :{\n         \"ohkTanimTip\" : \"TCKN\" \n         \"ohkTanimDeger\": \"11232123212\"\n     }    \n  },\n...\n}\n \n \n \n YS, ayrk GKD ile ilem balatabilecei HHS'lerin listesini HHS API'de yer alan \"ayrikGKD\"=\"E\" parametresi ile alabilir.\nYS, ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.DecoupledAuthenticationNotSupported  hatas iletilmelidir. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n \n \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda hata mesaj vermelidir. HHS tarafndan  TR.OHVPS.Business.CustomerMobileApplicationNotFound  hatas iletilmelidir. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. HHS, HKnn mobil uygulamasnn bulunmad bilgisine ulaamazsa kendisinin belirleyecei bildirim yntemlerinden biri ile HKye bilgilendirme yapar. Bildirim yntemi SMS ise HKya mobil uygulamasn atracak ekilde adres iletir, Web uygulamay atracak bir link iletilmemelidir. \n \n \n HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  TR.OHVPS.Business.EventSubscriptionNotFound  hata kodu iletilmelidir. \n \n \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir.   \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hata kodu iletilmelidir. \n \n \n Rza balatma ak ierisinde kimlik bilgisinin olduu durumlarda; HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  TR.OHVPS.Business.CustomerInfoMismatch  hatas iletilmelidir.\nKimlik alan iermeyen tek seferlik deme emri aklarnda bu kural geerli deildir. GSM ve IBAN deerleri sadece tek seferlik demelerde kullanlabilir. \n \n \n Tek seferlik deme ilemlerinde \"ohkTanimTip\" = \"GSM\"/\"IBAN\" olarak gnderilmi ise, HHS sisteminde bu GSM/IBAN ile eleen mterileri taramaldr. GSM/IBAN bilgisi HK baznda tekil bir kullancya eriim imkan salamaz ise  TR.OHVPS.Business.InvalidCustomerInfo  hatasn iletmelidir. \n \n \n Kontrollerin baarl olmas durumunda HHS rzay oluturur ve HK tekil verisi ile ulat HK'ya bilgilendirme mesaj gnderir.      Bilgilendirme mesaj ksa mesaj ya da anlk bildirim mesaj olabilir. HKnn birden fazla cihazda aktivasyonu varsa HHSnin i srelerine gre mevcut durumda nasl bir bildirim sreci iletiliyorsa ayn ekilde ilerlenebilir.  \n \n \n Kurumsal mteriler iin, hangi kullacya bildirim gitmesi isteniyor ise, rza aamasnda o kii ayrikGkd nesnesinde gnderilir. HHS'nin rza ierisindeki ohkTur deerine gre,  gelen bildirime verilen cevaba uygun uygulamasn amaldr. Kurumsal HK iin rza geldi ise, kurumsal giri sayfas; bireysel HK iin rza geldi ise bireysel giri sayfas mterinin nne almaldr ve ilgili hesaplara eriime izin vermelidir. \n \n \n HK'ya bir bildirim gelmemesi durumunda, HHS kendi sisteminde GKD srecine devam edemez. 5 dakika sonunda rza durumu Yetki Bekleniyor'dan Rza ptal / Sre Am (ptal kod 04) durumuna eker. \n \n \n \n \n HK, HHS sisteminden gelen bildirim mesajn alr. HHS sistemine login olduktan sonra ileme onay verilmezse veya GKD kontrolleri baarsz olursa HHS Olay Bildirim servisleri aracl ile GKD srecinin sonlandn YS'e iletir. Olay tipi \"AYRIK_GKD_BASARISIZ\" olacak ekilde bir POST /olay-dinleme servis ars yaplr.YS kendisine gelen olay bildirimi ile\nrza sorgulamas yaparak iptal detay kodunu renebilir. \n \n \n HK, HHS sisteminde login olduktan sonra ileme onay verirse; HHS tarafndan rza ile ilikili yetkod deeri retilir.HHS, YS'e HK iin \"yetkod\" deeri retildiinin bilgisini Olay Bildirim servisleri aracl ile iletir. Olay tipi \"AYRIK_GKD_BASARILI\" olacak ekilde bir POST /olay-dinleme servis ars yaplr. \n \n \n YS kendisine gelen olay bildirimi ile \"yetkod\" deerinin HHS'de retildiinin bilgisini alr. \"yetkod\" deerini renebilmek iin HHS'yi sorgulamas gerekmektedir.  \nHHS'nin aaca   GET /yetkilendirme-kodu endpointi   ile bu bilgiye eriebilir. \n \n \n YS, \"yetkod\" ile POST /erisim-belirteci endpointinden eriim belirteci alr. Bylelikle HK'nn Ayrk GKD sreci tamamlanm olur. \n 5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi \n CSRF Ataklarndan korunmak iin ve YS uygulamasnn bir nceki durumunu restore edebilmesi iin; YS tarafndan iletilen ynlendirme ve bildirim adreslerine , Oauth2 standartlarndaki state parametresine edeer,   durum kodu (drmKod)  parametresinin eklenmesi gerekmektedir. Durum kodu parametresi YS tarafndan retilen, tekil ve kolay tahmin edilemeyen bir deer olmaldr. Rza istei gnderimi aamasnda oluturulmaldr. YS uygulamasnda uygun bir yerde saklanmaldr (cookie, session, local storage gibi) . \n Durum kodu, rza isteindeki ynlendirme adresine parametre olarak eklenir.  GKD sreci sonrasnda yetki kodu ile birlikte bu bilgi, HHS tarafndan YSe iletilir. YS saklad deer ile parametre olarak gelen deerin eitliini kontrol eder. Ayn ise eriim belirteci almak zere ak ilerletir. Farkl ise ilemi keser. \n 5.4  Gl Kimlik Dorulama Kontrolleri \n HK, GKD iin HHS uygulamasna ynlendirildiinde, HHSnin eitli kontroller yaparak ilemin doruluunu teyit etmesi gerekmektedir.\nYaplmas gereken kontrollere ait temel senaryolar aadaki tabloda belirtilmitir. Bu senaryolar baz alnarak HHSler tarafndan zenginletirilebilir. \n Aadaki tabloda yer alan 07-13 aras Rza ptal Detay Kodlarnn olutuu senaryolar, HHS uygulamasnda yaplan kullanc dorulama ncesi ve sonras olarak iki admda incelenmelidir. \n HHS tarafnda, kullanc dorulama ncesinde yaplan kontroller neticesinde verilemeyen rzalar iin 04 : Sre Am : Yetki Bekleniyor iptal kodu atanr. HHS'nin YS uygulamasna 04 kodunu iletmesi beklenmez. YS zaman am neticesinde rza statsn sorgulayarak renir. \nKullanc dorulandktan sonra rza verilemiyorsa ilgili hata kodunun YS'e iletilmesi beklenmektedir. Kullanc dorulama sonras YS'e iletilen rza iptal detay kodu ile HHS veri modelinde tutulan rza ile ilikili rza iptal detay kodu, ayn deeri alacak ekilde gncellenmelidir. YS, HHS tarafndan kendine iletilen rza iptal detay kodunu kendi veri modelinde gncellemelidir. \n Zorunlu olarak belirtilen hata durumlarnn HHSler tarafndan gereklenmesi ve uygun hata kodlarnn YSe iletilmesi; ileride oluabilecek mutabakatlama sorunlarn ortadan kaldrabilecek, yaplacak raporlamalar kapsamnda sistem ve sre iyiletirmelerine katk salayacak, son kullanc asndan da alnan hataya ynelik bilgilendirici ierik salayacaktr. \n Hata aklamalar; hata koduna uygun ya da uyumlu olmak kaydyla, HHS ve YS tarafndan farkl ekillerde sunulabilir. \n GKD Srasnda yaplmas gereken kontroller \n \n \n \n Rza ptal Detay Kodu \n HHS hata aklamas* \n Ys ekrannda listelenecek rnek mesaj metni* \n rnek Senaryo \n Zorunlu / Opsiyonel \n \n \n \n \n 07 \n Rza mevcut ve durumu \"Yetkilendirildi\" veya \"Yetki Kullanld\" \n Yetki Hatas \n HK,  kullanc dorulama ilemi tamamlandktan sonra  YS ekrannda ileri - geri yaparak ya da HK'nn ynlendirme adresini kopyalayarak taraycya yaptrmas ile tekrar HHS'ye ynlendirir. Bu durumda HHS bu rza iptal detay kodunu iletir. HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 08 \n Rzano ile kimlik bilgileri uyumazl. \n lem gerekletirilememitir. \n YS tarafndan balatlan rza ierisinde yer alan kimlik bilgisi (rn:TCKN) ile HHS'de baarl kimlik dorulama yaplan HK'nn bilgilerinin uyumad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 09 \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) \n Gsterilebilecek hesap/kart bulunamamtr. \n HHS, kullanc dorulama yaptktan sonra, HK'nn uygun statl hesabnn olmad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 10 \n HK'nn Ak Bankaclk kanal ileme kapal \n HK'nn Ak Bankaclk kanal ileme kapal \n Ak bankacl ayr bir kanal olarak tanmlam HHS'lerde,  HK kullanc dorulama yaptktan sonra yaplan kontrollerde, HK'nn ilemlerini AB kanalna kapatm olmas durumunda   HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 11 \n HK'nn HHS'deki hesaplarnda yeterli yetkisinin olmamas \n Yetki hatas \n 1- Kurumsal firma kullanclarnn hesaplar zerinde ilem yetkisinin olmamas durumunda   2- Bireysel ortak hesaplarda hesap kst bulunuyorsa (para kna izin verilmedii durum)  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 12 \n HHSnin,  HK zelinde yapt kontrollerin baarsz olmas \n Yetki hatas \n HHS'nin, kullanc dorulama sonras HK iin i sistemlerinde yapt kontrollerin baarsz olmas. rnein: Mterinin henz bankaclk hizmet szlemesi gibi Internet ubesi zerinde ilem yapmasn engelleyen eksikleri olmas durumunda veya kurumsal kullancda vekalet sresinin dolmas/eksik dokman olmas durumunda kanal zerinde ilem yapamad durum  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 13 \n HK istei ile GKDden vazgeilmesi \n Mteri ilemden vazgemitir. \n HHS ekrannda yer alan VAZGE butonuna baslmas durumu (HK,HHS uygulamasnda kullanc dorulama yaptktan sonra VAZGE butonu olabilir.) \n Zorunlu \n \n \n 14 \n GKD ptali: Fraud phesi \n lem gerekletirilememitir. \n HHS Fraud phesi nedeniyle ilemin devamna izin vermez. HHS'nin, fraud kontrollerinin deme balatma hizmeti iin yapmas ve 14- GKD ptali: Fraud phesi ile rza iptalini gerekletirmelidir. HBH servislerinde HHS'nin rza iptal kodu 14 ile ilemi kesmesi HHS'nin kendi insiyatifindedir yani opsiyoneldir. \n Koullu \n \n \n 99 \n Dier \n lem gerekletirilememitir. \n Oluabilecek dier senaryolar. \n Zorunlu \n \n \n \n GKD srasnda iletilen rza no eer HHSnin sisteminde bulunamazsa durumu gncellenecek bir rza no da olmayacaktr. HHS kendi nyznde bu duruma uygun bir mesaj gsterebilir. YSe de Dier hata kodu ile bu durumu iletebilir. \n"},{title:"7.\tHesap Bilgisi Hizmeti",frontmatter:{},regularPath:"/v1.1.0/contents/hesap-bilgisi-hizmeti.html",relativePath:"v1.1.0/contents/hesap-bilgisi-hizmeti.md",key:"v-553c6446",path:"/v1.1.0/contents/hesap-bilgisi-hizmeti.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Hesap Bilgisi Hizmeti in Eriim Adresleri",slug:"hesap-bilgisi-hizmeti-icin-erisim-adresleri"},{level:2,title:"ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas:",slug:"adim-0-ohk-nn-hesap-bilgilerine-erisim-icin-talepte-bulunmas"},{level:2,title:"7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas",slug:"_7-1-adim-1-hesap-bilgisi-rzasnn-hazrlanmas"},{level:3,title:"POST /hesap-bilgisi-rizasi",slug:"post-hesap-bilgisi-rizasi"},{level:3,title:"Baarl stek:",slug:"basarl-istek"},{level:3,title:"Baarl Yant:",slug:"basarl-yant"},{level:2,title:"zinler",slug:"izinler"},{level:2,title:"7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi",slug:"_7-2-adim-2-hesap-bilgisi-hizmeti-rzasnn-tesisi"},{level:2,title:"7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas",slug:"_7-3-adim-2-1-hesap-bilgisi-rzasnn-sorgulanmas"},{level:2,title:"7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali",slug:"_7-4-adim-2-2-hesap-bilgisi-rzasnn-iptali"},{level:2,title:"7.5 ADIM 3: Hesap Bilgilerinin Alnmas",slug:"_7-5-adim-3-hesap-bilgilerinin-alnmas"},{level:2,title:"7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas",slug:"_7-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanmas"},{level:2,title:"7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas",slug:"_7-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanmas"},{level:2,title:"7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas",slug:"_7-8-adim-3-5-ve-3-6-islemlerin-sorgulanmas"}],content:" 7.\tHesap Bilgisi Hizmeti  \n Genel Bilgiler \n Hesap bilgisi sorgulama iin HBHS tarafndan mteri rzas tesisinin HHS tamamlanm olmas gerekir. Mteri rzas tesisi tamamlandktan sonra, HBHS sorgulamak istedii hesaba ait verileri ilgili eriim adresi zerinden sorgular. \n \n \n ekil 10: Hesap Bilgisi Hizmeti st Dzey Ak \n ekil-10da sunulan hesap bilgisi hizmeti 5 temel aktan oluur: \n 0.\tMterinin hesap bilgilerine eriim iin talepte bulunmas:  HK BHS mobil uygulama ya da web sitesinden hesap bilgilerine eriim ilemini balatr. \n 1.\tHesap Bilgisi mteri rzasnn hazrlanmas: \n HBHS, hesap bilgilerine eriim iin mteri rzas tesisi amacyla HHSdeki hesap bilgisi rzas eriim adresine bir POST isteinde bulunur ve bir hesap bilgisi rzas nesnesi oluturur. HHS hesap bilgisi rzas nesnesi iin biricik tanmlayac dner (RzaNo). Hesap bilgisi rzas, mterinin HBHSnin hesap bilgilerine eriim izin verdii alanlar ierir: \n \n zinler - eriim iin izin verilen veri kmelerinin listesi. \n Eriimin Geerli Olduu Son Tarih - HBHS'nin mterinin hesap bilgilerine eriebilecei istee bal seilebilen son tarih. \n lem Sorgulama Balang Zaman  Mteri rzasnn tesisinden itibaren geriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n lem Sorgulama Biti Zaman - Mteri rzasnn tesisinden itibaren ileriye dnk olarak HBHSnin hesap bilgilerine eriebilecei sreyi \n \n 2.\tHesap bilgisi hizmeti mteri rzasnn tesisi: \n HHS, Hesap Bilgisi Rzas servisi ile HK zelinde Yetki bekleniyor statsnde bir rza nesnesi hazrlar. HHS, GKDnin baaryla tamamlanmas sonrasnda hesap bilgisi rzas nesnesinin yetkilendirildiini belirtmek iin Rza Durumunu Rza Yetkilendirildi olarak gnceller. Nesne yetkilendirildikten sonra HHS nesne ile bir eriim belirteci (access token) ilikilendirir, Rza Durumunu Yetki Kullanld yapar ve bu belirteci HBHSye geri dner.  Bylece mteri rza tesisi salanm olur. \n Hesap bilgisi iin mteri rzasna ilikin temel ilkeler unlardr: \n \n 1 HK'nn 1 YS iin 1HHS'de Yetki Bekleniyor, Yetkilendirildi, Yetki Kullanld statsnde 1 rzas olabilir. \n Mteri rzasnn ayrntlar HK ile HBHS arasnda belirlenir. Bu nedenle mteri rzasnn ayrntlar HHS ekrannda deitirilmemelidir. \n HK, hesap eriim izni ayrntlarn yalnzca bir btn olarak yetkilendirebilir veya geri alabilir. \n Mteri rzas tesisi esnasnda, mteri HHS arayznde eriim iin yetkilendirecek hesaplar seer. \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN hizmeti sunmayabildikleri iin hesap referans ile aklarn kurgulayabilirler. YS nyzlerinde yaplan bilgilendirmelerde, IBAN harici hesap referans ile ilem yaplabilmesine dikkat edilmelidir. \n \n 2.1\tHesap bilgisi rzasnn sorgulanmas:  Mteri rzas  GET/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak sorgulanr. \n 2.2\tHesap bilgisi mteri rzasnn iptali:  Mteri rzas  DELETE/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak iptal edilir. \n 3.\tHesap bilgilerinin alnmas:  Hesap bilgileri ilgili kaynaa (hesaplar, bakiye, ilemler) GET istei yaplarak gerekletirilir. HBHS, mteri rzasnn tesisinden sonrasnda (geerli bir eriim belirticine sahip olduunda) ncelikle  GET/hesaplar  ars yapacaktr. \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular) mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin HBH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini (nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n Hesap Bilgisi Hizmeti in Eriim Adresleri \n Etki Alan (Scope) =hesap_bilgisi \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n hesap-bilgisi-rizasi \n POST \n /hesap-bilgisi-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n HesapBilgisiRizasiIstegi \n HesapBilgisiRizasi \n \n \n 2 \n erisim-belirteci  (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n HesapBilgisiRizasi \n \n \n 2.2 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n \n \n \n \n \n \n 3.1 \n hesaplar \n GET \n /hesaplar \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n HesapBilgileri(birden ok hesap) \n \n \n 3.2 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n HesapBilgileri(tek  hesap) \n \n \n 3.3 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n BakiyeBilgileri(tek  hesap) \n \n \n 3.4 \n bakiye \n GET \n /bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n BakiyeBilgileri(birden ok hesap) \n \n \n 3.5 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n IslemBilgileri (tek hesap) \n \n \n \n Tablo 11: Hesap Bilgisi Hizmeti in Eriim Adresleri \n ADIM 0: HK'nn hesap bilgilerine eriim iin talepte bulunmas: \n HK, HBHS uygulamasnda (web arayz/mobil uygulama) hesap bilgilerine eriim iin talepte bulunur. \n 7.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas \n Bu API ars HBHS'nin HHS'de yeni bir HesapBilgisiRizasi nesnesi oluturmasn ve nesneye erimek iin benzersiz bir rza numaras ({RizaNo}) dnlmesini salar. \n API arsnn baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas yeterlidir.\nBaaryla oluturulan hesap bilgisi rza kaynann rza durumu Yetki Bekleniyor olarak dzenlenir.\nHK daha nce ald rzaya ilikin eriim tarihleri, izin trlerini ve hesap bilgilerini gncellemek isterse, HBHS nce HHS nezdindeki rzay iptal etmeli ve sonrasnda yeni bir rza talebinde bulunmaldr.\n \n \n ekil 11: Hesap Bilgisi Mteri Rzasnn Hazrlanmas \n \n \n Srm 1.1.0 iin POST /hesap-bilgisi-rizasi isteinde 06- Anlk Bakiye Bildirimi izin tr iin YSn BAKYE kaynak tipinde olay abonelik kaydnn olmas gerekmektedir. BAKYE kaynak tipinde olay abonelik kayd olmayan YS kurumu ; srm 1.1.0 iin 06 izin trn kapsayan Hesap Bilgisi Rzas istei gnderdiinde HHS tarafndan  TR.OHVPS.Business.EventSubscriptionNotFound  hatas verilmeli ve rza oluturulmamaldr. \n \n \n POST /hesap-bilgisi-rizasi isteinin (REQUEST) gvdesinde (BODY)  HesapBilgisiRizasIstegi nesnesi (Tablo-12) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda HesapBilgisiRizasi (Tablo-13) nesnesi oluturulur. \n  POST /hesap-bilgisi-rizasi \n Baarl stek: \n STEK: \n HBHS, bu API eriim adresinden HHSye yeni bir HesapBilgisiRizasi oluturulmas iin istekte bulunur: \n \n HBHS, HKnn hesap bilgilerine ynelik rza balatma istei olduunu HHSye bildirir. \n HBHS, HKnn, HBHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk ve uzunluk kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan HBHS bilgilerinin ierisinde yer alan ynlendirme adresleri ile hesap bilgisi rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde iletilen kimlik bilgileri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Zorunlu) \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlar ile ilgili Tablo 12de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, benzersiz RizaNo ile HesapBilgisiRizasi nesnesi oluturur ve HBHSye dner. \n HHS, HesapBilgisiRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n \n Eriimin Geerli Olduu Son Tarih, lem Sorgulama Balang Zaman, lem Sorgulama Biti Zaman alanlarnda zaman aralklar mteri deneyimi penceresinden deerlendirilerek ay cinsinden belirtilmitir. Bu konuda aadaki gibi oluabilecek u rneklere dikkat edilmesi gerekmektedir. \n Yeni gnn balang saatinin 00:00:00 olduu kabul edilmitir. \n Bugn : 31.08.2019 \nBugn + 6 Ay : 01.03.2020 00:00:00 (29.02.2020 tm gn dahildir.) \nBugn : 30.08.2020 \nBugn + 6 Ay : 01.03.2020 00:00:00 (28.02.2021 tm gn dahildir.) \nBugn : 30.09.2022 \nBugn + 3 Ay : 01.01.2023 00:00:00 (30.12.2022 tm gn dahildir.) \nBugn : 14.07.2022 \nBugn + 3 Ay : 15.10.2022 00:00:00 (14.10.2022 tm gn dahildir.) \n Tablo 12: HesapBilgisiRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Hata durumunda TR.OHVPS.Connection.InvalidASPSP hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda TR.OHVPS.Connection.InvalidTPP hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr.   Yetkilendirme yntemi, HBHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.   Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.OHKTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr.   TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n \n >zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih.   Mteri YS ekranndan bu deeri belirleyebilir.   Varsaylan deer : Rza verilen tarih + 6 ay   Alabilecei maksimum deer : Rza tarihi + 6 ay    Alabilecei minimum deer : Rza tarihi + 1 gn    rnein  04/02/2023de minimum 05/02/2023 seilebilir. Bu durumda yeni gnn balang saati 00:00:00 olduu kabul edildii iin; erisimIzniSonTrh deeri 2023-02-06T00:00:00+03:00 olmaldr.  HHS rza onay ekranlarnda YS'ten iletilen eriim izni son tarihi yeni gnn balang saati olarak iletildiinden HK'ya gsterilecek tarih eriim izninin bitecei gn olarak gsterilmelidir.  rnee istinaden; HK YSde 05/02/2023 semi ise HHS rza onay ekrannda 06/02/2023 grmemeli, bu iki tarihin ayn, yani 05/02/2023 olacak ekilde gsterilmesi gerekmektedir.      rnek rza olu zaman  : 2023-02-04T21:20:20+03:00    1 gnlk rza verildiinde erisimIzniSonTrh deeri:    2023-02-06T00:00:00+03:00 (26 saat 40 sakikalk rza vermi oluyor.)    7 gnlk rza verildiinde erisimIzniSonTrh deeri:  2023-02-12T00:00:00+03:00    1 aylk rza verildiinde erisimIzniSonTrh deeri :   2023-03-05-T00:00:00+03:00 \n Bu alanda bir deer bulunmad durumda HHS hata dnmelidir. \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gemie dnk en fazla 12 ay olabilir, daha eski olmamas gerekir.   Varsaylan deeri rza verilen tarih (ilem zaman)  12 aydr.   HK bu alana bir deer girii salam ise zaman bilgisi retilirken ekrandan girilen tarihe 00:00:00 zaman bilgisi eklenmelidir. HK deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.   Minimum tarihi : Rzann verili tarihi  - 12 ay    Maksimum tarih: Rzann verili tarihi +  12 ay    zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve  lem Sorgulama Balang Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gelecee dnk en fazla 12 ay sonras olabilir, daha ileri bir tarih olmamas gerekir.   Varsaylan deeri: Rza verilen tarih + 12 aydr. HK bu alana bir deer girii salam ise girdii tarihe 1 gn eklenir ve yeni gnn ilk saati kabul edilen 00:00:00 saat bilgisini ekler.  HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.  Minimum tarihi : Rzann verili tarihi   12 ay  Maksimum tarihi :  Rzann verili tarihi + 12 ay   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. Eer dolu gnderilirse HHS tarafndan uygun hata mesaj iletilmelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve lem Sorgulama Biti Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez.   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n Baarl Yant: \n Tablo 13: HesapBilgisiRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu sral veri tipini deerlerinden birini alr. rn; hesap bilgi rzasnn tesisine dair ilk istek mesajna dnte B: Yetki Bekleniyor deerini almas beklenir. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir. \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir.  TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde\tGKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.  HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir. Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Hesap Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n > zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HBHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei balang zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei biti zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n > Ayrnt Bilgi \n ayrBlg \n Kompleks: AyrintiBilgi \n  \n \n \n \n > HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n zinler \n Bir hesap bilgisi mteri rzas kayna arsna yant olarak dndrlen verileri snrlamak iin izin kodlar kullanlr: \n \n Temel Hesap Bilgisi \n Ayrntl Hesap Bilgisi \n Bakiye Bilgisi \n Temel lem (Hesap Hareketleri) Bilgisi \n Ayrntl lem Bilgisi \n Anlk Bakiye Bildirimi \n \n HKya sunulacak seimler ve kurallar aadaki gibi olmaldr. \n \n \n \n Seim \n Kural \n \n \n \n \n Temel Hesap Bilgisi \n HK seimine sunulmamaldr. Deitirilemez ekilde seili gsterilmelidir. \n \n \n Ayrntl Hesap Bilgisi \n HK seim yapabilir. \n \n \n Bakiye Bilgisi \n HK seim yapabilir. \n \n \n Temel lem (Hesap Hareketleri)  Bilgisi \n HK seim yapabilir. \n \n \n Ayrntl lem Bilgisi \n HK seim yapabilir. Ayrntl lem Bilgisi seimi Temel lem Bilgisi seimini kapsar. (Ayrntl lem bilgisi seildiinde Temel lem Bilgisi de seili olmaldr.) \n \n \n Anlk Bakiye Bildirimi \n Bakiye Bilgisi izin tr ile birlikte seilmesi gereklidir. HK, HHS'de olacak bakiye deiikliklerinden anlk haberdar olmak istiyor ise bu izin tr seimi ile rza balatmas gereklidir. \n \n \n \n Aadaki durumlarda, izin kombinasyonlarna izin verilmez. HHS, bu hesap eriim onaylarn 400 (Hatal stek) yant koduyla reddetmelidir: \n \n zin dizisinin herhangi bir izin tr iermemesi durumu, \n zin dizisinde HHS tarafndan desteklenmeyen bir izin kodunun yer almas durumu \n 7.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi \n \n \n ekil 12: Hesap Bilgisi HK Rzasnn Tesisi \n Rza tesisinin baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas ve ardndan mterinin HHS tarafndan ynlendirmeli veya ayrk GKD ile dorulanmas gerekir. HHS'de oluturulan ve rza durumu Yetki Bekleniyor olan bir hesap bilgisi rzas, GKD sonras Yetkilendirildi statsne gncellenir. HBHS, eriim salayaca hesaplar hesap bilgisi rzasnn tesisinden nce seer. \n \n \n Ynlendirmeli dorulama aknda, HBHS HKy HHSye ynlendirir. \n \n \n HBHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n \n \n HHS, HK iin GKD srecini iletir. \n HKy dorularsa, \n \n \n HK HBHS zerinden ilem yaplmasna izin verecei hesap seimini, hesap numaras ya da hesap referans bilgisi ile yapar. HBHS zerinden HKnn verdii izin bilgilerini ve eriim izninin biti tarihi bilgilerini, HHS bilgilendirme amal HKya gsterir. \n \n \n HHS hesap bilgisiri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n HHS, HKy olumlu ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=H&drmKod=zzz\n \n \n \n HKy dorulayamazsa, \n \n \n HHS, hesap bilgisi rza kaynann durumunu Yetki ptal olarak gnceller. \n \n \n HHS, HKy olumsuz ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I &rizaNo=yy&rizaTip=H&rizaIptDtyKod=11&drmKod=zzz\n \n \n \n \n \n \n \n Ayrk dorulama aknda, HHS, HKnn hesap bilgisi hizmetini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister. \n \n Ayrk ak HBHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek hesap bilgisi rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, deme hizmeti kullancsn dorular. \n HK verdii izin tipi dahilinde bilgileri paylalacak olan hesaplar seer. \n HHS, hesap bilgisi rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS,  hesap bilgisi rzasnn durumunu Yetki Kullanld olarak gnceller. Rza tesisi salanm olur. \n 7.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HK, HHS zerinden rza iptali yapm olabilir veya HKnn verdii rza sresi dolmu olabilir.  Bu durumlarda HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir HesapBilgisiRizasi kaynann durumunu, istee bal olarak alabilir. \n Servis baarl yantnda Tablo 13de belirtilen HesapBilgisiRizasi nesnesini dnmektedir. \n Durum \nHesapBilgisiRizasi kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n \n Yetki Bekleniyor \n \n \n Yetkilendirildi \n \n \n Yetki Kullanld \n \n \n Yetki Sonlandrld \n \n \n Yetki ptal \n \n \n Hesap bilgisi rzas sonlandrld ve iptal statsnde olan rza'larn gncellenme zamanndan(gnclZmn) 6 ay sonrasna kadar sorgulanabilir olmas beklenmektedir. HHS'ler ilgili sre sonrasnda yaplacak rza sorgularna TR.OHVPS.Resource.NotFound uyars verebilir. YS'ler tarafndan iptal ve sonlandrld statsnde olan rzalar iin sorgulama yapmamaldr. \n 7.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali \n \n \n \n ekil 13: Hesap Bilgisi Mteri Rzasnn Geri Alnmas \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \n DELETE /hesap-bilgisi-rizasi ars, bir HBHS'nin nceden oluturulmu bir hesap eriim rzasn (yetkili olsun veya olmasn) silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, HBHS zerinden bu rzasn kaldrmak isteyebilir. \nBu API ars, mterinin HBHS zerinden hesap bilgisi rzasn iptal etmesine ve HHS nezdindeki hesap bilgisi rzas nesnesinin silinmesini salar. \nMterinin HBHSnin veri eriim iznini iptal etmesi durumunda HBHS, HHSde mevcut olan HesapBilgisiRizasi kaynan pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \nars aracl ile yerine getirilir. HBHS ayrca, sisteminden Hesap Eriim zni kaynaklarn da temizlemelidir. \nSz konusu silme ilemi, kaytlarn statsnn pasife ekilmesi ile gerekletirilmelidir. Sz konusu kaytlar, denetim izlerinin oluturulmas ve saklanmasna ilikin ikincil dzenleme hkmleri kapsamnda gvenli ekilde tutulmaldr. \nServis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr. \nHK rzas baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal olarak gncellenir ve gnclZmn zaman damgas vurularak gncellenir. \nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir: \nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (HBHS) \n 7.5 ADIM 3: Hesap Bilgilerinin Alnmas \n    \n \n   \n ekil 14: Hesap Bilgilerinin Alnmas \n STEK: \nMteri rzas tesis edilmi kullanc iin HBHS API eriim adresinden HHSye eriilebilir hesap bilgilerini GET istei ile sorgular: \n \n RizaDurumu Yetki Kullanld ise ileme balanr. RizaDurumu farkl bir deerde ise TR.OHVPS.Resource.ConsentMismatch hatasnn iletilmesi gerekir. \n GET verisinin modele gre kontrol yaplr (rnein: Alan kontrolleri) \n \n GET verisinin mantksal kontrolleri yaplr. \n \n \n Hesap bilgisi rzas alnm ve eriim izni devam eden hesaplar ierisinden herhangi bir hesabn kapatlmas ya da pasife alnmas durumunda YS tarafndan yaplan hesap isteine HHS tarafndan hesap bilgisi dnlmelidir. \n \n \n Kapal hesap iin TR.OHVPS.DataCode.HspDrm veri trnden KAPALI deeri ile, pasif hesap iin TR.OHVPS.DataCode.HspDrm veri trnden PASIF deeri ile dnlmelidir. \n 7.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas \n GET /hesaplar ve GET /hesaplar/{hspRef} \n Bu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bilgilerinin sorgulanr. Hesap bilgisi iin daha nce tanmlanm izin trne gre (Temel Hesap Bilgisi veya Detayl Hesap Bilgisi) yantnda dnlen HesapBilgileri nesnesinin ierii deiir.  Tablo 15te HesapBilgileri nesnesinin ierii verilmitir. \n Hesap Bilgisi Sorgu rnei (Tm Hesaplar) =  /hesaplar \nHesap Bilgisi Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef} \nlem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 14: Hesap Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numaras \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 15: HesapBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzas nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Hesap Temel \n hspTml \n Kompleks: HesapTemel \n Z \n Temel Hesap Bilgileri (Temel Hesap Bilgisi varsaylan izin tr olduundan Hesap Temel nesnesi zorunlu olarak yantta bulunur) \n \n \n > Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n > Hesap Numaras \n hspNo \n AN26 \n K \n Eer varsa deme hesabna ait IBAN bilgisi \n \n \n > Hesap Sahibi Unvan \n hspShb \n AN3..140 \n Z \n Hesap sahibi ya da hesap sahiplerinin ad-soyad, ticari unvan \n \n \n > ube Ad \n subeAdi \n AN3..50 \n K \n Eer varsa deme hesabnn bal olduu ubenin ad \n \n \n > Ksa Ad \n kisaAd \n AN3..50 \n K \n Eer hesap sahibi hesaba ait bir ad tanmladysa, tanmlanan hesap ad \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi. \n \n \n > Hesap Tr \n hspTur \n AN1 \n Z \n Hesabn tr (bireysel veya ticari). TR.OHVPS.DataCode.HspTur srali veri deerlerinden birini alr. \n \n \n > Hesap Tipi \n hspTip \n AN1..32 \n Z \n Hesabn tipi (VADESZ, KREDL vb.).TR.OHVPS.DataCode.HspTip sral veri deerlerinden birini alr. \n \n \n >Hesap rn Ad \n hspUrunAdi \n AN1..140 \n  \n HHS tarafndan atanm olan rn ad bilgisidir. HBHS tarafndan HKya gsterilmesi kullanm kolayl salayacaktr. \n \n \n > Hesap Durumu \n hspDrm \n AN5..50 \n Z \n Hesabn durumunu belirtir. TR.OHVPS.DataCode.HspDrm sral veri trlerinden birini alr. \n \n \n Hesap Detay \n hspDty \n Kompleks: HesapDetay \n K \n Detay Hesap Bilgileri (Temel Hesap Bilgisine ek olarak Detay Hesap Bilgisi izin tr de seilmise Hesap Detay nesnesi koullu olarak yantta bulunur) \n \n \n > Al Tarihi \n hspAclsTrh \n ISODateTime \n Z \n Belirtilen hesabn al tarihi. \n 7.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas \n GET /bakiye ve GET /hesaplar/{hspRef}/bakiye \nBu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bakiyesi sorgulanr. \nstek arsna dnlen BakiyeBilgileri nesnesi Tablo 17de verilmitir. \n Hesap Bilgisi Rzas alnm ve eriim izni devam eden hesaplar ierisinde yer alan hesaplardan kapatlm ya da pasif duruma alnm olan hesaplar iin bakiye istei yapldnda HHS tarafndan bakiye bilgisi dnlmelidir. \n Hesap bakiyelerinin gsterilmesi srasnda aada verilen rnekler gznnde bulundurulmaldr. \n rnek 1 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  -1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 2 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  2000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 3 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 4 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  3000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n lem Sorgu rnei (Belirli Bir Hesap)=  /bakiye?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 16: BakiyeBilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 17: BakiyeBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n Bakiye \n bky \n Kompleks:Bakiye \n Z \n \n \n \n > Hesap Bakiye Tutar \n bkyTtr \n AN1..25 \n Z \n Hesabn bakiyesi. Bloke tutar dlmeden iletilmelidir.   Tutar alan regex patterni u ekildedir:  '^-?\\d{1,18}$|^-?\\d{1,18}\\.\\d{1,5}$' \n \n \n > Blokeli Tutar \n blkTtr \n AN1..24 \n K \n Varsa hesapta blokeli tutar bilgisi.     Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n > Bakiye letilme Zaman \n bkyZmn \n ISODateTime \n Z \n Bakiyenin iletildii zaman bilgisi. \n \n \n > KrediliHesap \n krdHsp \n Kompleks: KrediliHesap \n K \n \n \n \n >> Kredili Mevduat Hesab Bakiyesi \n kulKrdTtr \n AN1..24 \n Z \n Kredili mevduat tutar. Kredili bir hesap ise zorunlu.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Kredi Dahil Gstergesi \n krdDhlGstr \n AN1 \n Z \n Kredili bir hesap ise zorunlu. Bakiye tutarnn kredi tutar dahil edilerek ya da edilmeden iletildiini gsterir.   0: Kredi tutar dahil edilmeden bakiye bilgisi iletilmesi durumu   1: Kredi tutar dahil edilerek bakiye bilgisi iletilmesi durumu \n 7.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas \n GET /hesaplar/{hspRef}/islemler \n Belirli bir hesaba ilikin ilem bilgileri Tablo 1daki istek parametrelerine gre sorgulanr. \nHesap Bilgisi Rzas alnm ve eriim izni devam eden hesaplar ierisinde yer alan hesaplardan kapatlm ya da pasif duruma alnm olan hesaplar iin ilemler istei yapldnda HHS tarafndan ilemler bilgisi dnlmelidir. \nlem bilgisi iin daha nce tanmlanm izin trne gre yantta dnen IslemBilgileri nesnesinin (Temel lem Bilgisi veya Temel lem Bilgisi ve Detayl lem Bilgisi) ierii deiir. \nlemler servisi hem HKnn talebi ile YS uygulamas zerinden arlabilecei gibi, YSn HKsz balatabilecei otomatik arlar ile de yant dnebilmektedir. \nHHS, ilemin sistemsel yaplp yaplmadn, istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir.\nHKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \nYS, otomatik yapaca sorgularda; \n \n Bireysel HKlar iin hesap baznda gnde en fazla 4 adet baar ile sonulanan sorgulama yapabilir. \n Kurumsal HKlar iin hesap baznda saatte en fazla 12 adet baar ile sonulanan sorgulama yapabilir. \n \n HHS, tutaca saya bilgisi ile bu saylar kontrol ederek daha fazla sorgulama yaplmasna izin vermeyebilir. \n Ayn istek parametreleri ile yaplan sorgu sonucunda dnecek toplam kayt says 100 atnda, sayfalama yntemi ile HHSnin cevap dnmesi beklenmektedir.  Her bir sayfa iin ilemler servisi tekrar arlsa da, bu arm HHSnin tuttuu saya deerini arttrmaz. HHSnin tutaca sayan kontrol parametreleri YS kodu, hesap numaras ya da referans olmaldr. Sayfa no parametresi varsa ve 1'den byk ise ilem sayacn arttrmamaldr. \n HKnn YS uygulamas zerinden tetikledii ilemlerde ise;\nbireysel HKlar  iin en fazla 1 aylk,\nkurumsal HKlar iin ise en fazla 1 haftalk bir pencere aralnda sorgulama yaplabilir. \n YS, otomatik yapaca sorgularda hem bireysel hem de kurumsal HKlar iin 24 saatlik bir pencere aralnda sorgulama yapabilir. \n Yeni gnn balang saatinin 00:00:00 olduu kabul edilmitir. \n Sorgu rnekleri aadaki gibidir:  \n 1 gnlk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-02T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n \n 1 haftalk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-08T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-02-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-03-01T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-01-31T00:00:00+03:00&\nhesapIslemBtsTrh=2020-02-28T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-02-28T00:00:00+03:00&\nhesapIslemBtsTrh=2020-03-28T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 24 saatlik pencerede yapaca sistemsel sorgu rnei (Son sorgusunun zerine 24 saat eklenmesi)  =\n/hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T14:10:08+03:00&\nhesapIslemBtsTrh=2020-06-02T14:10:08+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n nyzden alnan sorgu parametreleri ile oluturulan sorgu rnei (rnek sorgu tarih aral 20.02.2023- 25.02.2023 arasndadr)  =\n/hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2023-02-20T00:00:00+03:00&\nhesapIslemBtsTrh=2023-02-26T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n Tablo 18: lem Listesi Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n lem Sorgulama Balang Zaman \n hesapIslemBslTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin balang tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. HK tarafndan tetiklenen sorgularda;hesapIslemBslTrh ve hesapIslemBtsTrh aras fark bireysel HKlar iin en fazla 1 ay,kurumsal HKlar iin ise en fazla 1 hafta olabilir. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;son 24 saat sorgulanabilir. Bu yzden hesapIslemBtsTrh-24 saatten daha uzun bir aralk sorgulanamaz olmaldr. stek balnda yer alan PSU-Initiated alan E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n \n \n lem Sorgulama Biti Zaman \n hesapIslemBtsTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin biti tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;leri vadeli ilem emirleri dahil olmad iin (Srm 1.0.2 kapsamnda); lem Sorgulama Biti Zaman, her zaman, sorgulama zaman damgasn iletecek ekilde (datetime (now)) iletilebilir. \n \n \n En Dk lem Tutar \n minIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en dk ilem tutar.      Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n En Yksek lem Tutar \n mksIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en yksek ilem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Bor Alacak Gstergesi \n brcAlc \n AN1 \n  \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Hesaba bor yaratan ilem.A: Hesaba alacak yaratan ilem.{B,A} \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {islGrckZaman} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini islGrckZaman olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 19: IslemBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans Numaras \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n Islemler \n isller \n Kompleks:Islem[Array] \n K \n Hesaba ilikin hareketler varsa lemler nesnesi dizisi olarak dnlr. lemler nesnesi Temel lem Bilgileri ve Detay lem Bilgileri nesnesinden meydana gelir. zin tr varsaylan olarak Temel lem Bilgilerini ierir. Detay lem Bilgileri izin tr de seildi ise Temel lem Bilgilerine ek olarak Detay lem Bilgileri de gnderilir. \n \n \n > Temel lem Bilgileri \n islTml \n Kompleks:IslemTemel \n Z \n Temel lem Bilgileri varsaylan olarak dnlr. \n \n \n >> lem Numaras \n islNo \n AN3..50 \n Z \n Hesap hareketinin oluturulmas srasnda atanan ve bor (veya alacak) hareketini tekilletiren HHS baznda tekil tanmlaycdr. Bu deer tek bana tekil olabilecei gibi birden fazla deerin bir araya getirilmesiyle de tekillii salanm olabilir. Bu deerin en azndan hesap numaras (hesNo) baznda tekil olmas beklenir. Genellikle kullanlan rnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp,dekont numaras \n \n \n >> lem Referans Numaras \n refNo \n AN3..50 \n Z \n lemi utan uca tanmlayan tekil tanmlaycdr. Bor ve alacak hareketinden oluan bir veya birden fazla ilemler btn iin atanm olan ve bu btn tekilletiren (bir biri ile ilikisini tutan) deerdir.Bu deer hem YSten gelen deer olabilir (deme ilemlerinde kullanlan kkodRef ya da refBlg alan) hem de HHS iinde takip edilmek iin retilmi bir deer olabilir. HHS sisteminde 2 deerin de bulunmas durumunda;refNo alann doldurmak iin, HHSnin YSten gelen deere ncelik vermesi beklenmektedir. YSten gelen veri rnei: Sipari Numaras, Fatura Numaras, Karekod Referans vb. HHSte retilen veri rnei: Masrafl havale ileminde hem havale ileminin hem de masraf ileminin ayn referans numarasna sahip olmas da rnek olarak gsterilebilir. \n \n \n >> lem Tutar \n islTtr \n AN1..24 \n Z \n lem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Gncel Bakiye Tutar \n gnclBky \n AN1..25 \n Z \n lem sonras gncel bakiye bilgisi tutar.   Tutar alan regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n >> lem Gerekleme Zaman \n islGrckZaman \n ISODateTime \n Z \n lemin gerekleme zaman. \n \n \n >> lem Kanal \n kanal \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeKaynak sral veri tr deerlerinden birini alr. \n \n \n >> Borlandrma Alacaklandrma Gstergesi \n brcAlc \n AN1 \n Z \n TR.OHVPS.DataCode.BrcAlc sral veri tr deerlerinden birini alr. lemin hesab bor ya da alacaklandrd bilgisidir. \n \n \n >> lem Tr \n islTur \n AN3..50 \n Z \n HHSnin ileme ait ilikilendirdii ilem tr deeri. TR.OHVPS.DataCode.IslemTuru sral veri tr deerlerinden birini alr. \n \n \n >> lem Amac \n islAmc \n AN2 \n Z \n TR.OHVPS.DataCode.IslemAmaci srali veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> deme Sistemi No \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. Havale/FAST/PS  deme yntemleri iin tarih alan yyyy-aa-gg formatnda 10 karakter olarak iletilmelidir. \n \n \n > Detay lem Bilgileri \n islDty \n Kompleks: IslemDetay \n K \n Detay lem Bilgileri dizi olarak gnderilmelidir. \n \n \n >> lem Aklamas \n islAcklm \n AN1..200 \n Z \n HHS tarafndan atanan ilem aklamas. HHS kendi ilem hareketlerine yanstt aklamay buraya yanstmaldr. HHS'ler tm hesap hareketlerini YS'ler ile paylamakla ykml olup, hassas veri ieren(rn: faiz, komisyon bilgisi ieren vb.) ilem hareketleri de bu kapsamda deerlendirilerek ilem aklamasnn maskeli olarak iletilmesi salanr. Kelimelerin ilk 3 hanesi maskeli olacak ekilde, ancak sakncal bulunan kelimeler varsa; (rn: faiz, komiyon vb.) kelimelerin tamam maskeli olacak ekilde gsterilebilir. \n \n \n >> Kar Taraf \n krsTrf \n Kompleks:  KarsiTaraf \n K \n Kullanm ilem baznda deimektedir. rnek: FAST ileminde kar taraf alcnn bilgileridir. Vergi demesinde kurum IBAN bilgisi mteriye gsterilemeyebileceinden bu alann bo gelmesi HHS insiyatifindedir. \n \n \n >>> Kar Maskeli IBAN \n krsMskIBAN \n AN26 \n K \n lgili hesap hareketinin kar tarafnn maskeli IBAN bilgisi. \n \n \n >>> Kar Unvan \n krsMskUnvan \n AN3..140 \n K \n lgili hesap hareketinin kar tarafnn ad-soyad ya da ticari unvan bilgisi.Unvan bilgisi maskelenmeden iletilmelidir. \n \n \n >>> Kar Taraf Kimlik Bilgisi \n krsKimlikVrs \n AN1..11 \n  \n HHS sorumluluunda YS ile paylalan Kar Taraf Kimlik Bilgisi(Kimlik/Kurum Kimlik - TCKN/VKN) \n \n \n \n"},{title:"Gl Kimlik Dorulama",frontmatter:{},regularPath:"/v1.1.0/contents/erisim-belirteci.html",relativePath:"v1.1.0/contents/erisim-belirteci.md",key:"v-751f6acf",path:"/v1.1.0/contents/erisim-belirteci.html",headers:[{level:2,title:"Yetkilendirme Kodu API",slug:"yetkilendirme-kodu-api"},{level:2,title:"Eriim Belirteci API",slug:"erisim-belirteci-api"}],content:' Gl Kimlik Dorulama  \n \n HK\'nn YS uygulamasndan HHS uygulamasna ynlendirilmesi ile balanan gl kimlik dorulama sreci,  Oauth 2.0 standartlar gerei ncelikle yetkod deerinin YS\'e iletilmesi ile balar ve eriim belirtecinin alnmas sonucunda baar ile sonulanm olur. \n Gl Kimlik Dorulama iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =hesap_bilgisi  "odeme_emri" \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n yetkilendirme-kodu \n GET \n /yetkilendirme-kodu \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n yetkilendirmeKodu \n \n \n 2 \n erisim-belirteci \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n Yetkilendirme Kodu API \n GET /yetkilendirme-kodu \n Ayrk GKD srecinde kullanlacak olan Yetkilendirme Kodu API\'nin  HHS tarafndan sunulmas gerekmektedir. \n Ayrk GKD aknda; HHS, YS\'n olay dinleme servisine "AYRIK_GKD_BASARILI" olay tipi ile olay bildirimi yapar. Bylece HK\'nn kendi sistemine baar ile login olduunu ve yetKod deerinin HK ile ilikilendirildiinin bilgisini YS\'e iletmi olur.  \nHHS olay bildirimi iin retry policy sreleri kapsamnda 1 dakikada 3 kez deneme yapabilir. YS\'e olay bildirimi yaplmam ise, kendisine gelmeyen olay bildirimi iin yetkod\'un geerli olduu 5 dakika boyunca yetkilendirme-kodu endpointi ile sorgulama yaparak yetkod deerini alabilir. \n YS, "ODEME_EMRI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=O \n YS, "HESAP_BILGISI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=H \n STEK: \n YS, rza numarasn ve istein BH ya da HBH olmasna gre deien rza tipini parametre olarak istek talebine ekler. Rza tipinin alabilecei deerler  TR.OHVPS.DataCode.RizaTip  sral veri tiplerinde belirtilmitir. \n HHS\'nin, yetkilendirme yntemi "Ayrk Gkd" ise  rza numaras ile yetki kodu deerini dnmesi beklenmektedir. Ynlendirmeli GKD iin bu endpoint "yetKod" deerini dnmemelidir. Ynlendirmeli GKDye ait bir rza no ile yetkilendirme kodu API kullanlarak yet_kod alnmak istendiinde HHS tarafndan  TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n YANIT: \n HHS yant nesnesi ierisinde, HK\'ya ait yetki kodunu, rza no ve rza durumu ile birlikte YS\'e iletir. \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n Z \n GKD srecinde retilen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n Ayrk GKD srecinde, yetkod deerini alan YS; eriim belirteci API ile GKD srecini tamamlar. \n Eriim Belirteci API \n POST /erisim-belirteci \n STEK: \n YS erisim-belirteci eriim adresini 2 amala kullanr: \n \n \n Bir nceki admdan ald rizaNo, rizaTip (deme emri balatma hizmetinde O, hesap bilgisi hizmetinde H) ve GKD sonras dnlen yetKod bilgilerini kullanarak HHS nezdinde ErisimBelirteci nesnesi oluturmak zere istekte bulunur. YSn istekte bulunabilmesi iin GKD admnn baarl bir ekilde tamamlanmas rizaDrm bilgisinin yetkilendirildi olmas gerekir. Eriim Belirteci nesnesi ile rzas nesnesi (deme Emri Rzas veya Hesap Bilgisi Rzas) arasndaki iliki rza numaras zerinden salanr. \n \n \n Ald eriim belirtecinin Geerlilik Sresinin dolduu durumda, yenileme belirteci karlnda yeni bir eriim belirteci almas gerekmektedir. \n \n \n POST /erisim-belirteci isteinin (REQUEST) gvdesinde (BODY)  ErisimBelirteciIstegi nesnesi (Tablo-23) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda ErisimBelirteci nesnesi (Tablo 24) oluturulur veya (Yenileme Belirteci iin) gncellenir. Rza durumu Yetki Kullanld olarak gncellenir. \n Eriim Belirteci POST ilemi sonucunda HTTP 200 dnlmesi gerekmektedir. \n ErisimBelirteciIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Tipi \n rizaTip \n AN1 \n Z \n O veya H (TR.OHVPS.DataCode.RizaTip) \n \n \n Yetki Tipi \n yetTip \n AN1..50 \n Z \n yet_kod yada yenileme_belirteci deerini alabilir.  (TR.OHVPS.DataCode.YetTip) \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n K \n GKD ileminden dnen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. yetTip = yet_kod ise zorunludur. \n \n \n Yenilenme Belirteci \n yenilemeBelirteci \n AN1..4096 \n K \n Eriim belirtecinin yenilenmesi amacyla kullanlr. yetTip = yenileme_belirteci ise kullanm zorunludur. \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan erisimBelirteci nesnesinde bulunan eriim belirteci deeri deme emrinin balatlmas esnasnda kullanlr. \n "ErisimBelirteci" nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Eriim Belirteci \n erisimBelirteci \n AN1..4096 \n Z \n Yetkilendirme Kodu karlnda HHS tarafndan dnlen ve sonraki hesap bilgisi ve deme emri servislerine eriimde kullanlan bilgidir. Blm 3.6 Karakter Kodlama   blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. Yenileme belirteci ile birden fazla eriim belirteci alnmas durumunda verilen tm eriim belirtelerinin sreleri bitene kadar geerli olmaldr. \n \n \n Geerlilik Sresi \n gecerlilikSuresi \n N1..9 \n Z \n Eriim Belirtecini saniye cinsinden geerlilik sresidir.  Eriim belirteci geerli olduu son tarih ; Hesap Bilgisi Rzas iin en fazla 30 gn en az ise 1 gn olmaldr.  Eriimin Geerli Olduu Son Tarih(erisimIzniSonTrh); Eriim Belirteci Geerlilik Sresi\'nden kk ise Eriimin Geerli Olduu Son Tarih deeri ile snrldr. deme Emri Rzas iin 5 dakika olmaldr. \n \n \n Yenileme Belirteci \n yenilemeBelirteci \n AN1..4096 \n Z \n Eriim belirtecinin yenilenmesi amacyla kullanlr.   Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir.  Yenileme Belirteci ile Eriim Belirteci istei yapldnda HHS\'nin dnd yant ierisindeki yenilemeBelirteci deerini kesinlikle deitirmemesi gerekmektedir.Yenileme belirteci rza sresi boyunca gncellenmemelidir. \n \n \n Yenileme Belirteci Geerlik Sresi \n yenilemeBelirteciGecerlilikSuresi \n N1..9 \n Z \n Yenileme belirtecinin saniye cinsinden geerlilik sresidir. Yenileme belirtecinin geerli olduu son tarih ; Hesap Bilgisi iin Eriimin Geerli Olduu Son Tarih ile snrl olmaldr. Bu tarih geldii zaman Hesap Bilgisi Rza Durumunu Yetki Sonlandrld statsne ekilmesi gerekir. deme Balatma iin Rza Oluturma Zamanndan 15 gn sonras olmaldr. 15 gn sresi sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. leri vadeli ilemler bu kapsamda deildir.  deme emri 5 dakika iinde gerekletirilmelidir. Gereklemediinde 4.2.8 blmnde aktarlan rza stat gncellemesi yaplmaldr. \n \n \n \n erisim-belirteci erisim noktasndan elde edilen erisimBelirteci, ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda x-access-token alannda iletilir. \n Yenilenme Belirteci (refreshToken) kullanlarak Eriim Belirteci (accessToken) alndnda, dnen yanttaki Yenileme Belirteci Geerlik Sresi (yenilemeBelirteciGecerlilikSuresi) geen sre eksiltilerek, kalan zamann saniye cinsinden hesaplanmasyla iletilmelidir. \n Eriim Belirteci API arm srasnda rza durumlar kontrol edilmelidir. Bu kontrollerin nasl yaplmas gerektii 4-Rza Durumlar blmnde aktarlmtr. \n Yenileme belirteci karlnda yeni bir eriim belirteci alnmas srasnda HHS\'nin dnd hata yantnda httpCode = 401 ve errorCode = "TR.OHVPS.Connection.InvalidToken" gelirse YS nce rzann durumu sorgulamaldr.  \nEer geerli bir rza ise; HHS veya YS tarafnda bir sorun olduu anlalmaldr. Sistem tarafndan hata retilmeli ve sorun incelenmelidir. \nEer geerli bir rza deil ise YS tarafndaki rza durumu gncellenmelidir. \n'},{title:"HHS ve YS API",frontmatter:{},regularPath:"/v1.1.0/contents/hhs-yos-api.html",relativePath:"v1.1.0/contents/hhs-yos-api.md",key:"v-9cc354c6",path:"/v1.1.0/contents/hhs-yos-api.html",headers:[{level:2,title:"HHS API",slug:"hhs-api"},{level:2,title:"YOS API",slug:"yos-api"}],content:" HHS ve YS API \n HHS API, HHSlerin detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. HHS API iin hhs_read scope bilgisi kullanlr. \n Production ortamnda HHS / YOS API ierisinde sisteme dahil olmu, sertifikasyonu baar ile tamamlam paydalar listelenecektir. HHS tarafndan desteklenen API srmleri listelenecektir. \n YSler HHS APIsini sorgulayabilir ancak YS APIsini sorgulayamazlar. \nBenzer ekilde HHSler YS APIsini sorgulayabilir, HHS APIsini sorgulayamazlar. \n HHS API \n GET /hhs/{hhsKod} \n lem Sorgu rnei =  /hhs    bu sorgu yntemi ile tm HHSlerin dizi eklinde verileri listelenir. \nlem Sorgu rnei =  /hhs/2001    bu sorgu yntemi ile gnderilmi olan hhsKoduna ait bilgiler listelenir. Ya da 404 Not Found hatas alr. \nHHS ve YS API Tablo 20deki istek parametrelerine gre sorgulanabilir. \nlem Sorgu rnei (Belirli Bir Hesap) =  /hhs?srlmKrtr=kod&srlmYon=A \n Tablo 20: HHS ve YS API Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {kod, unv} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, sralama kriteri unv olarak belirlenmelidir. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 21: HHS Bilgileri Sorgulama Yant Hhs nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n hhs kodu \n kod \n AN4 \n Z \n HHS nin kod bilgisi \n \n \n hhs unvan \n unv \n AN3..140 \n Z \n HHS nin unvan bilgisi \n \n \n hhs markas \n marka \n AN1..140 \n Z \n HK'nn kolaylkla alglayabilecei ksa unvan bilgisi. HHS tarafndan belirlenecektir. \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n HHSnin mesaj imzalama iin paylat ak anahtar \n \n \n HHS Api Bilgileri \n apiBilgileri \n Kompleks: HhsApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :obh, hbh,gkd \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s2.0 s1.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n HHS'ye ait logo bilgileri. \n \n \n > logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur sral veri tr deerlerlerinden birini alr. \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n HHS tarafnda tutulan ve YS'lerle paylalacak olan url adres bilgisidir.  rnek: https://via.placeholder.com/150?text=0001 \n \n \n > logoArkaPlan \n logoArkaPlan \n AN1 \n Z \n TR.OHVPS.DataCode.LogoArkaPlan sral veri tr deerlerlerinden birini alr. \n \n \n > logoFormat \n logoFormat \n AN3 \n Z \n TR.OHVPS.DataCode.LogoFormat sral veri tr deerlerlerinden birini alr. \n \n \n Ayrk GKD \n ayrikGKD \n AN1 \n Z \n HHS'nin Ayrk GKD desteklediini BKM'ye bildirmesi ile bu alan E deerini alr.  TR.OHVPS.DataCode.EvetHayir sral veri tiplerinden birini alr. \n \n \n Durum \n durum \n AN1 \n Z \n HHS'nin durum bilgisidir.  TR.OHVPS.DataCode.HHSDurumu sral veri tipinde alabilecei deerler belirtilmitir. \n \n \n \n HHS API'de; Ak, Yaygnlatrma, Geici Hizmet Veremiyor, Kapal durumlarndaki HHS'ler listelenecektir.  \nSertifikasyon onay alan HHS'ler, retim ortamna geite \"Yaygnlatrma\" durumuna sahip olabilir.  HHS'nin, hangi YS'ler ile \"Yaygnlatrma\" kontrollerini yapaca, HHS ynetiminde olacaktr. Bylece retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi ve servislerini test etmesi salanabilir olacaktr. HHS'ler kendi kurum kontrollerini yapana kadar, \"Yaygnlatrma\" durumunda kalabilirler. HHS'nin BKM'ye yapaca talep ile, HHS \"Yaygnlatrma\" durumundan \"Ak\" durumuna geebilecektir. \n Aadaki durumlarda HHS'nin stats Geici Kapal olarak gncellenebilecektir: \n \n HHS'nin talebi ile uzun sreli (minimum 1 saati aan) yaanan teknik sorunlarda G statsne alnabilecektir. G statsne alnma talebinin HHS tarafndan ohvps@bkm.com.tr ye mail atarak iletilmesi beklenmektedir. \n lgili resmi kurumlardan gelen talep zerine HHS G statsne alnabilir. \n \n YS'ler hem A hem G statsnde olan HHS'leri listeleyebilir. Ancak YS uygulamasnda G statsnde olan bir HHS mteri tarafndan seilirse mteriye gerekli hata mesajnn verilmesi ve ilgili HHS'ye istek atlmamas salanmaldr. \n Hem YOS hem de HHS API iin geerli olacak; logo gnderiminde dikkat edilmesi gerekenler u ekilde tariflenmitir: \n \n Logolarn ham dosya yerine kurumun yaynlayaca bir URL zerinden sunulmas gerekmektedir. (rn: logoURL = https://kurumadi.com.tr/logo.png) Logo BKM tarafnda host edilmeyecektir. \n Logo urlin public eriilebilir url olmas gereklidir. \n Logo, yatayda veya dikeyde tama paysz tam oturacak, snr boyutlarn gemeyecek ve ortalanm yerleime sahip olmaldr. \n YS uygulamasnda gsterim esnasnda logolarn hzl yklenmesi ve dk veri tketmesi asndan; logo boyutu 250 KBn altnda olmaldr. \n HHS ve YSlerin tm logo trlerini (8 farkl tipte logoyu) zorunlu olarak dnmesi beklenmektedir. \n Circle logo kullanlmas gerektiinde ICON_LOGO logo tr kullanlmaldr. \n Logolarn gncellemek isteyen kurumlarn en az 3 i gn ncesinde BKMye bu deiiklii GET Test/retim Ortam Entegrasyon formu ile bildirmesi gereklidir.  BKM de katlmclara HHS/YS API aracl ile gncel logonun ekilmesi gerektiine dair bilgilendirme yapar. \n Logolar anlk eken katlmclarn, herhangi bir teknik nedenden dolay gncel logoyu alamad durum olabilir. Bu durumda sistemlerine kaydetmi olduu kuruma ait ikon logoyu gstermesi gereklidir. \n HHS ve YSler API aracl ile alm olduklar logolarn format zerinde deiiklik (kare, yuvarlak hale getirip resize etmek gibi) yapabilirler. Ancak logonun grsel ve yazlarn etkileyecek bir  deiiklik yapmamaldrlar. \n YS/HHS mobil uygulamasndaki dark mode ve light mode kullanmlarnda, hangi logonun kullanlacana uygulama sahibi karar verecektir. \n YOS API \n YS API, YS statsundeki kurumlarn detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. YS API iin yos_read scope bilgisi kullanlr. \n YS API yantnda, listelenen ynlendirme ve bildirim adresleri bulunmaktadr. HHS, ilem annda iletilen yonAdr ya da bldrAdr alanlarnda gnderilen adreslere yetKod deerini iletmelidir. YS API ierisinde yer alan adresleri, rza isteinde gnderilen adreslerin doruluunu kontrol etme amacyla kullanlmaldr. Bu nedenle YS API ierisinde listelenen adreslerin hostname seviyesinde yer almas yeterlidir. \n YS API ierisinde yer alan YS rol bilgileri ve aktiflik/pasiflik durumlar birbiriyle ilikili deildir. \n YS'n sahip olduu bhs,hbhs rolleri iin herhangi bir fraud ya da teknik sebeplerden tr geici sreyle geri alnabilir. \n YS'lerin hizmet verememesi durumunda rollerinin geri alnmas yaplmayacaktr. YS rolleri sadece ilgili resmi kurumlardan gelen talep zerine alnabilecektir. \n YS aktifliini korurken problem zlene kadar geici olarak alnan roller(bhs,hbhs) tekrardan aktif hale getirilir. \n GET /yos/{yosKod} \n lem Sorgu rnei =  /yos    bu sorgu yntemi ile tm YS'lerin dizi eklinde verileri listelenir. \n lem Sorgu rnei =  /yos/2501    bu sorgu yntemi ile gnderilmi olan yosKoduna ait bilgiler listelenir ya da 404 Not Found hatas alr.\nYS API Tablo 20deki istek parametrelerine gre sorgulanabilir.\nlem Sorgu rnei (Belirli Bir Hesap)=  /yos?srlmKrtr=kod&srlmYon=A \n Tablo 22: YOS Bilgileri Sorgulama Yant Yos nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Ys kodu \n kod \n AN4 \n Z \n YS'n kod bilgisi \n \n \n Ys unvan \n unv \n AN3..140 \n Z \n YS unvan bilgisi \n \n \n Ys markas \n marka \n AN1..140 \n Z \n HK'nn kolaylkla alglayabilecei ksa unvan bilgisi. YS tarafndan belirlenecektir. \n \n \n YS rolleri \n roller \n Array[AN4] \n Z \n YSun rollerini belirten deer. rnek: [ \"obhs\", \"hbhs\" ]  - obhs - deme Bilgisi Hizmet Salayc Rol  - hbhs - Hesap Bilgisi Hizmet Salayc Rol \n \n \n Adresler \n adresler \n Kompleks:Adres[Array] [1..N] \n Z \n --- \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerlerinden birini alr. Adres detaylarnn hangi GKD trne ait olduunu belirtir. \n \n \n > Adres Detaylar \n adresDetaylari \n adresDetaylari\tKompleks: AdresDetayi[Array] [1..N] \n Z \n \n \n \n >> Temel Adres \n tmlAdr \n AN1..1024 \n Z \n yetYntm deeri Y olarak iletildiinde Ynlendirmeli GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. yetYntm deeri A olarak iletildiinde Ayrk GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. Riza isteklerinde bu deer ile uyumluluu kontrol edilmelidir. rnek: https://example.com https://example2.com/path deepLink://example/test deepLink://example2/test \n \n \n >> Aklama \n aciklama \n AN1..1024 \n  \n YSn gnderdii adrese ynelik vermek istedii aklama rnek: WEB bireysel , WEB kurumsal  , APP \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n YSn mesaj imzalama iin paylat ak anahtar \n \n \n YS Api Bilgileri \n apiBilgileri \n Kompleks: YosApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :ods \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s2.0 s1.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n YOSe ait logo bilgileri. \n \n \n > logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur sral veri tr deerlerlerinden birini alr. \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n YS tarafnda tutulan ve HHSlerle paylalacak olan url adres bilgisidir.  rnek: https://via.placeholder.com/150?text=0001 \n \n \n > logoArkaPlan \n logoArkaPlan \n AN1 \n Z \n TR.OHVPS.DataCode.LogoArkaPlan sral veri tr deerlerlerinden birini alr. \n \n \n > logoFormat \n logoFormat \n AN3 \n Z \n TR.OHVPS.DataCode.LogoFormat sral veri tr deerlerlerinden birini alr. \n \n \n Durum \n durum \n AN1 \n Z \n YS'n durum bilgisidir.  TR.OHVPS.DataCode.YOSDurumu sral veri tipinde alabilecei deerler belirtilmitir. \n \n \n \n"},{title:"2.Kapsam ve Dayanak",frontmatter:{},regularPath:"/v1.1.0/contents/kapsam-ve-dayanak.html",relativePath:"v1.1.0/contents/kapsam-ve-dayanak.md",key:"v-9e25e106",path:"/v1.1.0/contents/kapsam-ve-dayanak.html",content:" 2.Kapsam ve Dayanak \n 12 Kasm 2019da gncellenen  6493 sayl deme ve Menkul Kymet Mutabakat Sistemleri, deme Hizmetleri ve Elektronik Para Kurulular Hakknda Kanun un (Kanun) 12nci maddesine yeni eklenen ve  deme Hizmetleri Direktifi 2 'de (Payment Services Directive 2, PSD2) bulunan iki yeni deme hizmeti aadaki gibi tanmlanmtr (ekil-1: deme Hizmetleri Veri Paylam Servisleri): \n \n deme Emri Balatma Hizmeti : HKnn istei zerine baka bir deme hizmeti salaycsnda bulunan  deme hesabyla  ilgili sunulan deme emri balatma hizmeti [Madde 12, birinci fkra, (f) bendi] \n Hesap Bilgisi Hizmeti : HKnn onaynn alnmas kouluyla, HKnn deme hizmeti salayclar nezdinde bulunan bir veya daha fazla  deme hesabna  ilikin konsolide edilmi bilgilerin evrim ii platformlarda sunulmas hizmeti [Madde 12, birinci fkra, (g) bendi] \n \n   \n ekil 1: deme Hizmetleri Veri Paylam Servisleri (HVPS)- tantm \n Kanunun 14/A maddesinin ikinci fkrasna gre , Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetleri ile ilgili ilemlerin yrtlmesine ilikin usul ve esaslar ile taraflarca uyulmas gereken teknik ve operasyonel gereklilikler ikincil dzenlemeler uyarnca Trkiye Cumhuriyet Merkez Bankas (TCMB) tarafndan belirlenir. Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri  deme hizmetleri veri paylam servisleri (HVPS)  olarak adlandrlmaktadr. \n deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelikin (Ynetmelik) 59uncu maddesinin birinci fkras uyarnca hazrlanan bu belgede sz konusu deme hizmetlerini sunacak deme hizmeti salaycsnn, deme hesabnn bulunduu deme hizmeti salaycsnn, varsa ilgili dier taraflarn ve bu hizmetlerin sunulmas iin taraflar arasnda kurulacak balantnn teknik ve operasyonel gereklilikleri aklanmaktadr. \n Dzenlemeler kapsamnda yetkilendirilen nc taraf hizmet salaycs  (Yetkili deme Hizmeti Salaycs, YS) , deme hizmeti kullanclarnn  Hesap Hizmeti Salayclar (HHS)  nezdindeki deme hesaplarna ulaarak deme emri balatma ve hesap bilgisi salama hizmetlerinden (deme hizmetleri veri paylam servislerinden) faydalanmasna araclk eder. deme hizmetleri veri paylam servisleri kapsamnda iki tip YS bulunmaktadr:  1) Hesap Bilgisi Hizmeti Salaycs (HBHS) ve 2) deme Emri Balatma Hizmeti Salaycs (BHS). \n Hesap Bilgisi Hizmeti Salaycs (HBHS) HKnn farkl Hesap Hizmeti Salayclar (HHS) nezdindeki hesaplarnn bilgilerini derleyerek evrim ii platformlarda  toplu ekilde  sunar. deme Emri Balatma Hizmeti Salaycs (BHS) ise talebi zerine HKnn HHSde bulunan deme hesabndan deme ilemi balatr. \n HVPSnin st dzey gsterimi ekil-2de verilmitir. \n   \n ekil 2: deme Hizmetleri Veri Paylam Servisleri (HVPS) -st dzey gsterim \n deme Hizmetleri Veri Paylam Servislerinin HHSler tarafndan  GET  vastasyla sunulduu uygulama mimarisi ise ekil-3te sunulmutur. \n  \n ekil 3: HVPS'nin GET vastasyla sunumu \n"},{title:"6.\tdeme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html",relativePath:"v1.1.0/contents/odeme-emri-baslatma-hizmeti.md",key:"v-7e5b51bd",path:"/v1.1.0/contents/odeme-emri-baslatma-hizmeti.html",headers:[{level:3,title:"deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"6.1.\tADIM 0 - deme Emri Balatma Istei",slug:"_6-1-adim-0-odeme-emri-baslatma-istegi"},{level:2,title:"6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas",slug:"_6-2-adim-1-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi",slug:"_6-3-adim-2-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_6-4-adim-2-1-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"6.5.\tADIM 3- deme Emrinin Oluturulmas",slug:"_6-5-adim-3-odeme-emrinin-olusturulmas"},{level:2,title:"6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal)",slug:"_6-6-adim-3-1-odeme-emri-sorgusu-istege-bagl"},{level:3,title:"GET /odeme-emri/{odemeEmriNo}",slug:"get-odeme-emri-odemeemrino"}],content:" 6.\tdeme Emri Balatma Hizmeti \n deme emri balatma ilemi havale, FAST ya da PS demesiyle sonulanabilir. deme ileminin amac kiiden kiiye para transferi, e-ticaret demesi gibi farkl deme trleri olabilir. demenin amacna gre BHSnin iletecei veri setinde farkllamalar olabilir. \n deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n deme Emri Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden deme emrini balatr. \n deme Emri Rza Hazrlanmas:  BHS, deme Emri Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n deme Emrinin Balatlmas:  BHS, deme emrini HHSye iletir. \n deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay Sorgular:  BHS, deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular)  mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin hem HBH hem de BH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini(nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n YS'ler gnderen hesap seimini aadaki yntemlerden biri ya da birka ile salayabilirler: \n \n YS, mterisinin deme hesabn HHS ekranndan setirebilir. \n YS, mterisinden Hesap Bilgisi rzas alr. Rza ald hesaplar zerinden hesap referans aracl ile deme emri balatabilir. \n YS, mterisinin deme hesabn elle girmesine olanak tanyabilir. IBAN' olmayan HHS'ler deme emri rzas admnda  TR.OHVPS.Business.IBANNotSupported  hatasn vermelidir. IBAN' olan HHS'lerin bu ak desteklemesi zorunludur. \n YS; mterisinin hesap referansn elle girmesini salayabilir. Hesap Referans bilgisi ile balatlan deme emri ilemlerinde HHS seimi zorunludur. \n \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN sunmadklar iin, YS'ler hesap referans ile deme balatabilirler. Bunlarn dndaki HHS'lerin, gnderen IBAN veya hesap referans ile deme akn desteklemesi zorunludur. \n \n ekil 4: deme Emri Balatma Hizmeti st Dzey  Ak \n deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. \n Tablo 6: deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n odeme-emri-rizasi \n POST \n /odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n OdemeEmriRizasiIstegi \n OdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n OdemeEmriRizaYaniti \n \n \n 3 \n odeme-emri \n POST \n /odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal stek ve Yant \n OdemeEmriIstegi \n OdemeEmri \n \n \n 3.1 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n OdemeEmri \n 6.1.\tADIM 0 - deme Emri Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) deme emri balatma ilemine onay verir. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas \n   \n ekil 5: deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak deme emri rza kaynann oluturulmasn (odemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi mi? \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahip mi? \n stekte bulunulan HHS kodu doru mu? \n \n \n \n POST baarl olursa, HHS, deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren odemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir OdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) \n HHS; kimlik bilgileri nesnesinde eer kimlik bilgileri iletilmi ise; bu veri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Koullu Zorunlu) \n HHS kimlik bilgisi ile gnderen unvannn uyumlu olduunun kontrol eder. HHS'ler EFT/FAST ilemlerinde kabul ettikleri kontrol kriterleri ile ileme izin verebilirler. (Zorunlu) \n Gnderen Hesap Numaras ile ilgili Tablo7de belirtilen kontroller yaplmaldr. (Zorunlu) \n HHS, deme iin benzersiz RizaNo ile OdemeEmriRizasi nesnesi oluturur ve BHSye dner. \n HHS, OdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \nBu aamada HKnn HHS tarafndan tanmlanm ve istein veri alannda gnderen hesaba (borlandrlacak hesaba) ilikin bir bilgisinin olmas gerekmez. \nHesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n \n POST /odeme-emri-rizasi  isteinin (REQUEST) gvdesinde (BODY)  odemeEmriRizasiIstegi nesnesi (Tablo-7) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda odemeEmriRizasi (Tablo-8) nesnesi oluturulur. \n Tek Seferlik deme \nTek seferlik deme ak YS'ten HHS'ye giden istekte, gnderen kimlik bilgilerinin olmad durumda gerekleir. Gnderen kimlik bilgisi olmadnda, KOLAS sorgusu yaplamayacandan tr, HHS tarafndan TR.OHVPS.Business.InvalidContent hatas dnlmelidir.  HK'nn YS'n mterisi olmad durumda tek seferlik deme balatlabilir. \nTek seferlik deme ak hem iyeri demelerinde hem de kiiden kiiye para transferlerinde kullanlabilen bir aktr. yeri tarafndan balatlan tek seferlik deme ilemlerinde katlmclar gnderen HK'dan cret alnamaz.\n Tek seferlik deme ak sadece bireysel mteriler iin kullanlabilir. \nTek seferlik deme aknda hem ynlendirmeli hem de ayrk GKD ak ile mteri yetkilendirmesi salanabilir. \n Aadaki senaryolar tek seferlik demeye rnek olarak gsterilebilir. \n yeri demesi ak rnei: Bir e-ticaret sitesinde, ye olmadan alveri yaplmas ve demenin YS tarafndan kimlik bilgisi olmadan balatlmas \nKiiden kiiye para transferi ak rnei: QR veya dier yntemler ile alc bilgilerinin gnderici ile paylalmas ve YS zerinden gnderici bilgileri olmadan alcya para transferi yaplmas iin rza verilmesi \n  BAARILI STEK: \n Tablo 7: OdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.ohkTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n HHS geerli bir para birimi olduu kontrol eder. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n K \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.  Tek seferlik deme dnda YS'n gnderen unvann gndermesi zorunludur. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  TR.OHVPS.Business.InvalidContent  hatas verilmelidir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir.  Kontrol baarsz olduunda  TR.OHVPS.Business. InvalidAccount  hatas YSe iletilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HHS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn unvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr.  FAST-TR Karekod dndaki i yeri demelerinde; yine Unvan alannda iyeri ad bilgisi gnderilmelidir. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n Tek seferlik demelerde ( kimlik bilgileri bo iletildiinde) KOLAS nesnesi dolu iletiliyorsa; HHS tarafndan TR.OHVPS.Business.InvalidContent hatas dnlmelidir \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n HHS, YS'n API deseninde \"O\" kodunu ilettiini kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarnda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.   -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tyeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n YS bu deeri HKy HHSye ynlendirmeden nceki ekranda gstermeli, ve HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak yine HKya gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir.  4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmriRizasi nesnesi Tablo-8deki parametrelerden oluur: \n Tablo 8: OdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr.  HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n \n \n \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n >> Unvan \n unv \n AN3..140 \n K \n Gnderenin unvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.   Tek seferlik deme dnda YS'n gnderen unvann gndermesi zorunludur. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.    deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisidir. Bu alan ileri vadeli demeler iin dnlmtr. lk fazda doldurulmasna gerek olmad dnlmektedir. \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil 6: deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn deme emrini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK -bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: odemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle,  OdemeEmriRizasi  nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr. HHS,  ADIM 2 -deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  OdemeEmriRizasi  nesnesine iler. \n GET /odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  OdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n Durum \n OdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n deme Emri Rzas sonlandrld ve iptal statsnde olan rza'larn gncellenme zamanndan(gnclZmn) 6 ay sonrasna kadar sorgulanabilir olmas beklenmektedir. HHS'ler ilgili sre sonrasnda yaplacak rza sorgularna TR.OHVPS.Resource.NotFound uyars verebilir. YS'ler tarafndan iptal ve sonlandrld statsnde olan rzalar iin sorgulama yapmamaldr. \n deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /odeme-emri-rizasi/{RizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-8de yer alan parametreleri ieren OdemeEmriRizasi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta OdemeEmriRizasi nesnesi gncellenir ve BHS  GET /odeme-emri-rizasi/{RizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren OdemeEmriRizasi nesnesini ekmelidir. \n ereve szleme kapsamnda olmayan tek seferlik deme ilemlerinde, Kimlik Tr ve Kimlik Verisi bilgilerinin deme emri rzas srasnda gnderimi zorunlu deildir. Baarl GKD sonras, yani eriim belirteci alndnda, deme emri olumadan nce, YSn deme emri rzasn sorgulayarak bu bilgileri almas ve deme emrini olutururken Kimlik Tr, Kimlik Verisi ve Gnderen Unvan alanlarn dolu olarak gndermesi beklenmektedir.  Ancak rza durumu Yetki Bekleniyor - B, Yetkilendirildi - Y ve Yetki ptal - I statlerinde ise, deme emri rzas sorgulamasnda, HHSnin Kimlik Tr ve Kimlik Verisi bilgisini YS ile paylamamas gerekmektedir. \n 6.5.\tADIM 3- deme Emrinin Oluturulmas \n   \n ekil 8: deme Emrinin Oluturulmas \n POST /odeme-emri \n \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS OdemeEmri kaynan oluturur. \n deme emri (OdemeEmri) uygun deme kaynana POST istei yaplarak balatlr.\n \n POST HHS tarafndan ilenir: RizaDurumu Yetki Kullanld ise ileme balanr. \n POST /odeme-emri-rizasi ile POST /odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr.POST verisindeki Gnderen Hesap Numaras ve Alc Hesap Numarasnn ayn bankaya aitse HAVALE deilse FAST veya PS i akna geilir. \n POST verisinin modele gre kontrol yaplr (alan kontrolleri) \n POST verisinin mantksal kontrolleri yaplr (IBAN kontrol, apraz alan kontroller) \n OdemeEmriDurumu Gerekleti / Gnderildi / Gereklemedi olarak gncellenir. \n \n \n POST baarl olursa, ierisinde OdemeEmriNo ve OdemeEmriDurumu deikenleri de bulunan OdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine Dnt olarak gncellenir. \n \n BAARILI STEK: \n Tablo 9: OdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidASPSP  hata kodunu dner. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda  TR.OHVPS.Connection.InvalidTPP  hata kodunu dner. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n >Ynlendirme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n \n \n \n \n \n \n \n \n \n >Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur. yetYntm = Y iin bu nesne iletilmemelidir. \n \n \n \n >>OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >>OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n \n \n >Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n deme Emri Rizas Nesnesindeki Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n deme Emri Rizas Nesnesindeki lem Tutar verisi ile ayn olmaldr. HHS ilem tutar deme mesajnda (Havale/FAST/PS) aynen tanmak durumundadr. \n Ttr \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda deme emrinde iletilen maskeli bilgi ile HHSnin kendi deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n KolasRef ( hem FAST hem de PS iin ayn) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. \n RefBlg (Hem FAST hem de PS iin ayn) \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n FAST/PS Acklm \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Sistemi verisi ile ayn olmaldr. \n \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n \n \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: OdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zamandr. \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n Z \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Emir Bilgileri \n emrBlg \n Kompleks: EmirBilgileri \n Z \n \n \n \n > deme Emri Numaras \n odmEmriNo \n AN1..128 \n Z \n odemeEmri nesnesinin UID'sidir. OdemeEmrine likin sorgular bu ID zerinden yaplr. \n \n \n > deme Emri Zaman \n odmEmriZmn \n ISODateTime \n Z \n odemeEmri nesnesinin oluturulma zamandr. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari unvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.  deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> Unvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari unvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen unvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O  deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Durumu \n odmDrm \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr.      deme Durumu alan ile ilgili olarak HHSler tarafndan YSlere  OdemeEmri servisi yantnda 02:Gnderildi, 04:Onayda Bekliyor,05:leme Alnd yantlar gnderilebilir.   05:leme Alnd  durumu YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu  02:Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS deme emri sorgulamas yapmaldr.   02:Gnderildi  durumu olutuktan sonra YS tarafndan deme emri sorgulamas yaplarak deme durumunun gncel deeri renilir. Gncel deerler  01:Gerekleti,03:Gereklemedi  durumlar olabilir. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> deme Sistem Numaras \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. Havale/FAST/PS  deme yntemleri iin tarih alan yyyy-aa-gg formatnda 10 karakter olarak iletilmelidir. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal) \n   \n ekil 9: deme Emri Sorgusu \n GET /odeme-emri/{odemeEmriNo} \n BHS, bu eriim adresi araclyla deme emrini sorgulayabilir. \n BAARILI YANIT: \n GET /odeme-emri/{odemeEmriNo} yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren OdemeEmri nesnesi dner. \n"},{frontmatter:{},regularPath:"/v1.1.0/contents/tanim-ve-kisitlamalar.html",relativePath:"v1.1.0/contents/tanim-ve-kisitlamalar.md",key:"v-e8779b46",path:"/v1.1.0/contents/tanim-ve-kisitlamalar.html",content:"  1.\tTanm ve Ksaltmalar   \n Tablo 1: Tanm ve Ksaltmalar \n \n \n \n Ksaltma \n Tanm \n Aklama \n ngilizce Aklama \n ngilizce Ksaltma \n \n \n \n \n S \n ereve Szleme \n deme hizmeti salaycs ile mteri arasnda tekil veya sreklilik arz eden deme ilemlerinin yrtlmesine ve mmkn olan durumlarda deme hesabnn almasna ilikin usul ve esaslar belirleyen szleme \n \n \n \n \n EPK \n Elektronik Para Kuruluu \n Kanun kapsamnda elektronik para ihra etme yetkisi verilen tzel kii \n Electronic Money Institution \n EMI \n \n \n FAST \n Fonlarn Anlk ve Srekli Transferi \n TCMB tarafndan iletilen Fonlarn Anlk ve Srekli Transferi Sistemi \n \n \n \n \n FAST TR-Karekod \n FAST-TR Karekod Teknik lke ve Kurallar Rehberi \n TR Karekodun FAST Sistemi araclyla gerekleecek ilemlerde kullanlmasna ilikin detayl teknik ilke ve kurallarn ieren dokman \n \n \n \n \n GET \n BKM API Geidi \n Bankalararas Kart Merkezi (BKM) tarafndan gelitirilen ve taraflara standart Ak Bankaclk ilemleri sunulmasn salayan API Geidi uygulamas \n \n \n \n \n GKD \n Gl Kimlik Dorulama \n Kimlik dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntem \n Strong Customer Authentication \n SCA \n \n \n B \n lem Bilgisi \n Gerekletirilen ileme ilikin ilem zamann, ilemin niteliini ve deme ilemi iin deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve demenin gndereni ile alcsn veya toplu deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve gndereni ile alclarn ieren bilgi \n \n \n \n \n DK \n lem Dorulama Kodu \n Kimlik dorulama yntemlerinden biriyle kendisini sisteme tantan bir mterinin gerekletirmek istedii ileme zg olmak ve belirli bir geerlilik sresi iinde ilem onaynda kullanlmak zere oluturulan, finansal sonu dorunan ilemlerde kiiye onay annda ilgili ilem bilgisi (B) ile birlikte gsterilen, alc veya tutarn deimesiyle geersiz hale gelen bilgi \n Authentication Code \n AC \n \n \n KOLAS \n Kolay Adresleme Servisi \n Fon transferlerinde hesap numaras ile ad soyad yerine kullanlan ve belirli bir hesap ile eletirilmi telefon numaras, e-posta adresi, T.C. Kimlik Numaras (TCKN), Vergi Kimlik Numaras (VKN), Yabanc Kimlik Numaras veya Pasaport Numaras gibi Kolay Adres bilgilerinin kaydedilmesini, gncellenmesini ve sorgulamasn salayan katman servis \n \n \n \n \n HBHS \n Hesap Bilgisi Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (g) bendinde tanmlanan deme hizmetini (hesap bilgisi hizmetini) sunan tzel kii \n Account Information Service Provider \n AISP \n \n \n HHS \n Hesap Hizmeti Salaycs \n Nezdinde deme hesab bulunan deme hizmeti salaycs \n Account Servicing Payment Service Provider \n ASPSP \n \n \n BHS \n deme Emri Balatma Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (f) bendinde tanmlanan deme hizmetini (deme emri balatma hizmetini) sunan tzel kii \n Payment Initiation Service Provider \n PISP \n \n \n DK \n deme Kuruluu \n deme hizmeti salamak ve gerekletirmek iin Kanun kapsamnda yetkilendirilmi tzel kii \n Payment Institution \n PI \n \n \n H \n deme Hesab \n deme hizmeti kullancs adna alan ve deme ileminin yrtlmesinde kullanlan hesap \n Payment Account \n PA \n \n \n HK \n deme Hizmeti Kullancs (Mteri) \n Gnderen, alc veya her ikisi sfatyla belirli bir deme hizmetinden faydalanan gerek veya tzel kii \n Payment Service User \n PSU \n \n \n HS \n deme Hizmeti Salaycs \n 5411 sayl Kanun kapsamndaki bankalar, EPK, DK ve Posta ve Telgraf Tekilat Anonim irketi(PTT) \n Payment Service Provider \n PSP \n \n \n HVPS \n deme Hizmetleri Veri Paylam Servisleri \n Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri \n \n \n \n \n PS \n Perakende deme Sistemi \n TCMB tarafndan iletilen, ilemlerin Trk Liras zerinden gerekletii Mteriler Aras Trk Liras Aktarm Sistemi \n \n \n \n \n TR-Karekod \n TR-Karekod lke ve Kurallar \n Ulusal karekod (TR Karekod) ilke ve kurallarnn belirlendii belge \n \n \n \n \n YS \n Yetkili deme Hizmeti Salaycs \n deme emri balatma hizmeti ve/veya hesap bilgisi hizmeti sunan tzel kii \n Third Party Payment Service Providers \n TPP \n \n \n \n"},{title:"4. Rza Durumlar",frontmatter:{},regularPath:"/v1.1.0/contents/riza-durumlari.html",relativePath:"v1.1.0/contents/riza-durumlari.md",key:"v-3358815e",path:"/v1.1.0/contents/riza-durumlari.html",headers:[{level:2,title:"4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri",slug:"_4-1-hesap-bilgisi-hizmeti-rza-durum-degisiklikleri"},{level:2,title:"4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri",slug:"_4-2-odeme-bilgisi-hizmeti-rza-durum-degisiklikleri"}],content:" 4. Rza Durumlar \n HK, deme Emri Balatma Hizmetine ya da Hesap Bilgisi Hizmetine mteri rzasnn tesisi ile balar. HKnn YS uygulamas zerinden yapt ilemler neticesinde rza durumlar deiebilir.\nRzann alabilecei durum kodlar u ekilde belirlenmitir. \n B: Yetki Bekleniyor   lk rza talebinde \n Y: Yetkilendirildi   Baarl GKD sonras yetKod retildiinde \n K: Yetki Kullanld   Eriim Belirteci alndnda \n E: Yetki deme emrine dnt   BHS iin \n S: Yetki Sonlandrld \nHBHS iin : Eriimin Geerli Olduu Son Tarih geldiinde \nBHS iin : Yenileme belirteci Son Tarihi geldiinde \n I :Yetki ptal \nRza iptal durumu ise gerek raporlama gerekse mteri deneyimi perspektifinden doru   bilgilendirmeler yaplabilmesi asndan aadaki gibi detay kodlar ile zenginletirilmitir: \n \n Rza ptal Detay Kodu: \n \n \n \n 01 :\tYeni Rza Talebi ile ptal \n 02 :\tKullanc stei ile HHS zerinden ptal \n 03 :\tKullanc stei ile YS zerinden ptal \n 04 :\tSre Am : Yetki Bekleniyor \n 05 :\tSre Am : Yetkilendirildi \n 06 :\tSre Am : Yetki demeye Dnmedi \n 07 :\tGKD iptali : Ayn rza no ile mkerrer arm \n 08 :\tGKD iptali : Rzano ile kimlik bilgileri uyumamas \n 09 :\tGKD iptali : Uygun rn bulunmuyor \n 10 :\tGKD iptali : HHS Ak Bankaclk kanal ileme kapal \n 11 :\tGKD iptali : Hesap Yetki Sorunu \n 12 :\tGKD iptali : HK HHS kontrollerini aamad \n 13 :\tGKD iptali : HK istei ile GKDden vazgeildi \n 14 :\tGKD iptali : Fraud phesi \n 99 :\tGKD iptali : Dier \n \n \n 4.1 ve 4.2 blmlerinde detaylandrlan rza durum deiikliklerinde rza iptal detay kodlar kullanlmtr. \n rnein B I/01 denildiinde Yetki Bekleniyor rza durumundan Yetki ptal rza durumuna Rza ptal Detay Kodu da 01 yani Yeni Rza Talebi ile ptal olarak gncellenmelidir ifade edilmitir. \n HK verdii rza srasnda setii hesaplarndan biri kapatlrsa, dier hesaplara ait bilgileri grmeye devam eder. Ancak HKnn hesabna ait bilgilerinin YS'e iletilmesini istemedii durumda, rzasn tamamen iptal ederek yeni hesap listesi ile yeni rza vermesi gerekmektedir. Yani hesap kapanmas nedeniyle rza geerliliini yitirmez. HK'nn proaktif olarak bu hesab rzadan karmas durumunda rza iptali olur. \n Rza iptal edilmedii ve geerli olduu srece kapal hesaplar iin dier evrimii kanallarda uygulanan yntem izlenmelidir. Dier evrimii kanallarda kapal hesaplara ilikin bilgi dnlmyor ise HVPS'den de dn yaplmaz. HKnn rza onay verdii ak hesaplarnn tm HHS tarafnda kapatld durumda, yine ayn ekilde HHS evrimii kanallarnda koyduu kurallara gre bu hesaplarnn YS uygulamasnda gsterilmesine karar verir. \n Hesap kapama ve ticari kullanclarn hesaplar zerindeki yetki deiiklikleri HHS'nin i sistemleri tarafndan yaplan kontrollerle ynetilir. Buradaki deiiklikler ile HHS sistemsel olarak rza iptali gerekletiremez. HK izni ve onay dahilinde rza iptal gerekletirilmesi gerekmektedir. \n HHS'ler sunmu olduklar Rza ptal ekrann (sadece Hesap Bilgisi Rzas iin), hangi ortamlardan GKD yaplmasna izin veriliyorsa (web/mobil) ayn ortamdan HK'ya sunmaldr.  rnein bir HHS bireysel mterileri iin web ve mobil, kurumsal mteriler iin web zerinden GKD imkan sunuyor ise, minimumda bireysel mteriler iin web ve mobil ortamlarndan, kurumsal mteriler iin web ortamndan Rza ptal ekran aracl ile rza iptaline izin vermelidir. Bunun dnda ar merkezi ya da ube gibi ortamlardan sunaca Rza ptal imkan HHS inisiyatifindedir. Bahsi geen zorunluluk deme Emri Rza ptal ekran iin geerli deildir. \n Benzer ekilde YS'ler hangi ortamlardan (web/mobil) hizmet veriyorsa, ayn ortam zerinden Rza ptal ekrann sunmaldr. \n 4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri \n Kural : Bir HK'nn, bir YS iin, bir HHS'de Y, K, B rza durumlarnda tek bir rzas olabilir.\nBir HK hem kiisel olarak hem de bir kurumun kullancs olabilir. Bu durumda kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n Hesap Bilgisi Rzas istei HHSye iletilir. \na.\tHHS HK'ya ait ieride rza var m kontrol eder. Eer yoksa  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \nb.\tEer ieride rza varsa \n i. Rza durumu Yetki Bekleniyor - B ise; \n    HHS, sistemde Yetki Bekleniyor - B rza durumuna sahip kayt olduu iin, ncelikle eski kayd Yetki ptal - I durumuna getirir.  Rza ptal Detay Kodu Yeni Rza Talebi ile iptal olmaldr.  B  I / 01  Sonrasnda,  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \n  ii. Rza durumu Yetkilendirildi - Y veya Yetki Kullanld - K ise; \nHK'nn halihazrda verilmi bir rzas vardr. HHS, nce mevcut rzann iptalinin yaplmas gerektiine dair   TR.OHVPS.Resource.ConsentMismatch  hatasn dner. YS, HHS ya da YS uygulamas zerinden bu rzann iptal edilmesi gerektiine dair HK'ya bilgilendirme yapar. \n  iii.\tRza durumu Yetki Sonlandrld - S  ise Yetki Bekleniyor - B durumunda yeni rza no oluturur. \n  iv.\tRza durumu Yetki ptal - I ise  Yetki Bekleniyor - B  durumunda yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda Rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.  B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Taraycy kapatm olabilir) Rza Yetki Bekleniyor - B rza durumunda kalr.  5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B rza durumundaki kaytlar Yetki ptal  : Yetki Bekleniyor Sre Am olarak gncellenir.   B  I / 04  Bkz. 9. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine  rizaIptDtyKod  deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n HK, hesaplarnda/izin trlerinde/Eriimin Geerli Olduu Son Tarih bilgilerinden bir ya da birden fazlasnda gncelleme yapmak iin YS ekranna girer. \n \n \n a.\tYS nce Rza ptal API'sini arr. Sonra yeni deerlerle yeni bir rza isteinde bulunur. Tekrar GKD gerekir. \n b.\tYS rza iptal yapmadan yeni rza alma akna balarsa 1.b ak devreye girer. \n c.\tRza gncelleme ilerleyen srmlerde ele alnacaktr. \n \n \n Eriim Belirteci API \n a. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B ya da Yetki Kullanld - K  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n Sorgulama: HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir hesap bilgisi-rizasi kaynann durumunu, istee bal olarak alabilir. Rza numaras ile sorgulama yaplr. \n \n \n Hesap Bilgisi Rzasnn ptali: HBHS zerinden ya da HHS zerinden yaplan rza iptallerinde Rza durumu  Yetki ptal - I olarak gncellenir. Rza numaras ile iptal salanr. \n a. HHS zerinden rza iptali yapm olabilir.  Rza durumu sorgulanr. \n Rza numaras Yetki Bekleniyor - B ve Yetkilendirildi - Y ve Yetki Kullanld - K durumlarnda ise Yetki ptal durumuna getirilir. Rza gnclzmn timestamp ile gncellenir.\nHHS, Rza iptalinde ayn zamanda eriim belirtecini de invalid hale getirmelidir. \n B  I / 02 \n Y  I / 02 \n K  I / 02 \n b.\tYS zerinden yaplacak iptal ileminde yine Y ve B ve K rza durumlarnda ise iptal edilebilir. \n B  I / 03 \n Y  I / 03 \n K  I / 03 \n Rza durumu Yetki Sonlandrld - S  ise iptal gereklemez. Rza durumunuz iptal etmeye uygun deildir. hatas HK'ya yanstlr.  TR.OHVPS.Resource.ConsentRevoked \n \n \n HKnn verdii rza sresi dolmu olabilir.\nEriimin Geerli Olduu Son Tarih geldiinde Rza durumu Yetki Kullanlddan Yetki Sonlandrld durumuna ekilmelidir.   K  S \n \n \n Hesaplar, Bakiye ve lemler servislerinde eriim belirteci kontrol ve sonrasnda rza kontrol yaplmaldr.\nGeerli bir eriim belirteci yok ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda Hesaplar, Bakiye ve lemler servislerini armamas beklenir. HHS'nin bu rza durumlar ile yaplm arlar olduunda  TR.OHVPS.Resource.ConsentRevoked  hatasn dnmesi gereklidir. \n Rza durumu Yetki Kullanld - K dnda ise  TR.OHVPS.Resource.ConsentMismatch  hatas verilmelidir. \n Rza durumu Yetki Kullanld - K ise servis aklarna devam edilir. \n Rza sorgulama API'sinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound hatas  verilmelidir. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor durumunda kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor   Rza ptal  / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi durumunda kalan kaytlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am: Yetkilendirildi  B  I / 05 \nYukarda bahsedilen, YS Sre Am nedeniyle rza iptal durum gncellemelerini yapmadan nce HHSyi sorgulayarak rza durumunu renmeli ve sre am dnda bir kodu varsa ayn kodla kendi sistemini gncellemelidir. \nEriimin Geerli Olduu Son Tarih geldiinde rza durumu Yetki Kullanlddan Yetki Sonlandrldya gncellenir.  K  S \n 4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri \n Kural : Bir HK'nn bir YS iin bir HHS'de istedii kadar rzas olabilir. \n Kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n deme Emri Rzas istei HHSye iletilir. eride rza olup olmamasna baklmakszn  Yetki Bekleniyor - B  rza durumu ile yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.   B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Browser kapatm olabilir)\nRza durumu Yetki Bekleniyor'dur. 5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B durumundaki kaytlar Rza ptal : Yetki Bekleniyor Sre Am olarak gncellenir. Bkz. 8. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine rizaIptDtyKod deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n GKD muafiyeti olduunda YS HHSden arka planda onay alr. Bu onay srasnda rza durumu  Yetkilendirildi  yaplr.  B  Y \n \n \n Eriim Belirteci API \na. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B , Yetki Kullanld - K  ya da Yetki deme emrine dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K veya Yetki deme Emrine Dnt  E olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n deme Balatma API nce eriim belirteci ve sonrasnda rza kontol yaplarak gerekletirilmelidir \n \n ncelikle Eriim Belirteci kontrol yaplmaldr. Geerli bir Eriim Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n Rza durumu Yetki Bekleniyor - B , Yetkilendirildi - Y, Yetki deme Emrine Dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n Rza durumu Yetki Kullanld - K olduunda deme emri gerekletirilir.  Rza durumu Yetki Kullanld - K'dan Yetki deme Emrine Dnt  E yaplmaldr.   K E \n \n \n \n Sorgulama: GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlarda, deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle, demeEmriRizasi nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr.\nRza sorgulama, deme Emri Sorgulama API'lerinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n \n \n deme Emri Rzasnn ptali bulunmamaktadr. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor'da kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor  Rza ptal / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi'de kalan kaytlar durumlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am : Yetkilendirildi  B  I / 05 \n 5 dakikadan uzun sredir Yetki kullanld'da kalan kaytlar durumlar gncellenir.\nYetki kullanld  Rza ptal / Sre Am : Yetki demeye Dnmedi  B  I / 06 \n Yenileme belirteci Son Tarih geldiinde rza durumu Yetki deme emrine dntden Yetki Sonlandrld'ya gncellenir. \n E  S \n \n \n GKD muafiyeti sadece deme balatma servislerinde bulunmaktadr. \n \n \n"},{title:"10.\tOlay Bildirim",frontmatter:{},regularPath:"/v1.1.0/contents/olay-bildirim.html",relativePath:"v1.1.0/contents/olay-bildirim.md",key:"v-206455c6",path:"/v1.1.0/contents/olay-bildirim.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Olay Abonelik Servisleri (OAS)",slug:"olay-abonelik-servisleri-oas"},{level:2,title:"ADIM 1: Olay Aboneliinin gerekletirilmesi",slug:"adim-1-olay-aboneliginin-gerceklestirilmesi"},{level:2,title:"ADIM 2: Olay Aboneliinin gncellenmesi",slug:"adim-2-olay-aboneliginin-guncellenmesi"},{level:2,title:"ADIM 3: Olay Aboneliinin sorgulanmas",slug:"adim-3-olay-aboneliginin-sorgulanmas"},{level:2,title:"ADIM 4: Olay Aboneliinin iptali",slug:"adim-4-olay-aboneliginin-iptali"},{level:2,title:"ADIM 5: Olay Aboneliinin letilemeyen Olaylar",slug:"adim-5-olay-aboneliginin-iletilemeyen-olaylar"},{level:2,title:"ADIM 6: Sistem Olay Dinleme",slug:"adim-6-sistem-olay-dinleme"},{level:2,title:"Olay Dinleme Servisleri (ODS)",slug:"olay-dinleme-servisleri-ods"},{level:2,title:"ADIM 1: Olay Dinleme",slug:"adim-1-olay-dinleme"},{level:2,title:"ADIM 2:  Sistem Olay Dinleme",slug:"adim-2-sistem-olay-dinleme"}],content:" 10.\tOlay Bildirim  \n Genel Bilgiler \n Olay Bildirim Abonelik API servisleri, HHS'lerin sunmu olduklar olay bildirimlerini takip etmek amacyla abonelik aklarn tanmlar. \n YS'ler olay bildirimlerini takip edebilmek iin talep ettikleri abonelik hizmetlerini belirterek HHS'ler zelinde bir abonelik kayd olutururlar. Bu abonelik kaydn okuyabilir, gncelleyebilir ya da silebilirler. \n Olay bildirimleri HHS'ler tarafndan 2 yntem ile salanr. lki olay bildirimlerinin anlk olarak iletilmesi, dieri ise anlk iletilemeyen olaylarn toplu olarak iletilmesidir. \n Olay Bildirimi 2 API ile ynetilecektir. \n 1 - Olay Abonelik Servisleri (OAS) \n2 - Olay Dinleme Servisleri  (ODS) \n Olay Abonelik ve Olay Dinleme API'lerinin istek ve yant balnda beklenen parametreler BH,HBH,GKD API'lerinden farkldr.\n 3.15. stek Bal  ve  3.16. Yant Bal  blmlerinde zorunlu parametreler ve aklamalar belirtilmitir. \n Olay Abonelik Servisleri (OAS) \n Olay abonelik Servisleri; HHS'ler tarafndan sunulacak olay bildirim abonelik servislerini ve iletilemeyen olaylar servisini iermektedir. \n HHS'nin sunaca bu API ile YS'ler u admlar gerekletirebilir. \n \n YS'n olay bildirimlerini dinleyebilmek iin ncelikle dinlemek istedii olaylara ait olay tipleri ve kaynak tiplerini belirlemesi gerekmektedir. \n Olay tipleri ve kaynak tiplerinin neler olaca \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda belirtilmitir. \n YS, belirledii olaylar iin HHS'ye olay abonelik endpointi aracl ile abonelik balatr. \n YS, abonelik numaras aracl ile abonelik bilgilerini grntleyebilir, gncelleyebilir, silebilir. \n YS, olay bildirimlerini bu abonelik sayesinde kendisinin sunaca Olay Dinleme API'si ile dinler. \n HHS anlk iletemedii olaylarn biriktirerek, iletilemeyen olaylar endpointi ile YS'e sunar. \n \n HHS'ler \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda belirlenen olay ve kaynak tiplerinin tm iin YS'lere bildirim sunmak zorundadr. \n Olay Abonelik Servislerinde Idempotency kurallarnn iletilmesine gerek bulunmamaktadr. \n Nezdinde deme hesab bulunduran baz hesap hizmeti salayclar(EPK, deme Kurulular) mterilerine ait hesaplar, dier HHS'lerdeki havuz hesaplarn kullanarak ynetiyor olabilir. Bu durum ilgili hesap hizmeti salayclarnn, HVPS kapsamnda HHS olduu rolde sunmas gereken olay bildirim servisleri ile ilgili uymas gereken kurallar deitirmemektedir. lgili hesap hizmeti salayclarnn standartlara uygun ekilde YS'lere bildirimleri yapmas gerekmektedir. \n YS'ler sahip olduklar rol zelinde olay abonelik servislerinden faydalanabilir. Bu yzden olay bildirim etki alan (scope) deerleri hesap_bilgisi ve/veya odeme_emri olarak belirlenmitir. \n Olay Abonelik Servisine ait API Endpointleri aadaki tabloda listelenmitir. \n Olay Abonelik Servisleri iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =hesap_bilgisi  \"odeme_emri\" \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n olay-abonelik \n POST \n /olay-abonelik \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n OlayAbonelikstegi \n OlayAbonelik \n \n \n 2 \n olay-abonelik \n GET \n /olay-abonelik \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n - \n OlayAbonelik \n \n \n 3 \n olay-abonelik/{olayAbonelikNo} \n PUT \n /olay-abonelik/{olayAbonelikNo} \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n OlayAbonelik \n OlayAbonelik \n \n \n 4 \n olay-abonelik/{olayAbonelikNo} \n DELETE \n /olay-abonelik/{olayAbonelikNo} \n Z \n stemci Kimlik Bilgileri \n - \n - \n - \n - \n \n \n 5 \n olay-abonelik/{olayAbonelikNo}/iletilemeyen-olaylar \n GET \n /olay-abonelik/{olayAbonelikNo}/iletilemeyen-olaylar \n Z \n stemci Kimlik Bilgileri \n - \n Sayfalama \n \n Olaylar \n \n \n 6 \n sistem-olay-dinleme \n POST \n sistem-olay-dinleme \n Z \n stemci Kimlik Bilgileri \n - \n - \n Olaylar \n - \n ADIM 1: Olay Aboneliinin gerekletirilmesi \n POST /olay-abonelik \n HHS'nin olay abonelik hizmeti sunduu servistir.\nYS, seecei olay-kaynak tipleri iin bu servis aracl ile abone olabilir. HHS POST ilemi sonucunda, YS adna bir olay abonelik kayna oluturur ve tekil tanmlayc olan olayAbonelikNo deerini dner. olayAbonelikNo retilirken farkl YS'ler iin ayn deer kullanlamaz. olayAbonelikNo evrensel tekil olmaldr. \n1 YS'n 1 HHS'de 1 adet abonelik kayd olabilir. \nBaarl POST istei sonucu HTTP 201 cevab ile iletilmelidir. \n YS tarafndan daha nce oluturulmu olay abonelik kayd varsa \"HTTP 400 -TR.OHVPS.Business.InvalidContent -Kaynak akmas\" hatasyla uyar mesajn dner. \n Olay Abonelik kayd oluturmak isteyen YS'n ODS API tanm HHS tarafndan kontrol edilmelidir. YS'n tanm olmamas halinde \"HTTP 400-TR.OHVPS.Business.InvalidContent\" hatas verilmelidir. \n Olay Abonelik kayd oluturmak isteyen YS tarafndan olay tipi ve kaynak tipi iin iletilen deerler olmas gereken sral veri tlerinden(TR.OHVPS.DataCode.OlayTip ve TR.OHVPS.DataCode.KaynakTip) farkl ise HHS tarafndan  \"HTTP 400-TR.OHVPS.Resource.InvalidFormat\" hatas verilmelidir. \n Abonelik zerinde grntleme, gncelleme, silme ilemlerini gerekletirebilir.\nYS'n Abonelii devam ettii srece; YS'n aaca Olay Dinleme API'sine, HHS tarafndan abonelik kapsamnda olay bildirimleri iletilir. \n BKM'nin sunaca abonelik servisleri iin HHS ve YS'lerin abonelik istei yapmasna gerek bulunmamaktadr. BKM retim ortam tanmlar yaplrken katlmclar abonelik servislerine ye yapacaktr. BKM'nin sunaca abonelik servislerinin olay tipi \"HHS_YOS_GUNCELLENDI\"dir. HHS ve YS API ile sunulan bilgilerde bir deiiklik olduunda yaplacak olay bildirimlerini salar.\nrnein; HHS logo bilgilerinde yaplacak bir deiiklik sonrasnda, YS'lere yaplacak bildirim ile logo bilgisini deien HHS'nin hhsKod deerini iletir. YS, HHS API'yi  hhsKod ile ararak HHS'nin gncel bilgilerini alr. Gncel bilgiler ile kendi sistemini gnceller. \n OlayAbonelikIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n \n \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n YS abone olmak istedii olay tiplerini TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deer ya da deerler ile doldurur. \n \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda \"Olay Bildirim Yapan\" kolonu \"HHS\" olan olay tipleri ile veri giriine izin verilir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n Olay tiplerinin tanmlanabildii kaynak listesi bulunmaktadr. Bu listeye uygun kaynak tipleri iletilmelidir. \n HHS, YS API zerinden YS'n rollerini alarak uygun kaynak tiplerine kayt olmasn salar. \n \n \n \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas iletilebilir. lk deeri olay abonelik oluturma zaman bilgisidir. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n \n \n \n \n Olay Tipleri ve Kaynak Tipleri likisi \n * Anlk : Olay gerekletikten sonra maksimum 5 saniye ierisindeki zaman \n \n \n \n Olay Tipleri \n YS Rol \n Kaynak Tipleri \n Olay Oluturulma durumu \n KaynakNo \n Asl verinin elde edilecei API \n Olay Bildirimini Yapan \n Olay Bildirim Zaman \n Retry Policy \n \n \n \n \n KAYNAK_GUNCELLENDI \n BH \n ODEME_EMRI \n Tm deme durum deiikliklerinde \n odemeEmriNo \n GET /odeme-emri/{odemeEmriNo} \n HHS \n Anlk \n 30 Dakika - 3 Deneme \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n Rza iptal detay kodu 02 : Kullanc stei ile HHS zerinden ptal durumunda \n RizaNo \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n HBH \n BAKIYE \n Bakiye nesnesindeki tutarla ilgili bir bilgi deitiinde ve HBH rzas ierisinde \"06-Anlk Bakiye Bildirimi\" izin tr varsa oluturulur. Mevcutta alnm rzalar iin  bakiye kaynak tipi zelinde 06 izin tr gerektiinden; mevcut rzann yenilenmesine dair mteriye bilgilendirme yaplarak 06 izin trn kapsayan yeni rza alnmas sreci YS tarafndan gerekletirilebilir. Bloke tutar deiiklii iin olay oluturma ve bildirimi HHS inisiyatifindedir. KrdHsp ierisinde yer alan kulKrdTtr deerinin deitii durumda olay bildirim gnderilmesi gerekmektedir. \n hspRef \n GET /hesaplar/{hspRef}/bakiye, GET /hesaplar/{hspRef}/islemler \n HHS \n Maksimum 10 dakika ierisinde \n Retry policy uygulanmamaldr. lk istek gnderilemedii durumda letilemeyen Olaylara eklenmelidir. \n \n \n \n HBH \n COKLU_ISLEM_TALEBI ( bulk-data) \n lgili API lke ve kurallarna eklendiinde gncellenecektir. \n \n \n HHS \n \n 30 Dakika - 3 Deneme \n \n \n AYRIK_GKD_BASARILI \n BH \n ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}}&rizaTip=O \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}&rizaTip=H \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n AYRIK_GKD_BASARISIZ \n BH \n ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /odeme-emri-rizasi/{RizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n HHS_YOS_GUNCELLENDI \n \n \n BKM sistemi tarafndan retilecek olaylar dinlemek iin kullanlacak kaynak tipidir. YS ve HHS'lerin BKM'ye abonelik oluturmasna gerek bulunmamaktadr. BKM HHS ve YS retim ortam tanm yaparken aboneliklerini balatacaktr.   (HHS yaygnlatrma durumundayken de abonelii balatlacaktr.) \n \n \n HHS \n \n \n \n \n \n YS \n HHS \n HHS bilgilerinde deiiklik olduunda, YS'n hhsKod ile sorgulama yapmas ve deien bilgiyi gncellemesi beklenmektedir. \n hhsKod \n GET /hhs/{hhsKod} \n BKM \n *Anlk \n 5 Dakika - 3 Deneme \n \n \n \n HHS \n YOS \n YS bilgilerinde deiiklik olduunda, HHS'nin yosKod ile sorgulama yapmas ve deien bilgiyi gncellemesi beklenmektedir. \n yosKod \n GET /yos/{yosKod} \n BKM \n *Anlk \n 5 Dakika - 3 Deneme \n \n \n \n * Anlk : Olay gerekletikten sonra maksimum 5 saniye ierisindeki zaman \n ADIM 2: Olay Aboneliinin gncellenmesi \n PUT\tolay-abonelik/{olayAbonelikNo} \n YS'n olay aboneliine ait abonelik tiplerini gncelleyebildii servistir. Olay abonelii oluturulduu zaman HHS tarafndan iletilen olayAbonelikNo aracl ile gncelleme ilemi yaplr. YS abone olmak istedii olay-kayt tiplerininin son halini gncelleme servisi ile HHS'ye iletir. HHS bu bilgilerle eski abonelik tiplerinin yerini deitirir. \n Baarl PUT istei sonucu HTTP 200 cevab ile iletilmelidir. \n OlayAbonelikIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n HHS geerli bir olay abonelik numaras olduunun kontroln yapar. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n HHS Sisteminde, YS'n eski abonelikleri yeni aboneliklerle gncellenmelidir. \n \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n YS abone olmak istedii olay tiplerini TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deer ya da deerler ile doldurur. \n \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda \"Olay Bildirim Yapan\" kolonu \"HHS\" olan olay tipleri ile veri giriine izin verilir.  Olay tipi AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ iin, YS'n ODS API'yi sunmas zorunludur. HHS, bu olay tipleri zelinde YS API zerinden YS'n bu API'yi sunduunu kontrol eder ve eer sunmuyor ise TR.OHVPS.Business.InvalidContent hatas dnerek kayt ilemini gerekletirmez. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n Olay tiplerinin tanmlanabildii kaynak listesi bulunmaktadr. Bu listeye uygun kaynak tipleri iletilmelidir. \n HHS, YS API zerinden YS'n rollerini alarak uygun kaynak tiplerine kayt olmasna izin verir. \n \n \n \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n ADIM 3: Olay Aboneliinin sorgulanmas \n GET /olay-abonelik \n YS olay abonelik bilgilerini sorgulamak isteyebilir. HHS, YS'e ait aktif durumdaki abonelik bilgisini iletir.\nBaarl GET sonucu HTTP 200 kodu ile iletilmelidir. \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n YS'n abone olduu olay - kaynak listesini dner. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deerler ierir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden deerler ierir. \n ADIM 4: Olay Aboneliinin iptali \n DELETE /olay-abonelik/olayAbonelikNo \n YS'n abonelik kaydn silmesi iin HHS'nin sunduu servistir.  Baarl silme ilemi sonucu HTTP 204 ile YS'e iletilir. \n ADIM 5: Olay Aboneliinin letilemeyen Olaylar \n GET /iletilemeyen-olaylar \n HHS kaynaklar zerinde oluacak olaylar YS'e POST/olay-dinleme servisi ile gnderim salamaktadr. Bu gnderim belli bir yeniden gnderim politas (retry-policy) ile yaplmaldr.  Ancak yine de iletilemeyen olaylar olursa (YS servisinden HTTP 202 alamama durumu) YS'e iletilemeyen-olaylar servisi zerinden sunulmaldr. Yani yeniden gnderim politikas sonunda gnderilemeyen olaylar bu servis ile sunulmaldr. \n Ayn kaynak numaras ile ayn olay-kaynak tipinde, 1 YSe ait, 1 adet iletilemeyen olay kayd olabilir. \n Bu serviste 1 gn ncesinden sorgu anna kadar tm kaytlarna ait iletilemeyen olaylar listelenmelidir.\nrnek sorgu zaman : 2023-04-06T15:14:00+03:00\nHHS'nin sunaca veri 2023-04-05T00:00:00+03:00  ile 2023-04-06T15:14:00+03:00 arasnda olmaldr.\nSralama yn olay tarihine gre artan ekilde olmaldr. Sayfalama 100'er kayt dnlerek yaplmaldr. \n YS tarafndan iletilemeyen olaylar istei 10 dakikada bir olacak ekilde yaplabilir. HHS bu limite uygun ilem kst uygulayabilir. \n lem Sorgu rnei GET lem Sorgu rnei  : /iletilemeyen-olaylar?syfNo=1&olyZmnBslTrh=2024-01-08T16:42:00+03:00&olyZmnBtsTrh=2024-01-09T17:09:00+03:00 \n rnein; \n olyZmnBslTrh : 07/01/2024 10:00:00+03:00\n olyZmnBtsTrh : 09/01/2024 16:00:00+03:00\n Sorgu Zaman : 09/01/2024 10:15:00+03:00 \n Yant ierisinde yer alan veriye ait tarih aral : 08/01/2024 00:00:00+03:00 - 09/01/2024 10:15:00+03:00 olmaldr. \n Balang ve biti zaman aral rnekte yer alan ekilde seilse dahi ilgili servis yant iin ncelikle sorgu zamanna baklp 1 gn ncesinden sorgu anna kadar tm kaytlarn iletilemeyen olaylar ierisinde listelenmesi salanmaldr. \n lgili tarih aralnda uygun veri olmamas halinde yant gvdesi bo olacak ekilde dnlmelidir. \n letilemeyen Olaylar Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS letilemeyen Olaylar listesine ait bu sayfadaki kaytlar gndermelidir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gndermelidir. \n \n \n Olay Zaman Balang Tarihi \n olyZmnBslTrh \n ISODateTime \n  \n Sorgulanacak Olay Zamanna ait balang tarihi \n HHS'ler iletilemeyen olaylar listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan tetiklenen sorgularda; olyZmnBslTrh iletilmedii durumda ya da 1 gn ncesinin balang saatine gre daha geri bir zaman dilimi gnderildiinde, balang zaman(olyZmnBslTrh) deeri sorgu zamanndan 1 gn ncesine ait gnn balang zaman olarak kabul edilmelidir. \n \n \n Olay Zaman Biti Tarihi \n olyZmnBtsTrh \n ISODateTime \n  \n Sorgulanacak Olay Zamanna ait biti tarihi \n HHS'ler iletilemeyen olaylar listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan tetiklenen sorgularda; olyZmnBtsTrh iletilmedii durumda ya da sorgu zamanndan daha ileri bir zaman dilimi gnderildiinde, biti zaman(olyZmnBtsTrh) deeri sorgu zaman olarak kabul edilmelidir. \n \n \n \n Tablo 17: Olaylar nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Olaylar \n olaylar \n Kompleks: Olaylar \n Z \n \n \n \n >Olay No \n olayNo \n AN1..64 \n Z \n Olaya ait evrensel tekil numaradr. \n \n \n >Olay Zamani \n olayZamani \n ISODateTime \n Z \n Olayn olutuu tarih bilgisidir. \n \n \n >Olay Tipi \n olayTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden birini alr. \n \n \n >Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden birini alr. \n \n \n >Kaynak Numaras \n kaynakNo \n AN1..128 \n Z \n Gncellenen kaynaa ait HHS sistemindeki tekil tanmlayc. \n \n \n \n Kaynak numarasnda gnderilen deer ile ilgili kayna sorgulayarak almak YS'n insiyatifindedir. \n ADIM 6: Sistem Olay Dinleme \n POST /sistem-olay-dinleme \n HHS'lerin sistem olaylarn dinleme amacyla amas gereken endpoint bilgisidir. \n YS API ierisinde yaplan deiikliklerde, BKM tarafndan HHS'lere olay bildirimlerini yaplr. \n Olaylar yant nesnesi ierisinde 1 adet kayt yer almaldr. \n Baarl POST istei sonucu HTTP 202 Accepted kodu ile dnlmelidir. \n HHS'den baarl yant alnamad durumda, 5 dakika aralklarla 3 kez deneme yaplacaktr. Hata alnmaya devam edilmesi durumunda baka bir aksiyon alnmayacaktr. \n Olay Dinleme Servisleri (ODS) \n YS sunaca Olay Dinleme Servisi ile hem HHS'den hem de BKM'den gelen olaylarn bildirimini dinleyebilir. YS'ler HHS'de yer alan olay abonelik kaytlarn iptal edebilir ancak BKM Sistem Olay Dinleme servisinin iletecei bildirimlerin alnmas zorunlu olduundan ODS API her zaman aktif olmaldr. \n HHS'den gelecek olay bildirimlerini olay-dinleme endpointi ile dinlerken, BKM'den gelecek olay bildirimlerini sistem-olay-dinleme endpointi ile dinlemelidir. \n Olay Dinleme Servislerinde Idempotency kurallarnn iletilmesine gerek bulunmamaktadr. \n Olay Dinleme Servisine ait API Endpointleri aadaki tabloda listelenmitir. \n Olay Dinleme Servisleri iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =olay_dinleme \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n olay-dinleme \n POST \n /olay-dinleme \n Z \n stemci Kimlik Bilgileri \n mzal stek \n - \n Olaylar \n - \n \n \n 2 \n sistem-olay-dinleme \n POST \n /olay-dinleme \n Z \n stemci Kimlik Bilgileri \n - \n - \n Olaylar \n - \n ADIM 1: Olay Dinleme \n POST /olay-dinleme \n Olay abonelik servisi ile abone olunan olaylar, olay dinleme servisi ile YS'e iletilir.\nOlaylar yant nesnesi ierisinde en fazla 100 kayt gnderilmelidir.\nBaarl POST istei sonucu HTTP 202 Accepted ile dnlmelidir. \n HHS'nin ilem hata aldnda, baarl ilem olana kadar 3 kez deneme yaplmas gerekmektedir.\nlk istekle son istek arasnda 30 dakika olacak ekilde, zamana yayarak bu denemelerin yaplmas gerekmektedir. (Exponential backoff policy uygulanmas beklenmektedir. )\nHHS kendi sistemini yormayacak ekilde, belirleyecei kurallar dahilinde bu gelitirmeyi yapmaldr. \n Tablo 17: Olaylar nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n >Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >>Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n >> Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n >Olaylar \n olaylar \n Kompleks: Olaylar \n Z \n \n \n \n >>Olay Numaras \n olayNo \n AN1..64 \n Z \n Olaya ait atanm tekil kimlik numaras \n \n \n >>Olay Zaman \n olayZamani \n ISODateTime \n Z \n Olayn oluma zaman \n \n \n >>Olay Tipi \n olayTipi \n AN1..36 \n > \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden birini alr. \n \n \n >>Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden birini alr. \n \n \n >>Kaynak Numaras \n kaynakNo \n AN1..128 \n Z \n Gncellenen kaynaa ait HHS sistemindeki tekil tanmlayc. \n ADIM 2:  Sistem Olay Dinleme \n POST /sistem-olay-dinleme \n YS'lerin sistem olaylarn dinleme amacyla amas gereken endpoint bilgisidir. \n HHS API ierisinde yaplan deiikliklerde, BKM tarafndan YS'lere olay bildirimlerini yaplr. \n Olaylar yant nesnesi ierisinde 1 adet kayt yer almaldr. \n Baarl POST istei sonucu HTTP 202 Accepted kodu ile dnlmelidir. \n YS'ten baarl yant alnamad durumda, 5 dakika aralklarla 3 kez deneme yaplacaktr. Hata alnmaya devam edilmesi durumunda baka bir aksiyon alnmayacaktr. \n"},{title:"3. Temel Prensipler",frontmatter:{},regularPath:"/v1.1.0/contents/temel-prensipler.html",relativePath:"v1.1.0/contents/temel-prensipler.md",key:"v-2fcc3a95",path:"/v1.1.0/contents/temel-prensipler.html",headers:[{level:2,title:"3.1 Genel",slug:"_3-1-genel"},{level:2,title:"3.2.\tstem (ar) ve Oturum",slug:"_3-2-istem-cagr-ve-oturum"},{level:2,title:"3.3.\tRESTful API",slug:"_3-3-restful-api"},{level:2,title:"3.4.\tSrm Ynetimi",slug:"_3-4-surum-yonetimi"},{level:2,title:"3.5.\tKaynak URI Yol Yaps",slug:"_3-5-kaynak-uri-yol-yaps"},{level:2,title:"3.6.\tKarakter Kodlama",slug:"_3-6-karakter-kodlama"},{level:2,title:"3.7.\tVeri Format",slug:"_3-7-veri-format"},{level:2,title:"3.8.\tstemci Sertifika Ynetimi",slug:"_3-8-istemci-sertifika-yonetimi"},{level:2,title:"3.9.\tYetkilendirme Trleri",slug:"_3-9-yetkilendirme-turleri"},{level:2,title:"3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar",slug:"_3-10-istek-cevap-mesajlarnda-kullanlan-nesne-yaplar"},{level:2,title:"3.11. Sayfalandrma ve Filtreleme",slug:"_3-11-sayfalandrma-ve-filtreleme"},{level:2,title:"3.12. Mesaj mzalama",slug:"_3-12-mesaj-imzalama"},{level:2,title:"3.13. Durum Kodu",slug:"_3-13-durum-kodu"},{level:2,title:"3.14. Gereksinimlerinin Snflandrlmas",slug:"_3-14-gereksinimlerinin-snflandrlmas"},{level:2,title:"3.15. stek Bal",slug:"_3-15-istek-baslg"},{level:2,title:"3.16. Yant Bal",slug:"_3-16-yant-baslg"},{level:2,title:"3.17. Idempotency Kurallar",slug:"_3-17-idempotency-kurallar"},{level:2,title:"3.18. HTTP Durum Kodlar",slug:"_3-18-http-durum-kodlar"},{level:2,title:"3.19. Maskeleme Kurallar",slug:"_3-19-maskeleme-kurallar"},{level:2,title:"3.20. Fonksiyonel Olmayan Gereksinimler",slug:"_3-20-fonksiyonel-olmayan-gereksinimler"},{level:2,title:"3.21. Otomatik Sorgular",slug:"_3-21-otomatik-sorgular"}],content:' 3. Temel Prensipler  \n Bu blmde deme Hizmetleri Veri Paylam Servisleri (Hesap Bilgisi Hizmeti, deme Emri Balatma Hizmeti) iin tanmlanan temel prensipler aklanmaktadr. \n 3.1 Genel \n \n \n HHSler Ynetmeliin 59. maddesinin beinci fkras ve deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebliin (Tebli) 23. maddesinin birinci fkras uyarnca, deme hizmetleri veri paylam servislerini GET araclyla HBHS ve BHSye sunmakla ykmldr. \n \n \n Tebliin 23. maddesinin ikinci fkras uyarnca deme emri balatma hizmetinde ak iletiim servisinin taraflar BHS ile HHSdir. \n \n \n Tebliin 23. maddesinin nc fkras uyarnca hesap bilgisi hizmetinde ak iletiim servisinin taraflar HBHS ile HHSdir. \n \n \n Ynetmeliin 60. maddesinin birinci fkras uyarnca mteri, deme emri balatma hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Ynetmeliin 61. maddesinin birinci fkras uyarnca mteri, hesap bilgisi hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Tebliin 25. maddesi uyarnca HHS ve YS (BHS ve HBHS) arasnda balant utan uca gvenli bir ekilde salanr. Bu amala iletim katmannda TLS (asgari 1.2 srm) ile ifreli iletiim salanr. \n \n \n Tebliin 23. maddesinin drdnc fkras uyarnca HHS tarafndan sunulan deme hizmetleri veri paylam servislerini kullanan yetkilendirilmi deme hizmeti salayclarnn TCMB tarafndan ilgili deme hizmeti iin yetkilendirilmi olduu kontrol edilir. \n \n \n Tebliin 25. maddesinin beinci fkras uyarnca zaman damgas, 15/1/2004 tarihli 5070 sayl Elektronik mza Kanunu kapsamnda tanmlanan zaman damgasna dayanr. \n \n \n API alan isimleri Trke olarak tanmlanmtr. Ancak API bal (header) alanndaki alan isimleri zelinde, API Geitleri tarafndan otomatik olarak tannabilmesi gzetilerek, ngilizce isimlendirme tercih edilmitir. \n \n \n HK halihazrda deme hesaplarna, evrim ii (mobil bankaclk, internet bankacl vb.) eriebilir durumda ise, HHS\'nin varsa Ak Bankaclk kanal veya yetki tanmn varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. HHSnin, Bireysel/Kurumsal/Ticari mteri ayrm yapmakszn tm mterileri iin, evrim ii kanallarda hesap hareketlerine eriim ve deme yapabilme yetkisi bulunmas durumunda, yine ayn ekilde Ak Bankaclk kanal veya yetki tanmn da varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. HHS Ak Bankaclk hizmetini kanal/yetki tanm ile ynetmesi durumunda hizmeti verdii ilgili kanallar(web,mobil) zerinden mterisine Ama/Kapama olana eklinde sunmas gerekmektedir. \n \n \n 5411 Sayl Kanun kapsamndaki bankalar, HHS API ierisinde Aktif durumda listelenmemiken, YS API ierisinde listelenemezler. \n 3.2.\tstem (ar) ve Oturum \n \n \n Her istek tekil istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Birden fazla istek ieren ilem YS tarafndan belirlenen arya zg talep kimlii (istek numaras: X-Request-ID) ve rza srecine zg talep kimlii (ilem grup numaras: X-Group-ID) deerleri kullanlmaldr. Ayn rza noya ait tm isteklerde ayn X-Group-ID bilgisi deeri gnderilmelidir. \n \n \n Oturum takibi ise PSU-Session-ID ile yaplr. Oturum numaras (PSU-Session-ID) HKl ilemler iin zaman damgas (PSU-Timestamp) ile birlikte ilgili tm ilem verilerini ierecek ekilde kayt altna alnr. \n \n \n rnein, bir deme emri balatma ilemi birden fazla istekten oluur. Her istek yukarda belirtildii gibi biricik istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Ancak ilemin oturum btnl PSU-Session-ID ile salanr. \n \n \n Taraflar atklar oturumu ilem btnln salayacak sre ierisinde ak tutar ve ilem biter bitmez kapatr. \n 3.3.\tRESTful API \n APIler, dnya leinde yaygn bir ekilde kullanlan Temsili Durum Transferi (Representational State Transfer, REST) mimari tarz ve JavaScript Nesne Notasyonu (JavaScript Object Notation, JSON) veri formatlarna uygun olarak gelitirilir. En st seviye Veri Tanmlama Dili (Data Description Language) ve en iyi uygulama rnekleri iin  ^JSON emas  temel alnr. \n stek ve yant mesajlarnda, istee bal veya koullu bir alan, deer iermiyorsa, bu alan JSON payloadunda yer almamaldr. \n rnek kod blou. \n "rzBlg":{\n         "rizaNo":"aa9bd7e7-0ccd-4edc-9639-5a358dbf2335",\n         "olusZmn":"2022-11-28T12:00:21+03:00",\n         "gnclZmn":null,    --\x3e hatal\n         "rizaDrm":"K",\n         "rizaIptDtyKod":"" --\x3e hatal \n      },\n \n rnek kod blou: \n \n         "alc":{\n            "hspNo": "TR800800004162387689546019",\n            "unv": "AHMET YILMAZ", \n            "kolas":{}  --\x3e nesne gnderimi hatal\n         },\n 3.4.\tSrm Ynetimi \n API sonraki aamalarda doabilecek gereksinimleri ve daha karmak kullanm durumlarn karlamak iin srmler halinde gelitirilir ve bu durum tasarm srasnda gz nnde bulundurulur. \n API v1.0.2 srmnde ; \n \n Kapsamdaki deme hesaplar : Vadesiz TL, yabanc para hesaplar (gerek ve tzel kiilere ait deme hesaplar), Kredili Mevduat Hesab \n Tekil deme (Virman/Havale/FAST/Mterileraras TL Aktarm Sistemi)\n \n Virman ve havale ilemleri kapsamnda yabanc para transferi yaplabilir. \n \n \n Hesap bilgisi hizmetleri\n \n Temel veya ayrntl hesap bilgisi \n Bakiye \n Gerekleen ilemler iin Hesap hareketleri \n \n \n Karekodlu demelerdeki 01, 02 ve 03 ak trleri\nyer almaktadr. \n \n API v1.1.0 srmnde ; \n \n API v1.0.2 srmne ek Olay Bildirim ve Ayrk GKD zellikleri eklenmitir. Srelerin daha iyi ilemesi iin eitli gncellemeler yaplmtr. \n \n Her srm deiikliinde bir nceki srm belirli bir sre desteklenecektir. Dier bir ifadeyle, sadece belirli bir sre iin mevcut ve bir nceki srm ayn anda eriilebilir olacaktr. \n 3.5.\tKaynak URI Yol Yaps \n YSlerin balatt arlarda URI yolu aadaki yapy takip eder: \n [hhs-yol-n-eki]/ohvps/ [kaynak-grubu]/ [srm]/ [kaynak]/[kaynak-no]/[alt-kaynak] \n Bu, aadaki unsurlardan oluur: \n \n [hhs-yol-n-eki] \nstee bal, HHS\'ye zg yol n ekini ifade eder. \nGET zerinden yaplan arlarda BKM tarafndan belirlenen sistem ad ve yol n eki kullanlr. \n ohvps \nSabit metin ohvps (deme Hizmetleri Veri Paylam Servisleri ksaltmas) \n [kaynak-grubu] \nKaynak grubu, APIye erimek iin kullanlan deme hizmetine (HBH, BH) gre eriim adresi (end point) grubunu tanmlar (hbh veya obh). \n [srm] \nAPI srmn ifade eder (/s[ana-srm].[alt-srm]/). \n [kaynak]/[kaynak-no] \nKaynak detaylarn ifade eder. \n [alt-kaynak] \nAlt kaynak detaylarn ifade eder. \n \n HHS, tm kaynaklar iin ayn katlmc yolu n ekini ve sistem adn kullanmaldr. \n BKM APIlerine erimek isteyen uygulamalarn yetkilerine gre aadaki APIlere abone olmalar gerekmektedir: \n OBH: \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s1.1/odeme-emri-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s1.1/odeme-emri \nHBH: \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesaplar \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesaplar/1234/islemler \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesaplar/1234/bakiye \nGKD \n https://gecit-api.bkmtest.com.tr/ohvps/gkd/s1.1/erisim-belirteci \nHHS  YS API \n https://gecit-api.bkmtest.com.tr/hhs-api/s1.1/hhs \n https://gecit-api.bkmtest.com.tr/hhs-api/s1.1/hhs/1234 \n https://gecit-api.bkmtest.com.tr/yos-api/s1.1/yos \n https://gecit-api.bkmtest.com.tr/yos-api/s1.1/yos/1234 \n HHSlerin salayacaklar APIlerdeki URI evrimi rnekleri aadaki gibidir. \n \n https://xbank.com.tr/api-portal/ohvps/obh/s1.1/odeme-emri \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s1.1/odeme-emri  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesap-bilgisi-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesaplar   (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesaplar/1234 \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesaplar/1234  (BKM API) \n \n GET zerinden yaplan arlarda, istek balnda bulunan x-aspsp-code (istein iletildii Hesap Hizmeti Salaycsnn kodu) deerine gre HHS APIde standart olarak tanmlanm olan basePath bilgisine servis uzants eklenerek HHSye ynlendirme yaplr. \n rnein, istek balnda  xbank n kodu varsa, YS tarafndan yaplan \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s1.1/hesap-bilgisi-rizasi \nars GET tarafndan karlanarak \n https://xbank.com.tr/api-portal/ohvps/hbh/s1.1/hesap-bilgisi-rizasi \nadresine ynlendirilir. \n Bu rnekte,  https://xbank.com.tr/api-portal  basePath bilgisi HHS tarafndan HHS APIye girilen deerdir. \n NEML :  URI Query parametreleri GET ile iletilirken deerlerde url-encode yaplmaldr. rnek bir API istei; \nGET /ohvps/hbh/s1.1/hesaplar/xxx/islemler?hesapIslemBslTrh=2023-02-07T16:42:38%2B03:00&hesapIslemBtsTrh=2023-02-07T17:09:18%2B03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfKytSayi=10&syfNo=1 \n Burada \'+\' karakterinin boluk olarak alglanmamas iin %2B deeri ile iletilmitir. \n 3.6.\tKarakter Kodlama \n API istekleri ve yantlarnn  Balk  parametrelerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr.  3.15. stek Bal  blmnde detaylandrlmtr. \n API istekleri ve yantlarnda  Gvde  parametrelerinde UTF-8 karakter kodlamas kullanlr. Bu, JSON iin varsaylan karakter kodlamasdr. \n Ancak, bir HHS\'nin kendi uygulamalar ve deme balatt deme sistemi (Havale vb.) baz UTF-8 karakterlerini kabul etmeyebilir. HHS, UTF-8 kodlamas ieren bir mesaj ileyemez ve reddederse, HTTP 400 (Hatal stek) durum kodu ile yant vermelidir. \n Gvde parametrelerinde desteklenen UTF-8 karakter kmesi aada listelenmitir. \n \n \n \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n \n \n \n \n \n 20 \n = \n 3d \n X \n 58 \n r \n 72 \n \n \n ! \n 21 \n ? \n 3f \n Y \n 59 \n s \n 73 \n\n 23 \n @ \n 40 \n Z \n 5a \n t \n 74 \n \n \n % \n 25 \n A \n 41 \n [ \n 5b \n u \n 75 \n \n \n & \n 26 \n B \n 42 \n \\ \n 5c \n v \n 76 \n \n \n \' \n 27 \n C \n 43 \n ] \n 5d \n w \n 77 \n \n \n ( \n 28 \n D \n 44 \n ^ \n 5e \n x \n 78 \n \n \n ) \n 29 \n E \n 45 \n _ \n 5f \n y \n 79 \n \n \n * \n 2a \n F \n 46 \n a \n 61 \n z \n 7a \n \n \n + \n 2b \n G \n 47 \n b \n 62 \n { \n 7b \n \n \n , \n 2c \n H \n 48 \n c \n 63 \n } \n 7d \n \n \n - \n 2d \n I \n 49 \n d \n 64 \n  \n c3 \n \n \n . \n 2e \n J \n 4a \n e \n 65 \n  \n c3 \n \n \n / \n 2f \n K \n 4b \n f \n 66 \n  \n c3 \n \n \n 0 \n 30 \n L \n 4c \n g \n 67 \n  \n c3 \n \n \n 1 \n 31 \n M \n 4d \n h \n 68 \n  \n c3 \n \n \n 2 \n 32 \n N \n 4e \n i \n 69 \n  \n c3 \n \n \n 3 \n 33 \n O \n 4f \n j \n 6a \n  \n c4 \n \n \n 4 \n 34 \n P \n 50 \n k \n 6b \n  \n c4 \n \n \n 5 \n 35 \n Q \n 51 \n l \n 6c \n  \n c4 \n \n \n 6 \n 36 \n R \n 52 \n m \n 6d \n  \n c4 \n \n \n 7 \n 37 \n S \n 53 \n n \n 6e \n  \n c5 \n \n \n 8 \n 38 \n T \n 54 \n o \n 6f \n  \n c5 \n \n \n 9 \n 39 \n U \n 55 \n p \n 70 \n \n \n \n \n : \n 3a \n V \n 56 \n q \n 71 \n \n \n \n \n ; \n 3b \n W \n 57 \n \n \n \n \n \n \n \n Ancak  Eriim belirteci, Yenileme belirteci ve Authorization  parametreleri daha dar bir karakter kmesi ile doldurulmaldr. \n Bearer HTTP Authorization emas RFC 6750\'de tanmlanmtr.  https://www.rfc-editor.org/rfc/rfc6750#section-2.1  blmnde izin verilen karakterlerin gnderilmesi beklenmektedir. Buradaki standartn her 3 parametre iin de uygulanmasna karar verilmitir. \n RFC 6750 ierisinde bearer token format u ekildedir : 1*( ALPHA / DIGIT / "-" / "." / "_" / "~" / "+" / "/" ) *"=" \nAugmented BNF for Syntax Specifications (ABNF) ile ifade edilen bu formatta token en az 1 adet alfanumerik karakter veya zel karakter ("-", "." , "_" , "~" , "+" , "/")  iermeli ve 0 ya da daha ok sayda "=" karakteri ile bitmelidir. \n ALPHA = A-Z / a-z aralndaki harflerdir. \nDIGIT = 0-9 aralndaki rakamlardr. \n 3.7.\tVeri Format \n \n Ak bankaclk kapsamndaki zaman damgas, ISO 8601 standartna uygun olarak yerel saat bilgisini ve timezone bilgisini de ierecek ekilde " yyyy-MM-ddTHH:mm:ssXXX " formattaki haliyle hazrlanmaldr. \n \n rnek:  "timestamp": "2021-05-30T20:34:15+03:00" \nyyyy : 4 hane yl \nMM : Baa 0 eklenmi, toplam 2 hane ay \ndd    : Baa 0 eklenmi, toplam 2 hane gn \nHH    : Baa 0 eklenmi, toplam 2 hane saat (0-23 aras deer alabilir.) \nmm : Baa 0 eklenmi, toplam 2 hane dakika \nss    : Baa 0 eklenmi, toplam 2 hane saniye \nXXX : ISO 8601 Time zone \n \n \n Zaman damgas hesaplamalarnda, yeni gnn balang saatinin 00:00:00 olduu kabul edilmitir. \n \n \n JWT veri paketlerinde kullanlan zaman damgalar, 1 Ocak 1970 Saat 00:00:00 (UTC) anndan itibaren geen saniye says deerini (Unix Time) kullanmaldr. \n \n \n Bir HHS, tarihi yanl biimlendirilmi bir istek aldnda, 400 (Hatal stek) durum kodu ve ilgili hata kodu ile yant vermelidir. \n \n \n ISO 4217 Standartnda para birimleri ve ka basamak ondalk deer ierebilecekleri belirlenmitir. \n https://www.iso.org/iso-4217-currency-codes.html   adresinden cretsiz olarak listeye eriilebilir.  \nAPI Standartlarnda da para birimleri  ISO 4217de tanmlanm olan 3 harfli kodlarla iletilir.   Tm tutar alanlar ISO 4217\'de tanmlanm para birimlerinin ondalk basamak deerleri de gz nnde bulundurularak iletilmelidir. Tutar alanlar art ya da eksi deer alabilecei iin API deseninde tanmlanm regular expressionlar dikkate alnmaldr. \nrnein; Bakiye API\'sindeki "Kredili Mevduat Hesab Bakiyesi" alan "-100.25" ve "Para Birimi" alan "TRY" olarak iletildiinde 25 deerinin kuru olduu anlalmaldr. \ndeme Emri Rzas API\'sinde yer alan "lem Tutar" alan "104.75" TRY olarak iletildiinde "75" deerinin kuru olduu anlalmaldr. \n"12000" Japon Yeni iin, ISO 4217de JPY para biriminin ondalk ksm olmadndan "lem Tutar" alannda "12000" ve "Para Birimi" alannda "JPY" deeri  iletilmelidir. \n \n \n Altn para birimi zelinde ISO 4217ye uygun olarak "XAU" cinsinde ve 2 basamak ondalk rakam ierecek ekilde iletilmelidir. rnein ierisinde "13,50 gr" altn olan hesap iin bakiye "13.50", para birimi "XAU" olarak gnderilmelidir. \n \n \n Dier madenlerde ondalk basamak ISO 4217 standartnda tanmland gibi olmaldr. \n \n \n Sral veri tipleri byk kk harfe duyarl olmaldr. \n 3.8.\tstemci Sertifika Ynetimi \n HVPS kapsamnda YS ve HHSlerin gvenli bir ekilde tanmlanmas amacyla elektronik sertifikalar kullanlr. \n HVPS kapsamnda taraflarn gvenli bir ekilde tanmlamas, utan uca gvenli iletiim, mesaj ifreleme ve mesaj imzalama ilevleri 15/1/2004 tarihli ve 5070 sayl Elektronik mza Kanununda aklanan elektronik sertifikalar kullanlarak salanr. Elektronik sertifikada Trkiye Cumhuriyet Merkez Bankas tarafndan verilen kurulu kodu ve kuruluun trne dair bilgiler bulunur. \n GET zerinden yaplan eriimlerde YS ve HHSlere nceden datlm olan istemci sertifikalar kullanlarak taraflarn (sunucu) kimliklerinin dorulanmas salanacaktr. stemci sertifikalar hem test hem de retim ortamnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii sertifikasyon srecinde de snanacaktr. Sz konusu sertifikalarn datm prosedrleri ve kullanmlara ynelik aklamalar EK-3te yer verilmitir. \n 3.9.\tYetkilendirme Trleri \n GET zerinden yaplan arlarda iki temel yetkilendirme tr kullanlr: \n 1.\tstemci Kimlik Bilgileri:  Mteri onaynn gerekmedii, sadece YSn tanmlanp doruland API arlarnda kullanlr. YSn yetkilendirilmi olduu ve faaliyet izninin yapt hizmet arsna uygun olduu kontrol edilir.  Bu amala, YSlere clientId ve clientSecret tahsis edilecektir. YSler ilgili clientId ve clientSecret ile sadece yetkilendirilmi olduklar servislere eriebileceklerdir. YSler kendilerine BKM tarafndan sunulacak APIyi, kendi clientID ve clientSecret deerleri ile sorgulayarak stemci Kimlik Bilgileri belirtecini (access token) elde edeceklerdir.\nHHSler de GET zerindeki YS APIsini sorgulama maksad ile GET\'e geldiklerinde, kendilerine atanm olan clientID ve clientSecret bilgileri ile yetki kontrolleri yaplr.\nHHSler kendilerinden alnacak username ve password deerleri kullanlarak oluturulacak basic authentication metodu ile servislerini sunacaklardr. \n 2.\tYetkilendirme Kodu:  YSn dorulanmasnn yansra mterinin GKD ile dorulanmas gereken API arlarnda kullanlr. Mteri dorulanarak yetkilendirme kodu oluturulmas HHSnin yetkilendirme arayzne ynlendirilir. GKDnin baaryla tamamlanmas sonrasnda yetkilendirme kodu YSe dnlr. YS daha sonra HHSnin  eriim belirteci  (access token) eriim adresini (EK-3: POST /erisim-belirteci) armak suretiyle yetkilendirme kodunu bir eriim belirteci (access token) ile deitirerek ilgili kaynaklar kullanabilir. \n deme emri balatma ve hesap bilgisi hizmetlerinde hangi yetkilendirme trlerinin kullanlaca bilgisi, ilgili balklardaki eriim adresleri (endpoints) tablolarnda yer almaktadr. \n erisim-belirteci  erisim noktasndan elde edilen  erisimBelirteci  ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda  x-access-token  alannda iletilir.\nBelirli bir sre iin tanmlanan eriim belirteci (access token) deerinin yenileme belirteci (refresh token) ile yenilenmesi gerekir. \n Eriim adreslerinde kullanlan yetkilendirme tr ilgili eriim adresi tablolarnda belirtilmitir. \n 3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar \n stek ve Cevap mesajlarnda kullanlacak olan nesneler tm elemanlarn kapsayacak ekilde Ek-1 de listelenmitir. Tm listelenen elemanlar asndan (U nokta mesaj yaplarnn belirtildii tablolarda belirtildii zere) alann Zorunlu (z) veya stee Bal () olma durumlarna gre baz alanlar gnderilebilir veya gnderilmeyebilir. \n 3.11. Sayfalandrma ve Filtreleme \n Sayfalandrma \n arya dnlen kaynak nesnesi ierisindeki kaytlar bir sayfalandrma yaps ile arlacak ekilde istek oluturulur. \n Oluturulacak istein ierisinde parametreler ile filtreleme, sayfa bana gsterilecek kayt says ve hangi sayfann nyzde gsterilecei bilgileri eriim noktasna iletilir ve ilgili kaytlar cevap olarak alnr. \n Filtreleme \n HHS, birden ok kayt dnlmesi gereken GET arlarnda snrl filtreleme destei salamaldr. Filtre parametreleri her zaman kaynak nesnesinin belirli alanlarna zgdr ve nesne iin tanmlanan kurallara uymaldr. \n 3.12. Mesaj mzalama \n Elektronik imzalar, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini destekler. mzalarn kaynak baznda hangi istek ve yantlara uyguland belirlidir. \n API yalnzca TLS\'ye dayanrsa, dijital kaytlar ve inkr edilemezlik kantlarn tutmak zor olur. Bu nedenle, TLS\'ye dayanmayan bir inkr edilemezlik zm olarak API isteinin HTTP balnda bir JWS kullanlarak salanabilir. \n HTTP isteinin gvdesinin hash fonksiyonu (SHA256) ile zeti alnacaktr. Elde edilen zet, asimetrik anahtarlar destekleyen bir algoritma kullanlarak imzalanacak ve JWS elde edilecektir. \n Bir istek, YS\'nin zel anahtar ile imzalanacak ve bu istee karlk gelen yant, HHS\'nin zel anahtar tarafndan imzalanacaktr. \n Tm API istekleri ve yantlar imzalanmaz. Mesaj imzalamann zorunlu olup olmad, desteklenip desteklenmedii her API zelinde belirlenir. \n Anahtar Deposu \n HHS\'ler ve YS\'ler tarafndan gvenilen bir Gven Otoritesi (Trust Anchor), taraflar iin bir genel anahtar deposu salamaktan sorumludur. \n Gven Otoritesi, taraflardan herhangi birisinin oluturduu bir anahtar iftinin ak blmn saklayan merkezi bir dizin (BKM tarafndan tutulan merkezi kayt sistemi vb.) olacaktr. \n Mesajlar dorulamak iin taraflarn genel anahtarlarnn paylalmas iin BKM bir servis salayacaktr. HHS API olarak adlandrlm olan bu servis ile HHS ve YS listelerine ulalabildii gibi dorulama ilemi iin ihtiya duyulacak olan genel anahtarlara da bu servis zerinden eriilebilinecektir. \n lgili Mesaj ifreleme iin genel ak, Ek-5 blmnde detaylaryla paylalmaktadr. \n 3.13. Durum Kodu \n APIler, iki farkl amaca hizmet eden iki durum kodu kullanr: \n \n HTTP Durum Kodu, API arsnn (kaynaktaki HTTP ilemi) sonucunu yanstr. \n Baz kaynak payloadlarndaki Durum alan, kaynaklarn durumunu yanstr. \n 3.14. Gereksinimlerinin Snflandrlmas \n Eriim adreslerinin ve alanlarn kullanm Zorunlu(Z), stee Bal() veya Koullu(K) olabilir. Kullanmlara ilikin durumlar ve kullanmn (K) koullu olduu duruma ilikin aklamalar ilgili tablolarda belirtilmitir. \n HVPS API\'lerinin (HBH,BH,GKD) istek ve yantta kullanlacak balk isimleri, ilgili RFC dokmanlarnda ve aadaki tabloda yer ald ekilde kullanlacaktr.  Uygulamaya zellemi balklar "X-" ile balayacaktr. Balk isimlerinde yer alacak ksaltmalar (rn. PSU, ASPSP gibi) tamam byk harfle yazlacak ekilde tanmlanacaktr. Balk isimleri byk  kk harfe duyarl olmamaldr. rnein x-request-id ya da X-Request-ID olarak gnderilmi olan bir istek bal deikeni, sunucu tarafnda hata vermeyecek ekilde ilenebilmelidir. \n 3.15. stek Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "PSU-Device-Data" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n stek ve Yant balnda yer alan alanlarn; POST GET DELETE methodlarnda, OBH,HBH,GKD,OAS,ODS API\'leri baznda Zorunlu/Koullu/stee Bal kullanm durumlar aadaki tabloda listelenmitir. \n \n Tablo 2: stek Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n POST \n GET \n DELETE \n POST \n GET \n DELETE \n \n \n \n \n \n \n \n OBH HBH GKD \n OBH HBH GKD \n OBH HBH GKD \n OAS ODS \n OAS ODS \n OAS ODS \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras.   rnek: deme emri balatma i aknn her admda farkl x-request-id deeri kullanlr.   arlarn ayn yant dnmesinin beklendii durumlarda (idempotent ilemlerde) ayn deer ile ar yaplr. \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras.  Ayn rza noya ait tm isteklerde ayn x-group-id bilgisi deeri gnderilmelidir. rnek: deme emri balatma/hesap bilgisi i aknn her admnda ayn x-group-id deeri kullanlr. \n Z \n Z \n Z \n - \n - \n - \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder. Bu deerin application/json olarak gnderilmesi gerekmektedir. Hata durumlarnda application/problem+json da iletilebilir.  (Baka bir deere ayarlanrsa, HHS, 415 Desteklenmeyen Ortam Tr (Unsupported Media Type) ile yant vermelidir) \n Z \n - \n - \n Z \n - \n - \n \n \n X-ASPSP-Code \n AN4 \n Hesap Hizmeti Salaycsnn (HHS) kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n PSU-Auth-Date \n ISODateTime \n HKnn YS zerinde en son oturum at saat. [RFC7231] rnein:  auth-date: Tue, 11 Sep 2012 19:43:31 GMT \n  \n  \n  \n - \n - \n - \n \n \n PSU-IP-Address \n AN7..15 \n HK YS zerinde oturum amsa, ilemi balatt cihazn IP adresi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-IP-Port \n AN1..5 \n HK YS zerinde oturum amsa, ilemi balatt cihazn Port adresi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-GEO-Location \n AN1..36 \n HKnn ilemi balatt cihazn konum bilgisi. RFC2426 standartna uygun olarak paylalmaldr. rnein  GEO:"<enlem >, <boylam>GEO:52.506931,13.144558 \n  \n  \n  \n - \n - \n - \n \n \n PSU-User-Agent \n AN 1.. 255 \n HKnn ilemi balatt cihazn salad user-agent bilgisi. (Tarayc, versiyon, iletim sistemi bilgileri) \n  \n  \n  \n - \n - \n - \n \n \n PSU-Timestamp \n ISODateTime \n HKnn ilemi balatt cihazn tarih saat ieren zaman bilgisi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-Device-ID \n AN5..40 \n HK ilemi mobil uygulama araclyla balattysa, kullanlan mobil uygulama ilk yklendiinde oluturulan tekil cihaz veya uygulama belirteci. HK cihaznn UUID deeri kullanlabilir. \n  \n  \n  \n - \n - \n - \n \n \n PSU-Device-Data \n AN1..1024 \n HKnn ilemi balatt mobil cihaza ait veriler.  rnek alanlar:   - Platform - (Android, iOS, Windows 10 Mobile)  - Device Model   - OS Name   - OS Version - Locale - Time zone \n  \n  \n  \n - \n - \n - \n \n \n PSU-Initiated \n AN1 \n lemin HK tarafndan balatlmas durumunda E , sistem tarafndan balatld durumda H deerini, olay bildirimine istinaden yaplacak isteklerde O deerini almas beklenir. lemler servisinde yaplacak sistemsel sorgulardaki ilem limitlerini kontrol amacyla kullanlr. O deerinin gnderilebilecei API\'ler  Asl Verinin Elde Edilecei API  olarak ilgili sayfada yer alan Olay Tipleri ve Kaynak Tipleri likisi tablosunda yer almaktadr. Asl verinin elde edilecei API\'ler zelinde O gnderimi yaplabilir. O olarak yaplan her istee HHS\'nin yant vermesi gereklidir. Otomatik sorgularda uygulanan st limitler, O gnderimi durumunda geerli deildir. \n Z \n Z \n Z \n - \n - \n - \n \n \n PSU-Fraud-Check \n AN1..4096 \n YS\'lerin eitli gvenlik kontrollerini gerekletirerek, nemli grlen aadaki bilgileri HHS\'ler ile paylamalar gerekmektedir. Bu bilgiler nda mterinin profili oluturulmasna katk salanacaktr.   HKl ilemlerde (PSU-Initiated = E gnderildii durumlarda) gnderilmesi zorunludur.  Sistemsel yaplan API armlarmda, Olay Bildirim Servis armlarnda ve HHS-YS API armlarnda gnderilmesine gerek bulunmamaktadr.  Paylalacak bilgiler u ekildedir.   FirstLoginFlag  : HK\'nn, mterilik mrnde ilgili YS sistemine (mobil ya da web uygulamas) ilk login olma sresini ifade eden deer. HK\'nn ilk yapt HBH ya da BH ilemi deil, YS sisteminde kendini aktifletirme tarih aral bilgisidir.   YS, kullancnn ilk login bilgisini tutarak sonraki ilemlerinde bu bilgiyi belirlenen format ile HHS\'ye aktaracaktr. rnein; YS\'n 7 aydr mterisi olan bir kullanc iin bu alan "5" olarak YS tarafndan beslenecektir. Burada ama; ilgili kullancnn YS\'n eski bir mterisi mi, yoksa yeni bir mterisi mi olup olmadn anlamaktr.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   DeviceFirstLoginFlag  : HK\'nn, mterilik mrnde ilem annda kulland cihazla YS uygulamasna (web ya da uygulama tabanl) ilk login olma sresini ifade eden deer. HK cihaz deiiklii yaparsa FirstLoginFlag deeri sabit kalmal  ancak DeviceFirstLoginFlag deeri deimelidir.  FirstloginFlag deeri ile HKnn YS uygulamasna ilk login tarih bilgisi ile ilgili bilgi verilirken, DeviceFirstLoginFlag ile de HKnn YS uygulamasna farkl bir cihaz aracl ile ilk login tarihinin bilgisi verilmektedir.  rnein; HK 7 aydr YS\'n mterisi olabilir, byle bir durumda FirstLoginFlag deeri "5" olacaktr. Ancak son ilemini daha nce hi kullanmad bir cihazdan yapmtr. Yeni cihazdaki login sre aral 0-2 saat aralnda  olduu iin DeviceFirstLoginFlag deeri "1" olacaktr.FirstLoginFlag deeri yine "5" olarak kalmaya devam edecektir.Bu bilgi ile YS, ilgili HHS\'ye ilk kez geliyor olsa bile; HHS, mterinin YS\' uzun sredir kullandn ama yeni bir cihazla ilemlerine devam ettiini anlayabilecektir. Bir HK, farkl cihazlar veya platformlar zerinden YS ile etkileime girebilir.  Kullanc ve YS arasnda bir oturum balatlm ise YSn tutarl ve kalc bir kimlik (device id) atamas beklenmektedir.  Device ID: Web sitesi veya mobil uygulama kullanclar iin retilen, tarayc ya da mobil uygulama tabanl benzersiz (tekil) tanmlayc deer. Mobil uygulamalar iin HKnn ilk defa ilgili cihaza aktivasyon yapt tarih bilgisi alnmaldr.   Device ID bilgileri YS uygulama ortam (web ya da uygulama tabanl) ve HK cihaz baznda tutulmaldr. YSten balatlan ilem hangi uygulama ortamna ait ise ilgili ortamala ilikili tutulan Device IDnin ilk login tarihine baklarak gncel flag deeri hesaplanmaldr.  Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   LastPasswordChangeFlag  : HK\'nn, YS (cihaz bamsz)  uygulamasna login olduu ifre bilgisinin en son deitirildii sreyi ifade eden deer. Mterinin en son ne zaman ifre deiiklii yaptn anlamak iin kullanlan alandr. Yeni mteri ve hi ifre deiiklii yapmam olabilir, byle bir durumda ilgili alan "0" olarak beslenecektir.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   BlacklistFlag  : HK\'nn herhangi bir sebeple YS\'n sakncal mteriler listesinde bulunup bulunmadn ifade eden deer.   Burada ama herhangi bir sebeple YS tarafnda yasakl olarak kaytl olan HK bilgisinin, dolandrcl nceden tespit etmek amal HHS\'ye aktarlmas olarak aklanabilir. rnein, YS tarafndan tespit edilen dolandrc kullanclara ait device id bilgisi, bu kara listede tutulur daha sonra ayn cihazla baka bir HK ilem yapacak olsa bile bu alanda ilgili bilgi "1" deeri ile HHS\'ye aktarlr. HHS\'de olmayp YS tarafnda olan bu rnekteki sakncal mteri/cihaz bilgisinin, dolayl yoldan HHS\'ye aktarlmas amalanmaktadr.  Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   MalwareFlag  : YS uygulamasnn alt cihaz zerindeki son 21 gne ait zararl yazlm tespit bilgisini ifade eden deer. rnein HK\'nn cihaznda zararl yazlm olduu ayn 1\'inde YS tarafndan tespit edildi. Zararl yazlm tespitinden 2 saat sonra YS zerinden login olan HK\'nn durumu,  "1" olarak iletilecektir. Bir gn sonra ayn 2\'sinde, yeni bir zararl yazlm tespiti yok ancak mevcut zararl yazlm aktifse alan "2" deeri ile iletilecektir. Sreler artarak 21 gne kadar TR.OHVPS.DataCode.ZmnAralik deerlerine gre iletilecektir.Son 21 gn iinde yeni bir tespit yoksa ayn 22\'sinden itibaren ilgili alan  "0" deeri ile beslenecektir. Not: Zararl yazlm, bankaclk ilemlerinin yapld uygulamalara girite kullanlan bilgilerin (ifre, kullanc kodu gibi) ele geirilmesi amacyla kullanlan bir uygulama ya da kod parac olabilir. Bu amalar dnda kullanlan (bankacla ynelik bir zararl yazlm olmayan) yazlm tespitleri iletilmemelidir. YS kanallarna her bir loginde, kullanlan cihazda bir zararl yazlm var m yok mu kontrol yaplmaldr.   Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   AnomalyFlag  : Dier pheli durumlarn varln ifade eden deer. Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   UnsafeAccountFlag : HHS tarafndan aktarlan bilgi ile son 21 gn iinde HK\'nn dolandrclk maduru olmas durumunu ifade eden deer. rnein; HHS 1, ayn 1\'inde sphe veya sahtekarlk nedeniyle bir deme ilemine izin vermedii durumda, bu bilgiyi rza iptal detay kodu ile YS\'e aktarm olur. Bu bilgiyi tutan YS, ilgili mterinin 15 dakika sonra HHS 2\'de yapt ilem iin ilgili alan "1" deeri ile besler. Bylece HHS 2, HK\'nn farkl bir HHS\'de son 15 dakika iinde pheli veya sahte bir ilemi olduunu anlayabilecektir. Ayn 22\'sinde yeni bir tespit/kayt yoksa bu alan YS tarafndan "0" olarak beslenecektir. Gnderilmesi Opsiyonel alandr.TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.     Flaglar JWT claims iine key value eklinde eklenerek gnderilecektir. EK-5: Mesaj mzalama Ak\'nda belirtilen yntemle imzalanarak oluturulan JWT PSU-Fraud-Check alanna konularak YS\'ler tarafndan HHS\'ye iletilmelidir. \n K \n K \n Z \n - \n - \n - \n \n \n PSU-Session-ID \n AN1..100 \n stei balatan YS tarafndan belirlenen oturuma zg talep kimlii. HK\'nn YS uygulamas zerinden kimlik dorulama mekanizmas ile bilgi sistemlerine dhil olmalarndan ilemlerini tamamlayp sistemden ayrlmalarna kadar geecek tm sreci kapsayacak ekilde ayn deeri almaldr. Tek seferlik deme gibi HKnn tannmadan balatld ilemlerde bu deer bo olarak iletilmelidir. \n  \n  \n  \n - \n - \n - \n \n \n Authorization \n AN1..4096 \n Katlmc ile GET arasndaki otorizasyon iin kullanlan token bilgisidir.  Yekilendirme trlerinden stemci Kimlik Bilgilerini adresler.    Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-Access-Token \n AN1..4096 \n HKnn GKD srecinde dorulanmas sonrasnda kullanlan eriim simgesi. Yetkilendirme trlerinden Yetkilendirme Kodu (GKD)nu adresler.  Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. \n  \n  \n  \n - \n - \n - \n \n \n X-JWS-Signature \n AN1..4096 \n Payload gvdesinin ayrlm bir JWS imzasn ieren stbilgi.  Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir.  Mesaj imzalama kullanlan API ve methoda gre gnderimi zorunludur. \n K \n K \n K \n K \n - \n - \n 3.16. Yant Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "Link" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n \n Tablo 3: Yant Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n Kullanm Durumu  OBH HBH GKD \n Kullanm Durumu  OAS ODS \n \n \n \n \n X-Request-ID \n AN1..36 \n YS tarafndan belirlenen arya zg talep kimlii. stek numaras    lgili istek balndaki bilgi geri dnlr. \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras. lgili istek balndaki bu deer geri dnlr. \n Z \n - \n \n \n X-ASPSP-Code \n AN4 \n Hesap Hizmeti Salaycsnn (HHS) kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder:  application/json \n Z \n Z \n \n \n X-JWS-Signature \n AN1..4096 \n JWS imzasn ieren stbilgi. Bu baln hangi yantlar iin kullanlmas gerektii ilgili endpoint iin belirtilmitir.  Hata durumlarnda, yant gvdesi deeri dnlyor ise imzalanmal ve imza bilgisi x-jws-signature alannda iletilmelidir.  Ancak uygulama katman tarafndan yakalanamayan dolays ile imzalanamayan hata durumlarnda x-jws-signature alan HHS\'ler tarafndan bo gnderilebilir. \n K \n K \n \n \n X-RateLimit-Limit \n N 1..18 \n stek kst uygulanan servislerde en fazla ka adet istek yaplabileceini gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n - \n \n \n X-RateLimit-Remaining \n N 1..18 \n stek kst uygulanan servislerde ka adet istek hakk kaldn gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n - \n \n \n X-RateLimit-Reset \n AN 1..255 \n stek kst uygulanan servislerde arm hakk bittikten sonra yeniden denemeden nce beklemesi gereken sreyi (saniye cinsinden) gsterir. HTTP 429 durum kodu (Too Many Requests) ile dnlen yantlarn balnda dnlmesi zorunludur.  YS olarak yaptnz sistemsel sorgularda; HTTP 429 durum kodu (Too Many Requests) ile dnlen yant aldnzda tekrar sorgu yapmadan nce X-RateLimit-Reset yant baln kontrol ederek, bu balktaki sre kadar bekledikten sonra yeniden sorgulama yaplmas gerekmektedir. \n K \n - \n \n \n x-total-count \n N 1..18 \n Hesaplar, lemler, Bakiye, letilemeyen Olaylar servislerinde sayfalama kullanld durumda, sorgu sonucu dnecek toplam kayt says bilgisi, bu alanda HHS isteine bal olarak gnderilebilir.   Kayt says 0 olduu durumda gnderimi zorunludur. \n K \n K \n \n \n Link \n 1..4096 \n Link alannn  Hesap Bilgisi Hizmeti iin Eriim Adresleri    tablosundaki parametre  = Sayfalama olan APIlerde ve letilemeyen Olaylar API\'sinde gnderim yaplmas zorunludur.  Sayfalama yaps kullanldnda gelen yantta birden fazla sayfa var ise; nceki, sonraki, ilk, son sayfalara gitmek iin gerekli referanslar link headernda aadaki rnekteki gibi doldurulabilir.  x-total-count alannn gnderimi kayt says 0 olduu durum dnda istee bal olduu iin; Link ierisindeki son sayfa bilgisi  (last) istee bal hale getirilmitir. nceki( prev) ve Sonraki (next) admlarnn uygun olan her durumda yer almas zorunludur. lk sayfada nceki seenei olmamal, son sayfada ise Sonraki seenei olmamaldr.    </ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=6&syfKytSayi=100>; rel="next",  </ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=4&syfKytSayi=100>; rel="prev",  </ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=14&syfKytSayi=100>; rel="last",  </ohvps/hbh/s1.1/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=0&syfKytSayi=100>; rel="first"    Hi hesap hareketinin olmad durumda dnen yant balnzn u ekilde olmas beklenmektedir.  Response body: [] Response header: Link: </ohvps/hbh/s1.1/hesaplar?srlmKrtr=hspRef&srlmYon=A&syfNo=1&syfKytSayi=100>; rel="last",</ohvps/hbh/s1.1/hesaplar?srlmKrtr=hspRef&srlmYon=A&syfNo=1&syfKytSayi=100>; rel="first"  x-total-count alan da 0 olarak iletilmelidir. \n K \n K \n 3.17. Idempotency Kurallar \n YSn aadaki durumlarda ayn istek numaras (x-request-id) ve ayn veri gvdesiyle ary tekrarlamas; HHSnin de bu durumlarda ayn yant dnmesi gereklidir. \n \n HHSnin yant kesinti/arza nedeniyle YSe ulamaz ve zaman am sz konusu olmas, \n HK, YS uygulamas zerinden ift tklama ile mkerrer defa HHS APIlerini arlmas,\n(API kontrollerinden nce YS uygulamasnn, ift tklama kontrol yapmas nerilmektedir.) \n YS, yant almasna ramen ileyemeden kaybedilmesi, \n \n durumlarnda HHS aadaki kurallar iletir: \n \n HHS gelen istek numarasn ve veri gvdesini birletirerek checksum deeri retir. \nchesksum deeri x-request-id|request.body nin hash algoritmalarndan (CRC32,MD5 vb)  geirilerek retilebilir. \n HHS bu checksum deeri ile YSe dnm olduu yant 5 dk boyunca saklar.  Saklama yntemi olarak veri taban veya nbellek aralar kullanlabilir. \n YS ayn istek numaras ve ayn veri gvdesi ile yeni bir ar yaptnda, ayn checksum deeri retilecei iin 5dk boyunca bu deere karlk gelen yant dner. \n 5 dk sonrasnda istek numaras veya veri gvdesi deimemi olsa dahi bu HHS tarafndan yeni istek olarak kabul edilir. \n \n Aadaki Public Post ilemleri iin bu kural setinin iletilmesi gerekmektedir: \n 1- deme emri rzas oluturma \n2- Eriim belirteci oluturma \n3- deme emri \n4- Hesap bilgisi rzas oluturma \n 3.18. HTTP Durum Kodlar \n RFC 2616\'da belirlenmi olan durum kodlar (status code) gnderilen istein durumunu YSa standart bir ekilde ifade eder. Eer bir hata varsa hatay, gnderilen istek baarl bir ekilde ilem grdyse ona ilikin durumu aktarr. Durum kodlar genel olarak 5 kategoridedir. \n \n 1xx Bilgi \n 2xx Baarl \n 3xx Ynlendirme \n 4xx stemci Hatas \n 5xx Sunucu Hatas \n \n errorCode Alannda Kullanlabilecek Sral Hata Tipleri : \n \n TR.OHVPS.Resource \n \n \tInvalidFormat \n \tConsentMismatch \n \tNotFound \n \tInvalidSignature \n \tMissingSignature \n \tMethodNotAllowed \n \tNotAcceptable \n \tUnsupportedMediaType \n \tConsentRevoked \n \n \n \n TR.OHVPS.Business \n \n \tInvalidContent \n \tInvalidAccount \n \n \n \n TR.OHVPS.Connection \n \n \tInvalidCertificate \n \tExceededRate \n \tInvalidTPP \n \tInvalidASPSP \n \tInvalidToken \n \tInvalidTPPRole \n \n \n \n TR.OHVPS.Server \n \n \tInternalError \n \tServiceUnavailable \n \n \n TR.OHVPS.Resource.InvalidFormat hatas alnd durumda; fieldErrors nesnesi ierisinde verilecek hata kodlar : \n \n TR.OHVPS.Field \n \n \tMissing \n \tInvalid \n \n \n Veri Tipi rnei: \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "d8bd4e5f-f094-48a6-aee1-3a800e2709d9" , \n     "timestamp" :   "2022-12-22T10:33:15+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.prBrm" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.kmlk.kmlkVrs" , \n             "messageTr" :   "boyut \'1\' ile \'30\' arasnda olmal" , \n             "message" :   "size must be between 1 and 30" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n \n Tablo 4: HTTP Durum Kodlar \n \n \n \n HTTP Durum \n stek Sonucu ve Aklamalar \n POST \n GET \n DELETE \n \n \n \n \n 200 OK \n stek Baaryla Tamamland. Kaynak gncellemek iin yaplan (rnein, GET) ve baaryla tamamlanan isteklerinde kullanlr. \n H \n E \n H \n \n \n 201 Created \n stek Baarl Oldu. Kaynak yaratma istei (rnein, POST /deme-emri-rizasi) baaryla sonuland. \n E \n H \n H \n \n \n 204 No Content \n Silme ilemi baaryla tamamland. Kaynak silme istei (rnein,  DELETE /hesap-rizasi/{RizaNo} ) baaryla sonuland. \n H \n H \n E \n \n \n 400 Bad Request \n stekte bozuk, eksik veya uyumlu olmayan JSON gvdesi, URL parametreleri veya balk alanlar var.  stekle balatlan ilem yapsal bozukluk, eksik veya tutarsz veri veya HHS tarafndaki kontrollerin hatal sonulanmas nedeniyle hata ile sonulanr ve hataya ilikin veriler hata nesnesi ierisinde dnlr. \n E \n E \n E \n \n \n 401 Unauthorized \n Yetkilendirme bal eksik, hatal veya geersiz olduundan istek yetkilendirilmediinde ve eriim reddedildiinde http 401 kodu dnlmelidir. \n E \n E \n E \n \n \n 403 Forbidden \n Eriim belirtecinin veya rzann kapsam uyumuyor. YS bir hesaba/ilem kaynana erimeye alr ve YS, istenen kaynaa erimek iin geerli izinlere sahip bir rzas yoktur.  rnein; hesap bilgisi rzas bakiye izni almamtr ancak /bakiyeler adresinden istekte bulunmutur. \n \n \n \n \n \n 404 Not Found \n **HHS geerli bir API eriim adresini salamyorsa, o URL\'ye gelen istekler iin 404 (Bulunamad) ile yant vermelidir.**YS, uygulama esaslarnda tanmlanmayan bir kaynak iin bir URL\'ye erimeye alrsa (rnein, GET /yurtdisi-odeme), HHS, 404 (Bulunamad) ile yant vermeyi seebilir. \n E \n E \n E \n \n \n 405 Method Not Allowed \n YS, desteklenmeyen bir yntemle kaynaa erimeye alt. \n E \n E \n E \n \n \n 406 Not Acceptable \n stek, geersiz bir karakter kmesi ieriyor. \n E \n E \n E \n \n \n 415 Unsupported Media Type \n stek gvdesi hedef kaynakta bu yntem tarafndan desteklenmeyen bir biimde oluturulduu iin ilem reddedildi \n E \n H \n H \n \n \n 429 Too Many Requests \n Belirli bir sre iinde ok fazla talepte bulunulduu iin ilem reddedildi.  HHSler adil kullanm politikalarn aan talepleri kstlayabilir. \n E \n E \n E \n \n \n 500 Internal Server Error \n API sunucu / servis katmannda sorun olutu. lem baarsz.  5XX hata durumlarnda yant gvde deeri olmad iin mesaj imzalama yaplamaz ve x-jws-signature alan bo olarak iletilir.  Bu durumda x-jws-signature kontrol yaplmamaldr. \n E \n E \n E \n \n \n 503 Service Unavailable \n Hizmet srm kullanmdan kaldrld.  Bir API\'nin kullanmdan kaldrld ve artk bir HHS tarafndan operasyonel olarak desteklenmedii durumlarda, URI yolu hala etkin olabilir ve API isteklerini kabul edebilir.  Bu durumda, YS\'n API srmnn evrimd olduunun farknda olmas iin 503 Hizmet Kullanlamyor dnmesi nerilir. \n E \n E \n E \n \n \n \n Hata rnekleri: \n 400 Bad Request \n TR.OHVPS.Business.InvalidContent  hatas HHS tarafndan yaplacak i kural kontrollerinin baarsz olduu durumda verilmelidir. \n TR.OHVPS.Resource.InvalidFormat  hatas ema validasyonu, alan uzunluk ve varlk kontrollerinin baarsz olduu durumda verilmelidir. \n \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "7f115b9c-d7c2-4a2a-bc45-5a9891c79072" , \n     "timestamp" :   "2022-12-22T10:47:57+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.alc.unv" , \n             "messageTr" :   "boyut \'3\' ile \'140\' arasnda olmal" , \n             "message" :   "size must be between 3 and 140" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.ttr" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n\n \n Zorunlu header alanlarndan biri ya da birka eksik olarak gnderilirse aadaki gibi bir hata dn gerekleebilir. \n HHS uygulamas tarafndan dnlebilecek hata rnekleri: \n \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "2005515d-f0e6-4a07-a439-0ef3b0f56011" , \n     "timestamp" :   "2022-12-22T10:39:26+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" , \n     "fieldErrors" :   [ \n         {          \n             "field" :   "X-Request-ID" , \n             "messageTr" :   "X-Request-ID deeri bo olamaz." , \n             "message" :   "X-Request-ID cannot be null." , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] \n }  \n\n \n Business hata rnei - 1: \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "677cfd9d-77c1-4ea3-8bdf-74a6e9887177" , \n     "timestamp" :   "2022-12-22T11:05:59+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "gonUnvan wrong" , \n     "moreInformationTr" :   "Gnderen nvan hatal" , \n     "errorCode" :   "TR.OHVPS.Business.InvalidContent" \n }  \n \n Business hata rnei - 2: \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "5df3b402-3aca-4305-a35b-5af0f3184b40" , \n     "timestamp" :   "2022-12-22T11:06:47+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Sender account is disabled or not found." , \n     "moreInformationTr" :   "Gonderen hesap aktif deil veya bulunamad." , \n     "errorCode" :   "TR.OHVPS.Business.InvalidAccount" \n }  \n \n GET\'te yaplan zorunlu header kontrollerinde aadaki hatalar dnebilir: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidASPSP" , \n     "moreInformation" :   "Invalid ASPSP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n GET tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPP" , \n     "moreInformation" :   "Invalid TPP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n GET tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T11:14:05+03:00" , \n     "path" :   "/ohvps/hbh/s1.1/hesap-bilgisi-rizasi" , \n     "id" :   "ee1e3ea7-a5e5-468b-bb02-314148f84e6a" , \n     "moreInformationTr" :   "Geersiz ys rol. lgili api ars iin yetkisi yok." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPPRole" , \n     "moreInformation" :   "Invalid TPP Role" , \n     "httpCode" :   403 , \n     "httpMessage" :   "Forbidden" \n }  \n\n \n 401 Unauthorized \n YS, sresi dolmu bir eriim belirteci kullandnda, HHS 401 (Yetkisiz) http kodu ile aadaki hata kodunu dnmelidir.  Aadaki nedenlerden herhangi biri nedeniyle bir Eriim Belirtecinin sresi dolduunda bu durum ortaya kabilir: \n \n Rzann sresi doldu (Son Kullanma Tarihi geti) \n Eriim Belirtecinin pheli kullanm veya sahtekarlk phesi \n Rzada belirlenen gn saysnn am\nBu hata, mteriden doru izinlerle yeniden kimlik dorulamas isteyerek zlebilir. \n \n \n { \n     "path" :   "/ohvps/gkd/s1.1/erisim-belirteci" , \n     "id" :   "ed3fd667-fc58-40ad-a982-e8937faccd15" , \n     "timestamp" :   "2022-12-22T11:17:33+03:00" , \n     "httpCode" :   401 , \n     "httpMessage" :   "Unauthorized" , \n     "moreInformation" :   "Refresh token expired or not found in database" , \n     "moreInformationTr" :   "Yenileme belirteci zaman amna uram veya veri tabannda yok" , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidToken" \n }  \n \n\n \n 403 Forbidden \n rn; YS yetkisi olmayan rol(BH/HBH) ile ilem yapmaya alt durumda 403 hatas alarak ileme devam edemez. \n { \n   "path" :   "/ohvps/hbh/s1.1/bakiye" , \n   "id" :   "3e48ea98-f889-48b9-aa6e-28aabc6cfb14" , \n   "timestamp" :   "2022-12-22T11:20:05+03:00" , \n   "httpCode" :   403 , \n   "httpMessage" :   "Forbidden" , \n   "moreInformation" :   "Forbidden" , \n   "moreInformationTr" :   "Bakiye Bilgileri iin HK izni bulunmamaktadr." , \n   "errorCode" :   "TR.OHVPS.Resource.Forbidden" \n }  \n \n 404 Not Found \n rn; GET /odeme-emri-rizasi/123456 ars durumunda 123456 geerli bir deme kayna deilse, HHS, 404 koduyla cevap vermelidir. \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi/123456" , \n     "id" :   "22f52b2d-d442-4a6a-8f39-d23eba45a34b" , \n     "timestamp" :   "2022-12-22T10:53:53+03:00" , \n     "httpCode" :   404 , \n     "httpMessage" :   "Not Found" , \n     "moreInformation" :   "Resource not found" , \n     "errorCode" :   "TR.OHVPS.Resource.NotFound" , \n     "moreInformationTr" :   "Kaynak bulunamad" \n }  \n\n \n 405 Method Not Allowed \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   405 , \n     "httpMessage" :   "Method Not Allowed" , \n     "moreInformation" :   "Method not allowed" , \n     "errorCode" :   "TR.OHVPS.Resource.MethodNotAllowed" , \n     "moreInformationTr" :   "stek yaplan URL iin izin verilmeyen metot" \n }  \n \n 406 Not Acceptable \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   406 , \n     "httpMessage" :   "Not Acceptable" , \n     "moreInformation" :   "Not Acceptable" , \n     "errorCode" :   "TR.OHVPS.Resource.NotAcceptable" , \n     "moreInformationTr" :   "Kabul edilmedi" \n }  \n \n 415 Unsupported Media Type \n stek balnda content-type, JSON dnda bir veri iletilirse bu hata verilebilir. \n \n { \n     "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n     "id" :   "63cc94b6-1b51-4648-9671-95e6e2e7e03d" , \n     "timestamp" :   "2022-12-22T11:37:12+03:00" , \n     "httpCode" :   415 , \n     "httpMessage" :   "Unsupported Media Type" , \n     "moreInformation" :   "Content type not supported" , \n     "errorCode" :   "TR.OHVPS.Resource.UnsupportedMediaType" , \n     "moreInformationTr" :   "Desteklenmeyen ierik tipi" \n }  \n \n 429 Too Many Requests \n { \n   "path" :   "/ohvps/hbh/s1.1/hesaplar/aef6061f-2978-4bb4-980d-b4c634c8055b/islemler" , \n   "id" :   "20473c5f-2f4f-4b2e-8b66-7978aec442f7" , \n   "timestamp" :   "2022-12-22T00:21:07+03:00" , \n   "httpCode" :   429 , \n   "httpMessage" :   "Too Many Requests" , \n   "moreInformation" :   "Exceeded rate" , \n   "moreInformationTr" :   "Eriim skl limiti am" , \n   "errorCode" :   "TR.OHVPS.Connection.ExceededRate" \n }  \n \n 500 Internal Server Error \n { \n   "id" :   "1b90c6dc-0277-4755-8b05-9297ddfab743" , \n   "path" :   "/ohvps/obh/s1.1/odeme-emri-rizasi" , \n   "timestamp" :   "2022-12-22T11:41:34+03:00" , \n   "httpCode" :   500 , \n   "httpMessage" :   "Internal Server Error" , \n   "moreInformation" :   "Unexpected condition was encountered." , \n   "moreInformationTr" :   "Beklenmeyen bir durumla karlald." , \n   "errorCode" :   "TR.OHVPS.Server.InternalError" \n }  \n\n \n 503 Service Unavailable \n \n   "timestamp" :   "2022-12-20T23:18:56+03:00" , \n   "path" :   "/ohvps/hbh/s1.1/hesap-bilgisi-rizasi/2a72678ee3d24de2be47887e4903a8c6" , \n   "id" :   "e76315b7-09f4-4295-b6d8-1f7fec632159" , \n   "moreInformationTr" :   "HHS u anda hizmet veremiyor." , \n   "errorCode" :   "TR.OHVPS.Server.ServiceUnavailable" , \n   "moreInformation" :   "HHS is currently unavailable" , \n   "httpCode" :   503 , \n   "httpMessage" :   "Service Unavailable" \n 3.19. Maskeleme Kurallar \n Maskeli olarak iletilmesi gereken verilerin maskeleme kurallar u ekildedir: \n \n IBAN verileri Hesap Numaras : lk 4 ve son 4 karakteri ak, dier karakterler maskeli olmaldr. rnek: TR54******************4812 \n Ad-Soyad / Ticari Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr.\nrnein: FATH SERKAN EREN ifadesi FA *** SE**** ER**** eklinde gsterilmelidir. \n Tabela Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet \' \' karakteri konumlandrlmaldr. rnein BANKALARARASI KART MERKEZ ANONM RKET ifadesi BA *** KA**** ME**** AN**** **** eklinde gsterilmelidir. \n YSten girilen alc unvan ve IBAN bilgileri deme emri rzas ve deme emri yantnda ak dnlr, Kolas aknda deme emri rzas yant ve deme emri istek ve yantnda maskeli tanr. \n 3.20. Fonksiyonel Olmayan Gereksinimler \n \n \n HHSlerin sunuyor olduklar servisleri en fazla 3000 ms iinde yant dnecek ekilde tasarlamaldr. \n \n \n HHS\'ler mevcut online ilem kanallarndan sunduklar eriilebilirlik ve performans kriterlerinden daha dk bir hizmet kalitesi sunmamaldr. \n \n \n HHSlerin sunuyor olduklar servislere sistemin gvenlik ve srekliliini salamak adna rate limit koyma ihtiyalar olur ise, standartlar ve ihtiyalara uygun ekilde bir konfigrasyon yapabilirler.  \n \n \n HHS rate limit tanm uyguluyor ise; YS\'ler arasnda ayrm yapmadan, adil ve makul snrlar dahilinde uygulamaldr.    \n \n \n YS tarafndan kullancnn balatmad otomatik sorgu limitleri  3.21 Otomatik Sorgular  blmnde detaylandrlmtr. HHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. Dier taraftan kullancnn balatt istekler iin uygulanacak limitler, HHS\'nin online ilem kanallarndan sunulan sorgu limitlerinden daha az olmamaldr. \n \n \n HHS\'ler, arm limitlerini aan istekler iin HTTP 429 - Too Many Request hatasn dnmelidir. rnek hata mesaj  3.18 HTTP Durum Kodlar  blmnde bulunmaktadr. Rate Limit zelinde tanmlanm parametreler olan X-RateLimit-Limit, X-RateLimit-Remaining ve X-RateLimit-Reset alanlar da   3.16 Yant Bal  blmnde aklanmtr. YS\'ler de HHS\'nin belirledii rate limit kurallarna uymakla ykmldr. \n 3.21. Otomatik Sorgular \n YS uygulamas, HK\'nn balatt ilemler neticesinde API arm yapabilecei gibi, sistemsel bir ekilde otomatik API arm da yapabilir. \nHHS, API armnn HK\'l ya da HK\'sz olduunu istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n HK YS uygulamasna giri yapt andan k yapt ana kadar yani HK oturumu boyunca yaplan API armlarnda, PSU-Initiated  deerinin "E" olmas gerekmektedir.  YS uygulamasnda HK oturumu boyunca,  HK\'nn bilgilerinden minimumda "bakiye" bilgisinin, uygulama arayzlerinde gncel deeri ile online sorgularla gsterimi YS\'n insiyatifindedir. \n HKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \n YS, aadaki API\'leri sistemsel bir ekilde arabilir. \nHHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. \nHHS tarafndan izin verilen sorgu saysnn zerinde yaplan bir sorgu iin HTTP 429 durum kodu (Too Many Requests) hatas dnlmelidir. Yant gvdesinde tekrar hata nesnesinin oluturulmas HHS inisiyatifindedir.  HHS yant header alannda iletilecek X-RateLimit-Reset (saniye cinsinden) deeri kadar sre sonunda\nYS\'n tekrar sorgulama yapmas beklenmektedir. \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Otomatik Sorgu Says \n \n \n \n \n 1 \n erisim-belirteci \n POST \n /erisim-belirteci \n --- \n \n \n 2 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Rza baznda gnde 4 \n \n \n 3 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Rza baznda gnde 24 \n \n \n 4 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Rza baznda gnde 4 \n \n \n 5 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n --- \n \n \n 6 \n hesaplar \n GET \n /hesaplar \n Bireysel gnde 4  Kurumsal gnde 4 \n \n \n 7 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Bireysel gnde 4 Kurumsal gnde 4 \n \n \n 8 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 9 \n bakiye \n GET \n /bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 10 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Bireysel gnde 4 Kurumsal HK - saatte 12 \n \n \n \n YS ve HHS son 24 saat ierisindeki sorgu saylarn toplayarak elde ettii sonularla limit kontrol yapmaldr (Pencere yntemi). \n lemler servisinin arm detaylarna  ^Blm 7.8  zerinden ulalabilir. \n Hesap bilgisi rzasnn YS tarafndan otomatik bir ekilde iptal edilmesi durumu  ^Blm 9\'da  aklanmtr. \n'},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/hesap-bilgisi-api.html",relativePath:"v1.1.0/deneyalani/hesap-bilgisi-api.md",key:"v-3637769d",path:"/v1.1.0/deneyalani/hesap-bilgisi-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/genel-bilgiler.html",relativePath:"v1.1.0/deneyalani/genel-bilgiler.md",key:"v-70a6dc4e",path:"/v1.1.0/deneyalani/genel-bilgiler.html",content:" GENEL BiLGLER: \n HVPS API lke ve Kurallar dokmanna istinaden gelitirmelerini yapan/yapacak olan katlmclar gelitirdikleri srme ait APIlerin nasl altklarn grmek istediklerinde Deney Alan zerinden gzlem yapabilirler. Bu kapsamda, Deney Alan katlmclara tarayc zerinden statik verilerle ilem balatarak, dnen yant inceleme imkan sunar. \n Deney Alan ile sunulan imkanlar u ekildedir: \n \n Servisler durum bilgisi iermeyecek ekilde (stateless) olarak sunulmaktadr. \n Gl Kimlik Dorulama aklarnda kurum zelinde oluturulan yetkilendirme kimlik bilgilerine ihtiya duyulmamaktadr. \n Yant veri kmesi statiktir. Servislere yaplan istekler, her zaman ayn yant dnmektedir. \n Yeni oluturma, gncelleme, silme ilemleri kaynak veri zerinde deiiklik yapmamaktadr. \n Deney alan genelin kullanmna aktr. yelik kayd olmakszn Deney Alan zerinden API incelemeleri gerekletirilebilmektedir. \n API dokmannda yaplacak minor deiiklikler deney alanna yanstlmayacaktr. \n \n Not: Deney Alannn kapsam geniletilmi versiyonu  BKM HVPS Simlatr uygulamas hem HHS hem de YS katlmclarnn; test uygulamalarn utan uca test edebilebilecei bir ortamdr. Simlatr uygulamas zerinden dinamik veri girii yaparak, gelitirilen servisler ile zorunlu senaryolarn tmnn simlasyonu gerekletirilebilir. Simlatr ortamndaki APIler, retim ortamnn bir kopyas olacak ekilde oluturulmutur ve kurumlarn retim ortamna hazr hale gelmelerine araclk eder. Bu uygulama, przsz bir retim ortam geii imkan salar ve HVPS BKM Teknik Sertifikasyonu gemek iin koulmas gereken sertifikasyon senaryolar BKM HVPS Simlatr zerinden sunulmaktadr. BKM Simlatr kullanm iin ayr bir sre iletilmekte olup daha fazla detayl bilgi almak iin ohvps@bkm.com.tr adresine taleplerinizi iletmeniz gerekmektedir. \n deme Emri Balatma API Deney Alan \n"},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/hhs-yos-api.html",relativePath:"v1.1.0/deneyalani/hhs-yos-api.md",key:"v-3ee390dd",path:"/v1.1.0/deneyalani/hhs-yos-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/olay-bildirim-api.html",relativePath:"v1.1.0/deneyalani/olay-bildirim-api.md",key:"v-642a7506",path:"/v1.1.0/deneyalani/olay-bildirim-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/test.html",relativePath:"v1.1.0/deneyalani/test.md",key:"v-68ac6685",path:"/v1.1.0/deneyalani/test.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v1.1.0/deneyalani/odeme-emri-api.html",relativePath:"v1.1.0/deneyalani/odeme-emri-api.md",key:"v-6480bcc7",path:"/v1.1.0/deneyalani/odeme-emri-api.html",content:" \n   \n "},{title:"8.\tDzenli deme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v2.0.0/contents/duzenli-odeme-emri-hizmeti.html",relativePath:"v2.0.0/contents/duzenli-odeme-emri-hizmeti.md",key:"v-f0a9c5f2",path:"/v2.0.0/contents/duzenli-odeme-emri-hizmeti.html",headers:[{level:2,title:"Dzenli deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"duzenli-odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"8.1.\tADIM 0 - Dzenli deme Emri Rzas Balatma Istei",slug:"_8-1-adim-0-duzenli-odeme-emri-rzas-baslatma-istegi"},{level:2,title:"8.2.\tADIM 1 - Dzenli deme Emri Rzasnn Hazrlanmas",slug:"_8-2-adim-1-duzenli-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"8.3.\tADIM 2- Dzenli deme Emri Rzasnn Yetkilendirilmesi",slug:"_8-3-adim-2-duzenli-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"8.4.\tADIM 2.1  Dzenli deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_8-4-adim-2-1-duzenli-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"8.5.\tADIM 3- Duzenli deme Emrinin Oluturulmas",slug:"_8-5-adim-3-duzenli-odeme-emrinin-olusturulmas"},{level:2,title:"8.6.\tADIM 3.1- Duzenli deme Emri Sorgusu (stee bal)",slug:"_8-6-adim-3-1-duzenli-odeme-emri-sorgusu-istege-bagl"},{level:2,title:"8.7.\tADIM 4- Dzenli deme Plan Sorgulama",slug:"_8-7-adim-4-duzenli-odeme-plan-sorgulama"},{level:2,title:"8.8.\tADIM 5- Dzenli deme Emri Rza ptali",slug:"_8-8-adim-5-duzenli-odeme-emri-rza-iptali"}],content:" 8.\tDzenli deme Emri Balatma Hizmeti \n deme hizmeti kullancsnn dzenli tekrar eden bir deme talimat gerekletirmek istedii deme emirlerinde bu hizmeti kullanabilir. demenin Havale / PS / FAST deme sistemlerinden hangisi ile gerekleeceine, deme gn geldiinde HHS karar verir. \n Dzenli deme hizmetini online bankaclk sistemlerinde sunan HHS'lerin, HVPS zerinden bu hizmetleri sunmas zorunludur. Mevcutta online kanallarndan bu hizmeti sunduklar mteri segmentine (bireysel,kurumsal vb.), HVPS zerinden hizmet sunmaya devam etmeleri gerekmektedir. YS, bireysel mteri zelinde dzenli deme hizmeti vermeyen HHS'ye dzenli deme talimat rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.IndividualCustomerNotSupported  hatas , kurumsal mteri zelinde dzenli deme talimat rzas istei yapldnda HHS tarafndan  TR.OHVPS.Business.CorporateCustomerNotSupported  hatas verilmelidir. \n HHS'ler dzenli deme hizmetini sunu bilgilerini HHS API aracl ile yaynlayacaklardr. YS, dzenli deme hizmeti balatabilecei HHS'lerin listesini HHS API'de yer alan \"hizmetTipi\":\"03\" parametresi ile alabilir. YS, dzenli deme hizmeti sunmayan HHS'ye dzenli deme talimat rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.RegularPaymentOrderNotSupported  hatas iletilmelidir. \n Dzenli deme emri hizmetinde TRY dndaki yabanc para birimleri iin HHS tarafndan destek verilmemesi durumunda  TR.OHVPS.Business.InvalidCurrencyCode  hataas verilmelidir. \n Dzenli deme talimat gncelleme hizmeti YS zerinden yaplamayacaktr. HK aktif olan dzenli deme talimat rzasn iptal ederek, yeniden oluturabilecektir. \n HHS zerinden ilgili gncelleme hizmeti salanabilir. deme plannda yaplan gncelleme sonucunda olay bildirim ile YS'e bildirim salanacaktr. HHS zerinden gncelleme yaplrken son deme gn iin ileri bir tarihe gncelleme adm olmamaldr. Sadece ilk oluturulan dzenli deme emri ierisindeki son deme gnnden ncesi olacak ekilde gncelleme yaplmasna izin verilmelidir. \n Dzenli deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n Dzenli deme Emri Rzas Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden dzenli deme emri rzasn balatr. \n Dzenli deme Emri Rza Hazrlanmas:  BHS, Dzenli deme Emri Rzas Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n Dzenli deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve dzenli deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n Dzenli deme Emrinin Balatlmas:  BHS, dzenli deme emrini HHSye iletir. \n Dzenli deme Emri Rza Durumu, Dzenli deme Emri Durumu, Dzenli deme Emri Detay Sorgular:  BHS, Dzenli deme Emri Rza Durumu, Dzenli deme Emri Durumu, Dzenli deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n Dzenli deme Plan Sorgular:  BHS, Dzenli deme Emri iin oluturulan talimata dair deme plann sorgulayabilir. \n \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular)  mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin hem HBH hem de BH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini(nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n YS'ler gnderen hesap seimini aadaki yntemlerden biri ya da birka ile salayabilirler: \n \n YS, mterisinin deme hesabn HHS ekranndan setirebilir. \n YS, mterisinden Hesap Bilgisi rzas alr. Rza ald hesaplar zerinden hesap referans aracl ile dzenli deme emri balatabilir. \n YS, mterisinin deme hesabn elle girmesine olanak tanyabilir. IBAN' olmayan HHS'ler dzenli deme emri rzas admnda  TR.OHVPS.Business.IBANNotSupported  hatasn vermelidir. IBAN' olan HHS'lerin bu ak desteklemesi zorunludur. \n YS; mterisinin hesap referansn elle girmesini salayabilir. Hesap Referans bilgisi ile balatlan dzenli deme emri ilemlerinde HHS seimi zorunludur. \n \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN sunmadklar iin, YS'ler hesap referans ile deme balatabilirler. Bunlarn dndaki HHS'lerin, gnderen IBAN veya hesap referans ile deme akn desteklemesi zorunludur. \n Dzenli deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n Dzenli deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. deme Emri Hizmeti ile ayn etki alan(scope) kullanlmaktadr. \n Tablo : Dzenli deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n duzenli-odeme-emri-rizasi \n POST \n /duzenli-odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n DuzenliOdemeEmriRizasiIstegi \n DuzenliOdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 3 \n duzenli-odeme-emri-rizasi \n GET \n /duzenli-odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n DuzenliOdemeEmriRizasi \n \n \n 4 \n duzenli-odeme-emri \n POST \n /duzenli-odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal stek ve Yant \n DuzenliOdemeEmriIstegi \n DuzenliOdemeEmri \n \n \n 5 \n duzenli-odeme-emri \n GET \n /duzenli-odeme-emri/{talimatNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n DuzenliOdemeEmri \n \n \n 6 \n duzenli-odeme-emri-rizasi-iptal \n DELETE \n /duzenli-odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n - \n - \n - \n \n \n 7 \n duzenli-odeme-talimat-plani \n GET \n /duzenli-odeme-emri/{talimatNo}/odeme-plani \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n DuzenliOdemeEmriPlani \n 8.1.\tADIM 0 - Dzenli deme Emri Rzas Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) dzenli deme emri rzas srecini balatr. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 8.2.\tADIM 1 - Dzenli deme Emri Rzasnn Hazrlanmas \n   \n ekil : Dzenli deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak dzenli deme emri rza kaynann oluturulmasn (DuzenliOdemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi olduu geit tarafndan kontrol edilir. \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahiplii geit tarafndan kontrol edilir. \n HHS tarafndan, istek balndaki x-aspsp-code ile katilimciBlg ierisinde yer alan hhsKod deeri ile ayn olduunu kontrol edilir. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n \n \n \n POST baarl olursa, HHS, dzenli deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren DuzenliOdemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1 HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /duzenli-odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir DuzenliOdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, dzenli deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n YS, dzenli deme hizmeti sunmayan (HHS API'de yer alan \"hizmetTipi\":\"03\" yok ise) HHS'ye dzenli deme talimat rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.RegularPaymentOrderNotSupported  hatas dnlr. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hata kodu iletilmeli ve fieldErrors dolu olacak ekilde hatal alan belirten detayl aklama gnderilmelidir. InvalidFormat hata kodlarnda fieldErrors ierii gnderilmeli ve anlalr aklama ile message, messageTr alanlar doldurulmas zorunludur. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n YS, bireysel mteri zelinde dzenli deme hizmeti vermeyen HHS'ye dzenli deme talimat rzas istei yapmas durumunda HHS tarafndan  \"TR.OHVPS.Business.IndividualCustomerNotSupported\"  hatas , kurumsal mteri zelinde dzenli deme talimat rzas istei yapldnda HHS tarafndan  \"TR.OHVPS.Business.CorporateCustomerNotSupported\"  hatas dnlr. \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme adresleri ile dzenli deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.TPPRedirectionAddressMismatch\"  hatas dnlr. \n HHS; kimlik bilgileri nesnesinde yer alan kimlik bilgileri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Koullu Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.CustomerNotFound\"  hatas dnlr. \n Dzenli deme Emri Balatma Hizmeti rza isteinde bulunan HKnn Ak Bankaclk Kanal Yetki tanm yok ise  \"TR.OHVPS.Business.OpenBankingChannelClosed\"  hatas dnlr. HHS insiyatifinde olup HHS bu kontrol GKD sonras gerekletirebilir. \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir. \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n Ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yaplmas durumunda HHS tarafndan  \"TR.OHVPS.Business.DecoupledAuthenticationNotSupported\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n Ayrk GKD ile balatlan rza aklarnda HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder. YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  \"TR.OHVPS.Business.EventSubscriptionNotFound\"  hatas dnlr. \n Rza balatma ak ierisinde kimlik bilgisinin, HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  \"TR.OHVPS.Business.CustomerInfoMismatch\"  hatas dnlr. \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda HHS tarafndan  \"TR.OHVPS.Business.CustomerMobileApplicationNotFound\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n HHS kimlik bilgisi ile gnderen nvannn uyumlu olduunu kontrol eder. HHS'ler EFT/FAST ilemlerinde kabul ettikleri kontrol kriterleri ile ileme izin verebilirler. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.IncorrectSenderTitle\"  hatas dnlr. \n Gnderen Hesap Numaras BHS tarafndan iletildii durumda;\n \n IBANn doruluu (kontrol basama dorulamas) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.InvalidAccount\"  hatas dnlr. \n IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountCodeMismatch\"  hatas dnlr. \n Hesap numarasnn HKya ait olduu kontrol edilir.Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.CustomerAccountMismatch\"  hatas dnlr. \n HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. (lgili hesabn para transfer ilemine yetkisi olmamas) Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountUnauthorized\"  hatas dnlr. \n HHSde gnderen hesabn aktiflii kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountInactive\"  hatas dnlr. \n \n \n Gnderen hesap numaras iin, Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile dzenli deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  \"TR.OHVPS.Business.ActiveConsentNotFound\"  hatas verilmelidir. \n Dzenli deme emri rzasnda alc hesap bilgileri Karekod ya da Kolas ile belirlenebilir. HHS online kanallarnda dzenli deme hizmetini Karekod ve Kolas aracl ile kabul ediyorsa, HVPS servisleri ile de kabul etmek zorundadr. YS tarafndan dzenli deme emri rzas istei ierisinde alc bilgisi iin karekod ya da kolas kompleks alanlar yer almas durumunda , destek vermeyen HHS'ler tarafndan  \"TR.OHVPS.Business.RecipientAccountTypeNotSupported\"  hatas verilmelidir. \n Alc ve gnderen hesabn ayn olmas durumunda  TR.OHVPS.Business.SenderRecipientSame  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n Mterinin kendi hesaplar arasnda talimat veremeyecei durumlarn kontrol iin  TR.OHVPS.Business.SameAccountTransferRestricted  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n \n Yukardaki kontroller tamamlandktan sonra HHS, DuzenliOdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n Bu aamada HKnn HHS tarafndan tanmlanm ve istein veri alannda gnderen hesaba (borlandrlacak hesaba) ilikin bir bilgisinin olmas gerekmez. \nHesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK dzenli deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n POST /duzenli-odeme-emri-rizasi  isteinin (REQUEST) gvdesinde (BODY)  DuzenliOdemeEmriRizasiIstegi nesnesi (Tablo) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda DuzenliOdemeEmriRizasi (Tablo) nesnesi oluturulur. \n  BAARILI STEK: \n Tablo : DuzenliOdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan dzenli deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.ohkTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda dzenli deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile dzenli deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HHS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> nvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn nvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n Talimatn gerekleecei ana kadar KOLAS tanmnnda deiiklik olabilecei iin,  KOLAS ile yaplan dzenli deme emri ilemleri, talimatn verildii anda zlen IBAN'a yaplacaktr. \n Kolas ile dzenli deme emri hizmeti desteklenmiyorsa; HHS tarafndan hata dnlmelidir. \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n Karekod ile yaplan dzenli ilemler, talimatn verildii anda zlen IBAN'a yaplacaktr. \n Karekod ile dzenli deme emri hizmeti desteklenmiyorsa; HHS tarafndan hata dnlmelidir. \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n HHS, YS'n API deseninde \"O\" kodunu ilettiini kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarnda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.   -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tyeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n YS bu deeri HKy HHSye ynlendirmeden nceki ekranda gstermeli, ve HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak yine HKya gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan DuzenliOdemeEmriRizasi nesnesi Tabloda parametrelerden oluur: \n Tablo : DuzenliOdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n DuzenliOdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n DuzenliOdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n DuzenliOdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr.  HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.   Tek seferlik deme dnda YS'n gnderen nvann gndermesi zorunludur. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.    deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n 8.3.\tADIM 2- Dzenli deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil : Dzenli deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn dzenli deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, dzenli deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=D&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, dzenli deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=D&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=D&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn dzenli deme emri rzasn balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK, bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, dzenli deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, dzenli deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 8.4.\tADIM 2.1  Dzenli deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: DuzenliOdemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp Dzenli deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda dzenli deme emri isteinde gnderen hesap bilgilerinin zorunlu olmas nedeniyle,  DuzenliOdemeEmriRizasi  nesnesi sorgulanarak bu bilgiler alnmaldr. HHS,  ADIM 2 -Dzenli deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  DuzenliOdemeEmriRizasi  nesnesine iler. \n \n Sorgulama yaplan Dzenli deme Emri HHS tarafnda bulunmuyor ise  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n \n GET /duzenli-odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  DuzenliOdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n Durum \n DuzenliOdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine/Talimata Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n Dzenli deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /duzenli-odeme-emri-rizasi/{rizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  DuzenliOdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-8de yer alan parametreleri ieren DuzenliOdemeEmriRizasi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (leri Tarihli deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta DuzenliOdemeEmriRizasi nesnesi gncellenir ve BHS  GET /duzenli-odeme-emri-rizasi/{rizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren DuzenliOdemeEmriRizasi nesnesini ekmelidir. \n 8.5.\tADIM 3- Duzenli deme Emrinin Oluturulmas \n   \n ekil 8: Duzenli deme Emrinin Oluturulmas \n POST /duzenli-odeme-emri \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS DuzenliOdemeEmri kaynan oluturur.\nDuzenli deme emri (DuzenliOdemeEmri) uygun deme kaynana POST istei yaplarak balatlr. \n \n Eriim Belirteci kontrol yaplr. Geerli bir Eriim Belirteci yok ise  \"TR.OHVPS.Connection.InvalidToken\"  hatas dnlr. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n Rza durumu kontrol edilir.\n \n B: Yetki Bekleniyor, Y: Yetkilendirildi  ya da E: Yetki deme Emrine Dnt ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n I: Rza ptal ya da S: Yetki Sonlandrld ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu K: Yetki Kullanld ise kontrollere devam edilir. \n \n \n POST /duzenli-odeme-emri-rizasi ile POST /duzenli-odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr. Dzenli deme Emri rzasnda gnderilen deerlerden farkl bir deer gnderildii durumda  TR.OHVPS.Business.FieldMismatch  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra POST baarl olursa, ierisinde tlmtNo deikeni bulunan DuzenliOdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine/Talimata Dnt olarak gncellenir. \n BAARILI STEK: \n Tablo 9: DuzenliOdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan dzenli deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n >Ynlendirme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n >Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur. yetYntm = Y iin bu nesne iletilmemelidir. \n \n \n \n >>OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >>OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n \n \n >Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. Duzenli deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. Duzenli deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn dzenli deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. Duzenli deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. Duzenli deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  Duzenli deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n Duzenli deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n Duzenli deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda dzenli deme emrinde iletilen maskeli bilgi ile HHSnin kendi dzenli deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n Duzenli deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n Duzenli deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n KolasRef ( hem FAST hem de PS iin ayn) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n Duzenli deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n Duzenli deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n Duzenli deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n Duzenli deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n Duzenli deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. \n RefBlg (Hem FAST hem de PS iin ayn) \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n FAST/PS Acklm \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan DuzenliOdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: DuzenliOdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zamandr. \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n Z \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.  deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O  deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n Talimat Bilgileri \n tlmtBlg \n Kompleks: TalimatBilgileri \n - \n \n \n \n > Talimat Numaras \n tlmtNo \n AN1..128 \n Z \n Dzenli deme Emri nesnesinin UID'sidir. Dzenli deme Emri kayd'na dair likin sorgular bu ID zerinden yaplr. \n \n \n > Talimat Oluma Zaman \n tlmtOlsZmn \n ISODateTime \n Z \n duzenliOdemeEmri nesnesinin oluturulma zaman, talimatn HHS'de oluturulduu zaman bilgisidir. \n \n \n > Talimat Tutar \n tlmtTtr \n AN1..24 \n Z \n BHS'nin HHS'de belirledii tutar bilgisidir. Talimata ait ilk deme emri kaydnn tutar bilgisi iletilmelidir.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n > lk deme Gn \n ilkOdmGn \n ISODate \n Z \n BHS'nin HHS'de belirledii ilk deme gn bilgisidir.   Alabilecei minimum tarih deeri dzenli demenin verildii tarihin 1 gn sonras olabilir. Maksimum deer ise 30 gn olacak ekilde seilebilir.  \n \n \n > Son deme Gn \n sonOdmGn \n ISODate \n Z \n BHS'nin HHS'de belirledii son deme gn bilgisidir. Alabilecei minimum gn deeri ilk deme gnnn 1 gn sonras olabilir. Maksimum deer ise 2 yl olmaldr.  \n \n \n > deme Says \n odmSayi \n N3 \n Z \n BHS'nin HHS'de belirledii deme saysdr. Minimum deer 2 adet olmaldr. \n \n \n > deme Periyodu \n odmPryt \n AN1 \n Z \n BHS'nin HHS'de belirledii deme periyot bilgisidir. TR.OHVPS.DataCode.OdemePeriyodu sral veri deerlerinden birini alr. \n \n \n > Talimat Rumuzu \n tlmtRmz \n AN1..180 \n  \n BHS'nin HHS'de belirledii talimata dair rumuz aklamasdr. lgili alan istee bal olup HHS'lerin inisiyatifindedir. \n 8.6.\tADIM 3.1- Duzenli deme Emri Sorgusu (stee bal) \n   \n ekil 9: Duzenli deme Emri Sorgusu \n GET /duzenli-odeme-emri/{tlmtNo} \n BHS, bu eriim adresi araclyla dzenli deme emrini sorgulayabilir. Maksimum talimata dair son deme gnnn 5 gn sonrasna kadar sorgulama yaplabilir. Sonrasnda yaplacak sorgulamalarda eriim belirtecinin yetki sresi sonland iin HHS  TR.OHVPS.Resource.ConsentRevoked hatasn dnmelidir.\nptal edilmi talimatn bilgileri sorgulanmak istendiinde de yine  TR.OHVPS.Resource.ConsentRevoked hatas verilmelidir. \n YS sadece kendi uygulamas zerinden verilmi dzenli demeleri sorgulayabilir. Eriim izni olmayan bir deme emri numaras ile sorgulama yaptnda HHS'den  TR.OHVPS.Resource.NotFound  hatasn alr. \n BAARILI YANIT: \n GET /duzenli-odeme-emri/{tlmtNo} yantnn (RESPONSE) gvdesinde (BODY)  DuzenliOdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren DuzenliOdemeEmri nesnesi dner. \n 8.7.\tADIM 4- Dzenli deme Plan Sorgulama \n \n ekil 10: Dzenli deme Plan Sorgulama \n GET /duzenli-odeme-emri/{talimatNo}/odeme-plani \n BHS, bu eriim adresi araclyla dzenli deme plann grntleyebilir. ptal edilen bir deme emri rzasna dair talimat deme plan grntlenemeyecektir. ptal edilmi bir talimata ait istek geldiinde HHS tarafndan  \"TR.OHVPS.Resource.ConsentRevoked\"  hatas dnlmelidir. \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan \"DuzenliOdemeEmriPlani\" nesnesi Tablo-11deki parametrelerden oluur: \n Tablo 11: DuzenliOdemeEmriPlani nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n deme Sra Numaras \n odmSiraNo \n AN1..999 \n Z \n deme plan ierisindeki sray belirten deerdir. \n \n \n deme Tutar \n odmTtr \n AN1..24 \n Z \n deme plan ierisinde deme numaras kaydna ait denecek tutar bilgisi   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n Gerekleen deme Tutar \n grckOdmTtr \n AN1..24 \n K \n deme plan ierisinde deme numaras kaydna ait denmi  tutar bilgisi. Ksmi deme yaplan ilemlerde ksmi deme tutar bilgisi eklenmelidir. Ksmi deme yerine denecek tutarn tamam denmesi durumunda ilgili tutar bilgisi iletilmelidir. deme Durumu 01, 02 ve 06 olan kaytlar iin bu alann gnderilmesi zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n deme Tutar Para Birimi \n prBrm \n AN3 \n Z \n Tutara ait Para Birimi.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n deme Talimat Tarihi \n odmTlmtTrh \n ISODate \n Z \n deme plan ierisindeki ilgili demenin gereklemesi beklenen tarih bilgisidir. \n \n \n deme Gerekleme Zaman \n odmGrckZmn \n ISODateTime \n K \n deme plan ierisindeki ilgili demenin gerekletii tarih bilgisidir. deme durumu 01, 02 ve 06 olan kaytlar iin bu alann gnderilmesi zorunludur. \n \n \n deme Durumu \n odmDrm \n AN2 \n Z \n deme plan ierisindeki demelere ait durumu belirten deerdir.  TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr. \n 8.8.\tADIM 5- Dzenli deme Emri Rza ptali \n \n ekil 10: Dzenli deme Emri Rzas ptali \n DELETE /duzenli-odeme-emri-rizasi/{rizaNo} \n BHS, bu eriim adresi araclyla dzenli deme emri rzasn iptal edebilir. \n DELETE /duzenli-odeme-emri-rizasi ars, bir BHS'nin nceden oluturulmu bir dzenli deme emri rzasn silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, BHS zerinden bu rzasn kaldrmak isteyebilir. \n \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rza, iptal edilen rizaNo bilgisi ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n ptal edilmek istenen Dzenli deme Emri Rzas HHS tarafnda bulunmuyor ise  TR.OHVPS.ResourceNotFound  hatas dnlr. \n Rza durumu I ve S olmayan kaytlar iin rza iptali salanacaktr. I ve S olan kaytlar iin rza iptal edilmek istendiinde HHS'ler tarafndan  TR.OHVPS.Resource.ConsentRevoked  hatas dnlecektir. \n \n Yukarda kontroller baaryla tamamlandktan sonra srasyla aadaki ilemler yaplr. \n \n Dzenli deme talimat plan ierisinde yer alan odmDrm deeri 04 ve 05 olan kaytlar 07 durum kodu ile gncellenecektir. Dier durum kodlar iin 07 durum kod gncellemesi yaplmayacaktr. \n likili dzenli deme emri talimat iptal edilmelidir. \n Rza iptal edilmelidir. \n \n Bu API ars, mterinin BHS zerinden dzenli deme emri rzasn iptal etmesine ve HHS nezdindeki dzenli deme emri rzas nesnesinin silinmesini salar.\nMterinin BHSnin veri eriim iznini iptal etmesi durumunda BHS, HHSde mevcut olan DuzenliOdemeEmriRizasi'na dair rza ve talimat bilgilerini pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa\nDELETE /duzenli-odeme-emri-rizasi/{RizaNo}\nars aracl ile yerine getirilir. \n Servis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr.\nHK rzas baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal olarak ve gnclZmn zaman damgas vurularak gncellenir.\nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir:\nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (BHS) \n"},{title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",frontmatter:{},regularPath:"/v2.0.0/contents/ekler.html",relativePath:"v2.0.0/contents/ekler.md",key:"v-e89e9b86",path:"/v2.0.0/contents/ekler.html",headers:[{level:2,title:"EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar",slug:"ek-1-istek-cevap-mesajlarnda-kullanlacak-nesne-yaplar"},{level:2,title:"EK-2: Sral Veri Trleri",slug:"ek-2-sral-veri-turleri"},{level:2,title:"EK-3: stemci Sertifikalarnn Tanm ve Ynetimi",slug:"ek-3-istemci-sertifikalarnn-tanm-ve-yonetimi"},{level:2,title:"EK-4: Sunucu Sertifikalar",slug:"ek-4-sunucu-sertifikalar"},{level:2,title:"EK-5: Mesaj mzalama Ak",slug:"ek-5-mesaj-imzalama-aks"},{level:3,title:"mzalama Kurallar (YS)",slug:"imzalama-kurallar-yos"},{level:2,title:"EK-6: HHS/YS API Mimarisi",slug:"ek-6-hhs-yos-api-mimarisi"}],content:' EK-1: stek/Cevap Mesajlarnda Kullanlacak Nesne Yaplar \n Ak Bankaclk simlatr uygulamas zerinde swagger dkmanlarnn gncel srmlerine eriim salanabilir. \n EK-2: Sral Veri Trleri \n \n \n \n Kod \n Aklama \n \n \n \n \n TR.OHVPS.DataCode.BrcAlc \n lemin hesab borlandrd ya da alacaklandrd bilgisidir. B : Bor A : Alacak N : Finansal Olmayan \n \n \n TR.OHVPS.DataCode.EvetHayir \n E : Evet H : Hayr \n \n \n TR.OHVPS.DataCode.GkdTur \n GKD yaplmasn gerekli bulduu durumda HHS, YSn belirledii yntemi dikkate alarak kendi belirledii GKD yntemini bildirir: Y: Ynlendirmeli GKD A: Ayrk GKD \n \n \n TR.OHVPS.DataCode.HHSDurumu \n A : Ak. retim Ortamnda HHSnin aktif bir ekilde hizmet vermesi durumu.  Y : Yaygnlatrma. retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi durumu.    G : Geici Hizmet Veremiyor. HHS servislerinde teknik bir sorun olmas nedeniyle HHSnin hizmet verememesi durumu.  K: Kapal. HHSnin hizmet vermeme durumu. \n \n \n TR.OHVPS.DataCode.HHSYOSSrlmKrtr \n kod : Kod unv : Unvan \n \n \n TR.OHVPS.DataCode.HspDrm \n Hesabn durumunu belirtir: AKTIF PASIF KAPALI \n \n \n TR.OHVPS.DataCode.HspTip \n Hesap eidini belirtir: VADESIZ KREDILI_MEVDUAT_HESABI POS CEK YATIRIM \n \n \n TR.OHVPS.DataCode.HspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.IslemAmaci \n 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Gayrimenkul alm demesi 13: Motorlu tat alm demesi 14: Bor verme/Bor deme 15: Hediye/ba/yardm 16: Vergi/resim/har demesi 17: Tazminat/sigorta demesi 18: Avukatlk/Danmanlk/Mavirlik demesi 19: Salk demesi 20: Kripto/dijital varlk 21: ans oyunlar/bahis demesi 22: Elence/sosyal medya demesi 99: Dier \n \n \n TR.OHVPS.DataCode.IslemTuru \n Hesap hareketleri (ilemler) sorgusunda dnlen lem Tr (islTur) parametresi aadaki deerlerden birini alabilir: HAVALE EFT FAST PARA_YATIRMA PARA_CEKME YABANCI_PARA_HAVALE YATIRIM_HESABINA_AKTARIM YATIRIM_HESABINDAN_AKTARIM KURUM_FATURA_ODEMESI CEK SENET SIGORTA_ODEMESI UCRET_KOMISYON_FAIZ SGK_ODEMESI VERGI_ODEMESI DOVIZ_ALIM DOVIZ_SATIM KREDI_ODEMESI KREDI_KULLANIM KK_ODEMESI KK_NAKIT_AVANS SANS_OYUNU UYE_ISYERI_ISLEMLERI HGS_OGS_ISLEMLERI DOGRUDAN_BORCLANDIRMA_SISTEMI DIGER \n \n \n TR.OHVPS.DataCode.IzinTur \n 01: Temel Hesap Bilgisi 02: Ayrntl Hesap Bilgisi 03: Bakiye Bilgisi 04: Temel lem (Hesap Hareketleri) Bilgisi 05: Ayrntl lem Bilgisi 06: Anlk Bakiye Bildirimi 07: Temel Kart Bilgisi 08: Detayl Kart Bilgisi 09: Ayrntl Kart lem Bilgisi \n \n \n TR.OHVPS.DataCode.KareKodAksTur \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  01: FAST katlmcsndan dinamik dorulamal hizmet alnan iyeri demesi 02: FAST katlmcsndan statik dorulamal iyeri demesi 03: Kiiden kiiye demeler \n \n \n TR.OHVPS.DataCode.KaynakTip \n HESAP_BILGISI_RIZASI  ODEME_EMRI_RIZASI   ODEME_EMRI   ILERI_TARIHLI_ODEME_EMRI_RIZASI   ILERI_TARIHLI_ODEME_EMRI   DUZENLI_ODEME_EMRI_RIZASI  DUZENLI_ODEME_PLANI  DUZENLI_ODEME_EMRI   BAKIYE    COKLU_ISLEM_TALEBI    HHS    YOS   KART_BILGILERI \n \n \n TR.OHVPS.DataCode.KimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) Y , YKN , N11 P , PNO , AN7..9 \n \n \n TR.OHVPS.DataCode.KolasHspTur \n Hesabn bireysel veya ticari nitelikte olduunu belirtir: B: Bireysel T: Ticari \n \n \n TR.OHVPS.DataCode.KolasTur \n Mterinin sorgulama istedii Kolay Adres Tipi deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr: T: Telefon Numaras E: E-Posta K: TCKN V: VKN Y: YKN P: Pasaport Numaras \n \n \n TR.OHVPS.DataCode.KurumKimlikTur \n Kod, Tip, Format K , TCKN , N11 M , MNO , AN1..30 (HHSye zel bireysel veya kurum mteri numaras) V , VKN , AN10 \n \n \n TR.OHVPS.DataCode.LogoArkaPlan \n B :  Logolarn arka plannn beyaz olmas (Erkek Logo)   K : Logolarn arka plannn renkli/koyu olmas (Dii Logo) \n \n \n TR.OHVPS.DataCode.LogoFormat \n SVG :  Logonun svg formatnda olmasn ifade eder. Logonun 1:2 orannda olmas gerekmektedir.   PNG : Logonun png formatnda olmasn ifade eder. Logonun 500 X 1000 px olmas gerekmektedir. \n \n \n TR.OHVPS.DataCode.LogoTur \n FULL_LOGO   : Yaz ve ikon ekillerin bir arada olduu logo   ICON_LOGO : kon ekillerin olduu ( Sadece grsel olan-yazsz ) logo \n \n \n TR.OHVPS.DataCode.OdemeAmaci \n demenin Amacna ynelik olarak aadaki deerlerden birini alr: 01: Konut Kiras demesi 02:  yeri Kiras demesi 03: Dier Kira demesi 04: E-Ticaret demesi: Elektronik ticaret ilem amal aktarmlar 05: alan demesi: Maa, harcrah, prim gibi alan demeleri 06: Ticari deme: Ticari iletmelerin birbirlerine, kendi hesaplarna veya mterilerine demeleri, bor, ithalat, ihracat, irket satn alma, vb. kapsamnda demeler 07: Bireysel deme: zel amal (aile bireylerine, hediye, ba, bor, alveri vs.) demeler 08: Yatrm: Mevduat, menkul kymet, dviz, gayr menkul, tat, varlk alm, temett deme, tahsilat vb. gibi yatrm amal demeler 09: Finansal: Kredi, depo, repo, trev, finansal varlk alm/satm vb. demeler 10: Eitim demesi 11: Aidat demesi 12: Gayrimenkul alm demesi* 13: Motorlu tat alm demesi* 14: Bor verme/Bor deme* 15: Hediye/ba/yardm* 16: Vergi/resim/har demesi* 17: Tazminat/sigorta demesi* 18: Avukatlk/Danmanlk/Mavirlik demesi* 19: Salk demesi* 20: Kripto/dijital varlk* 21: ans oyunlar/bahis demesi* 22: Elence/sosyal medya demesi*   Liste ierisinde * ile iaretlenen \'deme Amac\' deiiklikleri, TCMB gei sreciyle senkronize ekilde, 26 ubat 2026 Perembe gn sonu ile birlikte devreye alnacaktr. \n \n \n TR.OHVPS.DataCode.OdemeDurumu \n demenin durumunu gsterir. Alabilecei deerler: 01: Gerekleti (deme ilgili deme sistemine iletildi ve alc hesabna ulat.)  02: Gnderildi (deme ilgili deme sistemine iletildi ancak alc hesabna ulatna dair teyit alnmad.)lemin son durumunun teyidi iin YS sorgulama yapmaldr. 03- Gereklemedi (demenin ilgili deme sistemine iletiminde veya ilenmesi srasnda hata, zaman am, sistemin gn sonu ilemlerine balamas vb. durum olutu ve deme gereeklemedi veya iade edildi.) 04- Onayda bekliyor (deme emri veya ileri tarihli deme emri alnd. oklu onay aknn tamamlanmas bekleniyor.) 05- deme Bekleniyor ( deme Sistemine gnderilmeden nceki statdr.) 06- Ksmen Gerekleti ( leri tarihli ve dzenli deme talimatlarnda ksmi deme yaplan ilemler iin geerli statdr.) 07- ptal Edildi ( deme sistemine gnderilmeden nce mteri ya da herhangi bir sebepten iptal edilen durumlarda kullanlabilir.) \n \n \n TR.OHVPS.DataCode.OdemeKaynak \n I: nternet bankaclndan gnderilen demelerde kullanlr. A: Otomatik para makineleri (ATM) ile gnderilen demelerde kullanlr. T: Telefon bankacl ile gnderilen demelerde kullanlr. K: Kiosklar araclyla gnderilen demelerde kullanlr. S: ubeden girilen demelerde kullanlr. M: Mobil uygulamadan gnderilen demelerde kullanlr. D: Yukardakiler dndaki deme kaynaklarndan gnderilen demelerde kullanlr.  O: Ak bankaclk aracl ile gnderilen demelerde kullanlr. \n \n \n TR.OHVPS.DataCode.OdemeSistemi \n lemin ynlendirildii deme Sistemine gre aadaki deerlerden birini alabilir: H: Havale F: FAST E: EFT (PS) deerlerinden birini alabilir. \n \n \n TR.OHVPS.DataCode.OhkTur \n B: Bireysel  K: Kurumsal \n \n \n TR.OHVPS.DataCode.OhkTanimTip \n TCKN: TCKN  (ohkTanimDeger N11 olarak gnderilmelidir.)  MNO:      HHSye zel bireysel veya kurum mteri numaras (OHKTanimDeger AN1..30 olarak gnderilmelidir. )   YKN:    Yabanc Kimlik Numaras (OHKTanimDeger N11 olarak gnderilmelidir.)    PNO:    Pasaport numars (ohkTanimDeger AN7..9 olarak gnderilmelidir.)    GSM:     Cep telefonu numaras (ohkTanimDeger N10 olarak gnderilmelidir.)   IBAN:   IBAN numaras (OHKTanimDeger AN26 olarak gnderilmelidir.) \n \n \n TR.OHVPS.DataCode.OlayTip \n KAYNAK_GUNCELLENDI  AYRIK_GKD_BASARILI AYRIK_GKD_BASARISIZ HHS_YOS_GUNCELLENDI \n \n \n TR.OHVPS.DataCode.YOSDurumu \n A : Ak. retim Ortamnda YSn aktif bir ekilde hizmet vermesi durumu.   G : Geici Hizmet Veremiyor. YS servislerinde teknik bir sorun olmas nedeniyle YS\'n hizmet verememesi durumu.   K: Kapal. YS\'n hizmet vermeme durumu. \n \n \n TR.OHVPS.DataCode.PSUInitiated \n E : Evet  H : Hayr   O : Olay Bildirim \n \n \n TR.OHVPS.DataCode.RizaDurumu \n B: Yetki Bekleniyor Y: Yetkilendirildi K: Yetki Kullanld E: Yetki deme Emrine/Talimata Dnt S: Yetki Sonlandrld I :Yetki Iptal \n \n \n TR.OHVPS.DataCode.RizaIptDtyKod \n 01 :Yeni Rza Talebi ile ptal 02 :Kullanc stei ile HHS zerinden ptal 03 :Kullanc stei ile YS zerinden ptal 04 :Sre Am : Yetki Bekleniyor 05 :Sre Am : Yetkilendirildi 06 :Sre Am : Yetki demeye Dnmedi 07 :GKD iptali : Ayn rza no ile mkerrer arm 08 :GKD iptali : Rzano ile TCKN uyumamas 09 :GKD iptali : Uygun rn bulunmuyor 10 :GKD iptali : HHS Ak Bankaclk kanal ileme kapal 11 :GKD iptali : Hesap Yetki Sorunu 12 :GKD iptali : HK HHS kontrollerini aamad 13 :GKD iptali : HK istei ile GKDden vazgeildi 14 :GKD iptali : Fraud phesi 15 :Hesap Rza Gncelleme Talebi ile ptal  99 :GKD iptali : Dier \n \n \n TR.OHVPS.DataCode.RizaTip \n H: Hesap Bilgisi Rzas O: deme Emri Rzas  I: leri Tarihli deme Emri Rzas D: Dzenli deme Emri Rzas \n \n \n TR.OHVPS.DataCode.SrlmYon \n A: Azalan deerle sralama Y: Artan deerle sralama \n \n \n TR.OHVPS.DataCode.VarYok \n 0 : Kayt Yok   1 : Kayt Var \n \n \n TR.OHVPS.DataCode.YetTip \n Alabilecei deerlere gre hangi belirtecin dneceine karar verilir. yet_kod yenileme_belirteci \n \n \n TR.OHVPS.DataCode.ZmnAralik \n 0 : Kayt Yok  1 : 0-2 saat 2 : 2 saat 1 dakika-24 saat  3 : 1-3 gn   4 : 4-15 gn\t  5 : 16 gn ve st \n \n \n TR.OHVPS.DataCode.HizmetTipi \n 01 :  Ayrk GKD  02 : leri Tarihli deme 03 : Dzenli deme \n \n \n TR.OHVPS.DataCode.OdemePeriyodu \n G :  Gnlk  H : Haftalk A : Aylk D : Dier \n \n \n TR.OHVPS.DataCode.KartTip \n B : Banka Kart  K : Kredi Kart P : n demeli(Prepaid) Kart \n \n \n TR.OHVPS.DataCode.AltKartTip \n A : Asl  E : Ek Kart S : Sanal Kart \n \n \n TR.OHVPS.DataCode.KartStatu \n A : Ak/Aktif  P : Pasif I : ptal \n \n \n TR.OHVPS.DataCode.IslemPuanDurumu \n 01 : Puan Kazanm  02: Puan Kullanm  03: Puan ade  04: Puan ptal \n \n \n TR.OHVPS.DataCode.KartSema \n T : TROY  M : Mastercard V : Visa U : UnionPay A : American Express J : JCB \n \n \n TR.OHVPS.DataCode.KartTuru \n B : Bireysel  T :Ticari \n \n \n TR.OHVPS.DataCode.KartFormu \n F : Fiziksel  D :Dijital \n \n \n TR.OHVPS.DataCode.EkstreStatu \n A : Aktif  P : Pasif \n EK-3: stemci Sertifikalarnn Tanm ve Ynetimi \n Tm katlmclarn GET\'e eriebilmesi iin, BKM tarafndan yaplan istemci sertifika dorulamasndan gemesi gerekmektedir. stemci sertifikas retilmeden nce katlmclarn CSR retme akn tamamlamas gerekmektedir. \n OpenSSL ile CSR (Certificate Signing Request) Oluturma \nAadaki komut ile 2048-bit RSA private key ve CSR oluturulur. \nopenssl req -new -newkey rsa:2048 -nodes -keyout PRIVATEKEY.key -out CSR.csr \n CSR ile ilgili detay bilgilerin giriinde; \nCommon Name (CN) olarak 4 karakterli hhsKod ya da yosKod deeri ile, \ndier alanlar iin de kurum bilgileriniz ile giri yaplr. \n Tm bilgilerin girilmesinden sonra oluan private key dosyas kurumunuzda saklanr.\nCSR dosyas ise istemci sertifika retmek zere kullanlr. Bu aamada takip edilmesi gereken admlar u ekildedir: \n Katlmclarn, TRIP ortam zerinden, BKM Tarafndan yetki verilmi kullanclarnn grebilecei "stemci Sertifika Talebi" men admna giri yapmalar beklenir. Alan ekranda,"CSR Dosyas Ykleme" alan ierisine, katlmcnn retmi olduu csr dosyas yklenir. Yaklak 1 dakika ierisinde kuruma zel olarak retilmi olan client sertifikas indirilmeye hazr hale gelecektir. "ndir" butonu ile client sertifika indirilir. stemci tarafnda web isteinin ilgili sertifika ile ilikilendirilerek oluturulmas gerekmektedir. \n Uzun dnemli olarak hazrlanacak olan sertifikalar sertifikasyon ve retim ortamlarnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii bu aamalarda snanacaktr. \n GET\'in test ve retim ortamlar ayrmnda istemci sertifikalar, HHS Listeleme API eriimleri ve Sertifikasyon balantlar ekil 15-HHS/YS API Mimarisi Diagramnda resmedilmitir. \n EK-4: Sunucu Sertifikalar \n Sunucu sertifikalarnn endpoint bilgisini (Fqdn) ierecek ve global bir Certification Authority tarafndan imzalanm olarak sunulmas gerekmektedir.\nrnein; entegrasyon formu ierinde yer alan URL bilgisinin (test.xbank.com.tr) sertifika ierisinde tanml olmas ve bu sertifikann global bir CA rnein Verisign tarafndan imzalanm olarak sunulmas gerekmektedir. \n Hizmet salayc olan HHS\'ler tarafndan sunucu sertifikalar uygulanmaldr. \n EK-5: Mesaj mzalama Ak \n Dijital imzalama yaps, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini salamak amacyla kurgulanmtr.  mzalarn kaynak baznda hangi istek ve yantlara uyguland belirlidir. \n API yalnzca TLS\'ye dayanrsa, dijital kaytlar ve inkr edilemezlik kantlarn tutmak zor olur. Bu nedenle, TLS\'ye dayanmayan bir inkr edilemezlik zm olarak API isteinin HTTP balnda bir JWS kullanlarak salanabilir. \n HTTP isteinin gvdesinin hash fonksiyonu (SHA256) ile zeti alnacaktr. Elde edilen zet, asimetrik anahtarlar destekleyen bir algoritma kullanlarak imzalanacak ve JWS elde edilecektir. stein kendinize geldii durumda body zerinde hi bir deiiklie tabi tutmadan (serialize/deserialize, minify, trim, vb yapmadan) dorulama yapmanz gerekmektedir. Ayn ekilde istein kendinizden kt aamada da response body zerinde hi bir deiiklie tabi tutmadan (serialize/deserialize, minify, trim, vb yapmadan) mesaj imzalama yaplmaldr. \n Bu kapsamda imzalama ak aadaki gibi olmaldr: \n \n HHS ve YS ncelikle zel ve ak anahtarlarn oluturmaldr. Bu anahtarlar oluturmak iin aada openssl kullanlarak oluturma rnei paylalmtr. Bu anahtarlardan zel olan anahtar mesaj imzalamak iin kullanlacak olup, ak anahtar ise mesaj dorulamak amacyla mesajn alcs tarafndan kullanlacaktr. \n \n zel anahtarn oluturulmas. private.pem => zel anahtar  \n openssl genrsa -out private.pem 2048 \n zel anahtardan ak anahtarn oluturulmas. public_key.pem => Ak anahtar (BKM ile paylalacak ak anahtar) \n openssl rsa -in private.pem -pubout -outform PEM -out public_key.pem \n Opsiyonel olarak zel anahtarn PCKS8 formatna evrilmesi (Java asndan PCKS8 formatnda olma ihtiyac nedeniyle). private_key.pem => zel anahtarn formatlanm hali.  \n openssl pkcs8 -topk8 -inform PEM -in private.pem -out private_key.pem nocrypt \n \n \n Ak ve zel anahtarlar oluturulduktan sonra Ak Anahtar BKM ile paylalr. BKM bu ak anahtar dier katlmclarn ulaabilmesi ve alabilmesi iin bir Anahtar Deposu yaklam ile bnyesinde tutar. lgili anahtar iletebilmek ve alabilmek iin kullanlacak HHS/YOS API ye eriim detaylar EK-6 blmnde detayl olarak paylalmtr.  Eer kurumun ilgili anahtar iftinin yenilenme durumu sz konusu ise yenilemenin hemen ardndan ak anahtar yeni bir imzalama yaplmadan nce mutlaka BKM ile paylalmaldr. \n \n \n mzal mesaj aacak olan kurum mesaj imzalayan kurumun ak anahtarn her sorguda yeniden almak durumunda deildir. Belirli periyodlarda kendi ortamndaki anahtar yenileyerek sistemi iletebilir. Ancak imzalayan kurum anahtar ifti yenilemesi yaptnda BKM ile ak anahtarn paylasa dahi imzal mesaj dorulayacak taraf eski ak anahtar ile dorulama yapmaya alt iin hata alacaktr. Bu ilk hata durumunda hzlca BKM zerinden yeni anahtar alp mesaj tekrar dorulamay denemelidir. Eer yine hata alyor ise dorulama ilemini hata statsne almaldr. Bu sebeple anahtar yenileyen kurum yeni ak anahtarn yeni bir mesaj imzalama yapmadan nce mutlaka BKM ile paylamaldr. \n \n \n PSU-Fraud-Check alan iin de JWT formatnda kt hazrlanmas beklenmektedir. rnek bir PSU-Fraud-Check payload deeri aadaki gibidir; \n {"AnomalyFlag": "0", \n"LastPasswordChangeFlag": "1", \n"FirstLoginFlag": "1", \n"DeviceFirstLoginFlag": "1", \n"BlacklistFlag": "0", \n"MalwareFlag": "0", \n"UnsafeAccountFlag": "0", \n"exp": 1663424479, \n"iat": 1663338079, \n"iss": "[https://apigw.bkm.com.tr|https://apigw.bkm.com.tr/]" } \n mzalama Kurallar (YS) \n Bir YS zerinden balayan ak rnek olarak paylalmtr. \n \n \n YS, mesaj imzalama gerektiren her API isteinin HTTP gvdesini (request body) kendi zel anahtar ile ifreleyerek imza bilgisini oluturur. \n \n \n Ardndan bu imza verisini, gnderecei mesajn istek balnda yer alan X-JWS-Signature alannda gndermelidir. \n \n \n X-JWS-Signature alannda gnderilecek olan bilgi aadaki yntem ile oluturulmaldr. \n \n \n Bu alana yazlacak olan bilgi JWT formatnda oluturulmaldr. \n \n \n Bir JWT, header-payload-signature alanlarndan olumaktadr. \n \n Header alannda JWTyi imzalamak iin kullanlacak algoritma belirtilmelidir.  Standartlar kapsamnda RS256 kullanlacaktr. \n Payload ksmnda zel olarak oluturulacak olan body claim alanna istek gvdesi (request body) verisinin SHA256 hash deeri karl yazlmaldr. \n JSON payload oluturulurken RFC 7519 baz alnmaldr. "iss" (Issuer) Claim, "exp" (Expiration Time) Claim, "iat" (Issued At) Claim, body Claim alanlarnn gnderilmesi zorunludur. ^RFC7519 \na.\t"iss" (Issuer) Claim : Kurumunuza zel bilgidir. \nb.\t"exp" (Expiration Time) Claim: Saniye cinsinden (Unix time) imzann son geerli olduu tarih. Bu tarih  mevcut sunucu saatinizden 60 dakika sonra olacak ekilde kullanlmaldr. \nc.\t"iat" (Issued At) Claim : Saniye cinsinden (Unix time) imzann oluturulduu tarih. Bu tarih  mevcut sunucu saatinizden 5 dakika nce olacak ekilde kullanlmaldr. \nd.\tbody Claim : istek gvdesi (request body) verisinin SHA256 hash deeri karl. \n Signature alannda da zel anahtar ile imzalanm olan imza ierii yer alacaktr. \n \n X-JWS-Signature:   JWS imzasn ieren stbilgi. Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir. \n rnek X-JWS-Signature Payload Deeri \n { \n"iss": "https://apigw.bkm.com.tr", \n"exp": 1646832405, \n"iat": 1646746005, \n"body": "c543072f97a761a1d891dc81acc380bc1e6f61ca6541bd93ebfdece338457922" \n} \n \n \n \n \n YS, istei gnderir. Sadece mesajn btnln ve doruluunu teyit amac ile istek gvdesi (request body) SHA256 hash deeri imzalanarak X-JWS-Signature alannda bu imza iletilir. stein gvde (request body) ksm ak ve ifresiz olarak gnderilmektedir. \n \n \n HHS, istei alr, talebi gerekletirmeden nce ald API isteklerinin imzasn dorulamaldr. X-JWS-Signature alanndaki JWT aadaki admlarla dorulanmaldr. \n \n Header ksmndaki algoritmanin RS256 olduu kontrol edilir. \n Gnderen kurumun ak anahtar ile JWT verify (dorulama) ilemi yaplr. \n Yukardaki ilemlerin doruluunun ardndan JWTnin payload ksmndaki body claim alanndaki bilginin, istein gvde verisinin SHA256 hash deerlerinin ayn olduu kontrol edilir. \n rnek checksum deeri   "a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571" veya   "A64B19F95EEB1FB0A0A3E2DBBC6E3D8472C52184D4543417DDC6D156FC5C5571" eklinde olabilir. ki hali de ayn deere sahiptir. Kontrollerde buna dikkat edilmesi gerekmektedir. \n \n \n \n Yukardaki ilemler ile doruluu teyit edilmi olan istein talebi gerekletirir. \n \n \n Eer istek dorulanamyor ise gnderen kurumun ak ve zel anahtar ifti yenilenmi olabilir. \n \n \n BKM HHS API  zerinden ilgili kurumun bilgilerini (kurum kodu vs) kullanarak kurumun detay bilgileri eker ve kendi ortamnda yeniler. \n \n \n Ardndan imzay tekrar ak anahtar ile dorulayarak kontroller gerekletirilir. (Eer halen dorulama ilemi baarsz ise bu istek iin hata ak altrlr.  TR.OHVPS.Resource.InvalidSignature  kodu ile hata retilebilir.) \n \n \n mza bilgisinin beklendii (x-jws-signature) servislerde, bu bilginin iletilmedii durumlarda  TR.OHVPS.Resource.MissingSignature  hatas retilebilir. \n \n \n HHS istei iledikten sonra cevab olutururken de yukardaki aklar ile gnderecei cevab imzalamaldr. \n \n \n stek yant gvdesinin SHA256 checksum deeri iin hexadecimal kt kullanlacaktr. Oluacak ktnn 64 karakter olmas beklenmektedir. Kontrol iin "^[A-Fa-f0-9]{64}$" RegEx tarifini kullanabilirsiniz. \n \n \n rnek bir gvde: \n {"katilimciBlg":{"hhsKod":"8000","yosKod":"8000"},"gkd":{"yetYntm":"Y","yonAdr":"https://boss-test.bkm.com.tr/boss/ab/yosSimulator/8000?drmKod=6021de9f-55e7-454a-94be-2044866b22e1"},"kmlk":{"kmlkTur":"M","kmlkVrs":"123456","ohkTur":"B"},"hspBlg":{"iznBlg":{"iznTur":["01","02","03","04","05"],"erisimIzniSonTrh":"2022-10-12T23:59:59+03:00","hesapIslemBslZmn":"2021-10-10T00:00:00+03:00","hesapIslemBtsZmn":"2023-10-10T23:59:59+03:00"}}}\n \n Bu gvdenin checksum\': \n a64b19f95eeb1fb0a0a3e2dbbc6e3d8472c52184d4543417ddc6d156fc5c5571\n \n Bu checksum\'n iletildii x-jws-signature balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJodHRwczovL2FwaWd3LmJrbS5jb20udHIiLCJleHAiOjE2NjU0NzU1NjIsImlhdCI6MTY2NTM4OTE2MiwiYm9keSI6ImE2NGIxOWY5NWVlYjFmYjBhMGEzZTJkYmJjNmUzZDg0NzJjNTIxODRkNDU0MzQxN2RkYzZkMTU2ZmM1YzU1NzEifQ.Q65PI_1fTEzzBMirvmJvXgVX3orhhZ4_UqujtGdHkU7me-1ymIjvPrzy3kfyER1pedFb7HDCBuPvYoqjX8eUnpiiZsxfzCiEa0McIhoFeUOggq-O8VihItp8bLr2DWwQ9JHN1-WXB2mL31KAKFAL1VY9-DXuAdT-RfE_SLYsl2ycmNy4ti4XvfDvvlE56ZsieFZ727VuwR8wi7F0kKDc6UhjaMF9xcUeAM1fxX-bmcOaOo1NZGC0vvgjNZKz_OJrN-q8VhWYnQPiJ7wY7S9IG8bHIkBImKSVf8LuOEvl8u0BZzADLH1iOBd9x2l1plyI_NLPTrnOqhWhKlljkkJBCg\n \n Eer PSU-Fraud-Check iin balk gnderilecekse, yine JWT formatnda imza retilmelidir. rnek bir psu-fraud-check balk deeri: \n eyJhbGciOiJSUzI1NiJ9.eyJBbm9tYWx5RmxhZyI6IjAiLCJMYXN0UGFzc3dvcmRDaGFuZ2VGbGFnIjoiMSIsIkZpcnN0TG9naW5GbGFnIjoiMSIsIkRldmljZUZpcnN0TG9naW5GbGFnIjoiMSIsIkJsYWNrbGlzdEZsYWciOiIwIiwiTWFsd2FyZUZsYWciOiIwIiwiVW5zYWZlQWNjb3VudEZsYWciOiIwIiwiZXhwIjoxNjY1NDc1NTU2LCJpYXQiOjE2NjUzODkxNTYsImlzcyI6Imh0dHBzOi8vYXBpZ3cuYmttLmNvbS50ciJ9.DhUh_nsXDuNIrvsQ3KOhOXdVcJg6fTDVW8K1oea8kLtmb7n-_hJHY3mWX5zzobu-Vh2VvFzIxPhHtol6gLHFktmIMiQ9TDHb_mRZFXgJB4ToNfqc3Fy9mi5bS8By2IYi1HxDaCStstaZDaunzXfHCtqybfZXyk6teDrf-iIf6lqX9Keo7GZO-Y7mP7C13-c_QwyNKrZK4TZwUQbecRqXYn1DcEHM7kukQHTar_hKBWkXPmNpScY0J2rKksr4ejR1uLhdQm-Pdwoe9y6qrNEB79vMLBkRNtbuV0vc1GYHp_YKkzBKBI_58uuB2GD9877CsrcRnHMQb88xpxiPKh6-ew\n EK-6: HHS/YS API Mimarisi \n HHS/YS API Uygulama Mimarisinde Test ve retim ortamlarnda aadaki alanda yer almaktadr. \n \n ekil 15: HHS/YS API Mimarisi \n'},{title:"Gl Kimlik Dorulama",frontmatter:{},regularPath:"/v2.0.0/contents/erisim-belirteci.html",relativePath:"v2.0.0/contents/erisim-belirteci.md",key:"v-14ad9962",path:"/v2.0.0/contents/erisim-belirteci.html",headers:[{level:2,title:"Yetkilendirme Kodu API",slug:"yetkilendirme-kodu-api"},{level:2,title:"Eriim Belirteci API",slug:"erisim-belirteci-api"}],content:' Gl Kimlik Dorulama  \n \n HK\'nn YS uygulamasndan HHS uygulamasna ynlendirilmesi ile balanan gl kimlik dorulama sreci,  Oauth 2.0 standartlar gerei ncelikle yetkod deerinin YS\'e iletilmesi ile balar ve eriim belirtecinin alnmas sonucunda baar ile sonulanm olur. \n Gl Kimlik Dorulama iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =hesap_bilgisi  "odeme_emri" \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n yetkilendirme-kodu \n GET \n /yetkilendirme-kodu \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n yetkilendirmeKodu \n \n \n 2 \n erisim-belirteci \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n Yetkilendirme Kodu API \n GET /yetkilendirme-kodu \n Ayrk GKD srecinde kullanlacak olan Yetkilendirme Kodu API\'nin  HHS tarafndan sunulmas gerekmektedir. \n Ayrk GKD aknda; HHS, YS\'n olay dinleme servisine "AYRIK_GKD_BASARILI" olay tipi ile olay bildirimi yapar. Bylece HK\'nn kendi sistemine baar ile login olduunu ve yetKod deerinin HK ile ilikilendirildiinin bilgisini YS\'e iletmi olur.  \nHHS olay bildirimi iin retry policy sreleri kapsamnda 1 dakikada 3 kez deneme yapabilir. YS\'e olay bildirimi yaplmam ise, kendisine gelmeyen olay bildirimi iin yetkod\'un geerli olduu 5 dakika boyunca yetkilendirme-kodu endpointi ile sorgulama yaparak yetkod deerini alabilir. \n YS, "ODEME_EMRI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=O \n YS, "ILERI_TARIHLI_ODEME_EMRI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=I \n YS, "DUZENLI_TEKRARLI_ODEME_EMRI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=D \n YS, "HESAP_BILGISI_RIZASI" kayna iin bildirim yapld ise; GET /yetkilendirme-kodu endpointi ile yetkod sorgusu yaplr. \nrnek arm :\n GET /yetkilendirme-kodu?rizaNo=123&rizaTip=H \n STEK: \n YS, rza numarasn ve istein BH ya da HBH olmasna gre deien rza tipini parametre olarak istek talebine ekler. Rza tipinin alabilecei deerler  TR.OHVPS.DataCode.RizaTip  sral veri tiplerinde belirtilmitir. \n HHS\'nin, yetkilendirme yntemi "Ayrk Gkd" ise  rza numaras ile yetki kodu deerini dnmesi beklenmektedir. Ynlendirmeli GKD iin bu endpoint "yetKod" deerini dnmemelidir. Ynlendirmeli GKDye ait bir rza no ile yetkilendirme kodu API kullanlarak yet_kod alnmak istendiinde HHS tarafndan  TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n YANIT: \n HHS yant nesnesi ierisinde, HK\'ya ait yetki kodunu, rza no ve rza durumu ile birlikte YS\'e iletir. \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n Z \n GKD srecinde retilen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n Ayrk GKD srecinde, yetkod deerini alan YS; eriim belirteci API ile GKD srecini tamamlar. \n Eriim Belirteci API \n POST /erisim-belirteci \n STEK: \n YS erisim-belirteci eriim adresini 2 amala kullanr: \n \n \n Bir nceki admdan ald rizaNo, rizaTip (deme emri balatma hizmetinde O, hesap bilgisi hizmetinde H, ileri tarihli deme emri balatma hizmetinde "I") ve GKD sonras dnlen yetKod bilgilerini kullanarak HHS nezdinde ErisimBelirteci nesnesi oluturmak zere istekte bulunur. YSn istekte bulunabilmesi iin GKD admnn baarl bir ekilde tamamlanmas rizaDrm bilgisinin yetkilendirildi olmas gerekir. Eriim Belirteci nesnesi ile rzas nesnesi (deme Emri Rzas, Hesap Bilgisi Rzas veya leri Tarihli deme Emri Rzas) arasndaki iliki rza numaras zerinden salanr. \n \n \n Ald eriim belirtecinin Geerlilik Sresinin dolduu durumda, yenileme belirteci karlnda yeni bir eriim belirteci almas gerekmektedir. \n \n \n POST /erisim-belirteci isteinin (REQUEST) gvdesinde (BODY)  ErisimBelirteciIstegi nesnesi (Tablo-23) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda ErisimBelirteci nesnesi (Tablo 24) oluturulur veya (Yenileme Belirteci iin) gncellenir. Rza durumu Yetki Kullanld olarak gncellenir. \n Eriim Belirteci POST ilemi sonucunda HTTP 200 dnlmesi gerekmektedir. \n ErisimBelirteciIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n RzaNo \n rizaNo \n AN1..128 \n Z \n Rza nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Rza Tipi \n rizaTip \n AN1 \n Z \n O,H,I,D (TR.OHVPS.DataCode.RizaTip) \n \n \n Yetki Tipi \n yetTip \n AN1..50 \n Z \n yet_kod yada yenileme_belirteci deerini alabilir.  (TR.OHVPS.DataCode.YetTip) \n \n \n Yetki Kodu \n yetKod \n AN1..255 \n K \n GKD ileminden dnen yetkilendirme kodudur. Tek kullanmlk olup, ayn yetKod ile birden fazla token alnamaz. yetKod Parametresinin yaam mr 5 dakika olmaldr. yetTip = yet_kod ise zorunludur. \n \n \n Yenilenme Belirteci \n yenilemeBelirteci \n AN1..4096 \n K \n Eriim belirtecinin yenilenmesi amacyla kullanlr. yetTip = yenileme_belirteci ise kullanm zorunludur. \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan erisimBelirteci nesnesinde bulunan eriim belirteci deeri deme emrinin balatlmas esnasnda kullanlr. \n "ErisimBelirteci" nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format:Veri modeli smi \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Eriim Belirteci \n erisimBelirteci \n AN1..4096 \n Z \n Yetkilendirme Kodu karlnda HHS tarafndan dnlen ve sonraki hesap bilgisi ve deme emri servislerine eriimde kullanlan bilgidir. Blm 3.6 Karakter Kodlama   blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. Yenileme belirteci ile birden fazla eriim belirteci alnmas durumunda verilen tm eriim belirtelerinin sreleri bitene kadar geerli olmaldr. \n \n \n Geerlilik Sresi \n gecerlilikSuresi \n N1..9 \n Z \n Eriim Belirtecini saniye cinsinden geerlilik sresidir.  Eriim belirteci geerli olduu son tarih ; Hesap Bilgisi Rzas iin en fazla 30 gn en az ise 1 gn olmaldr.  Eriimin Geerli Olduu Son Tarih(erisimIzniSonTrh); Eriim Belirteci Geerlilik Sresi\'nden kk ise Eriimin Geerli Olduu Son Tarih deeri ile snrldr. deme Emri Rzas ,leri Tarihli deme Emri Rzas ve Dzenli Tekrarl deme Emri Rzas iin 5 dakika olmaldr. \n \n \n Yenileme Belirteci \n yenilemeBelirteci \n AN1..4096 \n Z \n Eriim belirtecinin yenilenmesi amacyla kullanlr.   Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir.  Yenileme Belirteci ile Eriim Belirteci istei yapldnda HHS\'nin dnd yant ierisindeki yenilemeBelirteci deerini kesinlikle deitirmemesi gerekmektedir.Yenileme belirteci rza sresi boyunca gncellenmemelidir. \n \n \n Yenileme Belirteci Geerlik Sresi \n yenilemeBelirteciGecerlilikSuresi \n N1..9 \n Z \n Yenileme belirtecinin saniye cinsinden geerlilik sresidir. Yenileme belirtecinin geerli olduu son tarih ; Hesap Bilgisi iin Eriimin Geerli Olduu Son Tarih ile snrl olmaldr. Bu tarih geldii zaman Hesap Bilgisi Rza Durumunu Yetki Sonlandrld statsne ekilmesi gerekir. deme Balatma iin Rza Oluturma Zamanndan 15 gn sonras olmaldr. 15 gn sresi sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. deme emri 5 dakika iinde gerekletirilmelidir. Gereklemediinde 4.2.8 blmnde aktarlan rza stat gncellemesi yaplmaldr.  Yenileme belirteci geerlilik sresi, leri Tarihli deme Emri Balatma iin talimatn gerekleecei zamandan 15 gn sonras olmaldr. Talimat gerekletikten sonras iin 15 gn sreyle sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. Yenileme belirteci geerlilik sresi, Dzenli Tekrarl deme Emri Balatma iin talimatn gerekleecei  son deme gn  zamanndan 5 gn sonras olmaldr. Son talimat gerekletikten sonras iin 5 gn sreyle sorgulama servislerinin armn destekleyecek ekilde uzun tutulmutur. \n \n \n \n erisim-belirteci erisim noktasndan elde edilen erisimBelirteci, ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda x-access-token alannda iletilir. \n Yenilenme Belirteci (refreshToken) kullanlarak Eriim Belirteci (accessToken) alndnda, dnen yanttaki Yenileme Belirteci Geerlik Sresi (yenilemeBelirteciGecerlilikSuresi) geen sre eksiltilerek, kalan zamann saniye cinsinden hesaplanmasyla iletilmelidir. \n Eriim Belirteci API arm srasnda rza durumlar kontrol edilmelidir. Bu kontrollerin nasl yaplmas gerektii 4-Rza Durumlar blmnde aktarlmtr. \n Yenileme belirteci karlnda yeni bir eriim belirteci alnmas srasnda HHS\'nin dnd hata yantnda httpCode = 401 ve errorCode = "TR.OHVPS.Connection.InvalidToken" gelirse YS nce rzann durumu sorgulamaldr.  \nEer geerli bir rza ise; HHS veya YS tarafnda bir sorun olduu anlalmaldr. Sistem tarafndan hata retilmeli ve sorun incelenmelidir. \nEer geerli bir rza deil ise YS tarafndaki rza durumu gncellenmelidir. \n'},{title:"5.\tGl Kimlik Dorulama",frontmatter:{},regularPath:"/v2.0.0/contents/gkd.html",relativePath:"v2.0.0/contents/gkd.md",key:"v-24f9d8c6",path:"/v2.0.0/contents/gkd.html",headers:[{level:2,title:"5.1.\tYnlendirmeli Gl Kimlik Dorulama",slug:"_5-1-yonlendirmeli-guclu-kimlik-dogrulama"},{level:2,title:"5.2.\tAyrk Gl Kimlik Dorulama",slug:"_5-2-ayrk-guclu-kimlik-dogrulama"},{level:3,title:"5.2.1\tStatik Model",slug:"_5-2-1statik-model"},{level:2,title:"5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi",slug:"_5-3-yonlendirme-bildirim-adresleri-ve-durum-kodu-parametresi"},{level:2,title:"5.4  Gl Kimlik Dorulama Kontrolleri",slug:"_5-4-guclu-kimlik-dogrulama-kontrolleri"}],content:" 5.\tGl Kimlik Dorulama \n Mteri iin gl kimlik dorulama, HKnn (mterinin) kimliinin dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntemi tanmlar. \n deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebli uyarnca hesap bilgisi hizmetinde mterinin onaynn alnmas esnasnda ve deme emri balatma hizmetinde her bir deme emri balatma ileminde  HHS tarafndan mteriye gl kimlik dorulama (GKD) uygulanmas esastr.  Buna gre: \n \n \n Hesap bilgisi hizmetinde HKnn onaynn alnmas esnasnda  Tebliin 26 nc maddesinin 1 inci fkras uyarnca  HHS tarafndan HKya GKD uygulanr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 2 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanr ve ilem dorulama kodu ile HKnn onay alnr. \n \n \n deme emri balatma hizmetinde,  Tebliin 26 nc maddesinin 3 nci fkras uyarnca  HHS tarafndan HKya gl kimlik dorulama uygulanmasna ilikin istisna veya ilave gvenlik nlemleri ibu API lke ve Kurallar belgesinde tanmlanr. \n \n \n HHS, gl kimlik dorulama srecinde HKnin sahip olduu bileen snf olarak SMS OTP ya da SMS ile ilem dorulama kodu kullanabilir. \n \n \n HHS, aadaki hallerde veya  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre tek bileen ile kimlik dorulama yapabilir. \n \n demenin gndereni ve alcsnn ayn olmas, \n Daha nce tanmlanm gvenli alclar listesine deme yaplmas, \n HKnin talimatna istinaden gerekletirilen dzenli bir deme olmas. \n \n \n \n Tek bileen ile kimlik dorulama yaplan bu ilemlerle ilgili olarak gerekletirilen ilemin mteri tarafndan yapldn ispat etme ykmll HHSye ait olur. \n \n \n lem Dorulamada  Tebliin 3 nc maddesinin birinci fkras  bendindeki  ilem bilgisi tanmna uygun olarak aadaki bilgiler ile  Tebliin 3 nc maddesinin birinci fkras hh bendinde  tanmlanan ileme zel retilmi ilem dorulama kodu birlikte kullanlr. \n \n Alc Unvan (Kolas aknda maskeli olarak)  (deme emri balatma hizmeti) \n Tutar (deme emri balatma hizmeti) \n Referans bilgisi (8 karakterden kk ise alann tm deeri, byk ise ilk 4 ve son 4 hanesi) \n \n leme ait yukardaki bilgilerden en az biri deitii zaman  Tebliin 3 nc maddesinin birinci fkras hh bendinde  belirtildii gibi yeni bir ilem dorulama kodu retilecek ekilde ak kurgulanmaldr. \n \n \n lem dorulama kodunun gnderilmesinden HHS sorumludur. HHS,  Tebliin 10 uncu maddesinin ikinci fkrasnda  belirtilen risk deerlendirmesi sonucuna gre ilem dorulama kodu kullanmakszn HKnn onayn alabilir. lem dorulama kodu kullanlmayan ilemlerle ilgili olarak gerekletirilen ilemin HK tarafndan yapldn ispat etme ykmll HHSye aittir. \n \n \n HVPS API lke ve Kurallar kapsamnda iki adet Gl Kimlik Dorulama (GKD) yntemi kullanlacaktr: \n \n Ynlendirmeli (Redirect) GKD Yntemi \n Ayrk (Decoupled) GKD Yntemi \n \n \n \n Hem web hem mobil uygulama hizmeti bulunan katlmclar iin her iki uygulama zelinde de ynlendirme yaplmas zorunludur. Web ya da mobil uygulamalardan sadece birinin olmas durumunda ilgili uygulama zelinde ynlendirme yaplmas zorunludur. \n 5.1.\tYnlendirmeli Gl Kimlik Dorulama \n Ynlendirmeli GKD Ynteminde, mteri kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir. \n Mteri HHSye (uygulama veya web arayz vastasyla) ynlendirildikten sonra mterinin gl kimlik dorulamas adm adm ve dorudan HHS ile mteri arasnda yrtlr. GKDnin tamamlanmasndan sonra mteri tekrar YS uygulamasna ynlendirilir. \n Ynlendirmeli GKD Yntemi iin st dzey rnek i ak aadaki admlardan oluur: \n \n YS, GKD iin HHS tarafndan tanmlanan arayze (tarayc ya da uygulama) ynlendirme yapar. \n Mteri, YS arayznden ayrlr, ynlendirildii HHS arayz zerinde kimlik dorulama ilemlerini gerekletirir. \n GKD tamamlandktan sonra mteri, YS arayzne tekrar ynlendirilir ve ilem sonucu grntlenir. \n \n Ynlendirmeli GKD iin temel gereklilikler unlardr: \n \n deme hizmeti (hesap bilgisi veya deme emri balatma hizmeti) tarayc ya da uygulama tabanl bir ekilde sunulabilir. Web ya da mobil uygulamalardan sadece birinin olmas durumunda ilgili uygulama zelinde ynlendirme yaplmas zorunludur. \n \n Tarayc Tabanl Ynlendirme \n Ynlendirmeli GKD Ynteminde; rza isteine baarl yant alndktan sonra, HK, kimlik dorulama iin YS tarafndan HHS arayzne ynlendirilir.\nYS, ynlendirme akn kendi sunucusundan karlayaca bir istek ile balatmaldr. YS web arayzndeki bu yap, 302 yant kodu ve yant balndaki Location deeri ile HK taraycsn HHS adresine ynlendirmelidir. Bu sayede GKD, HHS tarafnda balayabilir. \n YS tarafndaki ynlendirme servisi iin rnek response; \n HTTP/1.1 302 Found\nLocation: {{hhsYonAdr}}\n \n HK, HHSye (app veya web arayz vastasyla) ynlendirildikten sonra HK'nin gl kimlik dorulamas HHS ile HK arasnda yrtlr. GKDnin tamamlanmasndan sonra HK tekrar YS uygulamasna ynlendirilir. \n HHS, ynlendirme akn kendi sunucusundan karlayaca bir istek ile balatmaldr. HHS web/app arayzndeki bu yap, HK'nin oturumunu gvenli bir ekilde kapatmaldr. Ardndan 302 yant kodu ve yant balndaki Location deeri ile HK taraycsn YS adresine ynlendirmelidir. \n HTTP/1.1 302 Found\nLocation: {{yosYonAdr}}&rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O\n \n HHSnin web arayzne, \n \n HHSnin mobil uygulamasnn olmad, \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) sunduu mobil cihazda HHS uygulamasnn ykl olmad, \ndurumlarda ynlendirme yaplr. \n \n YSn mobil uygulamas varsa mobil cihazda uygulamadan taraycya, YSn mobil uygulamas yoksa deme hizmetinin sunduu cihazda (Kiisel Bilgisayar veya Mobil Cihaz) tarayc zerinden ynlendirme yaplr. \n Uygulama Tabanl Ynlendirme \n HKnn deme hizmetini (hesap bilgisi veya deme emri balatma hizmeti) YSn mobil uygulamas ile kullanyorsa, ayn mobil cihazda HHSnin mobil uygulamasnn yklenmi olmas durumunda, HK dorulamasnn HHS mobil uygulamas tarafndan yaplmas iin uygulama tabanl ynlendirme yaplr. Bylece HK, deme hizmetine eriim iin HHSnin mobil kanalna eriim srasnda kulland dorulama yntemini ile dorulanabilir. \n HHS'nin mobil uygulamas olmas durumunda hhsYonAdr olarak universal link kullanmas gerekmektedir. \n Tablo 5: Ynlendirmeli Gl Kimlik Dorulama Kanallar \n \n \n \n Dorulama Yntemi \n YS Olas Ortam \n HHS Olas Ortam \n \n \n \n \n Tarayc Tabanl Ynlendirme \n Kiisel Bilgisayar (masast, dizst)/Mobil Cihaz \n Kiisel Bilgisayar (masast, dizst) / Mobil Cihaz \n \n \n Uygulama Tabanl Ynlendirme \n Mobil Cihaz \n Mobil Cihaz \n 5.2.\tAyrk Gl Kimlik Dorulama \n Ayrk Gl Kimlik Dorulama, bir kullancnn kimliinin, bir ilem balatldktan sonra ayr bir ekilde doruland ynteme verilen addr. Bu GKD modelinde, kimlik dorulama ilem srecinden \"ayrtrlmtr\". Kullanclar, baka bir arayze ynlendirilmek yerine ( tarayc veya uygulama tabanl ynlendirme gibi), ayr bir kanal zerinden (telefonlarnda bir uygulama bildirimi gibi) ilemi dorulamalar iin bildirim alr.\nKullanc, ilemi tamamen ayr bir cihaz veya uygulama kullanarak dorulayabilir. \n lk fazda Ayrk GKD'de QRl modeller kullanlmayacaktr. \n Ayrk GKD uygulamalarnn farkl rnekleri bulunmaktadr. Ancak yaygn olan yaklam, bir web arayz ve bir mobil uygulamann kombinasyonunu kullanmay ierir. \n Mobil uygulamas bulunan HHS'ler iin Ayrk GKD desteklenmesi zorunludur.  HHSnin web olduu durumda Ayrk GKD ak uygulanmayacaktr. Mobil uygulamas bulunup mteri zelinde mobil aktiflik kontrol sreci HHS inisiyatifindedir. Ayrk GKD srecinde HHS tarafnda sadece mobil uygulama zerinden GKD yaplmaldr. HKnn web uygulamasna ynlendirme yapmamas gerekmektedir. \n YS rolnde Ayrk GKD aknn HKya sorularak balatlmasna gerek bulunmamakla beraber bu bilginin HKya sorulmas YS inisiyatifindedir. YS olarak, Ayrk GKD i aklar kapsamnda HKya ayrk GKD ncesi HHS mobil uygulamasnn varl sorularak (bildirim ayarlarnn ak olmas gerektii bilgisi de verilebilir) ilerlenebilir. Ayn zamanda Ayrk GKD ile rza srecinin balatlmas zorunlu deildir. Rza sreci balatlrken yetkilendirme yntemi YS inisiyatifindedir. \n rnek bir ak u ekildedir: \n \n lem Balatma (YS Web/Mobil Arayz):  HK bir ilemi YSn web/mobil arayznde balatr. YS uygulamas, HK'nn tekil bir kullanc kimliini rzaya ekleyerek bir rza balatma ilemini HHSye iletir. HHS, tekil kullanc kimliini kullanarak HK'nn mobil uygulamasna bir bildirim gnderir. \n Kimlik Dorulama stei (HHS Mobil Uygulama):  HK Mobil uygulama bildirimi alr ve mobil uygulama HK'ya  kimlik dorulama istei sunar. HHSnin BDDK tarafndan belirlenmi GKD yntemlerine uygun davranmas beklenmektedir. \n Kimlik Dorulama Onay (HHS Mobil Uygulama):  Mobil uygulama, HKnn kimlik dorulama giriimini dorular. Baarl olursa rza onay sonras mobil uygulama, 'Ayrk Yetkilendirme Baarl' olay bildirimini YSe gnderir. \n lem Onay (YS Web/Mobil Arayz):  YS,  HHS'den gelen 'Ayrk Yetkilendirme Baarl' olay bildirimine konu olan rzay kullanarak yetkilendirme koduna eriir. Bundan sonraki sre eriim belirteci alnmas servisi ile devam eder. \n \n Ayrk Gl Kimlik Dorulamann Olay Bildirim Servisleri ile olan Bamllklar \n Ayrk GKD srecinde; HHS'nin yetkilendirme kodunu YS'e iletmesi iin gerekli nkoul olan HK dorulamas admnn tamamlanmasn olay bildirimi ile YS'e yapmas gerekmektedir.\nBu nedenle YS'lerin eer Ayrk GKD srecini destekleyecek ise;  /olay-dinleme endpointini aarak olay bildirimi almas zorunludur. \n zetle: \n Ynlendirmeli GKD \n \n HHS mobil uygulamas olmas durumunda ynlendirme adresi olarak universalLink kullanmal. \n Bu link tanm  uygulama var ise uygulamay a yoksa webden devam et eklinde olmal. \n YSn mobilden mi webden mi geldii HHS asndan nemli deildir. HHS olarak YS hangi adresi yonAdr deerinde gndermi ise yetkilendirme sreci bittiinde o adrese ynlendirme yaplmaldr. \n \n Ayrk GKD \n \n Mobil uygulamas bulunan HHS'ler iin Ayrk GKD desteklenmesi zorunludur. HHSnin web olduu durumda Ayrk GKD ak uygulanmayacaktr. Mobil uygulamas bulunup mteri zelinde mobil aktiflik kontrol sreci HHS inisiyatifindedir. Ayrk GKD srecinde HHS tarafnda sadece mobil uygulama zerinden GKD yaplmaldr. HKnn web uygulamasna ynlendirme yapmamas gerekmektedir. \n HKnin Mobil uygulamasnn olmadn tespit edebildiiniz her durum iin rza oluturma aamasnda TR.OHVPS.Business.CustomerMobileApplicationNotFound hatas dlr. \n HHS, HKnn mobil uygulamasnn bulunmad bilgisine ulaamazsa kendisinin belirleyecei bildirim yntemlerinden biri ile HKye bilgilendirme yapar. Bildirim yntemi SMS ise HKya mobil uygulamasn atracak ekilde adres iletir, Web uygulamay atracak bir link iletilmemelidir. HK bu bildirimi dikkate almazsa/alamazsa veya HKda mobil uygulama yok ise bu durumda rza sre amndan iptal olur. \n HK mevcut bankaclk ilemlerinde bildirimi nasl gnderiyorsanz (rnein: Anlk bildirim gnderildi, alnmad, SMSe dnld gibi.) ayn ekilde bildirim gndererek HKnin uygulama zerinden rzay onaylamas beklenir. Buradaki ak HHSnin dier rnleri iin verdii mteri deneyimi ile paralel olmaldr. \n 5.2.1\tStatik Model \n YS'n HK'y tand ve HK'ya ait tanmlayc bilgileri HHS'ye aktarabildii durumda kullanlmaktadr. Buradaki HK'ya ait tanmlayc bilgiler TCKN, MNO , YKN, PNO, GSM, IBAN olarak belirlenmitir. \n Ak aadaki gibi kurgulanmtr: \n   \n \n \n HK, YS uygulamas zerinde ilem balatr. \n \n \n HK, YS uygulamas ierisinde, farkl bir ortam zerinden HHS dorulamasn gerekletirmek istediini belirtir. HK'y tanma tip ve deerleri YS HK'dan talep edebilecei gibi, YS sisteminde hali hazrda kaytl bilgilerle de ak devam ettirebilir.  \n \n \n HK, YS'n mterisi ve YS uygulamasna login ise tek seferlik deme ak balatamaz. \n \n \n YS tarafndan balatlan tek seferlik bir deme ileminin Ayrk GKD ile onaylanaca durumda;\nYSn ilgili kullancya ait HK Tanm Deer verisinin yannda ileme ait ve ilgili HK ile eletirilmi olan  ve sadece YS ile HKnn bilebilecei bir deerin daha HK tarafndan salanmas ve YS tarafndan kontrol edilerek eleen deme emrinin HHSye iletilmesi gerekmektedir. rnein; bu deer YS tarafnda yaplan tek seferlik deme ilemine ait fatura numaras. \n \n \n YS nyzde HK'dan ald ohkTanimTip ve ohkTanimDeger deerlerini kimlik tr ve kimlik deeri alanlarna atamamaldr. \n \n \n YS, ayrk GKD ile ilem balatabilecei HHS'lerin listesini HHS API'de yer alan \"hizmetTipi\"=\"01\" parametresi ile alabilir. \n \n \n YS, HK bilgileri ile rza oluturur. Rza nesnesi ierisinde yer alan GKD nesnesinde ilgili parametreler aadaki ekilde doldurulur: \n \n \n ohkTanimTip ve ohkTanimDeger parametreleri \nBu metodda; ayrikGkd nesnesi ierisindeki \"ohkTanimTip\" parametresi TR.OHVPS.DataCode.ohkTanimTip sral veri tiplerinden TCKN, MNO , YKN, PNO, GSM, IBAN deerlerinden birini alabilir. ohkTanimDeger parametresi de seilen tipe ait HK'ya ait deeri iermelidir.Rza balatma ak ierisinde kimlik bilgisinin olduu durumlarda; HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr.Kimlik alan iermeyen tek seferlik deme emri aklarnda bu kural geerli deildir. GSM ve IBAN deerleri sadece tek seferlik demelerde kullanlabilir. \n YS'ten ohkTanimTip olarak gelen IBAN bilgisi sadece HK'y tanmak iin kullanlabilir. Tanm tipi IBAN ile balatlan bir ilemde HK, baka bir IBAN ile deme balatabilir. \n Kurumsal mteriler iin kmlkTur ve kmlkVrs alanlar ohkTanimTip ve ohkTanimDeger alanlarnda gnderilmelidir. \n \n \n yetYntm parametresi \nyetYntm parametresi  Ayrk GKD  akn ifade eden \"A\" deerini almaldr.  \n \n \n \n \n rnek bir istek : \nPOST/ohvps/obh/s2.0/odeme-emri-rizasi \n RizaNesnesi \n {\n...\n  \"gkd\": {\n    \"yetYntm\": \"A\",\n     \"ayrikGkd\" :{\n         \"ohkTanimTip\" : \"TCKN\" \n         \"ohkTanimDeger\": \"11232123212\"\n     }    \n  },\n...\n}\n \n \n \n YS, ayrk GKD ile ilem balatabilecei HHS'lerin listesini HHS API'de yer alan \"hizmetTipi\":\"01\" parametresi ile alabilir.\nYS, ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.DecoupledAuthenticationNotSupported  hatas iletilmelidir. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n \n \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda hata mesaj vermelidir. HHS tarafndan  TR.OHVPS.Business.CustomerMobileApplicationNotFound  hatas iletilmelidir. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. HHS, HKnn mobil uygulamasnn bulunmad bilgisine ulaamazsa kendisinin belirleyecei bildirim yntemlerinden biri ile HKye bilgilendirme yapar. Bildirim yntemi SMS ise HKya mobil uygulamasn atracak ekilde adres iletir, Web uygulamay atracak bir link iletilmemelidir. \n \n \n HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  TR.OHVPS.Business.EventSubscriptionNotFound  hata kodu iletilmelidir. \n \n \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir.   \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hata kodu iletilmelidir. \n \n \n Rza balatma ak ierisinde kimlik bilgisinin olduu durumlarda; HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  TR.OHVPS.Business.CustomerInfoMismatch  hatas iletilmelidir.\nKimlik alan iermeyen tek seferlik deme emri aklarnda bu kural geerli deildir. GSM ve IBAN deerleri sadece tek seferlik demelerde kullanlabilir. \n \n \n Tek seferlik deme ilemlerinde \"ohkTanimTip\" = \"GSM\"/\"IBAN\" olarak gnderilmi ise, HHS sisteminde bu GSM/IBAN ile eleen mterileri taramaldr. GSM/IBAN bilgisi HK baznda tekil bir kullancya eriim imkan salamaz ise  TR.OHVPS.Business.InvalidCustomerInfo  hatasn iletmelidir. \n \n \n Kontrollerin baarl olmas durumunda HHS rzay oluturur ve HK tekil verisi ile ulat HK'ya bilgilendirme mesaj gnderir.      Bilgilendirme mesaj ksa mesaj ya da anlk bildirim mesaj olabilir. HKnn birden fazla cihazda aktivasyonu varsa HHSnin i srelerine gre mevcut durumda nasl bir bildirim sreci iletiliyorsa ayn ekilde ilerlenebilir.  \n \n \n Kurumsal mteriler iin, hangi kullacya bildirim gitmesi isteniyor ise, rza aamasnda o kii ayrikGkd nesnesinde gnderilir. HHS'nin rza ierisindeki ohkTur deerine gre,  gelen bildirime verilen cevaba uygun uygulamasn amaldr. Kurumsal HK iin rza geldi ise, kurumsal giri sayfas; bireysel HK iin rza geldi ise bireysel giri sayfas mterinin nne almaldr ve ilgili hesaplara eriime izin vermelidir. \n \n \n HK'ya bir bildirim gelmemesi durumunda, HHS kendi sisteminde GKD srecine devam edemez. 5 dakika sonunda rza durumu Yetki Bekleniyor'dan Rza ptal / Sre Am (ptal kod 04) durumuna eker. \n \n \n \n \n HK, HHS sisteminden gelen bildirim mesajn alr. HHS sistemine login olduktan sonra ileme onay verilmezse veya GKD kontrolleri baarsz olursa HHS Olay Bildirim servisleri aracl ile GKD srecinin sonlandn YS'e iletir. Olay tipi \"AYRIK_GKD_BASARISIZ\" olacak ekilde bir POST /olay-dinleme servis ars yaplr.YS kendisine gelen olay bildirimi ile\nrza sorgulamas yaparak iptal detay kodunu renebilir. \n \n \n HK, HHS sisteminde login olduktan sonra ileme onay verirse; HHS tarafndan rza ile ilikili yetkod deeri retilir.HHS, YS'e HK iin \"yetkod\" deeri retildiinin bilgisini Olay Bildirim servisleri aracl ile iletir. Olay tipi \"AYRIK_GKD_BASARILI\" olacak ekilde bir POST /olay-dinleme servis ars yaplr. \n \n \n YS kendisine gelen olay bildirimi ile \"yetkod\" deerinin HHS'de retildiinin bilgisini alr. \"yetkod\" deerini renebilmek iin HHS'yi sorgulamas gerekmektedir.  \nHHS'nin aaca   GET /yetkilendirme-kodu endpointi   ile bu bilgiye eriebilir. \n \n \n YS, \"yetkod\" ile POST /erisim-belirteci endpointinden eriim belirteci alr. Bylelikle HK'nn Ayrk GKD sreci tamamlanm olur. \n 5.3.\tYnlendirme/Bildirim Adresleri ve Durum Kodu Parametresi \n CSRF Ataklarndan korunmak iin ve YS uygulamasnn bir nceki durumunu restore edebilmesi iin; YS tarafndan iletilen ynlendirme ve bildirim adreslerine , Oauth2 standartlarndaki state parametresine edeer,   durum kodu (drmKod)  parametresinin eklenmesi gerekmektedir. Durum kodu parametresi YS tarafndan retilen, tekil ve kolay tahmin edilemeyen bir deer olmaldr. Rza istei gnderimi aamasnda oluturulmaldr. YS uygulamasnda uygun bir yerde saklanmaldr (cookie, session, local storage gibi) . \n Durum kodu, rza isteindeki ynlendirme adresine parametre olarak eklenir.  GKD sreci sonrasnda yetki kodu ile birlikte bu bilgi, HHS tarafndan YSe iletilir. YS saklad deer ile parametre olarak gelen deerin eitliini kontrol eder. Ayn ise eriim belirteci almak zere ak ilerletir. Farkl ise ilemi keser. \n 5.4  Gl Kimlik Dorulama Kontrolleri \n HK, GKD iin HHS uygulamasna ynlendirildiinde, HHSnin eitli kontroller yaparak ilemin doruluunu teyit etmesi gerekmektedir.\nYaplmas gereken kontrollere ait temel senaryolar aadaki tabloda belirtilmitir. Bu senaryolar baz alnarak HHSler tarafndan zenginletirilebilir. \n Aadaki tabloda yer alan 07-13 aras Rza ptal Detay Kodlarnn olutuu senaryolar, HHS uygulamasnda yaplan kullanc dorulama ncesi ve sonras olarak iki admda incelenmelidir. \n HHS tarafnda, kullanc dorulama ncesinde yaplan kontroller neticesinde verilemeyen rzalar iin 04 : Sre Am : Yetki Bekleniyor iptal kodu atanr. HHS'nin YS uygulamasna 04 kodunu iletmesi beklenmez. YS zaman am neticesinde rza statsn sorgulayarak renir. \nKullanc dorulandktan sonra rza verilemiyorsa ilgili hata kodunun YS'e iletilmesi beklenmektedir. Kullanc dorulama sonras YS'e iletilen rza iptal detay kodu ile HHS veri modelinde tutulan rza ile ilikili rza iptal detay kodu, ayn deeri alacak ekilde gncellenmelidir. YS, HHS tarafndan kendine iletilen rza iptal detay kodunu kendi veri modelinde gncellemelidir. \n Zorunlu olarak belirtilen hata durumlarnn HHSler tarafndan gereklenmesi ve uygun hata kodlarnn YSe iletilmesi; ileride oluabilecek mutabakatlama sorunlarn ortadan kaldrabilecek, yaplacak raporlamalar kapsamnda sistem ve sre iyiletirmelerine katk salayacak, son kullanc asndan da alnan hataya ynelik bilgilendirici ierik salayacaktr. \n Hata aklamalar; hata koduna uygun ya da uyumlu olmak kaydyla, HHS ve YS tarafndan farkl ekillerde sunulabilir. \n GKD Srasnda yaplmas gereken kontroller \n \n \n \n Rza ptal Detay Kodu \n HHS hata aklamas* \n Ys ekrannda listelenecek rnek mesaj metni* \n rnek Senaryo \n Zorunlu / Opsiyonel \n \n \n \n \n 07 \n Rza mevcut ve durumu \"Yetkilendirildi\" veya \"Yetki Kullanld\" \n Yetki Hatas \n HK,  kullanc dorulama ilemi tamamlandktan sonra  YS ekrannda ileri - geri yaparak ya da HK'nn ynlendirme adresini kopyalayarak taraycya yaptrmas ile tekrar HHS'ye ynlendirir. Bu durumda HHS bu rza iptal detay kodunu iletir. HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 08 \n Rzano ile kimlik bilgileri uyumazl. \n lem gerekletirilememitir. \n YS tarafndan balatlan rza ierisinde yer alan kimlik bilgisi (rn:TCKN) ile HHS'de baarl kimlik dorulama yaplan HK'nn bilgilerinin uyumad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 09 \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) \n Gsterilebilecek hesap/kart bulunamamtr. \n HHS, kullanc dorulama yaptktan sonra, HK'nn uygun statl hesabnn olmad durumda  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 10 \n HK'nn Ak Bankaclk kanal ileme kapal \n HK'nn Ak Bankaclk kanal ileme kapal \n Ak bankacl ayr bir kanal olarak tanmlam HHS'lerde,  HK kullanc dorulama yaptktan sonra yaplan kontrollerde, HK'nn ilemlerini AB kanalna kapatm olmas durumunda   HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 11 \n HK'nn HHS'deki hesaplarnda yeterli yetkisinin olmamas \n Yetki hatas \n 1- Kurumsal firma kullanclarnn hesaplar zerinde ilem yetkisinin olmamas durumunda   2- Bireysel ortak hesaplarda hesap kst bulunuyorsa (para kna izin verilmedii durum)  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Zorunlu \n \n \n 12 \n HHSnin,  HK zelinde yapt kontrollerin baarsz olmas \n Yetki hatas \n HHS'nin, kullanc dorulama sonras HK iin i sistemlerinde yapt kontrollerin baarsz olmas. rnein: Mterinin henz bankaclk hizmet szlemesi gibi Internet ubesi zerinde ilem yapmasn engelleyen eksikleri olmas durumunda veya kurumsal kullancda vekalet sresinin dolmas/eksik dokman olmas durumunda kanal zerinde ilem yapamad durum  HHS ve YS'ler veri modellerini bu bilgi dorultusunda gncellemelidir. \n Opsiyonel \n \n \n 13 \n HK istei ile GKDden vazgeilmesi \n Mteri ilemden vazgemitir. \n HHS ekrannda yer alan VAZGE butonuna baslmas durumu (HK,HHS uygulamasnda kullanc dorulama yaptktan sonra VAZGE butonu olabilir.) \n Zorunlu \n \n \n 14 \n GKD ptali: Fraud phesi \n lem gerekletirilememitir. \n HHS Fraud phesi nedeniyle ilemin devamna izin vermez. HHS'nin, fraud kontrollerinin deme balatma hizmeti iin yapmas ve 14- GKD ptali: Fraud phesi ile rza iptalini gerekletirmelidir. HBH servislerinde HHS'nin rza iptal kodu 14 ile ilemi kesmesi HHS'nin kendi insiyatifindedir yani opsiyoneldir. \n Koullu \n \n \n 99 \n Dier \n lem gerekletirilememitir. \n Oluabilecek dier senaryolar. \n Zorunlu \n \n \n \n GKD srasnda iletilen rza no eer HHSnin sisteminde bulunamazsa durumu gncellenecek bir rza no da olmayacaktr. HHS kendi nyznde bu duruma uygun bir mesaj gsterebilir. YSe de Dier hata kodu ile bu durumu iletebilir. \n"},{title:"HHS ve YS API",frontmatter:{},regularPath:"/v2.0.0/contents/hhs-yos-api.html",relativePath:"v2.0.0/contents/hhs-yos-api.md",key:"v-2b71dd9d",path:"/v2.0.0/contents/hhs-yos-api.html",headers:[{level:2,title:"HHS API",slug:"hhs-api"},{level:2,title:"YOS API",slug:"yos-api"}],content:" HHS ve YS API \n HHS API, HHSlerin detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. HHS API iin hhs_read scope bilgisi kullanlr. \n Production ortamnda HHS / YOS API ierisinde sisteme dahil olmu, sertifikasyonu baar ile tamamlam paydalar listelenecektir. HHS tarafndan desteklenen API srmleri listelenecektir. \n YSler HHS APIsini sorgulayabilir ancak YS APIsini sorgulayamazlar. \nBenzer ekilde HHSler YS APIsini sorgulayabilir, HHS APIsini sorgulayamazlar. \n HHS API \n GET /hhs/{hhsKod} \n lem Sorgu rnei =  /hhs    bu sorgu yntemi ile tm HHSlerin dizi eklinde verileri listelenir. \nlem Sorgu rnei =  /hhs/2001    bu sorgu yntemi ile gnderilmi olan hhsKoduna ait bilgiler listelenir. Ya da 404 Not Found hatas alr. \nHHS ve YS API Tablo 20deki istek parametrelerine gre sorgulanabilir. \nlem Sorgu rnei (Belirli Bir Hesap) =  /hhs?srlmKrtr=kod&srlmYon=A \n Tablo 20: HHS ve YS API Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {kod, unv} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, sralama kriteri unv olarak belirlenmelidir. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 21: HHS Bilgileri Sorgulama Yant Hhs nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n hhs kodu \n kod \n AN4 \n Z \n HHS nin kod bilgisi \n \n \n hhs unvan \n unv \n AN3..140 \n Z \n HHS nin unvan bilgisi \n \n \n hhs markas \n marka \n AN1..140 \n Z \n HK'nn kolaylkla alglayabilecei ksa unvan bilgisi. HHS tarafndan belirlenecektir. \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n HHSnin mesaj imzalama iin paylat ak anahtar \n \n \n HHS Api Bilgileri \n apiBilgileri \n Kompleks: HhsApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :obh, hbh,gkd \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s1.0, s2.0 \n \n \n HHS Hizmet Bilgileri \n hizmetBilgileri \n Kompleks: HhsHizmetBilgi[Array][0..N] \n Z \n Desteklenen hizmet ve srm bilgileri dnlecektir. \n \n \n > hizmetTipi \n hizmetTipi \n AN1..20 \n Z \n Hizmet Tipi bilgileri.TR.OHVPS.DataCode.HizmetTipi sral veri tr deerlerinden birini alr. \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s1.1, s2.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n HHS'ye ait logo bilgileri. \n \n \n > logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur sral veri tr deerlerlerinden birini alr. \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n HHS tarafnda tutulan ve YS'lerle paylalacak olan url adres bilgisidir.  rnek: https://via.placeholder.com/150?text=0001 \n \n \n > logoArkaPlan \n logoArkaPlan \n AN1 \n Z \n TR.OHVPS.DataCode.LogoArkaPlan sral veri tr deerlerlerinden birini alr. \n \n \n > logoFormat \n logoFormat \n AN3 \n Z \n TR.OHVPS.DataCode.LogoFormat sral veri tr deerlerlerinden birini alr. \n \n \n Durum \n durum \n AN1 \n Z \n HHS'nin durum bilgisidir.  TR.OHVPS.DataCode.HHSDurumu sral veri tipinde alabilecei deerler belirtilmitir. \n \n \n \n HHS API'de; Ak, Yaygnlatrma, Geici Hizmet Veremiyor, Kapal durumlarndaki HHS'ler listelenecektir.  \nSertifikasyon onay alan HHS'ler, retim ortamna geite \"Yaygnlatrma\" durumuna sahip olabilir.  HHS'nin, hangi YS'ler ile \"Yaygnlatrma\" kontrollerini yapaca, HHS ynetiminde olacaktr. Bylece retim Ortamnda HHSnin kendisi tarafndan tanmlanm kstl HKya hizmet vermesi ve servislerini test etmesi salanabilir olacaktr. HHS'ler kendi kurum kontrollerini yapana kadar, \"Yaygnlatrma\" durumunda kalabilirler. HHS'nin BKM'ye yapaca talep ile, HHS \"Yaygnlatrma\" durumundan \"Ak\" durumuna geebilecektir. \n Aadaki durumlarda HHS'nin stats Geici Kapal olarak gncellenebilecektir: \n \n HHS'nin talebi ile uzun sreli (minimum 1 saati aan) yaanan teknik sorunlarda G statsne alnabilecektir. G statsne alnma talebinin HHS tarafndan ohvps@bkm.com.tr ye mail atarak iletilmesi beklenmektedir. \n lgili resmi kurumlardan gelen talep zerine HHS G statsne alnabilir. \n \n YS'ler hem A hem G statsnde olan HHS'leri listeleyebilir. Ancak YS uygulamasnda G statsnde olan bir HHS mteri tarafndan seilirse mteriye gerekli hata mesajnn verilmesi ve ilgili HHS'ye istek atlmamas salanmaldr. \n Hem YOS hem de HHS API iin geerli olacak; logo gnderiminde dikkat edilmesi gerekenler u ekilde tariflenmitir: \n \n Logolarn ham dosya yerine kurumun yaynlayaca bir URL zerinden sunulmas gerekmektedir. (rn: logoURL = https://kurumadi.com.tr/logo.png) Logo BKM tarafnda host edilmeyecektir. \n Logo urlin public eriilebilir url olmas gereklidir. \n Logo, yatayda veya dikeyde tama paysz tam oturacak, snr boyutlarn gemeyecek ve ortalanm yerleime sahip olmaldr. \n YS uygulamasnda gsterim esnasnda logolarn hzl yklenmesi ve dk veri tketmesi asndan; logo boyutu 250 KBn altnda olmaldr. \n HHS ve YSlerin tm logo trlerini (8 farkl tipte logoyu) zorunlu olarak dnmesi beklenmektedir. \n Circle logo kullanlmas gerektiinde ICON_LOGO logo tr kullanlmaldr. \n Logolarn gncellemek isteyen kurumlarn en az 3 i gn ncesinde BKMye bu deiiklii GET Test/retim Ortam Entegrasyon formu ile bildirmesi gereklidir.  BKM de katlmclara HHS/YS API aracl ile gncel logonun ekilmesi gerektiine dair bilgilendirme yapar. \n Logolar anlk eken katlmclarn, herhangi bir teknik nedenden dolay gncel logoyu alamad durum olabilir. Bu durumda sistemlerine kaydetmi olduu kuruma ait ikon logoyu gstermesi gereklidir. \n HHS ve YSler API aracl ile alm olduklar logolarn format zerinde deiiklik (kare, yuvarlak hale getirip resize etmek gibi) yapabilirler. Ancak logonun grsel ve yazlarn etkileyecek bir  deiiklik yapmamaldrlar. \n YS/HHS mobil uygulamasndaki dark mode ve light mode kullanmlarnda, hangi logonun kullanlacana uygulama sahibi karar verecektir. \n YOS API \n YS API, YS statsundeki kurumlarn detay bilgilerini sunan servistir. Bu servis ile aadaki istek/yant yaplar ile ihtiya duyulabilecek ilgili bilgiler temin edilebilir. YS API iin yos_read scope bilgisi kullanlr. \n YS API yantnda, listelenen ynlendirme ve bildirim adresleri bulunmaktadr. HHS, ilem annda iletilen yonAdr ya da bldrAdr alanlarnda gnderilen adreslere yetKod deerini iletmelidir. YS API ierisinde yer alan adresleri, rza isteinde gnderilen adreslerin doruluunu kontrol etme amacyla kullanlmaldr. Bu nedenle YS API ierisinde listelenen adreslerin hostname seviyesinde yer almas yeterlidir. \n YS API ierisinde yer alan YS rol bilgileri ve aktiflik/pasiflik durumlar birbiriyle ilikili deildir. \n YS'n sahip olduu bhs,hbhs rolleri iin herhangi bir fraud ya da teknik sebeplerden tr geici sreyle geri alnabilir. \n YS'lerin hizmet verememesi durumunda rollerinin geri alnmas yaplmayacaktr. YS rolleri sadece ilgili resmi kurumlardan gelen talep zerine alnabilecektir. \n YS aktifliini korurken problem zlene kadar geici olarak alnan roller(bhs,hbhs) tekrardan aktif hale getirilir. \n GET /yos/{yosKod} \n lem Sorgu rnei =  /yos    bu sorgu yntemi ile tm YS'lerin dizi eklinde verileri listelenir. \n lem Sorgu rnei =  /yos/2501    bu sorgu yntemi ile gnderilmi olan yosKoduna ait bilgiler listelenir ya da 404 Not Found hatas alr.\nYS API Tablo 20deki istek parametrelerine gre sorgulanabilir.\nlem Sorgu rnei (Belirli Bir Hesap)=  /yos?srlmKrtr=kod&srlmYon=A \n Tablo 22: YOS Bilgileri Sorgulama Yant Yos nesnesi \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Ys kodu \n kod \n AN4 \n Z \n YS'n kod bilgisi \n \n \n Ys unvan \n unv \n AN3..140 \n Z \n YS unvan bilgisi \n \n \n Ys markas \n marka \n AN1..140 \n Z \n HK'nn kolaylkla alglayabilecei ksa unvan bilgisi. YS tarafndan belirlenecektir. \n \n \n YS rolleri \n roller \n Array[AN4] \n Z \n YSun rollerini belirten deer. rnek: [ \"obhs\", \"hbhs\" ]  - obhs - deme Bilgisi Hizmet Salayc Rol  - hbhs - Hesap Bilgisi Hizmet Salayc Rol \n \n \n Adresler \n adresler \n Kompleks:Adres[Array] [1..N] \n Z \n --- \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerlerinden birini alr. Adres detaylarnn hangi GKD trne ait olduunu belirtir. \n \n \n > Adres Detaylar \n adresDetaylari \n adresDetaylari\tKompleks: AdresDetayi[Array] [1..N] \n Z \n \n \n \n >> Temel Adres \n tmlAdr \n AN1..1024 \n Z \n yetYntm deeri Y olarak iletildiinde Ynlendirmeli GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. yetYntm deeri A olarak iletildiinde Ayrk GKD srecinde HHSnin YOSe authorizasyon kodunu hangi url e gnderecei bilgisini tutar. Riza isteklerinde bu deer ile uyumluluu kontrol edilmelidir. rnek: https://example.com https://example2.com/path deepLink://example/test deepLink://example2/test \n \n \n >> Aklama \n aciklama \n AN1..1024 \n  \n YSn gnderdii adrese ynelik vermek istedii aklama rnek: WEB bireysel , WEB kurumsal  , APP \n \n \n Ak anahtar \n acikAnahtar \n AN1..1024 \n Z \n YSn mesaj imzalama iin paylat ak anahtar \n \n \n YS Api Bilgileri \n apiBilgileri \n Kompleks: YosApiBilgi[Array][0..N] \n Z \n Desteklenen Api ve srm bilgileri dnlecektir. \n \n \n > api \n api \n AN1..20 \n Z \n Api smi rnek :ods \n \n \n > surum \n surum \n AN1..10 \n Z \n Api Srm Kodu rnek: s1.0, s2.0 s1.0 \n \n \n Logo Bilgileri \n logoBilgileri \n Kompleks: LogoBilgisi [Array][1..N] \n Z \n YOSe ait logo bilgileri. \n \n \n > logoTur \n logoTur \n AN3..50 \n Z \n Logonun trn belirler. TR.OHVPS.DataCode.LogoTur sral veri tr deerlerlerinden birini alr. \n \n \n > logoAdr \n logoAdr \n AN1..255 \n Z \n YS tarafnda tutulan ve HHSlerle paylalacak olan url adres bilgisidir.  rnek: https://via.placeholder.com/150?text=0001 \n \n \n > logoArkaPlan \n logoArkaPlan \n AN1 \n Z \n TR.OHVPS.DataCode.LogoArkaPlan sral veri tr deerlerlerinden birini alr. \n \n \n > logoFormat \n logoFormat \n AN3 \n Z \n TR.OHVPS.DataCode.LogoFormat sral veri tr deerlerlerinden birini alr. \n \n \n Durum \n durum \n AN1 \n Z \n YS'n durum bilgisidir.  TR.OHVPS.DataCode.YOSDurumu sral veri tipinde alabilecei deerler belirtilmitir. \n \n \n \n"},{title:"7.\tleri Tarihli deme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti.html",relativePath:"v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti.md",key:"v-c07c3efa",path:"/v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti.html",headers:[{level:2,title:"leri Tarihli deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"ileri-tarihli-odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"7.1.\tADIM 0 - leri Tarihli deme Emri Rzas Balatma Istei",slug:"_7-1-adim-0-ileri-tarihli-odeme-emri-rzas-baslatma-istegi"},{level:2,title:"7.2.\tADIM 1 - leri Tarihli deme Emri Rzasnn Hazrlanmas",slug:"_7-2-adim-1-ileri-tarihli-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"7.3.\tADIM 2- leri Tarihli deme Emri Rzasnn Yetkilendirilmesi",slug:"_7-3-adim-2-ileri-tarihli-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"7.4.\tADIM 2.1  leri Tarihli deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_7-4-adim-2-1-ileri-tarihli-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"7.5.\tADIM 3- leri Tarihli deme Emrinin Oluturulmas",slug:"_7-5-adim-3-ileri-tarihli-odeme-emrinin-olusturulmas"},{level:2,title:"7.6.\tADIM 3.1- leri Tarihli deme Emri Sorgusu (stee bal)",slug:"_7-6-adim-3-1-ileri-tarihli-odeme-emri-sorgusu-istege-bagl"},{level:2,title:"7.7.\tADIM 4- leri Tarihli deme Emri Rza ptali",slug:"_7-7-adim-4-ileri-tarihli-odeme-emri-rza-iptali"}],content:" 7.\tleri Tarihli deme Emri Balatma Hizmeti \n deme hizmeti kullancsnn ileri bir tarihte gereklemesini istedii deme emirlerinde bu hizmeti kullanabilir. demenin Havale / PS / FAST deme sistemlerinden hangisi ile gerekleeceine, deme gn geldiinde HHS karar verir. \n leri tarihli deme hizmetini online bankaclk sistemlerinde sunan HHS'lerin, HVPS zerinden bu hizmetleri sunmas zorunludur. Mevcutta online kanallarndan bu hizmeti sunduklar mteri segmentine (bireysel,kurumsal vb.), HVPS zerinden hizmet sunmaya devam etmeleri gerekmektedir. YS, bireysel mteri zelinde ileri tarihli deme hizmeti vermeyen HHS'ye ileri tarihli bir deme emri rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.IndividualCustomerNotSupported\"  hatas , kurumsal mteri zelinde ileri tarihli deme emri rzas istei yapldnda HHS tarafndan  TR.OHVPS.Business.CorporateCustomerNotSupported  hatas verilmelidir. \n HHS'ler ileri tarihli deme emri hizmetini sunu bilgilerini HHS API aracl ile yaynlayacaklardr. YS, ileri tarihli deme hizmeti balatabilecei HHS'lerin listesini HHS API'de yer alan \"hizmetTipi\":\"02\" parametresi ile alabilir. YS, ileri tarihli deme hizmeti sunmayan HHS'ye ileri tarihli bir deme emri rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.ScheduledPaymentNotSupported  hatas iletilmelidir. \n leri tarihli deme emri hizmetinde TRY dndaki yabanc para birimleri iin HHS tarafndan destek verilmemesi durumunda  TR.OHVPS.Business.InvalidCurrencyCode  hataas verilmelidir. \n leri tarihli deme emri gncelleme hizmeti YS zerinden yaplamayacaktr. HK aktif olan dzenli deme talimat rzasn iptal ederek, yeniden oluturabilecektir. \n HHS zerinden ilgili gncelleme hizmeti salanabilir. leri tarihli talimat ierisinde yaplan gncelleme sonucunda olay bildirim ile YS'e bildirim salanacaktr. HHS zerinden gncelleme yaplrken talimat tarihine dair ileri bir tarihe gncelleme adm olmamaldr. Sadece ilk oluturulan talimat tarihinden ncesi olacak ekilde gncelleme yaplmasna izin verilmelidir. \n leri Tarili deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n leri Tarihli deme Emri Rza Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden ileri tarihli deme emrini balatr. \n leri Tarihli deme Emri Rza Hazrlanmas:  BHS, leri Tarihli deme Emri Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n leri Tarihli deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve ileri tarihli deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n leri Tarihli deme Emrinin Balatlmas:  BHS, ileri tarihli deme emrini HHSye iletir. \n leri Tarihli deme Emri Rza Durumu, leri Tarihli deme Emri Durumu, leri Tarihli deme Emri Detay Sorgular:  BHS, leri Tarihli deme Emri Rza Durumu, leri Tarihli deme Emri Durumu, leri Tarihli deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular)  mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin hem HBH hem de BH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini(nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n YS'ler gnderen hesap seimini aadaki yntemlerden biri ya da birka ile salayabilirler: \n \n YS, mterisinin deme hesabn HHS ekranndan setirebilir. \n YS, mterisinden Hesap Bilgisi rzas alr. Rza ald hesaplar zerinden hesap referans aracl ile ileri tarihli deme emri balatabilir. \n YS, mterisinin deme hesabn elle girmesine olanak tanyabilir. IBAN' olmayan HHS'ler ileri tarihli deme emri rzas admnda  TR.OHVPS.Business.IBANNotSupported  hatasn vermelidir. IBAN' olan HHS'lerin bu ak desteklemesi zorunludur. \n YS; mterisinin hesap referansn elle girmesini salayabilir. Hesap Referans bilgisi ile balatlan ileri tarihli deme emri ilemlerinde HHS seimi zorunludur. \n \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN sunmadklar iin, YS'ler hesap referans ile deme balatabilirler. Bunlarn dndaki HHS'lerin, gnderen IBAN veya hesap referans ile deme akn desteklemesi zorunludur. \n leri Tarihli deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n leri Tarihli deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. deme Emri Hizmeti ile ayn etki alan(scope) kullanlmaktadr. \n Tablo : leri Tarihli deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n ileri-tarihli-odeme-emri-rizasi \n POST \n /ileri-tarihli-odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n IleriTarihliOdemeEmriRizasiIstegi \n IleriTarihliOdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 3 \n ileri-tarihli-odeme-emri-rizasi \n GET \n /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n IleriTarihliOdemeEmriRizaYaniti \n \n \n 4 \n ileri-tarihli-odeme-emri \n POST \n /ileri-tarihli-odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal stek ve Yant \n IleriTarihliOdemeEmriIstegi \n IleriTarihliOdemeEmri \n \n \n 5 \n ileri-tarihli-odeme-emri \n GET \n /ileri-tarihli-odeme-emri/{odmEmriNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n IleriTarihliOdemeEmri \n \n \n 6 \n ileri-tarihli-odeme-emri-rizasi-iptal \n DELETE \n /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n - \n - \n - \n 7.1.\tADIM 0 - leri Tarihli deme Emri Rzas Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) ileri tarihli deme emri rzas srecini balatr. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 7.2.\tADIM 1 - leri Tarihli deme Emri Rzasnn Hazrlanmas \n   \n ekil : leri Tarihli deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak ileri tarihli deme emri rza kaynann oluturulmasn (ileriTarihliOdemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi olduu geit tarafndan kontrol edilir. \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahiplii geit tarafndan kontrol edilir. \n HHS tarafndan, istek balndaki x-aspsp-code ile katilimciBlg ierisinde yer alan hhsKod deeri ile ayn olduunu kontrol edilir. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n \n \n \n POST baarl olursa, HHS, ileri tarihli deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren ileriTarihliOdemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /ileri-tarihli-odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir IleriTarihliOdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, ileri tarihli deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS'ler ileri tarihli deme emri hizmetini sunu bilgilerini HHS API aracl ile yaynlayacaklardr. YS, ileri tarihli deme hizmeti balatabilecei HHS'lerin listesini HHS API'de yer alan \"hizmetTipi\":\"02\" parametresi ile alabilir. YS, ileri tarihli deme hizmeti sunmayan HHS'ye ileri tarihli bir deme emri rzas istei yapmas durumunda HHS tarafndan  TR.OHVPS.Business.ScheduledPaymentNotSupported  hatas iletilmelidir. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hata kodu iletilmeli ve fieldErrors dolu olacak ekilde hatal alan belirten detayl aklama gnderilmelidir. InvalidFormat hata kodlarnda fieldErrors ierii gnderilmeli ve anlalr aklama ile message, messageTr alanlar doldurulmas zorunludur. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n HHS, bireysel mteri zelinde ileri tarihli deme hizmetini kendi kanallarnda sunmuyor ise HHS'ye ileri tarihli bir deme emri rzas istei yapmas durumunda HHS tarafndan  \"TR.OHVPS.Business.IndividualCustomerNotSupported\"  hatas ,\nkurumsal mteri zelinde ileri tarihli deme emri rzas istei yapldnda HHS tarafndan  \"TR.OHVPS.Business.CorporateCustomerNotSupported\"  hatas dnlr. \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme adresleri ile ileri tarihli deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.TPPRedirectionAddressMismatch\"  hatas dnlr. \n HHS; kimlik bilgileri nesnesinde yer alan kimlik bilgisi ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.  (Koullu Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.CustomerNotFound\"  hatas dnlr. \n leri Tarihli deme Emri Balatma Hizmeti rza isteinde bulunan HKnn Ak Bankaclk Kanal Yetki tanm yok ise  \"TR.OHVPS.Business.OpenBankingChannelClosed\"  hatas dnlr. HHS insiyatifinde olup HHS bu kontrol GKD sonras gerekletirebilir. \n leri tarihli deme emri rzasnda alc hesap bilgileri Karekod ya da Kolas ile belirlenebilir. HHS online kanallarnda ileri tarihli deme hizmetini Karekod ve Kolas aracl ile kabul ediyorsa, HVPS servisleri ile de kabul etmek zorundadr. YS tarafndan ileri tarihli deme emri rzas istei ierisinde alc bilgisi iin karekod ya da kolas kompleks alanlar yer almas durumunda , destek vermeyen HHS'ler tarafndan  TR.OHVPS.Business.RecipientAccountTypeNotSupported  hatas dnlr. \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir. \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n Ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yaplmas durumunda HHS tarafndan  \"TR.OHVPS.Business.DecoupledAuthenticationNotSupported\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n Ayrk GKD ile balatlan rza aklarnda HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder. YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  \"TR.OHVPS.Business.EventSubscriptionNotFound\"  hatas dnlr. \n Rza balatma ak ierisinde kimlik bilgisinin, HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  \"TR.OHVPS.Business.CustomerInfoMismatch\"  hatas dnlr. \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda HHS tarafndan  \"TR.OHVPS.Business.CustomerMobileApplicationNotFound\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n HHS kimlik bilgisi ile gnderen nvannn uyumlu olduunu kontrol eder. HHS'ler EFT/FAST ilemlerinde kabul ettikleri kontrol kriterleri ile ileme izin verebilirler. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.IncorrectSenderTitle\"  hatas dnlr. \n Gnderen Hesap Numaras BHS tarafndan iletildii durumda;\n \n IBANn doruluu (kontrol basama dorulamas) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.InvalidAccount\"  hatas dnlr. \n IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountCodeMismatch\"  hatas dnlr. \n Hesap numarasnn HKya ait olduu kontrol edilir.Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.CustomerAccountMismatch\"  hatas dnlr. \n HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. (lgili hesabn para transfer ilemine yetkisi olmamas) Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountUnauthorized\"  hatas dnlr. \n HHSde gnderen hesabn aktiflii kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountInactive\"  hatas dnlr. \n \n \n Gnderen Hesap Numaras iin, Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile ileri tarihli deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  \"TR.OHVPS.Business.ActiveConsentNotFound\"  hatas dnlr. \n Talimat tarihi, talimat verilen gnn tarihinden minimum 1 gn sonras, maksimum ise 1 yl sonras olacak ekilde seilebilir. Belirtilen tarih aral dnda BHS tarafndan talimat tarihi iletilmesi durumunda HHS tarafndan  \"TR.OHVPS.Business.InvalidOrderDateRange\"  hatas dnlr. \n Talimati tarih bilgisi iin deme gnnn i gnne gelmedii ve HHS'nin FAST/Havale ile anlk deme balatamad durumda,  HHS tarafdan  \"TR.OHVPS.Business.OrderDateNotWorkDay\"  hata mesaj ile ilemi kesmelidir. YS, HK'ya tarih bilgisini gncelletebilir ya da kendisi otomatik atama yapabilir. Sonrasnda tekrar rza talebinde bulunmaldr. \n Alc ve gnderen hesabn ayn olmas durumunda  TR.OHVPS.Business.SenderRecipientSame  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n Mterinin kendi hesaplar arasnda talimat veremeyecei durumlarn kontrol iin  TR.OHVPS.Business.SameAccountTransferRestricted  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n \n Yukardaki kontroller tamamlandktan sonra HHS, deme iin benzersiz RizaNo ile IleriTarihliOdemeEmriRizasi nesnesi oluturur ve BHSye dner. \n HHS, IleriTarihliOdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n Hesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK ileri tarihli deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n  BAARILI STEK: \n Tablo : IleriTarihliOdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan ileri tarihli deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.ohkTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n HHS geerli bir para birimi olduu kontrol eder. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda ileri tarihli deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile ileri tarihli deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HHS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> nvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn nvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n Talimatn gerekleecei ana kadar KOLAS tanmnnda deiiklik olabilecei iin,  KOLAS ile yaplan ileri tarihli ilemler, talimatn verildii anda zlen IBAN'a yaplacaktr. \n Kolas ile ileri tarihli deme emri hizmeti desteklenmiyorsa; HHS tarafndan hata dnlmelidir. \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n Karekod ile yaplan ileri tarihli ilemler, talimatn verildii anda zlen IBAN'a yaplacaktr. \n Karekod ile ileri tarihli deme emri hizmeti desteklenmiyorsa; HHS tarafndan hata dnlmelidir. \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n HHS, YS'n API deseninde \"O\" kodunu ilettiini kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarnda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.   -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tyeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n YS bu deeri HKy HHSye ynlendirmeden nceki ekranda gstermeli, ve HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak yine HKya gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n \n >> Talimat Tarihi \n tlmtTrh \n ISODate \n Z \n HK tarafndan talep edilen, deme gerekleme zamandr. \n Talimat verilen gnn tarihinden minimum 1 gn sonras,maksimum ise 1 yl sonras olacak ekilde seilebilir. \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan IleriTarihliOdemeEmriRizasi nesnesi Tabloda parametrelerden oluur: \n Tablo : IleriTarihliOdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n IleriTarihliOdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n IleriTarihliOdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n IleriTarihliOdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr.  HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n Z \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.   Tek seferlik deme dnda YS'n gnderen nvann gndermesi zorunludur. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.    deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> Talimat Tarihi \n tlmtTrh \n ISODate \n Z \n HK tarafndan talep edilen, deme gerekleme zamandr. Talimat verilen gnn tarihinden minimum 1 gn sonras,maksimum ise 1 yl sonras olacak ekilde seilebilir. Belirtilen tarih aral dnda BHS tarafndan talimat tarihi iletilmesi durumunda HHS tarafndan  TR.OHVPS.Business.InvalidOrderDateRange  hatas verilmelidir. \n 7.3.\tADIM 2- leri Tarihli deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil : leri Tarihli deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn ileri tarihli deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, ileri tarihli deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=I&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, ileri tarihli deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=I&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=I&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn ileri tarihli deme emri rzasn balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK, bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, ileri tarihli deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, ileri tarihli deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 7.4.\tADIM 2.1  leri Tarihli deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: IleriTarihliOdemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp leri Tarihli deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda ileri tarihli deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle,  IleriTarihliOdemeEmriRizasi  nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr. HHS,  ADIM 2 -Ileri Tarihli deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  IleriTarihliOdemeEmriRizasi  nesnesine iler. \n \n Sorgulama yaplan leri Tarihli deme Emri HHS tarafnda bulunmuyor ise  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n \n GET /ileri-tarihli-odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  IleriTarihliOdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n Durum \n IleriTarihliOdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine/Talimata Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n leri Tarihli deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /ileri-tarihli-odeme-emri-rizasi/{rizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  IleriTarihliOdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda IleriTarihliOdemeEmriRizasi nesnesi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (leri Tarihli deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta IleriTarihliOdemeEmriRizasi nesnesi gncellenir ve BHS  GET /ileri-tarihli-odeme-emri-rizasi/{rizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren IleriTarihliOdemeEmriRizasi nesnesini ekmelidir. \n 7.5.\tADIM 3- leri Tarihli deme Emrinin Oluturulmas \n   \n ekil 8: leri Tarihli deme Emrinin Oluturulmas \n POST /ileri-tarihli-odeme-emri \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS OdemeEmri kaynan oluturur. \n leri Tarihli deme emri (IleriTarihliOdemeEmri) uygun deme kaynana POST istei yaplarak balatlr. \n \n Eriim Belirteci kontrol yaplr. Geerli bir Eriim Belirteci yok ise  \"TR.OHVPS.Connection.InvalidToken\"  hatas dnlr. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n Rza durumu kontrol edilir.\n \n B: Yetki Bekleniyor, Y: Yetkilendirildi  ya da E: Yetki deme Emrine Dnt ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n I: Rza ptal ya da S: Yetki Sonlandrld ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu K: Yetki Kullanld ise kontrollere devam edilir. \n \n \n POST /ileri-tarihli-odeme-emri-rizasi ile POST /ileri-tarihli-odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr. leri Tarihli deme Emri rzasnda gnderilen deerlerden farkl bir deer gnderildii durumda  TR.OHVPS.Business.FieldMismatch  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra, ierisinde odmEmriNo ve odmDrm deikenleri de bulunan IleriTarihliOdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine/Talimata Dnt olarak gncellenir. \n \n POST verisindeki Gnderen Hesap Numaras ve Alc Hesap Numarasnn ayn bankaya aitse HAVALE deilse FAST veya PS i akna geilir. \n \n BAARILI STEK: \n Tablo 9: IleriTarihliOdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan ileri tarihli deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n >Ynlendirme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n >Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur. yetYntm = Y iin bu nesne iletilmemelidir. \n \n \n \n >>OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >>OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n \n \n >Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. leri Tarihli deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. leri Tarihli deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn ileri tarihli deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. leri Tarihli deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. leri Tarihli deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  leri Tarihli deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n leri Tarihli deme Emri Rizas Nesnesindeki Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n leri Tarihli deme Emri Rizas Nesnesindeki lem Tutar verisi ile ayn olmaldr. HHS ilem tutar deme mesajnda (Havale/FAST/PS) aynen tanmak durumundadr. \n Ttr \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n leri Tarihli deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n leri Tarihli deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda ileri tarihli deme emrinde iletilen maskeli bilgi ile HHSnin kendi ileri tarihli deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n leri Tarihli deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n leri Tarihli deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n KolasRef ( hem FAST hem de PS iin ayn) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n leri Tarihli deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n leri Tarihli deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n leri Tarihli deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n leri Tarihli deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n leri Tarihli deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. \n RefBlg (Hem FAST hem de PS iin ayn) \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n FAST/PS Acklm \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n \n \n >> Talimat Tarihi \n tlmtTrh \n ISODate \n Z \n HK tarafndan talep edilen, deme gerekleme zamandr. Talimat verilen gnn tarihinden minimum 1 gn sonras,maksimum ise 1 yl sonras olacak ekilde seilebilir. \n \n \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan IleriTarihliOdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: IleriTarihliOdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zamandr. \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n Z \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Emir Bilgileri \n emrBlg \n Kompleks: EmirBilgileri \n Z \n \n \n \n > deme Emri Numaras \n odmEmriNo \n AN1..128 \n Z \n IleriTarihliOdemeEmri nesnesinin UID'sidir. IleriTarihliOdemeEmri likin sorgular bu ID zerinden yaplr. \n \n \n > deme Emri Zaman \n odmEmriZmn \n ISODateTime \n Z \n IleriTarihliOdemeEmri nesnesinin oluturulduu zaman bilgisi. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gerekleen lem Tutar \n grckIslTtr \n Kompleks:GerceklesenTutar \n K \n odmDrm:01 ,02 ve 06 olduu durumda gnderilmesi zorunludur. deme durumu 01 ve 02 durumlarnda gerekletirilen tutarn tamam bu alanda iletilmelidir. deme durumu: 06 olan ksmi deme ilemlerinde ise gerekleen tutar bilgisi iletilmelidir. \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n Talimat gerekletiinde deme yaplan tutar bilgisi.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.  deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O  deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Durumu \n odmDrm \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr.      deme Durumu alan ile ilgili olarak HHSler tarafndan YSlere  IleriTarihliOdemeEmri servisi yantnda  04:Onayda Bekliyor, 05:deme Bekleniyor yantlar gnderilebilir. 04:Onayda Bekliyor  ve  05:deme Bekleniyor  durumlar olutuktan sonra YS tarafndan ileri tarihli deme emri sorgulamas yaplarak deme durumunun gncel deeri renilir. Gncel deerler  01:Gerekleti,03:Gereklemedi , 06:Ksmen Gerekleti  ve  07:ptal Edildi  durumlar olabilir. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n K \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. odmDrm:01, 02 ve 06 olduu durumda gnderilmesi zorunludur. \n \n \n >> deme Sistem Numaras \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. Havale/FAST/PS  deme yntemleri iin tarih alan yyyy-aa-gg formatnda 10 karakter olarak iletilmelidir. odmDrm:01, 02 ve 06 olduu durumda gnderilmesi zorunludur. \n \n \n >> Talimat Tarihi \n tlmtTrh \n ISODate \n Z \n HK tarafndan talep edilen, deme gerekleme zamandr. Talimat verilen gnn tarihinden minimum 1 gn sonras,maksimum ise 1 yl sonras olacak ekilde seilebilir. \n \n \n >> Gerekleen deme Zaman \n grckOdmZmn \n ISODateTime \n K \n Gerekleen deme ilemine ait zaman bilgisi. odmDrm:01, 02 ve 06 olduu durumda gnderilmesi zorunludur. \n 7.6.\tADIM 3.1- leri Tarihli deme Emri Sorgusu (stee bal) \n   \n ekil 9: leri Tarihli deme Emri Sorgusu \n GET /ileri-tarihli-odeme-emri/{odmEmriNo} \n BHS, bu eriim adresi araclyla ileri tarihli deme emrini sorgulayabilir. Maksimum demenin gerekleecei gnn 15 gn sonrasna kadar sorgulama yaplabilir. Sonrasnda yaplacak sorgulamalarda eriim belirtecinin yetki sresi sonland iin HHS  \"TR.OHVPS.Resource.ConsentRevoked\" hatasn dnmelidir.\nptal edilmi talimatn bilgileri sorgulanmak istendiinde de yine  \"TR.OHVPS.Resource.ConsentRevoked\" hatas verilmelidir. \n YS sadece kendi uygulamas zerinden verilmi ileri tarihli demeleri sorgulayabilir. Eriim izni olmayan bir deme emri numaras ile sorgulama yaptnda HHS'den  \"TR.OHVPS.Resource.NotFound\"  hatasn alr. \n Ksmi demelerde, ksmen gerekleen deme tutar, \"gerekleen ilem tutar\"(grckIslTtr) alannda gnderilirken, gnderilmesi talep edilen tutar alan(rza balatma isteinde ki tutar) da \"ilem tutar\"(islTtr) alannda gnderilmeye devam edilmelidir. \n Gerekleen ilem tutar ve para birimi, deme gerekleme zaman alanlar, deme gnnden itibaren dolu olarak gelir. \n BAARILI YANIT: \n GET /ileri-tarihli-odeme-emri/{odmEmriNo} yantnn (RESPONSE) gvdesinde (BODY)  IleriTarihliOdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren IleriTarihliOdemeEmri nesnesi dner. \n 7.7.\tADIM 4- leri Tarihli deme Emri Rza ptali \n \n ekil 10: leri Tarihli deme Emri Rzas ptali \n DELETE /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n BHS, bu eriim adresi araclyla ileri tarihli deme emri rzasn iptal edebilir. \n DELETE /ileri-tarihli-odeme-emri-rizasi ars, bir BHS'nin nceden oluturulmu bir ileri tarihli deme emri rzasn silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, BHS zerinden bu rzasn kaldrmak isteyebilir. \n \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rza, silinen rizaNo bilgisi ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n ptal edilmek istenen leri Tarihli deme Emri Rzas HHS tarafnda bulunmuyor ise  TR.OHVPS.ResourceNotFound  hatas dnlr. \n Rza durumu Yetki Sonlandrld - S veya Yetki ptal - I ise  \"TR.OHVPS.Resource.ConsentRevoked\"  hatas dnlr. \n ptal edilmek istenen leri Tarihli deme Emri Rzasnn deme durumu 04 ya da 05 deil ise  TR.OHVPS.Business.TransactionCompleted  hatas dnlr. \n \n Yukarda kontroller baaryla tamamlandktan sonra srasyla aadaki ilemler yaplr. \n \n odmDrm deeri 04 ve 05 olan kaytlar 07 durum kodu ile gncellenmelidir. \n likili ileri tarihli deme emri talimat iptal edilmelidir. \n Rza iptal edilmelidir. \n \n Bu API ars, mterinin BHS zerinden ileri tarihli deme emri rzasn iptal etmesine ve HHS nezdindeki ileri tarihli deme emri rzas nesnesinin silinmesini salar.\nMterinin BHSnin veri eriim iznini iptal etmesi durumunda BHS, HHSde mevcut olan IleriTarihliOdemeEmriRizasi'na dair rza ve talimat bilgilerini pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa\nDELETE /ileri-tarihli-odeme-emri-rizasi/{RizaNo}\nars aracl ile yerine getirilir. \n Servis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr.\nHK rzas YS zerinden baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal ve durum kodu \"03\" olarak gncellenir ve gnclZmn zaman damgas vurularak gncellenir.\nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir:\nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (BHS) \n"},{title:"9.\tHesap Bilgisi Hizmeti",frontmatter:{},regularPath:"/v2.0.0/contents/hesap-bilgisi-hizmeti.html",relativePath:"v2.0.0/contents/hesap-bilgisi-hizmeti.md",key:"v-2c81f446",path:"/v2.0.0/contents/hesap-bilgisi-hizmeti.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Hesap Bilgisi Hizmeti in Eriim Adresleri",slug:"hesap-bilgisi-hizmeti-icin-erisim-adresleri"},{level:2,title:"ADIM 0: HK'nn hesap/kart bilgilerine eriim iin talepte bulunmas:",slug:"adim-0-ohk-nn-hesap-kart-bilgilerine-erisim-icin-talepte-bulunmas"},{level:2,title:"9.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas",slug:"_9-1-adim-1-hesap-bilgisi-rzasnn-hazrlanmas"},{level:3,title:"POST /hesap-bilgisi-rizasi",slug:"post-hesap-bilgisi-rizasi"},{level:3,title:"Baarl stek:",slug:"basarl-istek"},{level:3,title:"Baarl Yant:",slug:"basarl-yant"},{level:2,title:"zinler",slug:"izinler"},{level:2,title:"9.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi",slug:"_9-2-adim-2-hesap-bilgisi-hizmeti-rzasnn-tesisi"},{level:2,title:"9.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas",slug:"_9-3-adim-2-1-hesap-bilgisi-rzasnn-sorgulanmas"},{level:2,title:"9.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali",slug:"_9-4-adim-2-2-hesap-bilgisi-rzasnn-iptali"},{level:2,title:"9.5 ADIM 3: Hesap Bilgilerinin Alnmas",slug:"_9-5-adim-3-hesap-bilgilerinin-alnmas"},{level:2,title:"9.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas",slug:"_9-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanmas"},{level:2,title:"9.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas",slug:"_9-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanmas"},{level:2,title:"9.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas",slug:"_9-8-adim-3-5-ve-3-6-islemlerin-sorgulanmas"},{level:2,title:"9.9 ADIM 4: Kart Bilgilerinin Sorgulanmas",slug:"_9-9-adim-4-kart-bilgilerinin-sorgulanmas"},{level:2,title:"9.10 ADIM 4.1: Kart Detay Bilgilerinin Sorgulanmas",slug:"_9-10-adim-4-1-kart-detay-bilgilerinin-sorgulanmas"},{level:2,title:"9.11 ADIM 4.2: Kart Hareket Bilgilerinin Sorgulanmas",slug:"_9-11-adim-4-2-kart-hareket-bilgilerinin-sorgulanmas"}],content:" 9.\tHesap Bilgisi Hizmeti  \n Genel Bilgiler \n Bu dokmanda belirtilen \"Hesap Bilgisi Hizmeti\" ibaresi hem hesap hem de kart rza srelerini kapsamaktadr. \n Hesap bilgisi sorgulama iin HBHS tarafndan mteri rzas tesisinin HHS tamamlanm olmas gerekir. Mteri rzas tesisi tamamlandktan sonra, HBHS sorgulamak istedii hesaba ait verileri ilgili eriim adresi zerinden sorgular. \n \n \n ekil 10: Hesap Bilgisi Hizmeti st Dzey Ak \n ekil-10da sunulan hesap bilgisi hizmeti 5 temel aktan oluur: \n 0.\tMterinin hesap bilgilerine eriim iin talepte bulunmas:  HK BHS mobil uygulama ya da web sitesinden hesap bilgilerine eriim ilemini balatr. \n 1.\tHesap Bilgisi mteri rzasnn hazrlanmas: \n HBHS, hesap/kart bilgilerine eriim iin mteri rzas tesisi amacyla HHSdeki hesap bilgisi rzas eriim adresine bir POST isteinde bulunur ve bir hesap bilgisi rzas nesnesi oluturur. HHS hesap bilgisi rzas nesnesi iin biricik tanmlayac dner (RzaNo). Hesap bilgisi rzas, mterinin HBHSnin hesap/kart bilgilerine eriim izin verdii alanlar iin 9.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas balnda incelenebilir. \n 2.\tHesap bilgisi hizmeti mteri rzasnn tesisi: \n HHS, Hesap Bilgisi Rzas servisi ile HK zelinde Yetki bekleniyor statsnde bir rza nesnesi hazrlar. HHS, GKDnin baaryla tamamlanmas sonrasnda hesap bilgisi rzas nesnesinin yetkilendirildiini belirtmek iin Rza Durumunu Rza Yetkilendirildi olarak gnceller. Nesne yetkilendirildikten sonra HHS nesne ile bir eriim belirteci (access token) ilikilendirir, Rza Durumunu Yetki Kullanld yapar ve bu belirteci HBHSye geri dner.  Bylece mteri rza tesisi salanm olur. \n Hesap bilgisi rzasna ilikin temel ilkeler unlardr: \n \n 1 HK'nn 1 YS iin 1HHS'de Yetki Bekleniyor, Yetkilendirildi, Yetki Kullanld statsnde 1 rzas olabilir. \n Mteri rzasnn ayrntlar HK ile HBHS arasnda belirlenir. Bu nedenle mteri rzasnn ayrntlar HHS ekrannda deitirilmemelidir. \n HK, hesap ve kart eriim izni ayrntlarn yalnzca bir btn olarak yetkilendirebilir veya geri alabilir. \n Mteri rzas tesisi esnasnda, mteri HHS arayznde eriim iin yetkilendirecek hesaplar ve kartlar seer. \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN hizmeti sunmayabildikleri iin hesap referans ile aklarn kurgulayabilirler. YS nyzlerinde yaplan bilgilendirmelerde, IBAN harici hesap referans ile ilem yaplabilmesine dikkat edilmelidir. \n \n 2.1\tHesap bilgisi rzasnn sorgulanmas:  Mteri rzas  GET/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak sorgulanr. \n 2.2\tHesap bilgisi mteri rzasnn iptali:  Mteri rzas  DELETE/hesap-bilgisi-rizasi/{RizaNo}  ars yaplarak iptal edilir. \n 3.1\tHesap bilgilerinin alnmas:  Hesap bilgileri ilgili kaynaa (hesaplar, bakiye, ilemler) GET istei yaplarak gerekletirilir. HBHS, mteri rzasnn tesisinden sonrasnda (geerli bir eriim belirticine sahip olduunda) ncelikle  GET/hesaplar  ars yapacaktr. \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular) mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin HBH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini (nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n 4.\tKart bilgilerinin alnmas:   Kart bilgileri ilgili kaynaa (kartlar, kart detay, kart hareketleri) GET istei yaplarak gerekletirilir. HBHS, mteri rzasnn tesisinden sonrasnda (geerli bir eriim belirticine sahip olduunda) ncelikle  GET/kartlar  ars yapacaktr. \n Hesap Bilgisi Hizmeti in Eriim Adresleri \n Etki Alan (Scope) =hesap_bilgisi \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n hesap-bilgisi-rizasi \n POST \n /hesap-bilgisi-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n HesapBilgisiRizasiIstegi \n HesapBilgisiRizasi \n \n \n 2 \n erisim-belirteci  (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n \n HesapBilgisiRizasi \n \n \n 2.2 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD-Koullu) \n \n \n \n \n \n \n 3.1 \n hesaplar \n GET \n /hesaplar \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n HesapBilgileri(birden ok hesap) \n \n \n 3.2 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n HesapBilgileri(tek  hesap) \n \n \n 3.3 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n \n \n BakiyeBilgileri(tek  hesap) \n \n \n 3.4 \n bakiye \n GET \n /bakiye \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama \n \n BakiyeBilgileri(birden ok hesap) \n \n \n 3.5 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n IslemBilgileri (tek hesap) \n \n \n 4 \n kartlar \n GET \n /kartlar \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n KartBilgileri(birden ok kart) \n \n \n 4.1 \n kartlar \n GET \n /kartlar/{kartRef} \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n KartBilgileri(tek kart) \n \n \n 4.2 \n kart-detay \n GET \n /kartlar/{kartRef}/kart-detay \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Filtreleme \n \n KartDetayBilgileri \n \n \n 4.3 \n kart-hareketleri \n GET \n /kartlar/{kartRef}/kart-hareketleri \n Z \n stemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD) \n \n Sayfalama Filtreleme \n \n KartHareketleri \n \n \n \n Tablo 11: Hesap/Kart Bilgisi Hizmeti in Eriim Adresleri \n ADIM 0: HK'nn hesap/kart bilgilerine eriim iin talepte bulunmas: \n HK, HBHS uygulamasnda (web arayz/mobil uygulama) hesap/kart bilgilerine eriim iin talepte bulunur. \n 9.1 ADIM 1: Hesap Bilgisi Rzasnn Hazrlanmas \n Bu dokmanda belirtilen hesap bilgisi hizmeti ibaresi hem hesap hem de kart rza srelerini kapsamaktadr. \n Bu API ars HBHS'nin HHS'de yeni bir HesapBilgisiRizasi nesnesi oluturmasn ve nesneye erimek iin benzersiz bir rza numaras ({rizaNo}) dnlmesini salar. \n API arsnn baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas yeterlidir.\nBaaryla oluturulan hesap bilgisi rza kaynann rza durumu Yetki Bekleniyor olarak dzenlenir.\nHK daha nce ald rzaya ilikin eriim tarihleri, izin trlerini ve hesap bilgilerini gncellemek isterse, HBHS nce HHS nezdindeki rzay iptal etmeli ve sonrasnda yeni bir rza talebinde bulunmaldr.\n \n \n ekil 11: Hesap/Kart Bilgisi Mteri Rzasnn Hazrlanmas \n \n POST /hesap-bilgisi-rizasi isteinin (REQUEST) gvdesinde (BODY)  HesapBilgisiRizasIstegi nesnesi (Tablo-12) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda HesapBilgisiRizasi (Tablo-13) nesnesi oluturulur. \n  POST /hesap-bilgisi-rizasi \n Bu dokmanda belirtilen hesap bilgisi rzas ibaresi hem hesap hem de kart rza srelerini kapsamaktadr. \n Baarl stek: \n STEK: \n HBHS, bu API eriim adresinden HHSye yeni bir HesapBilgisiRizasi oluturulmas iin istekte bulunur: \n \n HBHS, HKnn hesap/kart bilgilerine ynelik rza balatma istei olduunu HHSye bildirir. YS'ler srm 2.0 iin Hesap Bilgisi Rzas istei gnderdiinde HHS'nin HK'y ynlendirecei mobil uygulama ierisinde srm 2.0 deiikliklerini ieren, kart bilgilerinin seimini yapacaklar srmn ykl olmamas durumunda HHS'ler tarafndan  TR.OHVPS.Business.CustomerMobileApplicationHasOlderVersion  hatas verilebilir. \n HBHS, HKnn, HBHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn API dkmannda belirtilen artlar salayacak ekilde zorunluluk ve uzunluk kontrollerini yapar.(Zorunlu) Kontrollere istinaden hata olumas durumunda  TR.OHVPS.Resource.InvalidFormat  hata kodu iletilmeli ve fieldErrors dolu olacak ekilde hatal alan belirten detayl aklama gnderilmelidir. InvalidFormat hata kodlarnda fieldErrors ierii gnderilmeli ve anlalr aklama ile message, messageTr alanlar doldurulmas zorunludur. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n HHS; YS API ile alnan temel adres bilgilerinde yer alan ynlendirme adresleri ile hesap bilgisi rzas nesnesi ierisinde yer alan YS  adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  TR.OHVPS.Business.TPPRedirectionAddressMismatch  hatas dnlr. \n HHS; kimlik bilgileri nesnesinde iletilen kimlik bilgileri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr.(Zorunlu) Kontrollere istinaden hata olumas durumunda  TR.OHVPS.Business.CustomerNotFound  hatas dnlr. Kurumsal mteri ile balatlan rzada yer alan mteri bilgisinin kar kurumda Kurumsal mteri deil; bireysel mteri olduu durumda TR.OHVPS.Business.BusinessCustomerMismatch hatas dnlr. \n Bir HK'nn 1 YS iin aktif tek bir rzas olabilir. HKnn  Yetkilendirildi ve Yetki Kullanld statsnde rzas varken yeni bir rza istei gnderdiinde HHS tarafndan  TR.OHVPS.Business.ConsentAlreadyExists  hatas dnlr.  Gncelleme istei gndermesi durumunda ise iletilmesi gereken aklar Rza Durumlar balndan kontrol edilmelidir. \n Hesap bilgi hizmeti rza isteinde bulunan HKnn Ak Bankaclk Kanal Yetki tanm yok ise  TR.OHVPS.Business.OpenBankingChannelClosed  hatas dnlr. HHS insiyatifinde olup HHS bu kontrol GKD sonras gerekletirebilir. \n Hesap bilgi hizmeti rza isteinde 01 ya da 07 izin tr olmak zorundadr. HHS tarafndan izin tr ierisinde 01 ya da 07 varlk durumu kontrol edilir. Olmamas durumunda  \"TR.OHVPS.Business.IncorrectPermissionType  hatas dnlr. \n Hesap bilgi hizmeti rza isteinde 01 izin tr bulunmuyor ise 02, 03, 04, 05 ya da 06 izin tr olmamaldr. 01 izin tr bulunmadnda 02, 03, 04, 05 ya da 06 izin trlerinden biri ya da birka gnderildiinde  \"TR.OHVPS.Business.IncorrectPermissionType  hatas dnlr. \n Hesap bilgi hizmeti rza isteinde 07 izin tr bulunmuyor ise 08 ya da 09 izin tr olmamaldr. 07 izin tr bulunmadnda 08 ya da 09 izin trlerinden biri ya da ikisi gnderildiinde  \"TR.OHVPS.Business.IncorrectPermissionType  hatas dnlr. \n HK, HHS'de olacak bakiye deiikliklerinden anlk haberdar olmak istiyor ise 06-Anlk Bakiye Bildirimi izin tr seimi ile rza balatmas gereklidir. 03-Bakiye Bilgisi izin tr ile birlikte seilmesi gereklidir. 06 izin tr seilip 03 izin tr seilmedii durumda  TR.OHVPS.Business.IncorrectPermissionType  hatas dnlr. \n zin tr 06: Anlk Bakiye Bildirimi seilmi ise HHS, YS'n KAYNAK_GUNCELLENDI olay tipinde olay aboneliinin varln kontrol eder. Olay abonelik kayd bulunmuyor ise  TR.OHVPS.Business.EventSubscriptionNotFound  hatas dnlr. \n Hesap bilgi hizmeti rza isteinde bulunan HKnn izin verecek hesap ya da kart yok ise  TR.OHVPS.Business.ProductNotSuitable  hatas dnlr. ki rnden biri var ise baarl yant dnlr. HHS insiyatifinde olup HHS bu kontrol GKD sonras gerekletirebilir. \n Eriimin Geerli Olduu Son Tarih bilgisi mteri bamsz alabilecei minimum deer : Rza tarihi + 1 gndr. Maksimum rza sresi bireysel mteriler iin 6 ay, Kurumsal/Tzel mteriler iin 12 ay olacaktr. Bireysel mteriler iin 6 aydan fazla, kurumsal mteriler iin ise 12 aydan fazla iletildii durumda  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. \n zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; lem Sorgulama Balang Zaman, hesap bilgisi rzas verilmesinden  gemie  dnk en fazla 12 ay olabilmektedir. 12 aydan fazla gnderilmesi durumunda  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. \n zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; lem Sorgulama Balang Zaman, hesap bilgisi rzas verilmesinden  gelecee  dnk en fazla 12 ay sonras olabilmektedir. 12 aydan fazla gnderilmesi durumunda  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. \n Ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yaplmas durumunda HHS tarafndan  TR.OHVPS.Business.DecoupledAuthenticationNotSupported  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir. \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. \n Ayrk GKD ile balatlan hesap bilgi hizmeti rza isteinde HHS, YSn AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder. YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  TR.OHVPS.Business.EventSubscriptionNotFound  hatas dnlr. \n HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  TR.OHVPS.Business.CustomerInfoMismatch  hatas dnlr. \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda hata mesaj vermelidir. HHS tarafndan  TR.OHVPS.Business.CustomerMobileApplicationNotFound  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n \n Yukardaki kontroller tamamlandktan sonra HHS, benzersiz RizaNo ile HesapBilgisiRizasi nesnesi oluturur ve HBHSye dner. \n HHS, HesapBilgisiRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n Tablo 12: HesapBilgisiRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n nceki Rza No \n oncekiRizaNo \n AN1..128 \n K \n HesapBilgisiRzasiIstegi nesnesinin gncelleme sebebiyle oluturulmas esnasnda HK'nn gncelleme yapmak istedii mevcut rza no bilgisi. Rza gncelleme yaplmak istendiinde gnderilmesi zorunludur. \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Hata durumunda TR.OHVPS.Connection.InvalidASPSP hata kodunu dner. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder.  Hata durumunda TR.OHVPS.Connection.InvalidTPP hata kodunu dner. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr.   Yetkilendirme yntemi, HBHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.   Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.OHKTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr.   TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir.   Kurum adna yaplan(ticari) ilemlerde kurum kullancsnn bilgisi iletilmelidir. \n \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n \n Hesap/Kart Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n \n >zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih.   Mteri YS ekranndan bu deeri belirleyebilir. Bireysel mteriler iin rza sresi 6 ay, Kurumsal/Tzel mteriler iin 12 ay olacaktr.    Bireysel Mteriler iin varsaylan deer : Rza verilen tarih + 6 ay   Kurumsal Mteriler iin varsaylan deer : Rza verilen tarih + 12 ay  Bireysel Mteriler iin alabilecei maksimum deer : Rza tarihi + 6 ay  Kurumsal Mteriler iin alabilecei maksimum deer : Rza tarihi + 12 ay    Mteri bamsz alabilecei minimum deer : Rza tarihi + 1 gn    rnein  04/02/2023de minimum 05/02/2023 seilebilir. Bu durumda yeni gnn balang saati 00:00:00 olduu kabul edildii iin; erisimIzniSonTrh deeri 2023-02-06T00:00:00+03:00 olmaldr.  HHS rza onay ekranlarnda YS'ten iletilen eriim izni son tarihi yeni gnn balang saati olarak iletildiinden HK'ya gsterilecek tarih eriim izninin bitecei gn olarak gsterilmelidir.  rnee istinaden; HK YSde 05/02/2023 semi ise HHS rza onay ekrannda 06/02/2023 grmemeli, bu iki tarihin ayn, yani 05/02/2023 olacak ekilde gsterilmesi gerekmektedir.      rnek rza olu zaman  : 2023-02-04T21:20:20+03:00    1 gnlk rza verildiinde erisimIzniSonTrh deeri:    2023-02-06T00:00:00+03:00 (26 saat 40 sakikalk rza vermi oluyor.)    7 gnlk rza verildiinde erisimIzniSonTrh deeri:  2023-02-12T00:00:00+03:00    1 aylk rza verildiinde erisimIzniSonTrh deeri :   2023-03-05-T00:00:00+03:00 \n Bu alanda bir deer bulunmad durumda HHS hata dnmelidir. \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gemie dnk en fazla 12 ay olabilir, daha eski olmamas gerekir.   Varsaylan deeri rza verilen tarih (ilem zaman)  12 aydr.   HK bu alana bir deer girii salam ise zaman bilgisi retilirken ekrandan girilen tarihe 00:00:00 zaman bilgisi eklenmelidir. HK deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.   Minimum tarihi : Rzann verili tarihi  - 12 ay    Maksimum tarih: Rzann verili tarihi +  12 ay    zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve  lem Sorgulama Balang Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap bilgisi rzas verilmesinden gelecee dnk en fazla 12 ay sonras olabilir, daha ileri bir tarih olmamas gerekir.   Varsaylan deeri: Rza verilen tarih + 12 aydr. HK bu alana bir deer girii salam ise girdii tarihe 1 gn eklenir ve yeni gnn ilk saati kabul edilen 00:00:00 saat bilgisini ekler.  HK bu alana bir deer girii salamam ise BHS varsaylan deerlerle bu alan doldurarak, HHSye iletir.  Minimum tarihi : Rzann verili tarihi   12 ay  Maksimum tarihi :  Rzann verili tarihi + 12 ay   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur.  zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ise gnderilmemelidir. Eer dolu gnderilirse HHS tarafndan uygun hata mesaj iletilmelidir. \n HK tarafndan izin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmemi ve lem Sorgulama Biti Zaman BHS tarafndan dolu olarak gnderilmi ise HHS tarafndan ilemin devamna izin verilmez.   zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seilmi ise; HHS bu alann alabilecei minimum ve maksimum deerlerin snrlar ierisinde olduunu kontrol eder. \n Baarl Yant: \n Tablo 13: HesapBilgisiRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n nceki Rza No \n oncekiRizaNo \n AN1..128 \n K \n HesapBilgisiRzasiIstegi nesnesinin gncelleme sebebiyle oluturulmas esnasnda HK'nn gncelleme yapmak istedii mevcut rza no bilgisi. Rza gncelleme yaplmak istendiinde gnderilmesi zorunludur. stekte gnderilen deer ayn ekilde yantta dnlmelidir. \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n HesapBilgisiRzas nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu sral veri tipini deerlerinden birini alr. rn; hesap bilgi rzasnn tesisine dair ilk istek mesajna dnte B: Yetki Bekleniyor deerini almas beklenir. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. \n \n \n Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n > Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur deerine gre uzunluk ve format deiir. \n \n \n > Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr.  TR.OHVPS.DataCode.KurumKimlikTur sral veri tr deerlerinden birini alr. \n \n \n > Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.  TR.OHVPS.DataCode.KurumKimlikTur deerine gre uzunluk ve format deiir. \n \n \n > deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur sral veri tr deerlerinden birini alr (B: Bireysel, K:Kurumsal) \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir.  TR.OHVPS.DataCode.GkdTur sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde\tGKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.  HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir. Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Hesap/Kart Bilgisi \n hspBlg \n Kompleks: HesapBilgisi \n Z \n \n \n \n > zin Bilgisi \n iznBlg \n Kompleks: IzinBilgisi \n Z \n \n \n \n >> zin Tr \n iznTur \n Array[AN2] \n Z \n HK tarafndan HBHS nyznde belirlenen izin tipleridir. Bir istekte birden fazla deer bulunabilir, TR.OHVPS.DataCode.IzinTur sral veri tr deerlerinden birini alr. \n \n \n >> Eriimin Geerli Olduu Son Tarih \n erisimIzniSonTrh \n ISODateTime \n Z \n Hesap bilgisi rzasnn geerli olduu son tarih \n \n \n >> lem Sorgulama Balang Zaman \n hesapIslemBslZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei balang zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n >> lem Sorgulama Biti Zaman \n hesapIslemBtsZmn \n ISODateTime \n K \n Hesap hareketlerinin sorgunabilecei biti zaman. zin tr Temel ilem Bilgisi ve/veya Ayrntl lem Bilgisi seildiinde bu alanlarn doldurulmas zorunludur. \n \n \n > Ayrnt Bilgi \n ayrBlg \n Kompleks: AyrintiBilgi \n  \n \n \n \n > HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n zinler \n Bir hesap bilgisi rzas kayna arsna yant olarak dndrlen verileri snrlamak iin izin kodlar kullanlr. \n Hesap ve karta dair tm bilgiler hesap bilgisi rzas altnda alnacaktr. zin trleri hesap ve karta gre ayrmaktadr. \n \n Temel Hesap Bilgisi \n Ayrntl Hesap Bilgisi \n Bakiye Bilgisi \n Temel lem (Hesap Hareketleri) Bilgisi \n Ayrntl lem Bilgisi \n Anlk Bakiye Bildirimi \n Temel Kart Bilgisi \n Detayl Kart Bilgisi \n Ayrntl Kart lem Bilgisi \n \n HKya sunulacak seimler ve kurallar aadaki gibi olmaldr. \n \n \n \n Seim \n Kural \n \n \n \n \n Temel Hesap Bilgisi \n HK seim yapabilir. Temel Kart Bilgisi seilmediyse bu izin trnn seimi zorunludur. \n \n \n Ayrntl Hesap Bilgisi \n HK seim yapabilir. \n \n \n Bakiye Bilgisi \n HK seim yapabilir. \n \n \n Temel lem (Hesap Hareketleri)  Bilgisi \n HK seim yapabilir. \n \n \n Ayrntl lem Bilgisi \n HK seim yapabilir. Ayrntl lem Bilgisi seimi Temel lem Bilgisi seimini kapsar. (Ayrntl lem bilgisi seildiinde Temel lem Bilgisi de seili olmaldr.) \n \n \n Anlk Bakiye Bildirimi \n Bakiye Bilgisi izin tr ile birlikte seilmesi gereklidir. HK, HHS'de olacak bakiye deiikliklerinden anlk haberdar olmak istiyor ise bu izin tr seimi ile rza balatmas gereklidir. \n \n \n Temel Kart Bilgisi \n HK seim yapabilir. Temel Hesap Bilgisi seilmediyse bu izin trnn seimi zorunludur. \n \n \n Detayl Kart Bilgisi \n HK seim yapabilir. \n \n \n Ayrntl Kart lem Bilgisi \n HK seim yapabilir. \n \n \n \n Aadaki durumlarda, izin kombinasyonlarna izin verilmez. HHS, bu hesap eriim onaylarn 400 (Hatal stek) yant koduyla reddetmelidir: \n \n zin dizisinin herhangi bir izin tr iermemesi durumu, \n zin dizisinde HHS tarafndan desteklenmeyen bir izin kodunun yer almas durumu \n 9.2 ADIM 2: Hesap Bilgisi Hizmeti Rzasnn Tesisi \n \n \n ekil 12: Hesap Bilgisi HK Rzasnn Tesisi \n Rza tesisinin baaryla sonulanmas iin HBHS'nin istemci kimlik bilgileri yetkisi kullanmas ve ardndan mterinin HHS tarafndan ynlendirmeli veya ayrk GKD ile dorulanmas gerekir. HHS'de oluturulan ve rza durumu Yetki Bekleniyor olan bir hesap bilgisi rzas, GKD sonras Yetkilendirildi statsne gncellenir. HBHS, eriim salayaca hesaplar ve kartlar hesap bilgisi rzasnn tesisinden nce seer. \n \n \n Ynlendirmeli dorulama aknda, HBHS HKy HHSye ynlendirir. \n \n \n HBHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n \n \n HHS, HK iin GKD srecini iletir. \n HKy dorularsa, \n \n \n HK HBHS zerinden ilem yaplmasna izin verecei hesap/kart seimini yapar. HBHS zerinden HKnn verdii izin bilgilerini ve eriim izninin balang/biti tarihi bilgilerini, HHS'ler bilgilendirme amal HKya gsterir. \n \n \n Rza gncelleme ak ile balatlan rza isteklerinde mevcut rza ierisinde seili olan hesap/kart bilgileri HK'ya HHS ekranlarnda ayn ekilde seili olarak getirilmelidir. HK'lar mevcut rza ierisinde izin vermi olduu hesap/kart bilgilerini seili olarak grntleyip yeni rza iin izin vermek istedii hesap/kartlarn seimini gncelleyebilmelidir. \n Rza gncelleme srecinde;  HKnn HHSdeki mevcut rzas kapsamnda YSten gelen rza izin trlerine gre listeleme yaplmaldr. 01,02,03,04,05,06 seildiyse hesaplarn; 07,08,09 seildiyse kartlarn HHSde listelenmesi gerekmektedir. rnein: HKnn mevcut rzasnda hesaplar (01,02,03 rza trlerinin seili olsun) iin hesap bilgisi rzas verilmi olsun eer YSten rza gncelleme kapsamnda 01,02, 07,08 rza trleri geldii durumda HHSnin mevcut hesap rzasn ve doal olarak hesaplar listelemesi ek olarak da karta ait rza trleri seildiinde kartlarn listelenmesi gerekecektir. Ancak, HKnn mevcut rzasnda hesaplar (01,02,03 rza trlerinin seili olsun) iin hesap bilgisi rzas verilmi olsun eer YSten rza gncelleme kapsamnda  07,08, 09 rza trleri geldii farz edildiinde HHSnin mevcut hesap rzasn gstermemesi ve sadece karta ait rza trleri seildii iin kartlar listelemesi gerekecektir. \n \n \n HHS hesap bilgisi rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n HHS, HKy olumlu ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=H&drmKod=zzz\n \n \n \n HKy dorulayamazsa, \n \n \n HHS, hesap bilgisi rza kaynann durumunu Yetki ptal olarak gnceller. \n \n \n HHS, HKy olumsuz ynlendirme ak ile HBHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I &rizaNo=yy&rizaTip=H&rizaIptDtyKod=11&drmKod=zzz\n \n \n \n \n \n \n \n Ayrk dorulama aknda, HHS, HKnn hesap bilgisi hizmetini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister. \n \n Ayrk ak HBHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek hesap bilgisi rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, deme hizmeti kullancsn dorular. \n HK verdii izin tipi dahilinde bilgileri paylalacak olan hesaplar seer. Rza gncelleme ak ile balatlan isteklerde HK mevcutta vermi olduu hesap ve kartlar seili olarak grntler. lgili seimler zerinde gncelleme salayarak onay verir. \n HHS, hesap bilgisi rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS,  hesap bilgisi rzasnn durumunu Yetki Kullanld olarak gnceller. Rza tesisi salanm olur. \n 9.3 ADIM 2.1: Hesap Bilgisi Rzasnn Sorgulanmas \n GET /hesap-bilgisi-rizasi/{rizaNo} \n HK, HHS zerinden rza iptali yapm olabilir veya HKnn verdii rza sresi dolmu olabilir.  Bu durumlarda HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir HesapBilgisiRizasi kaynann durumunu, istee bal olarak alabilir. \n \n YS sadece kendi uygulamas zerinden verilmi hesap bilgi rzasn sorgulayabilir. YS'e ait olmayan bir rza ile sorgulama yapldnda HHS tarafndan  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n YS'e ait rza sorgulama yaplrken ilgili rza kayd bulunamaz ise  TR.OHVPS.Resource.NotFound  hatas dnlr. \n \n Servis baarl yantnda Tablo 13de belirtilen HesapBilgisiRizasi nesnesini dnmektedir. \n Durum \nHesapBilgisiRizasi kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n \n Yetki Bekleniyor \n \n \n Yetkilendirildi \n \n \n Yetki Kullanld \n \n \n Yetki Sonlandrld \n \n \n Yetki ptal \n \n \n Hesap bilgisi rzas sonlandrld ve iptal statsnde olan rza'larn gncellenme zamanndan(gnclZmn) 6 ay sonrasna kadar sorgulanabilir olmas beklenmektedir. HHS'ler ilgili sre sonrasnda yaplacak rza sorgularna  \"TR.OHVPS.Resource.NotFound\"  uyars verebilir. YS'ler tarafndan iptal ve sonlandrld statsnde olan rzalar iin sorgulama yapmamaldr. \n 9.4 ADIM 2.2: Hesap Bilgisi Rzasnn ptali \n \n \n \n ekil 13: Hesap Bilgisi Mteri Rzasnn Geri Alnmas \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \n DELETE /hesap-bilgisi-rizasi ars, bir HBHS'nin nceden oluturulmu bir hesap eriim rzasn (yetkili olsun veya olmasn) silmesine izin verir. Mteri, rzasn HHS zerinden iptal etmek yerine, HBHS zerinden bu rzasn kaldrmak isteyebilir. \nBu API ars, mterinin HBHS zerinden hesap bilgisi rzasn iptal etmesine ve HHS nezdindeki hesap bilgisi rzas nesnesinin silinmesini salar. \n \n Rza durumunun K olduu durumlarda eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rza, silinen rizaNo bilgisi ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n Rza ptali API'sinde ilgili rza kayd bulunamaz ise  TR.OHVPS.Resource.NotFound  hatas dnlr. \n Rza durumu Yetki Sonlandrld - S veya Yetki ptal - I ise  \"TR.OHVPS.Resource.ConsentRevoked\"  hatas dnlr. \n \n Mterinin HBHSnin veri eriim iznini iptal etmesi durumunda HBHS, HHSde mevcut olan HesapBilgisiRizasi kaynan pratik olarak mmkn olan en ksa srede silmelidir. Bu ise, ilgili kaynaa \n DELETE /hesap-bilgisi-rizasi/{RizaNo} \nars aracl ile yerine getirilir. HBHS ayrca, sisteminden Hesap/Kart Eriim zni kaynaklarn da temizlemelidir. \nSz konusu silme ilemi, kaytlarn statsnn pasife ekilmesi ile gerekletirilmelidir. Sz konusu kaytlar, denetim izlerinin oluturulmas ve saklanmasna ilikin ikincil dzenleme hkmleri kapsamnda gvenli ekilde tutulmaldr. \nServis istek parametresi olarak sadece pathde iletilen Rza No bilgisine ihtiya duymaktadr. \nHK rzas baar ile silindiinde HTTP 204 response kodu ile ilem sonucu iletilir. Rza tipi I yani Yetki ptal olarak gncellenir ve gnclZmn zaman damgas vurularak gncellenir. \nHK ile rza iptali srasnda kurulacak iletiimde (e-posta, sms gibi) aadaki alanlarn iletilmesi tavsiye edilmektedir: \nYS Ad, HHS ad, Rza Oluturma Zaman, Servis Tipi Bilgisi (HBHS) \n 9.5 ADIM 3: Hesap Bilgilerinin Alnmas \n    \n \n   \n ekil 14: Hesap Bilgilerinin Alnmas \n STEK: \nMteri rzas tesis edilmi kullanc iin HBHS API eriim adresinden HHSye eriilebilir hesap bilgilerini GET istei ile sorgular: \n \n Parametrede yer alan deerlerin doru gnderildii kontrol edilir. Hatal gnderilmesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. Parametrede yer alan deerler gnderilmedii durumda parametredeki varsaylan deerler ile hesap bilgileri dnlr. Varsaylan deerler Tablo 14'de belirtilmitir. \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n /hesaplar/{hspRef} ile yaplan istekte;\n \n stek balnda yer alan X-Access-Token ile ilikili rzada, izin verilen hspRef'ler iin, hesap bilgisi sorgulanan hspRefe ait rza ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n lgili hspRef bulunamaz  TR.OHVPS.Resource.NotFound  hatas dnlr. \n \n \n Rza durumu kontrol edilir.\n \n RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda hesap bilgileri servisini armamas beklenir. Bu rza durumlar ile yaplm arlar olduunda HHS tarafndan  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu Yetki Kullanld ise kontrollere devam edilir. \n \n \n HHS tarafndan HKnn 01: Temel Hesap Bilgisi izin trne sahiplii kontrol edilir. 01 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra HHS, \"HesapBilgileri\" nesnesini oluturur ve HBHSye dner. \n \n Hesap bilgisi rzas alnm ve eriim izni devam eden hesaplar ierisinden herhangi bir hesabn kapatlmas ya da pasife alnmas durumunda YS tarafndan yaplan hesap isteine HHS tarafndan hesap bilgisi dnlmelidir. Rza ierisinde tek bir hesap olmas halinde ilgili hesabn kapatlmas durumunda rza 09 iptal detay kodu ile iptal edilmelidir.\nKapal hesap iin TR.OHVPS.DataCode.HspDrm veri trnden KAPALI deeri ile, pasif hesap iin TR.OHVPS.DataCode.HspDrm veri trnden PASIF deeri ile dnlmelidir. \n 9.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanmas \n GET /hesaplar ve GET /hesaplar/{hspRef} \n Bu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bilgileri sorgulanr. Hesap bilgisi iin daha nce tanmlanm izin trne gre (Temel Hesap Bilgisi veya Detayl Hesap Bilgisi) yantnda dnlen HesapBilgileri nesnesinin ierii deiir. Tablo 15te HesapBilgileri nesnesinin ierii verilmitir. \n Hesap Bilgisi Sorgu rnei (Tm Hesaplar) =  /hesaplar \nHesap Bilgisi Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef} \nlem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 14: Hesap Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numaras \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 15: HesapBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzas nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Hesap Temel \n hspTml \n Kompleks: HesapTemel \n Z \n Temel Hesap Bilgileri (Temel Hesap Bilgisi varsaylan izin tr olduundan Hesap Temel nesnesi zorunlu olarak yantta bulunur) \n \n \n > Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n > Hesap Numaras \n hspNo \n AN26 \n K \n Eer varsa deme hesabna ait IBAN bilgisi \n \n \n > Hesap Sahibi nvan \n hspShb \n AN3..140 \n Z \n Hesap sahibi ya da hesap sahiplerinin ad-soyad, ticari nvan \n \n \n > ube Ad \n subeAdi \n AN3..50 \n K \n Eer varsa deme hesabnn bal olduu ubenin ad \n \n \n > Ksa Ad \n kisaAd \n AN3..50 \n K \n Eer hesap sahibi hesaba ait bir ad tanmladysa, tanmlanan hesap ad \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi. \n \n \n > Hesap Tr \n hspTur \n AN1 \n Z \n Hesabn tr (bireysel veya ticari). TR.OHVPS.DataCode.HspTur srali veri deerlerinden birini alr. \n \n \n > Hesap Tipi \n hspTip \n AN1..32 \n Z \n Hesabn tipi (VADESZ, KREDL vb.).TR.OHVPS.DataCode.HspTip sral veri deerlerinden birini alr. \n \n \n >Hesap rn Ad \n hspUrunAdi \n AN1..140 \n  \n HHS tarafndan atanm olan rn ad bilgisidir. HBHS tarafndan HKya gsterilmesi kullanm kolayl salayacaktr. \n \n \n > Hesap Durumu \n hspDrm \n AN5..50 \n Z \n Hesabn durumunu belirtir. TR.OHVPS.DataCode.HspDrm sral veri trlerinden birini alr. \n \n \n Hesap Detay \n hspDty \n Kompleks: HesapDetay \n K \n Detay Hesap Bilgileri (Temel Hesap Bilgisine ek olarak Detay Hesap Bilgisi izin tr de seilmise Hesap Detay nesnesi koullu olarak yantta bulunur) \n \n \n > Al Tarihi \n hspAclsTrh \n ISODateTime \n Z \n Belirtilen hesabn al tarihi. \n 9.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanmas \n GET /bakiye ve GET /hesaplar/{hspRef}/bakiye \nBu eriim noktalarndan tm hesaplarn veya belirli bir hesabn bakiyesi sorgulanr.   stek arsna dnlen BakiyeBilgileri nesnesi Tablo 17de verilmitir. \n \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n /hesaplar/{hspRef}/bakiye ile yaplan istekte;\n \n stek balnda yer alan X-Access-Token ile ilikili rzada, izin verilen hspRef'ler iin, bakiye sorgusundaki hspRefe ait rza ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n lgili hspRef bulunamaz  TR.OHVPS.Resource.NotFound  hatas dnlr. \n \n \n Rza durumu kontrol edilir.\n \n RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda hesap bakiye servisini armamas beklenir. Bu rza durumlar ile yaplm arlar olduunda HHS tarafndan  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu Yetki Kullanld ise kontrollere devam edilir. \n \n \n Hesap Bakiye Sorgulanmas yaplrken HHS tarafndan HKnn 03: Bakiye Bilgisi izin tr sahiplii kontrol edilir. 03 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra HHS, \"BakiyeBilgileri\" nesnesini oluturur ve HBHSye dner. \n \n Hesap Bilgisi Rzas alnm ve eriim izni devam eden hesaplar ierisinde yer alan hesaplardan kapatlm ya da pasif duruma alnm olan hesaplar iin bakiye istei yapldnda HHS tarafndan bakiye bilgisi dnlmelidir. \n \n Hesap bakiyelerinin gsterilmesi srasnda aada verilen rnekler gznnde bulundurulmaldr. \n rnek 1 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  -1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 2 : HK  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  2000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 3 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  0 deerini ieriyorsa,  Hesap Bakiye Tutar  0 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n rnek 4 : HK  Hesap Bakiye Tutar  1000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL. HK 1000 TL para k gerekletirdi. Bakiye API'si yant ierisinde iletilen  Kredi Dahil Gstergesi  1 deerini ieriyorsa,  Hesap Bakiye Tutar  3000 TL,  Kredili Mevduat Hesab Bakiyesi  3000 TL olmaldr. \n lem Sorgu rnei (Belirli Bir Hesap)=  /bakiye?\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= hspRef &\nsrlmYon=A \n Tablo 16: BakiyeBilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek kaytlarn sralama kriterini belirtir. Alabilecei deerler: { hspRef} \n Bu veri gnderildii durumda, HHS listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini hspRef olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler:  A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 17: BakiyeBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n Bakiye \n bky \n Kompleks:Bakiye \n Z \n \n \n \n > Hesap Bakiye Tutar \n bkyTtr \n AN1..25 \n Z \n Hesabn bakiyesi. Bloke tutar dlmeden iletilmelidir.   Tutar alan regex patterni u ekildedir:  '^-?\\d{1,18}$|^-?\\d{1,18}\\.\\d{1,5}$' \n \n \n > Blokeli Tutar \n blkTtr \n AN1..24 \n K \n Varsa hesapta blokeli tutar bilgisi.     Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n > Bakiye letilme Zaman \n bkyZmn \n ISODateTime \n Z \n Bakiyenin iletildii zaman bilgisi. \n \n \n > KrediliHesap \n krdHsp \n Kompleks: KrediliHesap \n K \n \n \n \n >> Kredili Mevduat Hesab Bakiyesi \n kulKrdTtr \n AN1..24 \n Z \n Kredili mevduat tutar. Kredili bir hesap ise zorunlu.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Kredi Dahil Gstergesi \n krdDhlGstr \n AN1 \n Z \n Kredili bir hesap ise zorunlu. Bakiye tutarnn kredi tutar dahil edilerek ya da edilmeden iletildiini gsterir.   0: Kredi tutar dahil edilmeden bakiye bilgisi iletilmesi durumu   1: Kredi tutar dahil edilerek bakiye bilgisi iletilmesi durumu \n 9.8 ADIM 3.5 ve 3.6: lemlerin Sorgulanmas \n GET /hesaplar/{hspRef}/islemler \n Servis baarl yantnda Tablo 19da belirtilen \"IslemBilgileri\" nesnesini dnmektedir. \n \n Belirli bir hesaba ilikin ilem bilgileri Tablo 18deki istek parametrelerine gre sorgulanr. Parametrede yer alan deerlerin doru gnderildii kontrol edilir. Hatal gnderilmesi durumunda  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rzada, izin verilen hspRef'ler iin, ilemler sorgusundaki hspRefe ait rza ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n lgili hspRef bulunamaz  TR.OHVPS.Resource.NotFound  hatas dnlr. \n Rza durumu kontrol edilir.\n \n RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda ilemler servisini armamas beklenir. Bu rza durumlar ile yaplm arlar olduunda HHS tarafndan  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu Yetki Kullanld ise kontrollere devam edilir. \n \n \n HHS tarafndan HKnn 04: Temel lem (Hesap Hareketleri) Bilgisi veya \"05: Ayrntl lem Bilgisi\" izin trne sahiplii kontrol edilir. 04 veya 05 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported   hatas dnlr. \n \n Hesap Bilgisi Rzas alnm ve eriim izni devam eden hesaplar ierisinde yer alan hesaplardan kapatlm ya da pasif duruma alnm olan hesaplar iin ilemler istei yapldnda HHS tarafndan ilemler bilgisi dnlmelidir. \nlem bilgisi iin daha nce tanmlanm izin trne gre yantta dnen IslemBilgileri nesnesinin (Temel lem Bilgisi veya Temel lem Bilgisi ve Detayl lem Bilgisi) ierii deiir. \nlemler servisi hem HKnn talebi ile YS uygulamas zerinden arlabilecei gibi, YSn HKsz balatabilecei otomatik arlar ile de yant dnebilmektedir. \nHHS, ilemin sistemsel yaplp yaplmadn, istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir.\nHKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \nYS, otomatik yapaca sorgularda; \n \n Bireysel HKlar iin hesap baznda gnde en fazla 4 adet baar ile sonulanan sorgulama yapabilir. 4 adetten fazla yaplmas durumunda  TR.OHVPS.Connection.ExceededRate  hatas dnlr. \n Kurumsal HKlar iin hesap baznda saatte en fazla 12 adet baar ile sonulanan sorgulama yapabilir. 12 adetten fazla yaplmas durumunda  TR.OHVPS.Connection.ExceededRate  hatas dnlr. \n \n HHS, tutaca saya bilgisi ile bu saylar kontrol ederek daha fazla sorgulama yaplmasna izin vermeyebilir. \n Ayn istek parametreleri ile yaplan sorgu sonucunda dnecek toplam kayt says 100 atnda, sayfalama yntemi ile HHSnin cevap dnmesi beklenmektedir.  Her bir sayfa iin ilemler servisi tekrar arlsa da, bu arm HHSnin tuttuu saya deerini arttrmaz. HHSnin tutaca sayan kontrol parametreleri YS kodu, hesap numaras ya da referans olmaldr. Sayfa no parametresi varsa ve 1'den byk ise ilem sayacn arttrmamaldr. \n HKnn YS uygulamas zerinden tetikledii ilemlerde ise;\nbireysel HKlar  iin en fazla 1 aylk,\nkurumsal HKlar iin ise en fazla 1 haftalk bir pencere aralnda sorgulama yaplabilir. Belirtilen tarih aralndan farkl deer ile sorgulama yapldnda  TR.OHVPS.Business.InvalidStartEndTime  hatas dnlr. \n YS, otomatik yapaca sorgularda hem bireysel hem de kurumsal HKlar iin 24 saatlik bir pencere aralnda sorgulama yapabilir. Belirtilen tarih aralndan farkl deer ile sorgulama yapldnda  TR.OHVPS.Business.InvalidStartEndTime  hatas dnlr. \n Yeni gnn balang saatinin 00:00:00 olduu kabul edilmitir. \n Sorgu rnekleri aadaki gibidir:  \n 1 gnlk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-02T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n \n 1 haftalk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-06-08T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-02-01T00:00:00+03:00&\nhesapIslemBtsTrh=2020-03-01T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-01-31T00:00:00+03:00&\nhesapIslemBtsTrh=2020-02-28T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 1 Aylk lem Sorgu rnei (Belirli Bir Hesap) =  /hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-02-28T00:00:00+03:00&\nhesapIslemBtsTrh=2020-03-28T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n 24 saatlik pencerede yapaca sistemsel sorgu rnei (Son sorgusunun zerine 24 saat eklenmesi)  =\n/hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2020-06-01T14:10:08+03:00&\nhesapIslemBtsTrh=2020-06-02T14:10:08+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n nyzden alnan sorgu parametreleri ile oluturulan sorgu rnei (rnek sorgu tarih aral 20.02.2023- 25.02.2023 arasndadr)  =\n/hesaplar/{hspRef}/islemler?\nhesapIslemBslTrh=2023-02-20T00:00:00+03:00&\nhesapIslemBtsTrh=2023-02-26T00:00:00+03:00&\nminIslTtr=0&\nmksIslTtr=100000&\nbrcAlc=A&\nsyfKytSayi=25&\nsyfNo=1&\nsrlmKrtr= islGrckZaman &\nsrlmYon=A\n \n Tablo 18: lem Listesi Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n lem Sorgulama Balang Zaman \n hesapIslemBslTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin balang tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. HK tarafndan tetiklenen sorgularda;hesapIslemBslTrh ve hesapIslemBtsTrh aras fark bireysel HKlar iin en fazla 1 ay,kurumsal HKlar iin ise en fazla 1 hafta olabilir. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;son 24 saat sorgulanabilir. Bu yzden hesapIslemBtsTrh-24 saatten daha uzun bir aralk sorgulanamaz olmaldr. stek balnda yer alan PSU-Initiated alan E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n \n \n lem Sorgulama Biti Zaman \n hesapIslemBtsTrh \n ISODateTime \n Z \n Sorgulanacak ilemlerin biti tarihi. \n HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan sistemsel yaplan sorgulamalarda hem bireysel, hem de kurumsal HKlar iin;leri vadeli ilem emirleri dahil olmad iin (Srm 1.0.2 kapsamnda); lem Sorgulama Biti Zaman, her zaman, sorgulama zaman damgasn iletecek ekilde (datetime (now)) iletilebilir. \n \n \n En Dk lem Tutar \n minIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en dk ilem tutar.      Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n En Yksek lem Tutar \n mksIslTtr \n AN1..24 \n  \n Sorgulanacak ilemlerin alabilecei en yksek ilem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Bor Alacak Gstergesi \n brcAlc \n AN1 \n  \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Hesaba bor yaratan ilem.A: Hesaba alacak yaratan ilem.{B,A} \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Sralama Kriteri \n srlmKrtr \n AN3..50 \n  \n Cevapta dnlecek ilemlerin sralama kriterini belirtir. Alabilecei deerler: {islGrckZaman} \n Bu veri gnderildii durumda, HHS ilemler listesini bu kritere gre sralayarak gnderir. Gnderilmediinde, HHS sralama kriterini islGrckZaman olarak belirler. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS ilemler listesini bu yne gre sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 19: IslemBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Hesap Referans Numaras \n hspRef \n AN5..40 \n Z \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez. Bir hesap (IBAN) tek bir hspRef'e karlk gelmelidir, benzer ekilde bir hspRef tek bir IBAN'a karlk gelmelidir. Ayn hesap iin alnan tm rzalarda hesap referans bilgisinin deimemesi gerekmektedir. \n \n \n Islemler \n isller \n Kompleks:Islem[Array] \n K \n Hesaba ilikin hareketler varsa lemler nesnesi dizisi olarak dnlr. lemler nesnesi Temel lem Bilgileri ve Detay lem Bilgileri nesnesinden meydana gelir. zin tr varsaylan olarak Temel lem Bilgilerini ierir. Detay lem Bilgileri izin tr de seildi ise Temel lem Bilgilerine ek olarak Detay lem Bilgileri de gnderilir. \n \n \n > Temel lem Bilgileri \n islTml \n Kompleks:IslemTemel \n Z \n Temel lem Bilgileri varsaylan olarak dnlr. \n \n \n >> lem Numaras \n islNo \n AN3..50 \n Z \n Hesap hareketinin oluturulmas srasnda atanan ve bor (veya alacak) hareketini tekilletiren HHS baznda tekil tanmlaycdr. Bu deer tek bana tekil olabilecei gibi birden fazla deerin bir araya getirilmesiyle de tekillii salanm olabilir. Bu deerin en azndan hesap numaras (hesNo) baznda tekil olmas beklenir. Genellikle kullanlan rnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp,dekont numaras \n \n \n >> lem Referans Numaras \n refNo \n AN3..50 \n Z \n lemi utan uca tanmlayan tekil tanmlaycdr. Bor ve alacak hareketinden oluan bir veya birden fazla ilemler btn iin atanm olan ve bu btn tekilletiren (bir biri ile ilikisini tutan) deerdir.Bu deer hem YSten gelen deer olabilir (deme ilemlerinde kullanlan kkodRef ya da refBlg alan) hem de HHS iinde takip edilmek iin retilmi bir deer olabilir. HHS sisteminde 2 deerin de bulunmas durumunda;refNo alann doldurmak iin, HHSnin YSten gelen deere ncelik vermesi beklenmektedir. YSten gelen veri rnei: Sipari Numaras, Fatura Numaras, Karekod Referans vb. HHSte retilen veri rnei: Masrafl havale ileminde hem havale ileminin hem de masraf ileminin ayn referans numarasna sahip olmas da rnek olarak gsterilebilir. \n \n \n >> lem Tutar \n islTtr \n AN1..24 \n Z \n lem tutar.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n >> Gncel Bakiye Tutar \n gnclBky \n AN1..25 \n Z \n lem sonras gncel bakiye bilgisi tutar.    Tutar alan regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para birimi. \n \n \n >> lem Gerekleme Zaman \n islGrckZaman \n ISODateTime \n Z \n lemin gerekleme zaman. \n \n \n >> lem Kanal \n kanal \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeKaynak sral veri tr deerlerinden birini alr. \n \n \n >> Borlandrma Alacaklandrma Gstergesi \n brcAlc \n AN1 \n Z \n TR.OHVPS.DataCode.BrcAlc sral veri tr deerlerinden birini alr. lemin hesab bor ya da alacaklandrd bilgisidir. \n \n \n >> lem Tr \n islTur \n AN3..50 \n Z \n HHSnin ileme ait ilikilendirdii ilem tr deeri. TR.OHVPS.DataCode.IslemTuru sral veri tr deerlerinden birini alr. \n \n \n >> lem Amac \n islAmc \n AN2 \n Z \n TR.OHVPS.DataCode.IslemAmaci srali veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> deme Sistemi No \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. Havale/FAST/PS  deme yntemleri iin tarih alan yyyy-aa-gg formatnda 10 karakter olarak iletilmelidir. \n \n \n > Detay lem Bilgileri \n islDty \n Kompleks: IslemDetay \n K \n Detay lem Bilgileri dizi olarak gnderilmelidir. \n \n \n >> lem Aklamas \n islAcklm \n AN1..200 \n Z \n HHS tarafndan atanan ilem aklamas. HHS kendi ilem hareketlerine yanstt aklamay buraya yanstmaldr.  HHS'ler tm hesap hareketlerini YS'ler ile paylamakla ykml olup, hassas veri ieren(rn: faiz, komisyon bilgisi ieren vb.) ilem hareketleri de bu kapsamda deerlendirilerek ilem aklamasnn maskeli olarak iletilmesi salanr. Kelimelerin ilk 3 hanesi maskeli olacak ekilde, ancak sakncal bulunan kelimeler varsa; (rn: faiz, komiyon vb.) kelimelerin tamam maskeli olacak ekilde gsterilebilir. \n \n \n >> Kar Taraf \n krsTrf \n Kompleks:  KarsiTaraf \n K \n Kullanm ilem baznda deimektedir. rnek: FAST ileminde kar taraf alcnn bilgileridir. Vergi demesinde kurum IBAN bilgisi mteriye gsterilemeyebileceinden bu alann bo gelmesi HHS insiyatifindedir. \n \n \n >>> Kar Maskeli IBAN \n krsMskIBAN \n AN26 \n K \n lgili hesap hareketinin kar tarafnn maskeli IBAN bilgisi. \n \n \n >>> Kar nvan \n krsUnvan \n AN3..140 \n K \n lgili hesap hareketinin kar tarafnn ad-soyad ya da ticari nvan bilgisi. nvan bilgisi maskelenmeden iletilmelidir. \n \n \n >>> Kar Taraf Kimlik Bilgisi \n krsKimlikVrs \n AN1..11 \n  \n HHS sorumluluunda YS ile paylalan Kar Taraf Kimlik Bilgisi(Kimlik/Kurum Kimlik - TCKN/VKN) \n 9.9 ADIM 4: Kart Bilgilerinin Sorgulanmas \n    \n GET /kartlar ve GET /kartlar/{kartRef} \n Bu eriim noktalarndan tm kartlarn veya belirli bir kartn bilgileri sorgulanr ve kart listesi elde edilir. lgili sorgu iin 07 izin trnn verilmesi yeterlidir. HHS ekranlarnda kart seimi yaplrken sadece aktif/ak statde olan kartlar listelenecek ve HK'ya setirilecektir. Kartn ilgili kanalda listelenme yetkisi bulunmuyorsa HVPS kapsamnda listelenmeyebilir. Listelendii durumda; asl kart sahibi ile sanal/ek kart sahiplerinin ayn kii olduu dnldnde HHS ekranlarnda kart seimi yaplarak rza verilirken asl kart seilmeden ilgili asl karta bal sanal ve ek kartlarn ayrca seilerek rza verilmesine izin verilmemelidir. HHS mevcut kanallarnda ek ve sanal kart hareketlerini asl karttan ayrt etmeden mterisine gsteriyor ise asl kart seimi ile birlikte asl karta bal sanal ve/veya ek kart seimini zorunlu klmaldr. Asl kart hamili dnda bir kii iin ek kart kartld durumda ek kart sahibi HHS'de asl kart grmeyecek olduundan sadece kendisine kartlan ek kart listelenecek ve seerek rza vermesi salanacaktr. Ek kart hamilinin asl kart hamilinden farkl olduu durumda asl karta ait bir rza olmasa da ek karta rza verilebilir. \n Her durumda onay ekrannda rza verilen tm kartlarn listesini HK'ya gstermesi zorunludur. Kapal devre alan kartlar kapsama dahil deildir. \n YS tarafndan balatlan rza isteklerinde hesap ve kart izin trlerinin seili olmas durumunda HHS ekranlarnda hem hesaplarn hem de kartlarn listelenmesi salanacaktr. Ancak hesap ya da kart bilgilerinden en az birinin seilmesi yeterlidir. Hem hesap hem kart bilgisi iin seim yaplmas zorunluluu bulunmamaktadr. \n \n Parametrede yer alan deerlerin doru gnderildii kontrol edilir. Hatal gnderilmesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. Parametrede yer alan deerler gnderilmedii durumda parametredeki varsaylan deerler ile kart bilgileri dnlr. Varsaylan deerler Tablo 20'de belirtilmitir. \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n Rza durumu kontrol edilir.\n \n RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda kartlar servisini armamas beklenir. Bu rza durumlar ile yaplm arlar olduunda HHS tarafndan  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu Yetki Kullanld ise kontrollere devam edilir. \n \n \n lgili rza numarasnn 07: Temel Kart Bilgisi izin trne sahiplii kontrol edilir. 07 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra HHS tarafndan istek balnda yer alan X-Access-Token ile ilikili rza ierisindeki kart bilgileri dnlr. Kart bilgileri iin KartBilgileri nesnesinin ierii Tablo 21'de verilmitir. \n Kart Bilgisi Sorgu rnei (Tm Kartlar) = /kartlar?syfKytSayi=25&syfNo=1?kartTipi=K\nKart Bilgisi Sorgu rnei (Belirli Bir Kart) = /kartlar/{kartRef} \n ptal statsnde olan banka ve n demeli kart tipleri HHS tarafndan kartlar sorgusunda dnlmeyecek olup YS'ler tarafndan HK'ya da gsterilemeyecektir. ptal statl kredi kart tipi iin bor/taksit bilgisi veya art bakiye olmas durumunda kartlar listesinde HHS'ler tarafndan dn salanacak olup YS'ler tarafndan HK'ya gsterilecektir. ptal statsnde olup herhangi bir bakiye ve bor olmamas durumunda ilgili kart bilgisi kartlar listesinde HHS tarafndan iletilmeyecektir. \n HHS'de ak/aktif statde yer alan kartlar seilip rza tahsis edildikten sonra kartn statsnn pasif olmas durumunda HHS tarafndan mevcut kanallarnda gsterilen bilgiler kart liste, detay ve hareket sorgulamalarnda dnlmelidir. HHS'de kart seimi yapp rza tahsis edildikten sonra ilgili kartn gsterimi zelinde HHS'de kstlama getirilmesi durumlar iin rnekler aada detaylandrlmtr. \n \n Rza ierisinde sadece kart olmas durumunda ilgili rzann 09 iptal detay kodu ile iptal edilmesi salanacaktr. \n Rza ierisinde ilgili kartn dnda hesap/kart olmas durumunda rza iptal edilmeyecektir. lgili kart haricinde kart listesinde farkl bir kart yoksa kart listesi, sorgulandnda  TR.OHVPS.Business.RestrictedChannelAccess  hata kodu dnlecektir. \n \n Tablo 20: Kart Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Kart Tipi \n kartTipi \n AN1 \n  \n Kart tipleri zelinde Banka, Kredi ve n demeli kartlarn ayrca soruglanmas salanr. \n Bu veri gnderildii durumda, HHS kart tipine uygun olarak kart bilgilerini dner. \n \n \n \n Tablo 21: KartBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n Kart Referans Numaras \n kartRef \n AN5..40 \n Z \n HHS tarafndan her bir kart iin atanan biricik deerdir (uuid). Bir kart tek bir kartRef'e karlk gelmelidir, benzer ekilde bir kartRef tek bir karta karlk gelmelidir. Ayn kart iin alnan tm rzalarda kart referans bilgisinin deimemesi gerekmektedir. \n \n \n Kart Numaras \n kartNo \n AN15..16 \n Z \n Karta ait numara maskeli olarak iletilmelidir. Maskeleme kural kart'n ilk 6 ve son 4 hanesi ak olarak grnecek ekilde maskelenmelidir. Sanal kart bilgisi iin de ilgili numara maskeli olarak iletilmelidir. rn: 123456******5678 \n \n \n Asl Kart Numaras \n asilKartNo \n AN15..16 \n K \n Asl kartlar iin ilgili alan iletilmemelidir. Sanal ve ek kartlar iin bal olduklar asl kart numaralar iletilmelidir. Ek karta ait sanal kart iin asl kart numaras olarak ek kart numaras iletilmelidir. Kart numaras maskeli iletilmelidir. \n \n \n Kart Tipi \n kartTipi \n AN1 \n Z \n Kartn tipini belirten deerdir. Kart tipleri olarak alabilecei deerler  TR.OHVPS.DataCode.KartTip  sral veri trlerinden biridir. \n \n \n Alt Kart Tipi \n altKartTipi \n AN1 \n Z \n Kart Tipleri altnda yer alan alt kart tipleridir. Alt kart tipleri olarak alabilecei deerler  TR.OHVPS.DataCode.AltKartTip  sral veri trlerinden biridir.  Asl banka kart, sanal banka kart, ek kredi kart, asl kredi kart gibi tm kart tiplerini ayrtrmak iin asl ve alt kart tipleri kullanlmaktadr. \n \n \n Kart Formu \n kartFormu \n AN1 \n Z \n Kartn fiziksel ve dijital olduunu belirten deerdir. Alabilecei deerler  TR.OHVPS.DataCode.KartFormu  sral veri trlerinden biridir. \n \n \n Kart Tr \n kartTuru \n AN1 \n Z \n Kartn tipinin bireysel ya da ticari olmasna ynelik olan deerdir.  B:Bireysel, T:Ticari \n \n \n Kart Stats \n kartStatu \n AN1 \n Z \n TR.OHVPS.DataCode.KartStatu  sral veri tr deerlerinden birini alr.  Kart stats iin gncelleme yaplamayacak durumda ise iptal stats olarak deerlendirilmelidir. Kart stats gncellenebilir durumda ise ak ve pasif olarak deerlendirilmelidir. \n \n \n Kart Sahibi Ad/Soyad \n kartSahibi \n AN3..140 \n Z \n Kart sahibi ya da kart sahiplerinin ad-soyad. \n \n \n Kart Ticari Unvan \n kartTicariUnvan \n AN3..140 \n K \n Kart tr ticari ise ilgili alanda ticari unvan iletilmesi zorunludur. \n \n \n Kart rn Ad \n kartUrunAdi \n AN3..140 \n Z \n Kart bilgilerinin rn ad. rn : TROY Business Kart \n \n \n Ekstre Trleri \n ekstreTurleri \n Kompleks:EkstreTurleri[Array] \n Z \n Ekstre trleri dizi ierisinde iletilmelidir. \n \n \n > Ekstre Stats \n ekstreStatu \n AN1 \n Z \n TR.OHVPS.DataCode.EkstreStatu  sral veri tr deerlerinden birini alr.Ekstre trnn durumu iletilmelidir. Pasif olan ekstre trleri de iletilmelidir. A: Aktif : ilgili kartn ekstre trnn kullanma ak olmasdr. P: Pasif : lgili kartn esktre trnn eskiden kullanld ancak u an devre d durumda olmasdr.  rnek olarak: lgili kredi kartnn TRY, USD, EUR ekstre trleri ak olduu durumda  ekstre trnn de aktif olarak dnmesi beklenmektedir. HK, USD ekstre trn kapatt durumda USD pasif ; TRY ve EUR aktif olarak dnmesi beklenmektedir. Bylece HKnn u an pasif ama nceden aktif olan esktre trlerinin sorgulanmas salanabilecektir. Eer bir ekstre tr iin hi ekstre retilmemise, bu durumda HHSnin ilgili ekstre trn hi dnmemesi gerekmektedir. \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n lgili karta ait ekstre trleri para birimi.(TRY, USD, EUR, GBP) Yurtd ekstre olan kartlar iin TRY haricinde de deer dnlmesi gerekmektedir. Banka kartlarnda ise karta bal olan hesap para birimleri iletilmelidir. \n \n \n Kart Rumuz \n kartRumuz \n AN3..140 \n  \n Kart iin rumuz bilgisi var ise gnderilebilir. \n \n \n Kart emas \n kartSema \n AN1 \n Z \n TR.OHVPS.DataCode.KartSema  sral veri tr deerlerinden birini alr. \n 9.10 ADIM 4.1: Kart Detay Bilgilerinin Sorgulanmas \n GET /kartlar/{kartRef}/kart-detay \n KartBilgileri nesnesi ile elde edilen kart listesinde yer alan kartlarn detay sorgulanr. Detay ile birlikte KartDetayBilgileri nesnesinin ierii Tablo 23'de verilmitir. \n \n Parametrede yer alan ekstreTuru bilgisi Ekstre Trleri haricinde uygun olmayan bir deer gnderildiinde  TR.OHVPS.Business.InvalidCurrencyCode  hatas dnlr. Bu alan gnderilmiyorsa TRY olarak deerlendirilmelidir. \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rzada, izin verilen kartRef'ler iin, kart detay bilgileri sorgulanan kartRefe ait rza ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n lgili kartRef bulunamaz  TR.OHVPS.Resource.NotFound  hatas dnlr. \n Rza durumu kontrol edilir.\n \n B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n I: Rza ptal ya da S: Yetki Sonlandrld ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu K: Yetki Kullanld ise kontrollere devam edilir. \n \n \n lgili rza numarasnn 08: Detayl Kart Bilgisi izin trne sahiplii kontrol edilir. 08 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported\"  hatas dnlr. \n Alt kart tipi Sanal Kart olanlar iin detay bilgisi grntlenmeyecektir.  Sanal kart zelinde detay bilgi sorgulamas yaplmas durumunda HHS tarafndan  \"TR.OHVPS.Business.CardTypeNotSupported\"  hatas dnlr. \n Kart tipi olarak; iptal statsnde olan banka ve n demeli kartlar iin detay sorgulamas yaplamayacaktr. Kart tipi kredi kart olup iptal statsnde olan ve  borcu olmayan bir  kart iin de kart detay sorgulamas yaplamayacaktr. Detay sorgulamas yaplamayacak bir kart tipi iin HHS'ler tarafndan  \"TR.OHVPS.Business.InvalidCardStatus\"  hatas dnlr. \n Rza ierisinde kanal grntleme yetkisi kapatlan kart iin detay bilgisi sorgulandnda  TR.OHVPS.Business.RestrictedChannelAccess  hata kodu dnlecektir. \n lk kredi kart oluan HK'lar henz ekstre olumad sebebiyle tarih ve bor bilgileri de olumam olabilir. Bu sebeple ilgili tutar bilgileri sfr olacak ekilde dnlmelidir. Tarih bilgileri ise varsaylan tarih bilgisi olarak dnlebilir.(rn:01/01/1900) Bu ekilde gelen bir tarih bilgisi YS'ler tarafndan HK'ya bo olarak gsterilebilir. \n \n Yukardaki kontroller tamamlandktan sonra HHS tarafndan  KartDetayBilgileri  nesnesi dnlr. \n HHS'ler kart tipi kredi kart ise ve karta ait bor/taksit tutar bilgisi bulunuyorsa KartDetayBilgileri nesnesi iin baarl yant dnmek zorundadr. Bor bilgisi iin tutarlar eksi(-) olacak ekilde iletilmesi beklenmektedir. \n Kart Detay Bilgisi Sorgu rnei (Tek Bir Kart) = /kartlar/{kartRef}/kart-detay \n Parametre ieren Kart Detay Bilgisi Sorgu rnei (Tek Bir Kart) =  /kartlar/{kartRef}/kart-detay?ekstreTuru=USD \n Tablo 22: Kart Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Ekstre Tr \n ekstreTuru \n AN3 \n K \n Kart bilgileri yantnda dnlen ekstre trleri deerlerini almaktadr. Para birimine uygun olarak kart detay bilgileri sorgulanmaktadr. Ekstre parametresi TRY,USD,EUR,GBP olarak gnderilebilir. Bu alan gnderilmiyorsa TRY deerlendirilmelidir. lgili para birimine zel ekstre iindeki harcama deeri dnlecektir. \n Ekstre trleri haricinde uygun olmayan bir deer gnderildiinde hata verilmelidir. \n \n \n \n Tablo 23: KartDetayBilgileri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n Kart Tiplerine stinaden Detayl Aklama \n \n \n \n \n Rza No \n rizaNo \n AN1..128 \n Z \n HesapBilgisiRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n Kart Referans Numaras \n kartRef \n AN5..40 \n Z \n HHS tarafndan her bir kart iin atanan biricik deerdir (uuid). Bir kart tek bir kartRef'e karlk gelmelidir, benzer ekilde bir kartRef tek bir karta karlk gelmelidir. Ayn kart iin alnan tm rzalarda kart referans bilgisinin deimemesi gerekmektedir. \n \n \n \n Ekstre Tr \n ekstreTuru \n AN3 \n Z \n Ekstre tr TRY,USD,EUR,GBP olarak gnderilebilir. stek paremetresinde iletilen deer ile ayn deer olmaldr. \n \n \n \n Toplam Kart Limiti \n toplamLimit \n Kompleks:ToplamLimit \n K \n Karta ait toplam TL limit bilgisi. Toplam kart limiti (+) deerde gnderilmelidir. Negatif deer gnderilmemelidir. \n Kart tipi kredi kart ve n demeli kart olanlar iin ilgili alann dnlmesi zorunludur. Kart tipi banka olan kartlar iin ilgili alan dnlmemelidir. n demeli kartlarda, bal bulunduklar bir hesap olsa bile, sadece zerlerine yklenen tutarn gsterilmesi gerekmektedir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Tutar Bilgisi. Limit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Kullanlabilir Kart Limiti \n kullanilabilirLimit \n Kompleks:KullanlabilirLimit \n K \n Karta ait kullanlabilir TL limit bilgisi. Kullanlabilir kart limiti (+) deerde gnderilmelidir. Herhangi bir sebeple (kart limitinin almas vb.)  (-) olmas durumunda deerin (-) olarak gnderilmesi beklenmektedir. \n Kart tipi banka olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Tutar Bilgisi. Limit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Dnem i Hareket Toplam \n donemIciHareketToplami \n Kompleks:DonemIciHareketToplami \n Z \n Dnem ii hareket toplam ve kalan ekstre borcunun toplam dnlmelidir. Mterinin borcu olduu durumda (-) deer gnderilmelidir. Mterinin alaca olduu durumda (iade/fazla deme vb(+) deer ile tutar bilgisi gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili dneme ait hareketlerin toplam tutar bilgisidir. Kart tipi banka ve n demeli kartlar iin ilgili dnem ierisinde ay bandan itibaren yaplan hareketlerin toplam tutar bilgisi iletilmelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Tutar Bilgisi.  Tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Ekstre Borcu \n ekstreBorcu \n Kompleks:EkstreBorcu \n K \n lgili ekstre trne uygun olarak ekstre borcu iletilmelidir. Mterinin alaca olduu durumda (iade/fazla deme vb(+) deer ile tutar bilgisi gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili alann dnlmesi koulludur. Ek kredi kart iin ilgili alan varsa dnlmelidir . Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Bor tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Kalan Ekstre Borcu \n kalanEkstreBorcu \n Kompleks:KalanEkstreBorcu \n K \n lgili ekstre trne uygun olarak kalan ekstre borcu iletilmelidir. Mterinin kalan ekstre borcu olduu durumda (-) deer gnderilmelidir. Kalan ekstre borcu yoksa veya herhangi bir sebeple ektresinde alacak tutar varsa 0(sfr) deeri gnderilmelidir. Pozitif deer gnderilmemelidir. \n Kart tipi kredi kart olanlar iin ilgili alann dnlmesi koulludur. Alt kart tipi ; Asl ve Dijital kredi kart iin ilgili alann dnlmesi zorunludur. Ek kredi kart iin ilgili alan varsa dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Bor tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Asgari deme Tutar \n asgariOdemeTutari \n Kompleks:AsgariOdemeTutari \n K \n lgili ekstre trne uygun olarak ekstreye ait asgari deme tutar iletilmelidir. Ekstre Borcu (-) ise; asgari deme tutar da (-) deer olarak gnderilmelidir. Mterinin alaca olduu durumda (iade/fazla deme vb.)  \"0\" (sfr) deeri gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili alann dnlmesi koulludur. Alt kart tipi ; Asl ve Dijital kredi kart iin ilgili alann dnlmesi zorunludur. Ek kredi kart iin ilgili alan varsa dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n deme tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Kalan Asgari deme Tutar \n kalanAsgariOdemeTutari \n Kompleks:KalanAsgariOdemeTutari \n K \n lgili ekstre trne uygun olarak ekstreye ait kalan asgari deme tutar iletilmelidir. Ekstre Borcu (-) ise; asgari deme tutar da (-) deer olarak gnderilmelidir. Mterinin alaca olduu durumda (iade/fazla deme vb.)  \"0\" (sfr) deeri gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili alann dnlmesi koulludur. Alt kart tipi ; Asl ve Dijital kredi kart iin ilgili alann dnlmesi zorunludur. Ek kredi kart iin ilgili alan varsa dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n deme tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Hesap Kesim Tarihi \n hesapKesimTarihi \n ISODate \n Z \n Karta ait hesap kesim tarihi iletilmelidir. Hesap kesim tarihi olarak son kesilmi ekstrenin tarihi iletilmelidir. rnein; gnn tarihi 09/01/2026 olduu durumda her ayn 23'nde kesilen ekstre iin hesap kesim tarihi 2025-12-23 eklinde olacaktr. \n Kart tipi kredi kart olanlar iin hesap kesim tarihi iletilmelidir. Ek kart iin asl kartn hesap kesim tarihi dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin sorgulama yaplan ayn son takvim gn dnlmelidir. \n \n \n Sonraki Hesap Kesim Tarihi \n sonrakiHesapKesimTarihi \n ISODate \n Z \n Kesilecek olan ekstrenin hesap kesim tarihi tarihi iletilmelidir. rnein; gnn tarihi 09/01/2026 olduu durumda her ayn 23'nde kesilen ekstre iin sonraki hesap kesim tarihi 2026-01-23 eklinde olacaktr. \n Kart tipi kredi kart olanlar iin sonraki hesap kesim tarihi iletilmelidir. Ek kart iin asl kartn sonraki hesap kesim tarihi dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin sorgulama yaplan aydan bir sonraki ayn son takvim gn dnlmelidir \n \n \n Son deme Tarihi \n sonOdemeTarihi \n ISODate \n K \n Kesilmi olan ekstre iin kart borcunun denecei son deme tarih bilgisi dnlmelidir. rnein; kesilmi olan ekstreye ait  hesap kesim tarihi 2025-12-23 eklinde olan bir kredi kart iin son deme tarihi 2026-01-03 olacaktr. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Ek kart iin asl kartn son deme tarih bilgisi dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n Sonraki Son deme Tarihi \n sonrakiSonOdemeTarihi \n ISODate \n K \n Kesilecek olan ekstre iin kart borcunun denecei son deme tarih bilgisi dnlmelidir.  rnein; kesilecek olan ekstreye ait  hesap kesim tarihi 2026-01-23 eklinde olan bir kredi kart iin son deme tarihi 2026-02-03 olacaktr. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Ek kart iin asl kartn sonraki son deme tarih bilgisi dnlmelidir. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n Puan Bilgisi \n puanBilgisi \n Kompleks:PuanBilgisi[Array] \n \n Karta ait puan bilgileri dizi ierisinde iletilmelidir. \n \n \n \n > Puan Deeri \n puanDegeri \n AN1..25 \n K \n Kart iin mevcutta yer alan puan deeri varsa iletilmelidir. HHS zelinde puan deeri puan tipine gre birim olarak tutuluyorsa ilgili deer iletilmelidir. rn: 100 Plus puan bilgisi varsa puan deeri alannda 100 iletilmelidir. Puan deeri eksi deer alabilir. \n Tm kart tipleri iin puan bilgisi varsa dnlmelidir. \n \n \n > Puan Tipi \n puanTipi \n AN1..50 \n K \n Puan Tipi olarak HHS zelinde bir puanTipi varsa o bilgi iletilmelidir. rn: 100 Plus puan bilgisi varsa puan tipi alannda Plus deeri iletilmelidir. \n Tm kart tipleri iin puan bilgisi varsa dnlmelidir. \n \n \n Nakit ekim Limiti \n nakitCekimLimiti \n Kompleks:NakitCekimLimiti \n K \n Karta ait nakit ekim limit deeri iletilmelidir. Ekstre tr TRY dnda olan kartlar iin de TRY para biriminde geerli olan limit iletilmelidir. Nakit ekim Limiti (+) deerde gnderilmelidir. Negatif deer gnderilmemelidir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Limit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Kullanlabilir Nakit ekim Limiti \n kullanilabilirNakitCekimLimiti \n Kompleks:KullanilabilirNakitCekimLimiti \n K \n Karta ait kullanlabilir nakit ekim limit deeri iletilmelidir. Ekstre tr TRY dnda olan kartlar iin de TRY para biriminde geerli olan limit iletilmelidir. Kullanlabilir Nakit ekim Limiti (+) deerde gnderilmelidir. Herhangi bir sebeple (nakit limitinin almas vb.)  (-) olmas durumunda deerin (-) olarak gnderilmesi beklenmektedir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Limit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Kalan Toplam Taksit Tutar \n kalanToplamTaksitTutari \n Kompleks:KalanToplamTaksitTutari \n K \n Karta ait tm kalan taksitlerin toplam deeri iletilmelidir.Mterinin Taksit borcu olduu durumda (-) deer gnderilmelidir. Taksit iadesi veya benzeri nedenlerle oluan mterinin alacakl olduu durumda tutar (+) deer gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Taksit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Dnem Taksit Tutar Bilgisi \n donemTaksitTutarBilgisi \n Kompleks:DonemTaksitTutarBilgisi[array] \n K \n Kart Tipi kredi kart olanlar iin taksit bilgisi varsa taksit ieren dnemlerin dizi halinde iletilmesi zorunludur. \n \n \n \n > Dnem Deeri \n donemDegeri \n N3 \n Z \n Taksitli ilemler dnlmesi sebebiyle dnem deeri minimum 1 olacak ekilde dnlmelidir. \n \n \n \n > Dnem Taksit Tutar \n donemTaksitTutari \n Kompleks:DonemTaksitTutari \n Z \n lgili dnem deeri ierisindeki toplam taksit tutar bilgisi iletilmelidir. Mterinin Dnem Taksit Tutar borcu olduu durumda (-) deer gnderilmelidir. Dnem Taksit Tutar iadesi veya benzeri nedenlerle oluan mterinin alacakl olduu durumda tutar (+) deer gnderilmelidir. \n \n \n \n >> Tutar \n tutar \n AN1..25 \n Z \n Taksit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n >> Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n 9.11 ADIM 4.2: Kart Hareket Bilgilerinin Sorgulanmas \n GET /kartlar/{kartRef}/kart-hareketleri \n KartBilgileri nesnesi ile elde edilen kart listesinde yer alan kartlarn ilem/hareket bilgileri sorgulanr. Kart hareketleri iin \"KartHareketleri\" nesnesinin ierii Tablo 25'de verilmitir. \n \n Bir karta ilikin ilem bilgileri Tablo 24deki istek parametrelerine gre sorgulanr. Parametrede yer alan deerlerin doru gnderildii kontrol edilir. Hatal gnderilmesi durumunda HHS tarafndan  TR.OHVPS.Resource.InvalidFormat  hatas dnlr. Parametrede yer alan istee bal alanlar gnderilmedii durumda parametredeki varsaylan deerler ile kart hareketleri dnlr. \n Parametrede yer alan ekstreTuru bilgisi Ekstre Trleri haricinde uygun olmayan bir deer gnderildiinde  TR.OHVPS.Business.InvalidCurrencyCode  hatas dnlr. Bu alan gnderilmiyorsa TRY olarak deerlendirilmelidir. \n Eriim belirteci kontrol yaplr. Geerli bir eriim belirteci yok ise HHS tarafndan  TR.OHVPS.Connection.InvalidToken  hatas dnlr. \n stek balnda yer alan X-Access-Token ile ilikili rzada, izin verilen kartRef'ler iin, kart hareket bilgileri sorgusunda yer alan kartRefe ait rza ile ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n lgili kartRef bulunamaz ise  TR.OHVPS.Resource.NotFound  hatas dnlr. \n Rza durumu kontrol edilir.\n \n B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n I: Rza ptal ya da S: Yetki Sonlandrld ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu K: Yetki Kullanld ise kontrollere devam edilir. \n \n \n Kart Hareket Bilgilerinin Sorgulanmas yaplrken HHS tarafndan HKnn 09:  Ayrntl Kart lem Bilgisi izin trne sahiplii kontrol edilir. 09 izin trne sahip deil ise  TR.OHVPS.Business.PermissionTypeNotSupported  hatas dnlr. \n Kart tipi olarak; iptal statsnde olan banka ve n demeli kartlar iin hareket sorgulamas yaplamayacaktr. Kart tipi kredi kart olup iptal statsnde olan ve borcu olmayan bir kart iin de kart hareket sorgulamas yaplamayacaktr. Hareket sorgulamas yaplamayacak bir kart tipi iin HHS'ler tarafndan  \"TR.OHVPS.Business.InvalidCardStatus\"  hatas dnlmelidir. \n -Rza ierisinde kanal grntleme yetkisi kapatlan kart iin hareket bilgisi sorgulandnda  TR.OHVPS.Business.RestrictedChannelAccess  hata kodu dnlecektir. \n ptal statsnde olan kart tipleri iin gemie dnk hareket sorgulamas yaplamayacaktr. rnein; Kredi Kart iin -12 ile 18 aras olan dnem deeri iptal statsnde olan kredi kart iin 0 ile 18 arasnda yaplabilecektir. Tm kart tipleri iin belirtilen parametrede yer alan dnem deerinin uygun gnderilmedii durumda  TR.OHVPS.Business.InvalidPeriodValue  hatas dnlr. \n Ekstre bilgisi bulunmayan sanal ve ek kredi kart bilgileri iin ekstre dnemlerine zg kart hareketleri sorgulandnda HHS'ler tarafndan  TR.OHVPS.Business.NoStatementForCard  hatas dnlmelidir. \n Kartn yeni olumas/aktif edilmesi gibi srelerler sonucunda ekstre bilgisi hi olumam dnem deerleri iin kart hareketleri sorgulandnda HHS'ler tarafndan  TR.OHVPS.Business.StatementNotCreated  hatas dnlmelidir. \n \n Yukardaki kontroller tamamlandktan sonra HHS tarafndan \"KartHareketleri\" nesnesi dnlr. \n \n HHS'ler kart tipi kredi kart ise ve karta ait bor/taksit tutar bilgisi bulunuyorsa KartHareketleri nesnesi iin baarl yant dnmek zorundadr. \n Kart tipi Banka Kart olanlarda dnem ii olarak sorgulama yaplan aya ait ilgili banka kart ile yaplan kart hareketleri grntlenecektir. (Banka kart ile yaplan Para ekme/Yatrma, banka kart ile yaplan POS'tan Alveri vb.). Banka kartnda dnem deerinin \"-1\" gnderilmesi durumunda bir nceki aya ait kart hareketleri grntlenecektir. \n Kart hareketleri yantnda hareket bilgileri ilem tarihinine gre sral olarak iletilmelidir. lem tarihi en gncel tarihten geriye dnk olacak ekilde listelenmelidir. \n Kart hareketlerinde ekstre trleri dnda yaplan bir ilem varsa hangi ekstre trne dahil edilerek gsteriliyorsa gnderilmelidir.\n \n rn: 100 JPY'lik bir harcama ilemi TRY biriminde evirilip 23 TRY olarak TRY ekstre trnde gsteriliyorsa ilgili ilem iin ilem tutar 23 TRY, orijinal ilem tutar ise 100 JPY olarak deerlendirilmelidir. \n \n \n \n Tablo 24: Kart Hareket Bilgileri Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Dnem Deeri \n donemDegeri \n N3 \n Z \n Kart hareketlerinin sorgulanaca dneme ait deerdir.  Dnem ii : 0 Gemi Ay/Ekstre : -1 ile -12 aras Taksit : 1 ile 18 aras  Provizyon : 99  Kart tipine gre alabilecei dnem deerleri ise ;  Banka Kart : 0 ve -1 Kredi Kart : -12 ile 18 aras ve 99 (Sanal alt kart tipi hari dier tm alt kart tiplerinde bu deerler geerlidir.)  Alt kart tipi sanal kart tipinde ise alabilecei deerler 0 ve 99'dur. n demeli Kart : 0 ve -1 \n ptal statsnde olan kart tipleri iin gemie dnk hareket sorgulamas yaplamayacaktr. rnein; Kredi Kart iin -12 ile 18 aras olan dnem deeri iptal statsnde olan kredi kart iin 0 ile 18 arasnda yaplabilecektir.  Tm kart tipleri iin belirtilen dnem deerinin uygun gnderilmedii durumda hata verilmelidir. \n \n \n Ekstre Turu \n ekstreTuru \n AN3 \n K \n Kart bilgileri yantnda dnlen ekstre trleri deerlerini almaktadr. Para birimine uygun olarak kart detay bilgileri sorgulanmaktadr. Ekstre parametresi TRY,USD,EUR,GBP olarak gnderilebilir. Bu alan gnderilmiyorsa TRY deerlendirilmelidir. lgili para birimine zel ekstre iindeki harcama deeri dnlecektir. \n Ekstre trleri haricinde uygun olmayan bir deer gnderildiinde hata verilmelidir. \n \n \n Sayfa Bana stenen Kayt Says \n syfKytSayi \n N3 \n  \n Sayfa bana istenen kayt says. Bu alanda iletilen deer 100den byk olamaz. \n Bu veri gnderildii durumda, HHS ilemler listesini bu say kadar gruplandrarak gnderir. Bu veri gnderilmediinde sayfadaki kayt says 100 olarak kullanlr. \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS ilemler listesini bu sayfadaki kaytlar gnderir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gnderir. \n \n \n Bor Alacak Gstergesi \n brcAlc \n AN1 \n  \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Karta bor yaratan ilem.A: Karta alacak yaratan ilem. N: Finansal olmayan ilem {B,A,N} \n Bu veri gnderildii durumda HHS ilemler listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. \n \n \n Sralama Yn \n srlmYon \n AN1 \n  \n Cevapta dnlecek ilemlerin sralama ynn belirtir. Alabilecei deerler: A: Azalan deerle sralama Y: Artan deerle sralama {A,Y} \n Bu veri gnderildii durumda, HHS kart hareketlerini  sralama kriteri ilem tarihi  olacak ekilde ilgili yne uygun olarak sralayarak gnderir. Gnderilmediinde, HHS sralama ynn Azalan olarak belirler. \n \n \n \n Tablo 25: KartHareketleri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n Kart Tiplerine stinaden Detayl Aklama \n \n \n \n \n Kart Referans Numaras \n kartRef \n AN5..40 \n Z \n HHS tarafndan her bir kart iin atanan biricik deerdir (uuid). Bir kart tek bir kartRef'e karlk gelmelidir, benzer ekilde bir kartRef tek bir karta karlk gelmelidir. Ayn kart iin alnan tm rzalarda kart referans bilgisinin deimemesi gerekmektedir. \n \n \n \n Dnem Deeri \n donemDegeri \n N3 \n Z \n Kart hareketlerinin sorgulanaca dneme ait deerdir. \n \n \n \n Dnem Balang Tarihi \n donemBaslangicTarihi \n ISODate \n Z \n Sorgulama yaplan ekstre dnemine gre ilgili dneme ait balang tarih bilgisidir. Kart tipi kredi kart olanlar iin ilgili dneme ait balang tarihi iletilmelidir. Kart tipi banka kart ve n demeli kart olanlar iin sorgulama yaplan ayn balang tarihi iletilmelidir. \n \n \n \n Dnem Biti Tarihi \n donemBitisTarihi \n ISODate \n Z \n Sorgulama yaplan ekstre dnemine gre ilgili dneme ait biti tarih bilgisidir. Kart tipi kredi kart olanlar iin ilgili dneme ait biti tarihi iletilmelidir. Kart tipi banka kart ve n demeli kart olanlar iin sorgulama yaplan ayn biti tarihi iletilmelidir. \n \n \n \n Ekstre Tr \n ekstreTuru \n AN3 \n Z \n Ekstre tr TRY,USD,EUR,GBP olarak gnderilebilir. stek paremetresinde iletilen deer ile ayn deer olmaldr. \n \n \n \n Ekstre Borcu \n ekstreBorcu \n Kompleks:EkstreBorcu \n K \n Sorgulama yaplan gemi dneme iin ekstre trne uygun olarak ekstre borcu iletilmelidir. Mterinin borcu olduu durumda (-) deer gnderilmelidir.  Mterinin alaca olduu durumda (iade/fazla deme vb(+) deer ile tutar bilgisi gnderilmelidir. \n Kart tipi kredi kart olanlar iin sadece gemi dnem deerine istinaden ilgili alan iletilmelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Bor tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Asgari deme Tutar \n asgariOdemeTutari \n Kompleks:AsgariOdemeTutari \n K \n lgili gemi dnem iin ekstre trne uygun olarak ekstreye ait asgari deme tutar iletilmelidir. Ekstre Borcu (-) ise; asgari deme tutar da (-) deer olarak gnderilmelidir. Mterinin alaca olduu durumda (iade/fazla deme vb.)  \"0\" (sfr) deeri gnderilmelidir. \n Kart tipi kredi kart olanlar iin sadece gemi dnem deerine istinaden ilgili alan iletilmelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n deme tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Dnem Taksit Tutar \n donemTaksitTutari \n Kompleks:DonemTaksitTutari \n K \n stek parametresinde iletilen ilgili dnem deeri ierisindeki toplam taksit tutar bilgisi iletilmelidir. Mterinin Dnem Taksit Tutar borcu olduu durumda (-) deer gnderilmelidir. Dnem Taksit Tutar iadesi veya benzeri nedenlerle oluan mterinin alacakl olduu durumda tutar (+) deer gnderilmelidir. \n Kart tipi kredi kart olanlar iin taksit bilgisi varsa ilgili alan iletilmelidir. \n \n \n > Tutar \n tutar \n AN1..25 \n Z \n Dnem taksit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n > Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n Hesap Kesim Tarihi \n hesapKesimTarihi \n ISODate \n K \n Karta ait sorgulanan dneme ait hesap kesim tarihi iletilmelidir. Tarih formatnda iletilmelidir. rn : 2024-11-23 \n Kart tipi kredi kart olanlar iin sadece gemi dnem deerine istinaden ilgili alan iletilmelidir. \n \n \n Son deme Tarihi \n sonOdemeTarihi \n ISODate \n K \n Karta ait sorgulanan dnem iin son deme tarih bilgisi dnlmelidir. rn : 2024-12-02 \n Kart tipi kredi kart olanlar iin sadece gemi dnem deerine istinaden ilgili alan iletilmelidir. \n \n \n Hareket Bilgileri \n hareketBilgileri \n Kompleks Alan: HareketBilgileri[array] \n K \n Dizi halinde liste olacaktr. \n \n \n \n > lem Numaras \n islemNo \n AN3..50 \n Z \n Kart hareketinin oluturulmas srasnda atanan ve bor (veya alacak) hareketini tekilletiren HHS baznda tekil tanmlaycdr. Bu deer tek bana tekil olabilecei gibi birden fazla deerin bir araya getirilmesiyle de tekillii salanm olabilir. Bu deerin en azndan kart referans numaras baznda tekil olmas beklenir. Genellikle kullanlan rnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp \n \n \n \n > lem Tutar \n islemTutari \n Kompleks:IslemTutari \n Z \n Yaplan ileme ait tutar bilgisi. Taksitli bir ilem ise ilgili dnemdeki taksit tutar iletilecektir. HK, HHS'de ilgili dnem sorguladnda hangi tutar grntlyorsa ilgili tutar dnlecektir. leme ait sadece puan bilgisiyle kazanm, kullanm, iade veya iptal varsa ve tutar bilgisi yoksa ilgili tutar deeri sfr gnderilmelidir. Puana dair deerler ise PuanBilgileri alan ierisinde gnderilmelidir. \n \n \n \n >> Tutar \n tutar \n AN1..24 \n Z \n lem tutar iin regex patterni u ekildedir: ' ^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n >> Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi. Ekstre tr ile ayn olmas gerekmektedir. \n \n \n \n > Orijinal lem Tutar \n orijinalIslemTutari \n Kompleks:OrijinalIslemTutari \n K \n Ekstre tr dnda yaplan ileme ait tutar bilgisi. rnein; ekstre tr TRY gnderildii durumda ilem 100 JPY ise ilem tutar alannda 100 deeri iletilmelidir. \n \n \n \n >> Tutar \n tutar \n AN1..24 \n Z \n lem tutar iin regex patterni u ekildedir: ' ^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n >> Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi. rnein; 100 JPY ise ilem tutar para birimi alannda JPY deeri iletilmelidir. \n \n \n \n > lem Tarihi \n islemTarihi \n ISODateTime \n Z \n lemin gerekletii zaman bilgisi. Taksitli ilemlerde iinde bulunulan dnem zelinde ilgili taksitin yansyaca tarih deeri dnlmelidir. \n \n \n \n > Bor Alacak Gstergesi \n borcAlacak \n AN1 \n Z \n TR.OHVPS.DataCode.BrcAlc sral veri tipi deerlerinden birini alr. Sorgulanacak ilemlerin bor / alacak kriteri B: Karta bor yaratan ilem.A: Karta alacak yaratan ilem. N: Finansal olmayan ilem {B,A,N} \n \n \n \n > lem Aklamas \n islemAciklamasi \n AN1..200 \n Z \n Alveri ilemi olmas durumunda sadece iyeri adn ieren aklama, dier ilemler iin mevcut ilem aklamas iletilir. HHS'ler tm kart hareketlerini YS'ler ile paylamakla ykml olup, hassas veri ieren(rn: faiz, komisyon bilgisi ieren vb.) ilem hareketleri de bu kapsamda deerlendirilerek ilem aklamasnn maskeli olarak iletilmesi salanr. Kelimelerin ilk 3 hanesi maskeli olacak ekilde, ancak sakncal bulunan kelimeler varsa; (rn: faiz, komiyon vb.) kelimelerin tamam maskeli olacak ekilde gsterilebilir. \n \n \n \n > lem Puan Bilgileri \n islemPuanBilgileri \n Kompleks: IslemPuanBilgileri[Array] \n K \n lgili ilem sonras kazanlan veya kullanlan bir puan deeri varsa iletilmesi gerekmektedir. lgili puan bilgi veya bilgileri dizi ierisinde iletilmelidir. \n lgili alanda koula uygun olarak deer dnlecekse; kart tipi kredi, banka ve n demeli kart olanlar iin dnlmesi zorunludur. \n \n \n >> lem Puan \n islemPuani \n AN1..24 \n K \n leme dair kazanlan veya kullanlan puan deeri iletilmelidir. rn: 100 Plus kazanlm bir ilem iin 100 deeri iletilmelidir. \n \n \n \n >> lem Puan Birimi \n islemPuanBirimi \n AN1..50 \n K \n leme dair kazanlan veya kullanlan puan birimi iletilmelidir. rn: 100 Plus kazanlm bir ilem iin Plus deeri iletilmelidir. \n \n \n \n >> lem Puan Durumu \n islemPuanDurumu \n AN2 \n K \n lgili ilem sonucunda puan bilgisinin bir kazanm, kullanm, iade ve iptal durumlarna ynelik deer iletilmelidir. TR.OHVPS.DataCode.IslemPuanDurumu deerlerinden birini alr. 01: Puan Kazanm 02: Puan Kullanm 03: Puan ade 04: Puan ptal \n \n \n \n > Toplam Taksit Tutar \n toplamTaksitTutari \n Kompleks:ToplamTaksitTutari \n K \n lgili ilem taksitli bir ilem ise o ileme ait toplam taksit tutar iletilmelidir. lgili ilem tek ekim bir ilem ise o ilemde ilgili alan iletilmemelidir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n >> Tutar \n tutar \n AN1..25 \n Z \n Taksit Tutar Bilgisi. Taksit tutar iin regex patterni u ekildedir: ' ^[\\-\\+]?\\d{1,18}$|^[\\-\\+]?\\d{1,18}\\.\\d{1,5}$ ' \n \n \n \n >> Para Birimi \n paraBirimi \n AN3 \n Z \n Para Birimi \n \n \n \n > Toplam Taksit Says \n toplamTaksitSayisi \n N2 \n K \n lgili ilem taksitli bir ilem ise o ileme ait toplam taksit says iletilmelidir. lgili ilem tek ekim bir ilem ise o ilemde ilgili alan iletilmemelidir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > lgili Taksit Dnemi \n taksitDonemi \n N2 \n K \n Taksitli ilem olmas durumunda ileme ait ilgili taksit dnem bilgisi. rnein: 3 taksitli bir ilemde 2. taksit yansmsa 2 olarak gnderilmelidir. \n Kart tipi kredi kart olanlar iin ilgili alan dnlmesi zorunludur. Kart tipi banka ve n demeli kart olan kartlar iin ilgili alan dnlmemelidir. \n \n \n > Satc Kategori Kodu \n saticiKategoriKodu \n AN4 \n K \n Satc Kategori Kodu(MCC) varsa iletilmesi zorunludur. Alveri ilemlerinde gnderimi zorunludur. \n lgili alanda koula uygun olarak deer dnlecekse; kart tipi kredi ve banka kart olanlar iin dnlmesi zorunludur. \n \n \n \n"},{title:"2.Kapsam ve Dayanak",frontmatter:{},regularPath:"/v2.0.0/contents/kapsam-ve-dayanak.html",relativePath:"v2.0.0/contents/kapsam-ve-dayanak.md",key:"v-143b3106",path:"/v2.0.0/contents/kapsam-ve-dayanak.html",content:" 2.Kapsam ve Dayanak \n 12 Kasm 2019da gncellenen  6493 sayl deme ve Menkul Kymet Mutabakat Sistemleri, deme Hizmetleri ve Elektronik Para Kurulular Hakknda Kanun un (Kanun) 12nci maddesine yeni eklenen ve  deme Hizmetleri Direktifi 2 'de (Payment Services Directive 2, PSD2) bulunan iki yeni deme hizmeti aadaki gibi tanmlanmtr (ekil-1: deme Hizmetleri Veri Paylam Servisleri): \n \n deme Emri Balatma Hizmeti : HKnn istei zerine baka bir deme hizmeti salaycsnda bulunan  deme hesabyla  ilgili sunulan deme emri balatma hizmeti [Madde 12, birinci fkra, (f) bendi] \n Hesap Bilgisi Hizmeti : HKnn onaynn alnmas kouluyla, HKnn deme hizmeti salayclar nezdinde bulunan bir veya daha fazla  deme hesabna  ilikin konsolide edilmi bilgilerin evrim ii platformlarda sunulmas hizmeti [Madde 12, birinci fkra, (g) bendi] \n \n   \n ekil 1: deme Hizmetleri Veri Paylam Servisleri (HVPS)- tantm \n Kanunun 14/A maddesinin ikinci fkrasna gre , Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetleri ile ilgili ilemlerin yrtlmesine ilikin usul ve esaslar ile taraflarca uyulmas gereken teknik ve operasyonel gereklilikler ikincil dzenlemeler uyarnca Trkiye Cumhuriyet Merkez Bankas (TCMB) tarafndan belirlenir. Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri  deme hizmetleri veri paylam servisleri (HVPS)  olarak adlandrlmaktadr. \n deme Hizmetleri ve Elektronik Para hrac ile deme Hizmeti Salayclar Hakknda Ynetmelikin (Ynetmelik) 59uncu maddesinin birinci fkras uyarnca hazrlanan bu belgede sz konusu deme hizmetlerini sunacak deme hizmeti salaycsnn, deme hesabnn bulunduu deme hizmeti salaycsnn, varsa ilgili dier taraflarn ve bu hizmetlerin sunulmas iin taraflar arasnda kurulacak balantnn teknik ve operasyonel gereklilikleri aklanmaktadr. \n Dzenlemeler kapsamnda yetkilendirilen nc taraf hizmet salaycs  (Yetkili deme Hizmeti Salaycs, YS) , deme hizmeti kullanclarnn  Hesap Hizmeti Salayclar (HHS)  nezdindeki deme hesaplarna ulaarak deme emri balatma ve hesap bilgisi salama hizmetlerinden (deme hizmetleri veri paylam servislerinden) faydalanmasna araclk eder. deme hizmetleri veri paylam servisleri kapsamnda iki tip YS bulunmaktadr:  1) Hesap Bilgisi Hizmeti Salaycs (HBHS) ve 2) deme Emri Balatma Hizmeti Salaycs (BHS). \n Hesap Bilgisi Hizmeti Salaycs (HBHS) HKnn farkl Hesap Hizmeti Salayclar (HHS) nezdindeki hesaplarnn bilgilerini derleyerek evrim ii platformlarda  toplu ekilde  sunar. deme Emri Balatma Hizmeti Salaycs (BHS) ise talebi zerine HKnn HHSde bulunan deme hesabndan deme ilemi balatr. \n HVPSnin st dzey gsterimi ekil-2de verilmitir. \n   \n ekil 2: deme Hizmetleri Veri Paylam Servisleri (HVPS) -st dzey gsterim \n deme Hizmetleri Veri Paylam Servislerinin HHSler tarafndan  GET  vastasyla sunulduu uygulama mimarisi ise ekil-3te sunulmutur. \n  \n ekil 3: HVPS'nin GET vastasyla sunumu \n"},{title:"12.\tOlay Bildirim",frontmatter:{},regularPath:"/v2.0.0/contents/olay-bildirim.html",relativePath:"v2.0.0/contents/olay-bildirim.md",key:"v-448b4d1d",path:"/v2.0.0/contents/olay-bildirim.html",headers:[{level:2,title:"Genel Bilgiler",slug:"genel-bilgiler"},{level:2,title:"Olay Abonelik Servisleri (OAS)",slug:"olay-abonelik-servisleri-oas"},{level:2,title:"ADIM 1: Olay Aboneliinin gerekletirilmesi",slug:"adim-1-olay-aboneliginin-gerceklestirilmesi"},{level:2,title:"ADIM 2: Olay Aboneliinin gncellenmesi",slug:"adim-2-olay-aboneliginin-guncellenmesi"},{level:2,title:"ADIM 3: Olay Aboneliinin sorgulanmas",slug:"adim-3-olay-aboneliginin-sorgulanmas"},{level:2,title:"ADIM 4: Olay Aboneliinin iptali",slug:"adim-4-olay-aboneliginin-iptali"},{level:2,title:"ADIM 5: Olay Aboneliinin letilemeyen Olaylar",slug:"adim-5-olay-aboneliginin-iletilemeyen-olaylar"},{level:2,title:"ADIM 6: Sistem Olay Dinleme",slug:"adim-6-sistem-olay-dinleme"},{level:2,title:"Olay Dinleme Servisleri (ODS)",slug:"olay-dinleme-servisleri-ods"},{level:2,title:"ADIM 1: Olay Dinleme",slug:"adim-1-olay-dinleme"},{level:2,title:"ADIM 2:  Sistem Olay Dinleme",slug:"adim-2-sistem-olay-dinleme"}],content:" 12.\tOlay Bildirim  \n Genel Bilgiler \n Olay Bildirim Abonelik API servisleri, HHS'lerin sunmu olduklar olay bildirimlerini takip etmek amacyla abonelik aklarn tanmlar. \n YS'ler olay bildirimlerini takip edebilmek iin talep ettikleri abonelik hizmetlerini belirterek HHS'ler zelinde bir abonelik kayd olutururlar. Bu abonelik kaydn okuyabilir, gncelleyebilir ya da silebilirler. \n Olay bildirimleri HHS'ler tarafndan 2 yntem ile salanr. lki olay bildirimlerinin anlk olarak iletilmesi, dieri ise anlk iletilemeyen olaylarn toplu olarak iletilmesidir. \n Olay Bildirimi 2 API ile ynetilecektir. \n 1 - Olay Abonelik Servisleri (OAS) \n2 - Olay Dinleme Servisleri  (ODS) \n Olay Abonelik ve Olay Dinleme API'lerinin istek ve yant balnda beklenen parametreler BH,HBH,GKD API'lerinden farkldr.\n 3.15. stek Bal  ve  3.16. Yant Bal  blmlerinde zorunlu parametreler ve aklamalar belirtilmitir. \n Olay Abonelik Servisleri (OAS) \n Olay abonelik Servisleri; HHS'ler tarafndan sunulacak olay bildirim abonelik servislerini ve iletilemeyen olaylar servisini iermektedir. \n HHS'nin sunaca bu API ile YS'ler u admlar gerekletirebilir. \n \n YS'n olay bildirimlerini dinleyebilmek iin ncelikle dinlemek istedii olaylara ait olay tipleri ve kaynak tiplerini belirlemesi gerekmektedir. \n Olay tipleri ve kaynak tiplerinin neler olaca \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda belirtilmitir. \n YS, belirledii olaylar iin HHS'ye olay abonelik endpointi aracl ile abonelik balatr. \n YS, abonelik numaras aracl ile abonelik bilgilerini grntleyebilir, gncelleyebilir, silebilir. \n YS, olay bildirimlerini bu abonelik sayesinde kendisinin sunaca Olay Dinleme API'si ile dinler. \n HHS anlk iletemedii olaylarn biriktirerek, iletilemeyen olaylar endpointi ile YS'e sunar. \n \n HHS'ler \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda belirlenen olay ve kaynak tiplerinin tm iin YS'lere bildirim sunmak zorundadr. \n Olay Abonelik Servislerinde Idempotency kurallarnn iletilmesine gerek bulunmamaktadr. \n Nezdinde deme hesab bulunduran baz hesap hizmeti salayclar(EPK, deme Kurulular) mterilerine ait hesaplar, dier HHS'lerdeki havuz hesaplarn kullanarak ynetiyor olabilir. Bu durum ilgili hesap hizmeti salayclarnn, HVPS kapsamnda HHS olduu rolde sunmas gereken olay bildirim servisleri ile ilgili uymas gereken kurallar deitirmemektedir. lgili hesap hizmeti salayclarnn standartlara uygun ekilde YS'lere bildirimleri yapmas gerekmektedir. \n YS'ler sahip olduklar rol zelinde olay abonelik servislerinden faydalanabilir. Bu yzden olay bildirim etki alan (scope) deerleri hesap_bilgisi ve/veya odeme_emri olarak belirlenmitir. \n Olay Abonelik Servisine ait API Endpointleri aadaki tabloda listelenmitir. \n Olay Abonelik Servisleri iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =hesap_bilgisi  \"odeme_emri\" \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n olay-abonelik \n POST \n /olay-abonelik \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n OlayAbonelikstegi \n OlayAbonelik \n \n \n 2 \n olay-abonelik \n GET \n /olay-abonelik \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n \n - \n OlayAbonelik \n \n \n 3 \n olay-abonelik/{olayAbonelikNo} \n PUT \n /olay-abonelik/{olayAbonelikNo} \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n \n OlayAbonelik \n OlayAbonelik \n \n \n 4 \n olay-abonelik/{olayAbonelikNo} \n DELETE \n /olay-abonelik/{olayAbonelikNo} \n Z \n stemci Kimlik Bilgileri \n - \n - \n - \n - \n \n \n 5 \n olay-abonelik/{olayAbonelikNo}/iletilemeyen-olaylar \n GET \n /olay-abonelik/{olayAbonelikNo}/iletilemeyen-olaylar \n Z \n stemci Kimlik Bilgileri \n - \n Sayfalama \n \n Olaylar \n \n \n 6 \n sistem-olay-dinleme \n POST \n sistem-olay-dinleme \n Z \n stemci Kimlik Bilgileri \n - \n - \n Olaylar \n - \n ADIM 1: Olay Aboneliinin gerekletirilmesi \n POST /olay-abonelik \n HHS'nin olay abonelik hizmeti sunduu servistir.\nYS, seecei olay-kaynak tipleri iin bu servis aracl ile abone olabilir. HHS POST ilemi sonucunda, YS adna bir olay abonelik kayna oluturur ve tekil tanmlayc olan olayAbonelikNo deerini dner. olayAbonelikNo retilirken farkl YS'ler iin ayn deer kullanlamaz. olayAbonelikNo evrensel tekil olmaldr. \n1 YS'n 1 HHS'de 1 adet abonelik kayd olabilir. \nBaarl POST istei sonucu HTTP 201 cevab ile iletilmelidir. \n YS tarafndan daha nce oluturulmu olay abonelik kayd varsa  \"HTTP 400 -TR.OHVPS.Business.EventSubscriptionAlreadyExists\"  hatasyla uyar mesajn dner. \n Olay Abonelik kayd oluturmak isteyen YS'n ODS API tanm HHS tarafndan kontrol edilmelidir. YS'n tanm olmamas halinde  \"HTTP 400-TR.OHVPS.Business.InvalidContent\"  hatas verilmelidir. \n Olay Abonelik kayd oluturmak isteyen YS tarafndan olay tipi ve kaynak tipi iin iletilen deerler olmas gereken sral veri tlerinden(TR.OHVPS.DataCode.OlayTip ve TR.OHVPS.DataCode.KaynakTip) farkl ise HHS tarafndan   \"TR.OHVPS.Business.EventSubscriptionNotFound\"  hatas verilmelidir. \n Abonelik zerinde grntleme, gncelleme, silme ilemlerini gerekletirebilir.\nYS'n Abonelii devam ettii srece; YS'n aaca Olay Dinleme API'sine, HHS tarafndan abonelik kapsamnda olay bildirimleri iletilir. \n BKM'nin sunaca abonelik servisleri iin HHS ve YS'lerin abonelik istei yapmasna gerek bulunmamaktadr. BKM retim ortam tanmlar yaplrken katlmclar abonelik servislerine ye yapacaktr. BKM'nin sunaca abonelik servislerinin olay tipi \"HHS_YOS_GUNCELLENDI\"dir. HHS ve YS API ile sunulan bilgilerde bir deiiklik olduunda yaplacak olay bildirimlerini salar.\nrnein; HHS logo bilgilerinde yaplacak bir deiiklik sonrasnda, YS'lere yaplacak bildirim ile logo bilgisini deien HHS'nin hhsKod deerini iletir. YS, HHS API'yi  hhsKod ile ararak HHS'nin gncel bilgilerini alr. Gncel bilgiler ile kendi sistemini gnceller. \n Olay tipi ve kaynak tipine ekleme yapldka YS'lerin olay abonelik kaytlarn yeni tipleri ierecek ekilde gncel tutmas gerekmektedir. \n OlayAbonelikIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n \n \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n YS abone olmak istedii olay tiplerini TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deer ya da deerler ile doldurur. \n \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda \"Olay Bildirim Yapan\" kolonu \"HHS\" olan olay tipleri ile veri giriine izin verilir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n Olay tiplerinin tanmlanabildii kaynak listesi bulunmaktadr. Bu listeye uygun kaynak tipleri iletilmelidir. \n HHS, YS API zerinden YS'n rollerini alarak uygun kaynak tiplerine kayt olmasn salar. \n \n \n \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas iletilebilir. lk deeri olay abonelik oluturma zaman bilgisidir. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n \n \n \n \n Olay Tipleri ve Kaynak Tipleri likisi \n * Anlk : Olay gerekletikten sonra maksimum 5 saniye ierisindeki zaman \n \n \n \n Olay Tipleri \n YS Rol \n Kaynak Tipleri \n Olay Oluturulma durumu \n KaynakNo \n Asl verinin elde edilecei API \n Olay Bildirimini Yapan \n Olay Bildirim Zaman \n Retry Policy \n \n \n \n \n KAYNAK_GUNCELLENDI \n BH \n ODEME_EMRI \n Tm deme durum deiikliklerinde \n odmEmrNo \n GET /odeme-emri/{odemeEmriNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n BH \n ILERI_TARIHLI_ODEME_EMRI_RIZASI \n Rza iptal detay kodu 02 : Kullanc stei ile HHS zerinden ptal durumunda \n rizaNo \n GET /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n BH \n ILERI_TARIHLI_ODEME_EMRI \n Tm deme durum deiikliklerinde, deme emri ierisinde yer alan tutar, talimat tarihi deiikliklerinde \n odmEmrNo \n GET /ileri-tarihli-odeme-emri/{odemeEmriNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n BH \n DUZENLI_ODEME_EMRI_RIZASI \n Rza iptal detay kodu 02 : Kullanc stei ile HHS zerinden ptal durumunda \n rizaNo \n GET /duzenli-odeme-emri-rizasi/{rizaNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n BH \n DUZENLI_ODEME_PLANI \n Dzenli deme plan ierisinde yer alan herhangi bir alan iin deiiklik olduu durumda \n tlmtNo \n /duzenli-odeme-emri/{tlmtNo}/odeme-plani \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n BH \n DUZENLI_ODEME_EMRI \n Dzenli deme emri ierisinde gnderen hesap ve aklama alanlarna dair deiiklik olduu durumda \n tlmtNo \n /duzenli-odeme-emri/{tlmtNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n Rza iptal detay kodu 02 : Kullanc stei ile HHS zerinden ptal durumunda ve Rza iptal detay kodu 09 : Uygun rn bulunmuyor durumunda \n rizaNo \n GET /hesap-bilgisi-rizasi/{rizaNo} \n HHS \n *Anlk \n 30 Dakika - 3 Deneme \n \n \n \n HBH \n BAKIYE \n Bakiye nesnesindeki tutarla ilgili bir bilgi deitiinde ve HBH rzas ierisinde \"06-Anlk Bakiye Bildirimi\" izin tr varsa oluturulur. Mevcutta alnm rzalar iin  bakiye kaynak tipi zelinde 06 izin tr gerektiinden; mevcut rzann yenilenmesine dair mteriye bilgilendirme yaplarak 06 izin trn kapsayan yeni rza alnmas sreci YS tarafndan gerekletirilebilir. Bloke tutar deiiklii iin olay oluturma ve bildirimi HHS inisiyatifindedir. KrdHsp ierisinde yer alan kulKrdTtr deerinin deitii durumda olay bildirim gnderilmesi gerekmektedir. \n hspRef \n GET /hesaplar/{hspRef}/bakiye, GET /hesaplar/{hspRef}/islemler \n HHS \n Maksimum 10 dakika ierisinde \n Retry policy uygulanmamaldr. lk istek gnderilemedii durumda letilemeyen Olaylara eklenmelidir. \n \n \n \n HBH \n KART_BILGILERI \n Kart bilgileri nesnesindeki kart stats veya ekstre trleri ierisinde sadece yeni bir esktre tr eklendiinde oluturulur. Ekstre trnde azaltma ynnde gncelleme varsa olay bildirimi gnderilmemelidir. YS'e kart statsnn veya ekstre trlerinin deitiine dair olay bildirimi gnderilir. \n kartRef \n GET /kartlar,  GET /kartlar/{kartRef},   GET /kartlar/{kartRef}/kart-detay,  GET /kartlar/{kartRef}/kart-hareketleri \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n HBH \n COKLU_ISLEM_TALEBI ( bulk-data) \n lgili API lke ve kurallarna eklendiinde gncellenecektir. \n \n \n HHS \n \n 30 Dakika - 3 Deneme \n \n \n AYRIK_GKD_BASARILI \n BH \n ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}}&rizaTip=O \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}&rizaTip=H \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n BH \n ILERI_TARIHLI_ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}}&rizaTip=I \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n BH \n DUZENLI_ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladnda rza oluturulur. YS'e rza oluturulduuna dair bildirim yaplr. YS yetkod deerini sorgulama sonucunda elde eder. \n RizaNo \n GET /yetkilendirme-kodu?rizaNo={rizaNo}}&rizaTip=D \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n AYRIK_GKD_BASARISIZ \n BH \n ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /odeme-emri-rizasi/{RizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n HBH \n HESAP_BILGISI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /hesap-bilgisi-rizasi/{RizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n BH \n ILERI_TARIHLI_ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n \n BH \n DUZENLI_ODEME_EMRI_RIZASI \n HHS sisteminde HK kendini doruladktan sonra yapt kontroller neticesinde logine izin vermez ise YS'e bildirim yaplr. YS rza durumunu sorgulayarak ilemin neden iletilmediine dair bilgi edinebilir. \n RizaNo \n GET /duzenli-odeme-emri-rizasi/{rizaNo} \n HHS \n *Anlk \n 1 Dakika 3 kez \n \n \n HHS_YOS_GUNCELLENDI \n \n \n BKM sistemi tarafndan retilecek olaylar dinlemek iin kullanlacak kaynak tipidir. YS ve HHS'lerin BKM'ye abonelik oluturmasna gerek bulunmamaktadr. BKM HHS ve YS retim ortam tanm yaparken aboneliklerini balatacaktr.   (HHS yaygnlatrma durumundayken de abonelii balatlacaktr.) \n \n \n HHS \n \n \n \n \n \n YS \n HHS \n HHS bilgilerinde deiiklik olduunda, YS'n hhsKod ile sorgulama yapmas ve deien bilgiyi gncellemesi beklenmektedir. \n hhsKod \n GET /hhs/{hhsKod} \n BKM \n *Anlk \n 5 Dakika - 3 Deneme \n \n \n \n HHS \n YOS \n YS bilgilerinde deiiklik olduunda, HHS'nin yosKod ile sorgulama yapmas ve deien bilgiyi gncellemesi beklenmektedir. \n yosKod \n GET /yos/{yosKod} \n BKM \n *Anlk \n 5 Dakika - 3 Deneme \n \n \n \n * Anlk : Olay gerekletikten sonra maksimum 5 saniye ierisindeki zaman \n ADIM 2: Olay Aboneliinin gncellenmesi \n PUT\tolay-abonelik/{olayAbonelikNo} \n YS'n olay aboneliine ait abonelik tiplerini gncelleyebildii servistir. Olay abonelii oluturulduu zaman HHS tarafndan iletilen olayAbonelikNo aracl ile gncelleme ilemi yaplr. YS abone olmak istedii olay-kayt tiplerininin son halini gncelleme servisi ile HHS'ye iletir. HHS bu bilgilerle eski abonelik tiplerinin yerini deitirir. \n Baarl PUT istei sonucu HTTP 200 cevab ile iletilmelidir. \n OlayAbonelikIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n HHS geerli bir olay abonelik numaras olduunun kontroln yapar. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n HHS Sisteminde, YS'n eski abonelikleri yeni aboneliklerle gncellenmelidir. \n \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n YS abone olmak istedii olay tiplerini TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deer ya da deerler ile doldurur. \n \"Olay Tipleri ve Kaynak Tipleri likisi\" tablosunda \"Olay Bildirim Yapan\" kolonu \"HHS\" olan olay tipleri ile veri giriine izin verilir.  Olay tipi AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ iin, YS'n ODS API'yi sunmas zorunludur. HHS, bu olay tipleri zelinde YS API zerinden YS'n bu API'yi sunduunu kontrol eder ve eer sunmuyor ise TR.OHVPS.Business.InvalidContent hatas dnerek kayt ilemini gerekletirmez. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n Olay tiplerinin tanmlanabildii kaynak listesi bulunmaktadr. Bu listeye uygun kaynak tipleri iletilmelidir. \n HHS, YS API zerinden YS'n rollerini alarak uygun kaynak tiplerine kayt olmasna izin verir. \n \n \n \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n OlayAbonelikIstegi nesnesi ierisinde iletilen deerlerin yant ierisinde dnmesi beklenmektedir. \n ADIM 3: Olay Aboneliinin sorgulanmas \n GET /olay-abonelik \n YS olay abonelik bilgilerini sorgulamak isteyebilir. HHS, YS'e ait aktif durumdaki abonelik bilgisini iletir.\nBaarl GET sonucu HTTP 200 kodu ile iletilmelidir. \n OlayAbonelik nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Olay Abonelik Numaras \n olayAbonelikNo \n AN1..64 \n Z \n YS zelinde oluturulan tekil tanmlaycdr. Farkl YS'ler iin ayn deer kullanlamaz. \n \n \n Olay Abonelik Oluturulma zaman \n olusturmaZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin oluturulma zaman damgas \n \n \n Olay Abonelik Gncelleme zaman \n guncellemeZamani \n ISODateTime \n Z \n Olay Abonelik nesnesinin gncelleme zaman damgas \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Abonelik Tipleri \n abonelikTipleri \n Kompleks: abonelikTipleri[Array][1..N] \n Z \n YS'n abone olduu olay - kaynak listesini dner. \n \n \n > Olay Tipi \n olayTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden deerler ierir. \n \n \n > Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden deerler ierir. \n ADIM 4: Olay Aboneliinin iptali \n DELETE /olay-abonelik/olayAbonelikNo \n YS'n abonelik kaydn silmesi iin HHS'nin sunduu servistir.  Baarl silme ilemi sonucu HTTP 204 ile YS'e iletilir. \n ADIM 5: Olay Aboneliinin letilemeyen Olaylar \n GET /iletilemeyen-olaylar \n HHS kaynaklar zerinde oluacak olaylar YS'e POST/olay-dinleme servisi ile gnderim salamaktadr. Bu gnderim belli bir yeniden gnderim politas (retry-policy) ile yaplmaldr.  Ancak yine de iletilemeyen olaylar olursa (YS servisinden HTTP 202 alamama durumu) YS'e iletilemeyen-olaylar servisi zerinden sunulmaldr. Yani yeniden gnderim politikas sonunda gnderilemeyen olaylar bu servis ile sunulmaldr. \n Ayn kaynak numaras ile ayn olay-kaynak tipinde, 1 YSe ait, 1 adet iletilemeyen olay kayd olabilir. \n Bu serviste 1 gn ncesinden sorgu anna kadar tm kaytlarna ait iletilemeyen olaylar listelenmelidir.\nrnek sorgu zaman : 2023-04-06T15:14:00+03:00\nHHS'nin sunaca veri 2023-04-05T00:00:00+03:00  ile 2023-04-06T15:14:00+03:00 arasnda olmaldr.\nSralama yn olay tarihine gre artan ekilde olmaldr. Sayfalama 100'er kayt dnlerek yaplmaldr. \n YS tarafndan iletilemeyen olaylar istei 10 dakikada bir olacak ekilde yaplabilir. HHS bu limite uygun ilem kst uygulayabilir. \n lem Sorgu rnei GET lem Sorgu rnei  : /iletilemeyen-olaylar?syfNo=1&olyZmnBslTrh=2024-01-08T16:42:00+03:00&olyZmnBtsTrh=2024-01-09T17:09:00+03:00 \n rnein; \n olyZmnBslTrh : 07/01/2024 10:00:00+03:00\n olyZmnBtsTrh : 09/01/2024 16:00:00+03:00\n Sorgu Zaman : 09/01/2024 10:15:00+03:00 \n Yant ierisinde yer alan veriye ait tarih aral : 08/01/2024 00:00:00+03:00 - 09/01/2024 10:15:00+03:00 olmaldr. \n Balang ve biti zaman aral rnekte yer alan ekilde seilse dahi ilgili servis yant iin ncelikle sorgu zamanna baklp 1 gn ncesinden sorgu anna kadar tm kaytlarn iletilemeyen olaylar ierisinde listelenmesi salanmaldr. \n lgili tarih aralnda uygun veri olmamas halinde yant gvdesi bo olacak ekilde dnlmelidir. \n letilemeyen Olaylar Sorgulama stei Sorgu Parametreleri \n \n \n \n Alan Ad \n Parametre Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n HHS tarafndan yaplmas gereken kontrol ve ilemler \n \n \n \n \n stenen Sayfa Numarasi \n syfNo \n N3 \n  \n Cevapta dnecek sayfa numaras 1den balayarak artan deerlerle iletilmelidir. \n Bu veri gnderildii durumda, HHS letilemeyen Olaylar listesine ait bu sayfadaki kaytlar gndermelidir. Gnderilmediinde, HHS ilk sayfadaki kaytlar gndermelidir. \n \n \n Olay Zaman Balang Tarihi \n olyZmnBslTrh \n ISODateTime \n  \n Sorgulanacak Olay Zamanna ait balang tarihi \n HHS'ler iletilemeyen olaylar listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan tetiklenen sorgularda; olyZmnBslTrh iletilmedii durumda ya da 1 gn ncesinin balang saatine gre daha geri bir zaman dilimi gnderildiinde, balang zaman(olyZmnBslTrh) deeri sorgu zamanndan 1 gn ncesine ait gnn balang zaman olarak kabul edilmelidir. \n \n \n Olay Zaman Biti Tarihi \n olyZmnBtsTrh \n ISODateTime \n  \n Sorgulanacak Olay Zamanna ait biti tarihi \n HHS'ler iletilemeyen olaylar listesi dnn bu kritere gre filtreleyerek iletmek zorundadr. YS tarafndan tetiklenen sorgularda; olyZmnBtsTrh iletilmedii durumda ya da sorgu zamanndan daha ileri bir zaman dilimi gnderildiinde, biti zaman(olyZmnBtsTrh) deeri sorgu zaman olarak kabul edilmelidir. \n \n \n \n Tablo 17: Olaylar nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n Olaylar \n olaylar \n Kompleks: Olaylar \n Z \n \n \n \n >Olay No \n olayNo \n AN1..64 \n Z \n Olaya ait evrensel tekil numaradr. \n \n \n >Olay Zamani \n olayZamani \n ISODateTime \n Z \n Olayn olutuu tarih bilgisidir. \n \n \n >Olay Tipi \n olayTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden birini alr. \n \n \n >Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden birini alr. \n \n \n >Kaynak Numaras \n kaynakNo \n AN1..128 \n Z \n Gncellenen kaynaa ait HHS sistemindeki tekil tanmlayc. \n \n \n \n Kaynak numarasnda gnderilen deer ile ilgili kayna sorgulayarak almak YS'n insiyatifindedir. \n ADIM 6: Sistem Olay Dinleme \n POST /sistem-olay-dinleme \n HHS'lerin sistem olaylarn dinleme amacyla amas gereken endpoint bilgisidir. \n YS API ierisinde yaplan deiikliklerde, BKM tarafndan HHS'lere olay bildirimlerini yaplr. \n Olaylar yant nesnesi ierisinde 1 adet kayt yer almaldr. \n Baarl POST istei sonucu HTTP 202 Accepted kodu ile dnlmelidir. \n HHS'den baarl yant alnamad durumda, 5 dakika aralklarla 3 kez deneme yaplacaktr. Hata alnmaya devam edilmesi durumunda baka bir aksiyon alnmayacaktr. \n Olay Dinleme Servisleri (ODS) \n YS sunaca Olay Dinleme Servisi ile hem HHS'den hem de BKM'den gelen olaylarn bildirimini dinleyebilir. YS'ler HHS'de yer alan olay abonelik kaytlarn iptal edebilir ancak BKM Sistem Olay Dinleme servisinin iletecei bildirimlerin alnmas zorunlu olduundan ODS API her zaman aktif olmaldr. \n HHS'den gelecek olay bildirimlerini olay-dinleme endpointi ile dinlerken, BKM'den gelecek olay bildirimlerini sistem-olay-dinleme endpointi ile dinlemelidir. \n Olay Dinleme Servislerinde Idempotency kurallarnn iletilmesine gerek bulunmamaktadr. \n Olay Dinleme Servisine ait API Endpointleri aadaki tabloda listelenmitir. \n Olay Dinleme Servisleri iin Eriim Adresleri (Endpoints) \n Etki Alan (Scope) =olay_dinleme \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu (Z)/ stee Bal() \n Yetkilendirme Tr \n mzalama \n Parametre \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n olay-dinleme \n POST \n /olay-dinleme \n Z \n stemci Kimlik Bilgileri \n mzal stek \n - \n Olaylar \n - \n \n \n 2 \n sistem-olay-dinleme \n POST \n /olay-dinleme \n Z \n stemci Kimlik Bilgileri \n - \n - \n Olaylar \n - \n ADIM 1: Olay Dinleme \n POST /olay-dinleme \n Olay abonelik servisi ile abone olunan olaylar, olay dinleme servisi ile YS'e iletilir.\nOlaylar yant nesnesi ierisinde en fazla 100 kayt gnderilmelidir.\nBaarl POST istei sonucu HTTP 202 Accepted ile dnlmelidir. \n HHS'nin ilem hata aldnda, baarl ilem olana kadar 3 kez deneme yaplmas gerekmektedir.\nlk istekle son istek arasnda 30 dakika olacak ekilde, zamana yayarak bu denemelerin yaplmas gerekmektedir. (Exponential backoff policy uygulanmas beklenmektedir. )\nHHS kendi sistemini yormayacak ekilde, belirleyecei kurallar dahilinde bu gelitirmeyi yapmaldr. \n Tablo 17: Olaylar nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format \n Zorunlu / Koullu /  stee bal \n Aklama \n \n \n \n \n >Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >>Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n >> Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n >Olaylar \n olaylar \n Kompleks: Olaylar \n Z \n \n \n \n >>Olay Numaras \n olayNo \n AN1..64 \n Z \n Olaya ait atanm tekil kimlik numaras \n \n \n >>Olay Zaman \n olayZamani \n ISODateTime \n Z \n Olayn oluma zaman \n \n \n >>Olay Tipi \n olayTipi \n AN1..36 \n > \n TR.OHVPS.DataCode.OlayTip sral veri tiplerinden birini alr. \n \n \n >>Kaynak Tipi \n kaynakTipi \n AN1..36 \n Z \n TR.OHVPS.DataCode.KaynakTip sral veri tiplerinden birini alr. \n \n \n >>Kaynak Numaras \n kaynakNo \n AN1..128 \n Z \n Gncellenen kaynaa ait HHS sistemindeki tekil tanmlayc. \n ADIM 2:  Sistem Olay Dinleme \n POST /sistem-olay-dinleme \n YS'lerin sistem olaylarn dinleme amacyla amas gereken endpoint bilgisidir. \n HHS API ierisinde yaplan deiikliklerde, BKM tarafndan YS'lere olay bildirimlerini yaplr. \n Olaylar yant nesnesi ierisinde 1 adet kayt yer almaldr. \n Baarl POST istei sonucu HTTP 202 Accepted kodu ile dnlmelidir. \n YS'ten baarl yant alnamad durumda, 5 dakika aralklarla 3 kez deneme yaplacaktr. Hata alnmaya devam edilmesi durumunda baka bir aksiyon alnmayacaktr. \n"},{title:"6.\tdeme Emri Balatma Hizmeti",frontmatter:{},regularPath:"/v2.0.0/contents/odeme-emri-baslatma-hizmeti.html",relativePath:"v2.0.0/contents/odeme-emri-baslatma-hizmeti.md",key:"v-29ce59bd",path:"/v2.0.0/contents/odeme-emri-baslatma-hizmeti.html",headers:[{level:3,title:"deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints)",slug:"odeme-emri-baslatma-hizmeti-icin-erisim-adresleri-endpoints"},{level:2,title:"6.1.\tADIM 0 - deme Emri Balatma Istei",slug:"_6-1-adim-0-odeme-emri-baslatma-istegi"},{level:2,title:"6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas",slug:"_6-2-adim-1-odeme-emri-rzasnn-hazrlanmas"},{level:2,title:"6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi",slug:"_6-3-adim-2-odeme-emri-rzasnn-yetkilendirilmesi"},{level:2,title:"6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal)",slug:"_6-4-adim-2-1-odeme-emri-rzasnn-sorgulanmas-istege-bagl"},{level:2,title:"6.5.\tADIM 3- deme Emrinin Oluturulmas",slug:"_6-5-adim-3-odeme-emrinin-olusturulmas"},{level:2,title:"6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal)",slug:"_6-6-adim-3-1-odeme-emri-sorgusu-istege-bagl"},{level:3,title:"GET /odeme-emri/{odemeEmriNo}",slug:"get-odeme-emri-odemeemrino"}],content:" 6.\tdeme Emri Balatma Hizmeti \n deme emri balatma ilemi havale, FAST ya da PS demesiyle sonulanabilir. deme ileminin amac kiiden kiiye para transferi, e-ticaret demesi gibi farkl deme trleri olabilir. demenin amacna gre BHSnin iletecei veri setinde farkllamalar olabilir. \n deme Emri Balatma Hizmeti 5 temel akdan oluur: \n \n deme Emri Balatma steinin tetiklenmesi:  HK BHS mobil uygulama ya da websitesinden deme emrini balatr. \n deme Emri Rza Hazrlanmas:  BHS, deme Emri Balatma ilemi iin izin oluturulmas isteini HHSye iletir. \n deme Emri Rzasnn Yetkilendirilmesi:  HHS, gerekli grd durumlarda HKy GKD ile dorular ve deme emri rzasna eriim iin eriim belirteci tanmlanmasn temin eder. \n deme Emrinin Balatlmas:  BHS, deme emrini HHSye iletir. \n deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay Sorgular:  BHS, deme Emri Rza Durumu, deme Emri Durumu, deme Emri Detay bilgilerini istee bal olarak sorgulayabilir. \n \n Nezdinde deme hesab bulunduran hesap hizmeti salayclar(Banka, EPK, deme Kurulular)  mterilerine ait hesaplar hesap referans ya da hesap numaras zerinden takip etmektedir. YS'lerin hem HBH hem de BH servisleri iin hesap referans veya hesap numaras zerinden ilem yaplabileceini bilmeleri, sistemlerini API dokmannda belirtilen aklara gre uyumlandrmalar ve mteri bilgilendirmesini(nyzlerinde hesap no ve hesap referans ayrmn gzeterek) buna paralel yapmalar beklenmektedir. \n YS'ler gnderen hesap seimini aadaki yntemlerden biri ya da birka ile salayabilirler: \n \n YS, mterisinin deme hesabn HHS ekranndan setirebilir. \n YS, mterisinden Hesap Bilgisi rzas alr. Rza ald hesaplar zerinden hesap referans aracl ile deme emri balatabilir. \n YS, mterisinin deme hesabn elle girmesine olanak tanyabilir. IBAN' olmayan HHS'ler deme emri rzas admnda  TR.OHVPS.Business.IBANNotSupported  hatasn vermelidir. IBAN' olan HHS'lerin bu ak desteklemesi zorunludur. \n YS; mterisinin hesap referansn elle girmesini salayabilir. Hesap Referans bilgisi ile balatlan deme emri ilemlerinde HHS seimi zorunludur. \n \n deme Sistemine dorudan katlmc olmayan HHS'ler, mterilerine IBAN sunmadklar iin, YS'ler hesap referans ile deme balatabilirler. Bunlarn dndaki HHS'lerin, gnderen IBAN veya hesap referans ile deme akn desteklemesi zorunludur. \n \n ekil 4: deme Emri Balatma Hizmeti st Dzey  Ak \n deme Emri Balatma Hizmeti iin Eriim Adresleri (Endpoints) \n deme Emri Balatma Hizmeti in Eriim Adreslerinin Etki Alan (Scope) = odeme_emri olarak belirtilmelidir. \n Tablo 6: deme Emri Balatma Hizmeti in Eriim Adresleri \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Zorunlu / stee Bal \n Yetkilendirme Tr \n mzalama \n stem Nesnesi \n Yant Nesnesi \n \n \n \n \n 1 \n odeme-emri-rizasi \n POST \n /odeme-emri-rizasi \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n OdemeEmriRizasiIstegi \n OdemeEmriRizasi \n \n \n 2 \n erisim-belirteci (GKD iin) \n POST \n /erisim-belirteci \n Z \n stemci Kimlik Bilgileri \n mzal stek ve Yant \n ErisimBelirteciIstegi \n ErisimBelirteci \n \n \n 2.1 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Z \n stemci Kimlik Bilgileri \n mzal Yant \n - \n OdemeEmriRizaYaniti \n \n \n 3 \n odeme-emri \n POST \n /odeme-emri \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal stek ve Yant \n OdemeEmriIstegi \n OdemeEmri \n \n \n 3.1 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Z \n stemci Kimlik Bilgileri & Yetkilendirme Kodu (GKD) \n mzal Yant \n - \n OdemeEmri \n 6.1.\tADIM 0 - deme Emri Balatma Istei \n \n HK, BHS uygulamasnda (web arayz/mobil uygulama) deme emri balatma ilemine onay verir. \n Gnderen hesap detaylarnn bu aamada belirtilmesi zorunlu deildir. \n 6.2.\tADIM 1 - deme Emri Rzasnn Hazrlanmas \n   \n ekil 5: deme Emri Rzasnn Hazrlanmas \n \n \n BHS, deme hizmeti kullanc hesabnn bulunduu HHSye balanarak deme emri rza kaynann oluturulmasn (odemeEmriRizasi) salar. \n \n \n POST istei TLS protokol tesis edilen iletiim katman zerinden gerekletirilir. TLS iin nitelikli sertifikalar kullanlr. \n \n \n POST isteinin balndaki alanlar ve istemcinin sertifikasndaki zel alanlar kullanlarak istemcinin yetkilendirilmesi salanr: \n \n stekte bulunan BHS yetkilendirilmi olduu geit tarafndan kontrol edilir. \n stekte bulunan yetkilendirilmi deme hizmeti salaycs BHS rolne sahiplii geit tarafndan kontrol edilir. \n HHS tarafndan, istek balndaki x-aspsp-code ile katilimciBlg ierisinde yer alan hhsKod deeri ile ayn olduunu kontrol edilir. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n \n \n \n POST baarl olursa, HHS, deme emri iin ieride rza olup olmamasna baklmakszn yeni bir rza tanmlaycs RizaNo ieren odemeEmriRizasi  yant olarak dner. \n \n \n 1 HK'nn 1 YS iin 1HHS'de istedii kadar rzas olabilir. \n \n \n HHS tarafnda RizaDurumu deikeninin durumu Yetki Bekleniyor olarak gncellenir. \n \n \n YSn dorulama ekran olarak HKya aaca URL adresini de ilgili rza numarasna gre oluturur. Burada 2 farkl yntemle URL oluturabilir. \n \n Statik URL  : \nHHSnin base pathi/alt-dizin/{rzaNo} \nrnek hhsYonAdr : https://xbank.com.tr/ohvps/cb54834e36f742d09af3d534ece3352a \nBu adres iin ilgili dorulama sayfas nden hazrlanmal ve HKnn dorulama sayfasna eriimi iin yaynlanm olmaldr (publish edilmelidir). \n Dinamik URL : \nHHSnin base pathi/alt-dizin/GKD Karlama Ekran?rizano={rzano} \nrnek: https://xbank.com.tr/ohvps/gkd?rizano=cb54834e36f742d09af3d534ece3352a \n \n \n \n POST /odeme-emri-rizasi \n STEK: \n BHS, bu API eriim adresinden HHSye yeni bir OdemeEmriRizasi oluturulmas iin istekte bulunur: \n \n BHS, deme emri balatma istei olduunu HHSye bildirir. \n BHS, HKnn, BHS arayznden verdii rzann (n Onay) bir kopyasnn HHS nezdinde mteri tarafndan onaylanmas iin HHSye gnderilmesini salar. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hata kodu iletilmeli ve fieldErrors dolu olacak ekilde hatal alan belirten detayl aklama gnderilmelidir. InvalidFormat hata kodlarnda fieldErrors ierii gnderilmeli ve anlalr aklama ile message, messageTr alanlar doldurulmas zorunludur. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n HHS; YS API ile alnan BHS bilgilerinin ierisinde yer alan ynlendirme adresleri ile deme emri rzas nesnesi request mesajnda paylalan adreslerin uyumlu olup olmadnn kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.TPPRedirectionAddressMismatch\"  hatas dnlr. \n HHS; kimlik bilgileri nesnesinde eer kimlik bilgileri iletilmi ise; bu veri ile HKnn HHS mterisi olup olmadnn kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal HKlar iin yaplmaldr. (Koullu Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.CustomerNotFound\"  hatas dnlr. Kurumsal mteri ile balatlan rzada yer alan mteri bilgisinin kar kurumda Kurumsal mteri deil; bireysel mteri olduu durumda  TR.OHVPS.Business.BusinessCustomerMismatch  hatas dnlr. \n deme Emri Balatma Hizmeti rza isteinde bulunan HKnn Ak Bankaclk Kanal Yetki tanm yok ise  \"TR.OHVPS.Business.OpenBankingChannelClosed\"  hatas dnlr. HHS insiyatifinde olup HHS bu kontrol GKD sonras gerekletirebilir. \n HHS \"gkd\" nesnesi iin alan kontrollerini gerekletirir. \"yetYntm\" = \"A\" gnderilmi ise \"ayrikGkd\" nesnesinin dolu gnderilmesi zorunludur. Gnderilmemesi durumunda HHS tarafndan  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n Ayrk GKD desteklemeyen HHS'ye Ayrk GKD yntemiyle rza balatma istei yaplmas durumunda HHS tarafndan  \"TR.OHVPS.Business.DecoupledAuthenticationNotSupported\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n Ayrk GKD ile balatlan rza aklarnda HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder. YS iki olay tipine de abone olmak zorundadr. Eer olay abonelii yoksa HHS tarafndan  \"TR.OHVPS.Business.EventSubscriptionNotFound\"  hatas dnlr. \n Rza balatma ak ierisinde kimlik bilgisinin olduu durumlarda; HK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrk GKD ierisinde yer alan OHK Tanm Deer alan (ayrikGkd.ohkTanimDeger) birebir ayn olmaldr. Ayn olmad durumda HHS tarafndan  \"TR.OHVPS.Business.CustomerInfoMismatch\"  hatas dnlr. Kimlik alan iermeyen tek seferlik deme emri aklarnda bu kural geerli deildir. GSM ve IBAN deerleri sadece tek seferlik demelerde kullanlabilir. \n HHS tarafnda HK'nn mobil uygulamas bulunmamas durumu tespit edilebildii durumda Ayrk GKD ile balatlan rza aklarnda HHS tarafndan  \"TR.OHVPS.Business.CustomerMobileApplicationNotFound\"  hatas dnlr. YS ilgili ilemi Ynlendirmeli aka ekip sreci ilerletebilir. \n HHS kimlik bilgisi ile gnderen nvannn uyumlu olduunu kontrol eder. HHS'ler EFT/FAST ilemlerinde kabul ettikleri kontrol kriterleri ile ileme izin verebilirler. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Business.IncorrectSenderTitle\"  hatas dnlr. \n Gnderen Hesap Numaras BHS tarafndan iletildii durumda;\n \n IBANn doruluu (kontrol basama dorulamas) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.InvalidAccount\"  hatas dnlr. \n IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol) kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountCodeMismatch\"  hatas dnlr. \n Hesap numarasnn HKya ait olduu kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.CustomerAccountMismatch\"  hatas dnlr. \n HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. (lgili hesabn para transfer ilemine yetkisi olmamas) Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountUnauthorized\"  hatas dnlr. \n HHSde gnderen hesabn aktiflii kontrol edilir. Kontrollere istinaden hata olumas durumunda   \"TR.OHVPS.Business.AccountInactive\"  hatas dnlr. \n \n \n Gnderen Hesap Numaras iin, Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir. Eer aktif bir rzas yok ise  \"TR.OHVPS.Business.ActiveConsentNotFound\"  hatas dnlr. \n Hesap bakiye kontrolnn rza aamasnda yaplmamas gerekmektedir. nk HK deme emri gerekleene kadar hesabna para eklemesi yapabilir. \n Alc ve gnderen hesabn ayn olmas durumunda  TR.OHVPS.Business.SenderRecipientSame  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n Mterinin kendi hesaplar arasnda talimat veremeyecei durumlarn kontrol iin  TR.OHVPS.Business.SameAccountTransferRestricted  hatas dnmesi beklenmektedir. Bu hata HHS insiyatifindedir. \n \n Tek Seferlik deme \n \n Tek seferlik deme ak YS'ten HHS'ye giden istekte, gnderen kimlik bilgilerinin olmad durumda gerekleir. Gnderen kimlik bilgisi olmadnda, KOLAS sorgusu yaplamayacandan tr, HHS tarafndan  \"TR.OHVPS.Resource.OneTimePaymentNotSupport\"  hatas dnlmelidir. HK'nn YS'n mterisi olmad durumda tek seferlik deme balatlabilir. \n Tek seferlik deme ak hem iyeri demelerinde hem de kiiden kiiye para transferlerinde kullanlabilen bir aktr. yeri tarafndan balatlan tek seferlik deme ilemlerinde katlmclar gnderen HK'dan cret alnamaz. \n Tek seferlik deme ak sadece bireysel mteriler iin kullanlabilir. Kurumsal mteri ile deme emri balatlmas durumunda  \"TR.OHVPS.Resource.OneTimePaymentNotSupport\"  hatas dnlr.\nTek seferlik deme aknda hem ynlendirmeli hem de ayrk GKD ak ile mteri yetkilendirmesi salanabilir. \n Aadaki senaryolar tek seferlik demeye rnek olarak gsterilebilir. \nyeri demesi ak rnei: Bir e-ticaret sitesinde, ye olmadan alveri yaplmas ve demenin YS tarafndan kimlik bilgisi olmadan balatlmas \nKiiden kiiye para transferi ak rnei: QR veya dier yntemler ile alc bilgilerinin gnderici ile paylalmas ve YS zerinden gnderici bilgileri olmadan alcya para transferi yaplmas iin rza verilmesi \n \n Yukardaki kontroller tamamlandktan sonra HHS, deme iin benzersiz RizaNo ile OdemeEmriRizasi nesnesi oluturur ve BHSye dner.  HHS, OdemeEmriRizasi oluturduu anda durumunu Yetki Bekleniyor olarak dzenler. \n Tek seferlik deme ilemlerinde (gnderen kimlik bilgilerinin bo olduu durumda) ileri tarihli ve dzenli deme emri rzas balatlabilir; ancak bu i modelleri hizmete sunulmadan nce BKM ile paylalmal ve onay alnmaldr. \n POST /odeme-emri-rizasi  isteinin (REQUEST) gvdesinde (BODY)  odemeEmriRizasiIstegi nesnesi (Tablo-7) kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda odemeEmriRizasi (Tablo-8) nesnesi oluturulur. \n  BAARILI STEK: \n Tablo 7: OdemeEmriRizasiIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri rzas oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n  \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. Yetkilendirme yntemi, BHS tarafndan belirtilmeyebilir. \n HHS, HBHSnin belirledii yntemi dikkate alarak sreci ilgili aka uygun olarak devam ettirir. Desteklemedii yntem iin (rn: Ayrk GKD) ayrca hata mesaj verilmelidir. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu.  YSn iletecei adrestir.  Durum kodu(drmKod), ynlendirme adresine parametre olarak eklenmelidir. \n HHS, mteri uygulama / taraycsn bu alanda belirtilen adrese ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur.   HHS, YS'n AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri iin olay aboneliinin varln kontrol eder.  Bknz: Ayrk GKD \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir.  TR.OHVPS.DataCode.ohkTanimTip  sral veri tiplerinden birini alr. \n \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir. \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS geerli bir Kimlik Numaras Tr olduunu kontrol eder. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir.  Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr.  Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS geerli bir Kurum Kimlik Numaras Tr olduunu kontrol eder. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur.  HHS, BHS tarafndan iletilmesi durumunda Kurum Kimlik Verisi zeriden apraz kontroller uygulamaldr. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn girilmi olduu apraz olarak kontrol edilir. \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n HHS geerli bir para birimi olduu kontrol eder. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n \n >> nvan \n unv \n AN3..140 \n K \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.  Tek seferlik deme dnda YS'n gnderen nvann gndermesi zorunludur. \n HHSnin bu veri ile kendi sistemlerindeki verinin farkl olmas ve Kimlik Numaras ile elememesi durumunda deme emri balatma istei reddedilir.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.  Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir. Hesap referans ile deme emri rzas balatlacak ise HHS hesap referans deeri ile ilikilendirilmi mevcut bir hesap bilgisi rzas var m kontrol etmelidir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n BHS tarafndan iletildii durumda; IBAN ierisindeki HHS kodunun istek balndaki HHS kodu ile ayn olduu (hesabn HHSye aitliinin kontrol), IBANn doruluu (kontrol basama dorulamas), Hesap numarasnn HKya ait olduu, HHSye zel deme izni verilmeyen farkl statlerin bulunmas durumu kontrol edilir. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.  Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HHS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n HspRef'e bal IBAN deitiinde yeni IBAN'n da ilgili HspRef ile ilikilendirilmesi beklenmektedir. Bu durumda, HBHS, HspRef ile sorguya geldiinde HHS'nin yeni IBAN ve hesap hareketlerini dnebilmesi mmkn olacaktr. HspRefin, IBAN deitiinde deitirilmemesi tavsiye edilmektedir. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n >> nvan \n unv \n AN3..140 \n K \n Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Alcnn nvandr. BHS ekranlarndan girii yaplabilecei gibi BHSnin kaytl alclarndan yaplan seimle de doldurup gnderebildii bilgi olabilir.  FAST-TR Karekod Veri Organizasyonunda;  yeri tarafndan sunulan uzun karekod yapsnn  59:  alannda tanml yeri ad alandr, Kiiden Kiiye deme Karekod Yapsnn  07:  alannda tanml    deme Alcsnn Ad ve Soyad  alandr.  FAST-TR Karekod dndaki i yeri demelerinde; yine nvan alannda iyeri ad bilgisi gnderilmelidir. \n \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n Alcnn Hesap Numaras (IBAN)  alandr.   Kolay Adres Sistemi  kullanlmyorsa zorunludur.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  30-01:  alannda tanml  Yeri IBAN verisi kullanlr.  Alcnn birden fazla hesabnn kullanlabilir olduu durumlarda (zellikle iyeri demelerinde HHS nezdindeki hesap (on-us havale ak) tercih edilmelidir. \n HHS (Gnderen Katlmc) tarafndan IBAN dorulamas (kontrol basama dorulamas) yaplr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n Tek seferlik demelerde ( kimlik bilgileri bo iletildiinde) KOLAS nesnesi dolu iletiliyorsa; HHS tarafndan hata dnlmelidir \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n HHS (Gnderen FAST katlmcs) tarafndan KOLAS Servisine yaplan sorguda girdi olarak kullanlr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. Okunan karekodda referans deeri varsa kullanlmas zorunludur.  Karekod ilke ve kurallar belgesinde tanmland ekilde kullanlmas gerekmektedir.  Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n HHS, YS'n API deseninde \"O\" kodunu ilettiini kontrol eder. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n HHS geerli bir deme Amac kodu olduunu kontrol eder. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarnda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.   -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -\tyeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n YS bu deeri HKy HHSye ynlendirmeden nceki ekranda gstermeli, ve HHS bu deeri GKD iin kulland nyznde ilem dorulama kodunun bir unsuru olarak yine HKya gstermelidir. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir.  4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n  BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmriRizasi nesnesi Tablo-8deki parametrelerden oluur: \n Tablo 8: OdemeEmriRizasi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n > Gncellenme Zaman \n gnclZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin gncellenme zaman \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n > Rza Iptal Detay Kodu \n rizaIptDtyKod \n AN2 \n K \n Rza durumunun iptal olduu durumda zorunludur. Alabilecei deerler 4. Blmde detaylandrlmtr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr.  HHS, BHSnin belirledii yntemi dikkate alarak kendi belirledii yntemi kullanr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n \n \n \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   HHS tarafndan maksimum 5 dk iinde ilem tamamlanacak ekil zaman damgas oluturulur. Zaman am olduunda HHSnin GKDye izin vermeyecek ekilde hata mesaj vermesi gerekmektedir.  Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n K \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n K \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n  \n \n \n \n >> nvan \n unv \n AN3..140 \n K \n Gnderenin nvandr.  HHS, bu bilgiyi BHS sisteminden gelen veri yerine FASTa iletirken kendi sisteminden alabilir.   Tek seferlik deme dnda YS'n gnderen nvann gndermesi zorunludur. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n  \n BHS'nin n yznden daha nce kayt altna alnm hesaplar arasndan setirdii veya mteriye girdii IBANdr.  BHS tarafndan iletilmedii durumda, gnderen hesap bilgisini mteri tarafndan HHSnin dijital kanalnda GKD sonrasnda seilebilir. Bu amala BHS arayznde HHS setirilmelidir.   GKD sonras HHS ekrannda seilen Hesap Numaras POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Referans kullanlyorsa Hesap Numaras kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n  \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid). YS baznda farkllamas gerekmez.  BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir.   GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir.    Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.    deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n BHS tarafndan istek mesajnda iletilip dorulanan veya Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen alc maskeli IBAN bilgisidir. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n TR.OHVPS.DataCode.KareKodAksTur  sral veri deerlerinden birini alr. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn  gsterir. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. Karekod aknda, FAST Karekod Veri Organizasyonundaki 62-08: alannda tanml deme Amac verisi kullanlr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisidir. Bu alan ileri vadeli demeler iin dnlmtr. lk fazda doldurulmasna gerek olmad dnlmektedir. \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.3.\tADIM 2- deme Emri Rzasnn Yetkilendirilmesi \n   \n ekil 6: deme Emri Rzasnn Yetkilendirilmesi \n BHS, HKnn deme emrini yetkilendirmesi isteini iletir. deme emrinin yetkilendirilmesi, HHS tarafndan gerekletirilen Ynlendirme veya Ayrk GKD yntemiyle yaplr. \n \n \n Ynlendirmeli dorulama aknda , BHS HKy HHSye ynlendirir. \n \n BHS tarafndan ynlendirme, bir nceki admdaki RizaNoyu ierir. \n Ynlendirmenin RizaNoyu iermesi sayesinde, HHS hangi deme emriyle ilikili olarak ynlendirme yapldn ilikilendirebilir. \n HHS, HK iin GKD srecini iletir. \n \n HKy dorularsa, \n \n HK -bir nceki admda semediyse- borlu hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n HHS, HKy olumlu ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n \n \n \n yonAdr?rizaDrm=Y&yetKod=xx&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HKy dorulayamazsa, \n1. HHS, deme emri rza kaynann durumunu Yetki ptal olarak gnceller. \n2. HHS, HKy olumsuz ynlendirme ak ile BHS tarafndan tanmlanan ynlendirme adresine ynlendirir: \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&drmKod=zzz\n \n HHS tarafnda oluabilecek bir hata durumunun YSe aktarlmas gerektii durumlar olabilir. Bu durumda yonlendirme adresinde hata kodu parametresi zorunlu olarak iletilmelidir. \nHata aklamalarnn neler olabilecei ve YSn kendi uygulamasnda bu hatay ne ekilde gsterecei aada tariflenmitir. \n yonAdr?rizaDrm=I&rizaNo=yy&rizaTip=O&rizaIptDtyKod=11&drmKod=zzz\n \n URLde iletilen Rza ptal Detay Kodu Rza durumlar blmnde (4. Blm) belirtilen hata kodlar ile ayn olacak ekilde tasarlanmtr. GKD srasnda yaplmas gereken kontroller 5.3 blmnde detaylandrlmtr. \n \n Ayrk dorulama aknda , HHS, HKnn deme emrini balatt uygulamadan farkl olabilecek bir dorulama uygulamasnda ilemi dorulamasn ister.\n \n Ayrk ak BHSnin farkl bir kanal kullanarak yetkilendirme istei gndermesiyle balatlr. \n Bu yetkilendirme istei, yetkilendirilecek deme emri rzasnn eletirilecei HKnn bulunmas iin ilgili veriyi tar. \n HHS, HKy dorular. \n HK -bir nceki admda semediyse- borlandrlacak hesabn seer. \n HHS, deme emri rza kaynann durumunu Yetkilendirildi olarak gnceller. \n \n \n \n Baarl GKD sonrasnda (rizaDrm=Y) ilgili rza nesnesi iin (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alnmasnn ardndan eriim belirteci eriim adresine POST ars yaplarak yetkilendirme kodu karlnda eriim belirteci ve yenileme belirteci alnr. POST /eriim-belirteci eriim noktas EK-3te aklanmtr. \n Eriim belirteci alndktan sonra; HHS, deme emri rza kaynann durumunu Yetki Kullanld olarak gnceller. \n 6.4.\tADIM 2.1  deme Emri Rzasnn Sorgulanmas (istee bal) \n   \n ekil 7: odemeEmriRizasi nesnesinin sorgulanmas (istee bal) \n GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlar olabilir. Bu durumlarda deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle,  OdemeEmriRizasi  nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr. HHS,  ADIM 2 -deme Emri Rzasnn Yetkilendirilmesi  aknda HKnn hesaplar arasnda seim yapmasn ve seilen hesap bilgisinin  OdemeEmriRizasi  nesnesine iler. \n GET /odeme-emri-rizasi/{RizaNo} \n BHS, mevcut durumunu kontrol etmek iin, oluturulan bir  OdemeEmriRizasi  kaynann durumunu istee bal olarak alabilir. \n \n Sorgulama yaplan deme emri rzas HHS tarafnda bulunmuyor ise  \"TR.OHVPS.ResourceNotFound\"  hatas dnlr. \n \n Servis baarl yantnda Tablo 8de belirtilen \"OdemeEmriRizasi\" nesnesini dnmektedir. \n Durum \n OdemeEmriRizasi  kayna iin kullanlabilecek durum gstergeleri u ekildedir: \n \n Yetki Bekleniyor \n Yetkilendirildi \n Yetki Kullanld \n Yetki deme Emrine Dnt \n Yetki Sonlandrld \n Yetki ptal \n \n deme Emri Rzas sonlandrld ve iptal statsnde olan rza'larn gncellenme zamanndan(gnclZmn) 6 ay sonrasna kadar sorgulanabilir olmas beklenmektedir. HHS'ler ilgili sre sonrasnda yaplacak rza sorgularna \" TR.OHVPS.Resource.NotFound\"  uyars verebilir. YS'ler tarafndan iptal ve sonlandrld statsnde olan rzalar iin sorgulama yapmamaldr. \n deme emri rza durum deiiklikleri 4.2 blmnde detaylandrlmtr. \n BAARILI YANIT: \n GET /odeme-emri-rizasi/{RizaNo}  yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmriRizasistegi nesnesi kullanlr. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-8de yer alan parametreleri ieren OdemeEmriRizasi oluturulur. \n Gnderen Hesap Bilgisinin, ADIM 2 (deme Emri Rzasnn Yetkilendirilmesi) sonrasnda HHS ekranndan seildii akta OdemeEmriRizasi nesnesi gncellenir ve BHS  GET /odeme-emri-rizasi/{RizaNo}  istei yaparak gncel gnderen hesap bilgisi bilgisini de ieren OdemeEmriRizasi nesnesini ekmelidir. \n ereve szleme kapsamnda olmayan tek seferlik deme ilemlerinde, Kimlik Tr ve Kimlik Verisi bilgilerinin deme emri rzas srasnda gnderimi zorunlu deildir. Baarl GKD sonras, yani eriim belirteci alndnda, deme emri olumadan nce, YSn deme emri rzasn sorgulayarak bu bilgileri almas ve deme emrini olutururken Kimlik Tr, Kimlik Verisi ve Gnderen nvan alanlarn dolu olarak gndermesi beklenmektedir.  Ancak rza durumu Yetki Bekleniyor - B, Yetkilendirildi - Y ve Yetki ptal - I statlerinde ise, deme emri rzas sorgulamasnda, HHSnin Kimlik Tr ve Kimlik Verisi bilgisini YS ile paylamamas gerekmektedir. \n 6.5.\tADIM 3- deme Emrinin Oluturulmas \n   \n ekil 8: deme Emrinin Oluturulmas \n POST /odeme-emri \n HKnn Gl Kimlik Dorulama ile ilemi yetkilendirmesi sonrasnda, BHS OdemeEmri kaynan oluturur. \n deme emri (OdemeEmri) uygun deme kaynana POST istei yaplarak balatlr. \n \n Eriim Belirteci kontrol yaplr. Geerli bir Eriim Belirteci yok ise  \"TR.OHVPS.Connection.InvalidToken\"  hatas dnlr. \n HHS; istek mesajnda yer alan alanlarn HVPS API lke ve Kurallar dkmannda belirtilen artlar salayacak ekilde zorunluluk, uzunluk ve ierik kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata olumas durumunda  \"TR.OHVPS.Resource.InvalidFormat\"  hatas dnlr. \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidASPSP  hatas dnlr. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. Farkl olmas durumunda  TR.OHVPS.Connection.InvalidTPP  hatas dnlr. \n Rza durumu kontrol edilir.\n \n B: Yetki Bekleniyor, Y: Yetkilendirildi  ya da E: Yetki deme Emrine Dnt ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlr. \n I: Rza ptal ya da S: Yetki Sonlandrld ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlr. \n RizaDurumu K: Yetki Kullanld ise kontrollere devam edilir. \n \n \n POST /odeme-emri-rizasi ile POST /odeme-emri isteklerinde istek alanlarn ayn olmas beklenmektedir. HHS tarafndan kontrol salanmaldr. deme emri rzasnda gnderilen deerlerden farkl bir deer gnderildii durumda  TR.OHVPS.Business.FieldMismatch  hatas dnlr. \n HHS tarafndan deme Emrinin Oluturulmas API'sine istek yapldnda mterinin bakiyesi kontrol edilir. Bakiye yetersiz ise HHS tarafndan  \"TR.OHVPS.Business.BalanceInsufficient\"  hatas dnlr. Mterinin hesabnda bakiye olmas ancak gnlk ilem limitine taklmas durumunda ise  TR.OHVPS.Business.ExceededTransactionLimit  hatas dnlr. \n \n Yukardaki kontroller tamamlandktan sonra, ierisinde OdemeEmriNo ve OdemeEmriDurumu deikenleri de bulunan OdemeEmri nesnesi BHSye dner ve RizaDurumu deikenin deeri Yetki deme Emrine Dnt olarak gncellenir. \n \n POST verisindeki Gnderen Hesap Numaras ve Alc Hesap Numarasnn ayn bankaya aitse HAVALE deilse FAST veya PS i akna geilir. \n OdemeEmriDurumu Gerekleti / Gnderildi / Gereklemedi olarak gncellenir. \n \n BAARILI STEK: \n Tablo 9: OdemeEmriIstegi nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n HHS tarafndan deme emri oluturulmas srasnda yaplmas gereken kontrol ve ilemler \n FAST A01 PS M01 mesaj mapping \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zaman \n \n \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n HHS, hhsKodun kendisine ait olduunu ve istek balndaki x-aspsp-code deeri ile ayn olduunu kontrol eder. \n Gnderen katlmc kodu (yani bankann FAST/PSteki Katlmc kodu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n HHS, yosKodun geerli bir deme Hizmeti Salaycs Kodu olduunu ve istek balndaki x-tpp-code deeri ile ayn olduunu kontrol eder. \n YosKod \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n \n \n >Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n \n \n >Ynlendirme Adresi \n yonAdr \n AN1..1024 \n K \n Ynlendirmeli gl kimlik dorulama iin zorunludur. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n \n \n \n \n \n \n \n \n \n \n \n >Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n yetYntm = A gnderilmi ise ayrikGkd nesnesinin dolu gnderilmesi zorunludur. yetYntm = Y iin bu nesne iletilmemelidir. \n \n \n \n >>OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >>OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n \n \n >HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n \n \n >Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kimlik Numaras Tr verisi ile ayn olmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik trnn bu alanda gnderilmesi zorunludur. \n \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n ereve szleme kapsamndaki demelerde kullanm zorunludur. HHS, BHS tarafndan iletilmesi durumunda Kimlik Verisi zeriden apraz kontroller uygulamal ve Kimlik Verisini temel alarak GKD gerekletirmelidir. deme Emri Rizas Nesnesindeki Kimlik Numaras verisi ile ayn olmaldr. Gerek kii tarafndan yaplan demelerde, 1. HHS, Gnderen Ad ve Gnderen Hesap Numarasn deme emri isteinde (Havale/FAST/PS) gnderir. - Gnderen Ad ve dier tm mteri bilgileri, Kimlik Numaras zerinden elde edillir. Pasaport numarasna ilikin kontroller HHS'nin halihazrda kulland veri, ak ve tabi olduu dier dzenlemelerdeki ileyi ile ayn ekilde ele alnmaldr. Kurum adna yaplan (ticari) demelerde, kurum adna ilem yapan kullancnn kimlik verisi bu alanda gnderilebilmesi zorunludur. \n GonKimN / Psp \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Tr verisi ile ayn olmaldr. \n \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n Kurum adna yaplan (ticari) demelerde kullanm zorunludur. deme Emri Rizas Nesnesindeki Kurum Kimlik Verisi ile ayn olmaldr. \n GonKimN / VKN \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n Kurum adna yaplan demelerde K deerini alr. Kurum Kimlik Tr ve Kurum Kimlik Verisi alanlarnn giilmi olduu apraz olarak kontrol edilir.  deme Emri Rizas Nesnesindeki HK Tr ile ayn olmaldr. \n \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n deme Emri Rizas Nesnesindeki Para Birimi verisi ile ayn olmaldr. \n \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.   Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n deme Emri Rizas Nesnesindeki lem Tutar verisi ile ayn olmaldr. HHS ilem tutar deme mesajnda (Havale/FAST/PS) aynen tanmak durumundadr. \n Ttr \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n HHS ve BHS verisi tutarl olmaldr.  BHS verisi ile HHS verisinin farkllamas durumunun ise risk deerlendirme sistemlerine girdi olarak kullanmas tavsiye edilir. \n GonAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS'nin n yznden setirdii/kullancya girdii IBAN Hesap numaras ya da Hesap Referans alanlarndan en az birinin dolu olarak gelmesi gerekmektedir. \n deme Emri Rizas Yant Nesnesindeki Gnderen Hesap Numaras verisi ile ayn olmaldr. \n GonHesN \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme balatlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.   deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n YSten alc ad soyad bilgisi geliyorsa ve HHS'nin kontrolnden baarl bir ekilde geti ise HHS'nin tekrar alc ad soyad bilgisi iin giri yaptrmasna gerek bulunmamaktadr. \n AlAd \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n deme Emri Rizas Yant Nesnesindeki Alc Hesap Numaras verisi ile ayn olmaldr.  Kontroller baaryla sonulanrsa, bilgi FAST/PS AlHesN alanna dorudan aktarr ve FAST/PS Alan Katlmc Kodu (AlKK) olarak Alc HHS Kodu kullanlr.  KOLAS sorgusu sonucunda deme emrinde iletilen maskeli bilgi ile HHSnin kendi deme emri rzas isteinde tuttuu KOLAS sorgusundan dnlen bilgi maskelenerek karlatrlr. Eer ayn deilse uygun hata kodu dnlerek ilem sonlandrlr. \n AlHesN \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Tipi verisi ile ayn olmaldr. \n \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n deme Emri Rizas Yant Nesnesindeki Kolay Adres Deeri verisi ile ayn olmaldr. \n FAST (KolasRef) \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n KolasRef ( hem FAST hem de PS iin ayn) \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n deme Emri Rizas Nesnesindeki Kare Kod Ak Tr verisi ile ayn olmaldr. \n FAST: KrkdAksTur \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n deme Emri Rizas Nesnesindeki Karekod Referans verisi ile ayn olmaldr.  evrimii dorulama hizmeti alnmayan statik karekodlar iin Referans numarasnn bulunmad durumlarda HHS tarafndan NONREF ifadesi girilir. \n FAST: Karekod Referans (KrkdRef) \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O deeri atanarak iletilmelidir. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n deme Emri Rizas Nesnesindeki deme Kayna verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST/PS: OdmKynk \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Amac verisi ile ayn olmaldr. HHS tarafndan deme mesajnda (FAST/PS) aynen tanmak durumundadr. \n FAST (OdmAmc)/PS(OdmAmaci) \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  -yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n deme Emri Rizas Nesnesindeki Referans Bilgisi verisi ile ayn olmaldr. \n RefBlg (Hem FAST hem de PS iin ayn) \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n FAST/PS Acklm \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n deme Emri Rizas Nesnesindeki deme Sistemi verisi ile ayn olmaldr. \n \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda istekte yer alr.  yeri deme Bilgileri, YS uygulama nyznde HKnn bildii ve girii yaplmas beklenen bir bilgi olmamaldr. YS tarafndan sistemsel olarak doldurulmas gereklidir. \n \n \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). 4 karakterden kk deerlerin bana 0 eklenerek iletilmesi gereklidir. \n \n \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n \n \n \n \n \n BAARILI YANIT: \n POST ileminin RESPONSE gvdesini (BODY) oluturan OdemeEmri nesnesi Tablo-10daki parametrelerden oluur: \n Tablo 10: OdemeEmri nesnesi \n \n \n \n Alan Ad \n JSON Alan Ad \n Format: Veri modeli smi \n Zorunlu / Koullu / stee bal \n Aklama \n \n \n \n \n Riza Bilgileri \n rzBlg \n Kompleks: RizaBilgileri \n Z \n \n \n \n > Rza No \n rizaNo \n AN1..128 \n Z \n OdemeEmriRzasi nesnesinin oluturulmas esnasnda HHS kaynak sunucusu tarafndan atanan biricik tanmlayc \n \n \n > Oluturma Zaman \n olusZmn \n ISODateTime \n Z \n OdemeEmriRizasi nesnesinin oluturulma zamandr. \n \n \n > Rza Durumu \n rizaDrm \n AN1 \n Z \n TR.OHVPS.DataCode.RizaDurumu  sral veri tipini deerlerinden birini alr. \n \n \n Katlmc Bilgisi \n katilimciBlg \n Kompleks:KatilimciBilgisi \n Z \n Katlmclara atanm kod bilgileridir. \n \n \n >Hesap Hizmeti Salaycs Kodu \n hhsKod \n AN4 \n Z \n stein iletildii Hesap Hizmeti Salaycsnn kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n \n \n > Yetkili deme Hizmeti Salaycs Kodu \n yosKod \n AN4 \n Z \n stei gnderen Yetkili deme Hizmeti Salaycs (YS) kodudur. \n \n \n GKD \n gkd \n Kompleks:Gkd \n Z \n \n \n \n > Yetkilendirme Yntemi \n yetYntm \n AN1 \n Z \n TR.OHVPS.DataCode.GkdTur  sral veri tr deerlerinden birini alr. \n \n \n > Ynlenme Adresi \n yonAdr \n AN1..1024 \n Z \n Ynlendirmeli gl kimlik dorulama iin zorunlu. HHS, mteri uygulama / taraycsn ynlendirmeli akta bu alanda belirtilen YS adresine ynlendirir. \n \n \n > Ayrk GKD \n ayrikGkd \n Kompleks:AyrikGkd \n K \n Ayrk gl kimlik dorulama iin zorunlu. \n \n \n >> OHK Tanm Tip \n ohkTanimTip \n AN8 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm tipleridir. stek ierisindeki veri deitirilmeden iletilir. \n \n \n >> OHK Tanm Deer \n ohkTanimDeger \n AN1..30 \n K \n HK'nn HHS uygulamas tarafndan tannmasn salayacak tanm deeridir. ohkTanimTip'i ile uyumlu deerdir.  stek ierisindeki veri deitirilmeden iletilir. \n \n \n > HHS Ynlenme Adresi \n hhsYonAdr \n AN1..1024 \n K \n Ynlendirmeli ak trnde GKD dorulama bilgilerinin girilebilmesi iin uygulamadan alacak ynlendirme sayfasnn adresi. Ayrk GKD aknda bu alan dnlmemelidir. \n \n \n > Yetkilendirme Tamamlanma Zaman \n yetTmmZmn \n ISODateTime \n Z \n Yetkilendirme aknn tamamlanmas gereken son zaman gsterir.   Rza durumu Yetkilendirildi statsne geene kadarki sredir. \n \n \n Emir Bilgileri \n emrBlg \n Kompleks: EmirBilgileri \n Z \n \n \n \n > deme Emri Numaras \n odmEmriNo \n AN1..128 \n Z \n odemeEmri nesnesinin UID'sidir. OdemeEmrine likin sorgular bu ID zerinden yaplr. \n \n \n > deme Emri Zaman \n odmEmriZmn \n ISODateTime \n Z \n odemeEmri nesnesinin oluturulma zamandr. \n \n \n deme Balatma \n odmBsltm \n Kompleks: OdemeBaslatma \n Z \n \n \n \n > Kimlik \n kmlk \n Kompleks:Kimlik \n Z \n \n \n \n >> Kimlik Tr \n kmlkTur \n AN1 \n Z \n TR.OHVPS.DataCode.KimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kimlik Verisi \n kmlkVrs \n AN1..30 \n Z \n HHS nezdinde kullanc dorulamasnda kullanlan tanmlaycdr. TR.OHVPS.DataCode.KimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> Kurum Kimlik Tr \n krmKmlkTur \n AN1 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik trdr. TR.OHVPS.DataCode.KurumKimlikTur  sral veri tr deerlerinden birini alr. \n \n \n >> Kurum Kimlik Verisi \n krmKmlkVrs \n AN1..30 \n K \n Kurum adna yaplan demelerde HKnn altnda tanml olduu tzel kiilik iin kullanlan kurum kimlik verisidir.   TR.OHVPS.DataCode.KurumKimlikTur  deerine gre uzunluk ve format deiir. \n \n \n >> deme Hizmeti Kullancs Tr \n ohkTur \n AN1 \n Z \n TR.OHVPS.DataCode.OhkTur  sral veri tr deerlerinden birini alr  (B: Bireysel, K:Kurumsal) \n \n \n > lem Tutar \n islTtr \n Kompleks:Tutar \n Z \n \n \n \n >> Para Birimi \n prBrm \n AN3 \n Z \n Para Birimi.  Karekod aknda, FAST Karekod Veri Organizasyonundaki  53: (Para Birimi)  alannda tanml Para Birimi verisi kullanlr. \n \n \n >> Tutar \n ttr \n AN1..24 \n Z \n BHS'nin n yzde kullancdan teyit ald tutar.   Karekod aknda, FAST Karekod Veri Organizasyonundaki  54: (Tutar)  alannda tanml Tutar verisi kullanlr.    Tutar alan regex patterni u ekildedir: '^\\d{1,18}$|^\\d{1,18}\\.\\d{1,5}$' \n \n \n > Gnderen \n gon \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Gnderen kiinin ad soyad ya da ticari nvan bilgisi. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n K \n BHS tarafndan iletilip dorulanan veya HHS ekrannda seilen Gnderen Hesap Numaras dnlr. \n \n \n >> Hesap Referans \n hspRef \n AN5..40 \n K \n HHS tarafndan hesap iin atanan biricik tanmlycdr (uuid)  YS baznda farkllamas gerekmez. BHSnin ayn zamanda HBHS olduu durumda mteri rzas tesis edilmi bir hesabn referans zerinden de deme baaltlabilir. GKD sonras HHS ekrannda seilen Hesap Referans POST ileminin yantnda dnlemez ancak istee bal GET sorgusu ile dnlebilir. Hesap Numaras kullanlyorsa Hesap Referans kullanlmayabilir.  deme Sistemine dorudan katlmc olmayan HS'ler mterilerine IBAN sunmadklar iin hspRef zerinden deme balatabilirler. Bu durumda hesap numaras bo olacaktr. \n \n \n > Alc \n alc \n Kompleks:Hesap \n Z \n \n \n \n >> nvan \n unv \n AN3..140 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen adres kayd yaptrm olan alcnn maskeli ad-soyad veya maskeli ticari nvan bilgisidir. Kolastan dnen account owner alan kullanlmaldr. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen nvan bilgisidir. \n \n \n >> Hesap Numaras \n hspNo \n AN26 \n Z \n Alcnn Hesap Numaras alandr (IBAN). Kolay Adres  sorgusunda dnlen adres kayd yaptrm olan alcnn maskeli IBAN bilgisidir. Kolay adres deil ise BHS tarafndan istek mesajnda iletilen IBAN bilgisidir. Karekod aknda, FAST Karekod Veri Organizasyonundaki 30-01: alannda tanml  Yeri IBAN verisi kullanlr. \n \n \n >> Kolay Adres \n kolas \n Kompleks:Kolas \n K \n \n \n \n >>> Kolas Tr \n kolasTur \n AN1 \n Z \n Mterinin sorgulamak istedii Kolay Adres Tipi deeridir.  TR.OHVPS.DataCode.KolasTur  sral veri tr deerlerinden birini alr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Deeri \n kolasDgr \n AN7..50 \n Z \n Mterinin ekledii, HHS (FAST katlmcs) tarafndan dorulanm Kolay Adres deeridir. Alabilecei deerler BKM Kolay Adresleme Sistemi Uygulama Kurallar belgesinde tanmldr.  Alc Hesap Numaras girilmediyse kullanm zorunludur ve  Kolay Adres Tipi  alanyla birlikte kullanlr. \n \n \n >>> Kolas Referans Numaras \n kolasRefNo \n N12 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml KOLAS tarafndan ilgili sorguya zel olarak retilmi referans numarasdr. \n \n \n >>> Kolas Hesap Tr \n kolasHspTur \n AN1 \n Z \n Kolay Adres Alc Sorgusunda baarl sorgu sonucunda dnlen, BKM Kolay Adresleme Sistemi Uygulama Kurallarnda tanml hesap tr bilgisidir:   TR.OHVPS.DataCode.KolasHspTur  sral veri deerlerinden birini alr. \n \n \n > Karekod \n kkod \n Kompleks:Karekod \n K \n \n \n \n >> Ak Tr \n aksTur \n AN2 \n Z \n Karekod Ak Tr Karekod demesinin hangi akla gerekletirildiini gsterir.  Kolay Adresi Sistemi ile birlikte kullanlmaz.  01: FAST katlmcsndan dinamik dorulama hizmeti alnan iyeri demesi  02: FAST katlmcsndan statik dorulama hizmeti alnan iyeri demesi 03: Kiiden kiiye demeler \n \n \n >> Referans \n kkodRef \n AN1..12 \n K \n Karekod referans numarasn gsterir.  Okunan karekodda referans deeri varsa kullanlmas zorunludur. Kolay Adresi Sistemi ile birlikte kullanlmaz. \n \n \n >> retici Kodu \n kkodUrtcKod \n AN4 \n Z \n Karekod reticisinin kodu.  deme Hizmeti Salayclar ve TCMB tarafndan uygun grlen deme sistemi ileticisi TR Karekod retebilmek iin BKMye kayt bavurusu yaparak karekod retici kodu alabileceklerdir. Bankalar EFT kodlarn kullanacak olup ayrca kayt yaptrmalarna gerek bulunmamaktadr. 4 haneden ksa deerlerin sol taraf 0 karakteri ile tamamlanmaldr. \n \n \n > deme Ayrntlar \n odmAyr \n Kompleks: OdemeAyrintilari \n Z \n \n \n \n >> deme Kayna \n odmKynk \n AN1 \n Z \n demenin balatld kayna belirtir.  TR.OHVPS.DataCode.OdemeKaynak  sral veri deerlerinden O  deerini alr. O deeri Ak bankaclk aracl ile gnderilen demelerde kullanlr. anlamn tamaktadr. \n \n \n >> deme Durumu \n odmDrm \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeDurumu  sral veri deerlerinden birini alr.      deme Durumu alan ile ilgili olarak HHSler tarafndan YSlere  OdemeEmri servisi yantnda 02:Gnderildi, 04:Onayda Bekliyor,05:leme Alnd yantlar gnderilebilir.   05:leme Alnd  durumu YS tarafndan mteriye gsterilmeyen bir koddur. Bu kod dnldnde YS uygulamasnda HKya deme durumu  02:Gnderildi  olarak gsterilir. lemin son durumunun teyidi iin YS deme emri sorgulamas yapmaldr.   02:Gnderildi  durumu olutuktan sonra YS tarafndan deme emri sorgulamas yaplarak deme durumunun gncel deeri renilir. Gncel deerler  01:Gerekleti,03:Gereklemedi  durumlar olabilir. \n \n \n >> deme Amac \n odmAmc \n AN2 \n Z \n TR.OHVPS.DataCode.OdemeAmaci  sral veri deerlerinden birini alr. \n \n \n >> Referans Bilgisi \n refBlg \n AN1..140 \n K \n demeye zel  Referans Bilgisi  alandr. Karekod ilemi deil ise zorunludur.  -\tKiiden kiiye fon aktarmlarda: Gn ierisinde HK zelinde, her ileme zel biricik olarak oluturulan referans bilgisidir.  Karekod P2P ak iin referans bilgisi (Karekod referans numaras deil, ileme zel retilecek referans bilgisidir.) YS tarafndan atanacaktr.  -\tE-ticaret ilemlerinde sipari/takip numaras/mteri/abone numaras  - yeri demesi Karekod aknda, FAST Karekod Veri Organizasyonundaki  -\t62-01: alannda tanml Fatura Numaras   -\t62-06: alannda tanml Mteri Numaras   verilerinden biri kullanlr. \n \n \n >> Aklama \n odmAcklm \n AN1..200 \n  \n BHSnin HKdan ald ya da kendisinin atad ilem aklamas bilgisi.  FAST/PS sistemi zerinden yaplan demeler iin aklama bilgisi girilirse boluk karakteri girilerek geilemez. En az bir alfasaysal karakter girilmesi zorunludur. \n \n \n >> HK Mesaj Alan \n ohkMsj \n AN1..200 \n  \n HHSnin HKya gstermek zere ilettii mesaj. \n \n \n >> deme Sistemi \n odmStm \n AN1 \n Z \n TR.OHVPS.DataCode.OdemeSistemi  sral veri deerlerinden birini alr. \n \n \n >> deme Sistem Numaras \n odmStmNo \n AN10..50 \n K \n deme baarl balatldysa, demenin balatld sistemdeki referans numaras. Gerektiinde ilgili deme sisteminde/HHSde sz konusu demeye karlk gelen mesajla balant kurmada kullanlr.   deme Hizmeti kullancsna ilemin takibi iin gsterilebilir.  lemin ynlendirildii deme sistemi FAST ya da PS ise sistemdeki ilgili mesajn Tarih, GnderenKatilimKodu ve SorguNumarasi deerlerinin birleiminden oluur. Bu 3 alan mevcutta kullanld formatta aralarna dikey izgi (Unicode U+2223) iareti koyularak, birletirmeli ve iletilmelidir. rn : Tarih|GnderenKatilimKodu|SorguNumarasi   deme Havale/Virman ilemi ise HHSnin retmi olduu havale/virman numarasn ierir. Buradaki format da Tarih|GnderenKatilimKodu|Havale-virman numaras eklinde olmaldr. Havale/FAST/PS  deme yntemleri iin tarih alan yyyy-aa-gg formatnda 10 karakter olarak iletilmelidir. \n \n \n >> Beklenen deme Zaman \n bekOdmZmn \n ISODateTime \n K \n lemin ynlendirildii deme sistemi PS ise ve PS ilem saatleri dnda ise ilemin yaplabilecei ilk zaman bilgisi \n \n \n yeri deme Bilgileri \n isyOdmBlg \n Kompleks:IsyeriOdemeBilgileri \n K \n yeri demelerinde kullanlabilecek alanlardr. Karekodlu iyeri demesi aknda bu alanlar dolu geldii iin istee bal olarak gnderilebilir. isyOdmBlg alanlarnn en az birinin dolu olmas durumunda yantta yer alr. \n \n \n > yeri Kategori Kodu \n isyKtgKod \n AN4 \n K \n lemin, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). deme Amac = 06 ya da 04 olan deme ilemleri iin doldurulabilir. \n \n \n > Alt yeri Kategori Kodu \n altIsyKtgKod \n AN4 \n K \n lem alt iyerinden gerekletiriliyorsa, ISO 18245:2003 uyumlu yeri Kategori Kodudur (Merchant Category Code, MCC). \n \n \n >ye  Yeri Tekil Kimlik \n genelUyeIsyeriNo \n AN8 \n K \n yeri kayt sisteminde kaytl yeri iin BKM tarafndan retilmi olan genel iyeri numarasdr (GlobalMerchantId) 8 haneden kk gnderiminde baa 0 eklenmelidir. rnek deer 01630618 \n 6.6.\tADIM 3.1- deme Emri Sorgusu (stee bal) \n   \n ekil 9: deme Emri Sorgusu \n GET /odeme-emri/{odemeEmriNo} \n BHS, bu eriim adresi araclyla deme emrini sorgulayabilir. \n BAARILI YANIT: \n GET /odeme-emri/{odemeEmriNo} yantnn (RESPONSE) gvdesinde (BODY)  OdemeEmri nesnesi bulunur. stek baaryla sonulanrsa HHS kaynak sunucusunda Tablo-10da yer alan parametreleri ieren OdemeEmri nesnesi dner. \n \n stek balnda yer alan X-Access-Token ile ilikili rzada, yer alan odemeEmriNo iin, deme emri sorgusundaki odemeEmriNo bilgisinin ayn olup olmad kontrol edilir. Farkl olmas durumunda  \"TR.OHVPS.Resource.NotFound\"  hatas dnlr. \n Sorgulama yaplan deme emri numaras HHS tarafnda bulunmuyor ise  \"TR.OHVPS.ResourceNotFound\"  hatas dnlr. \n \n"},{frontmatter:{},regularPath:"/v2.0.0/contents/tanim-ve-kisitlamalar.html",relativePath:"v2.0.0/contents/tanim-ve-kisitlamalar.md",key:"v-bfbd2b46",path:"/v2.0.0/contents/tanim-ve-kisitlamalar.html",content:"  1.\tTanm ve Ksaltmalar   \n Tablo 1: Tanm ve Ksaltmalar \n \n \n \n Ksaltma \n Tanm \n Aklama \n ngilizce Aklama \n ngilizce Ksaltma \n \n \n \n \n S \n ereve Szleme \n deme hizmeti salaycs ile mteri arasnda tekil veya sreklilik arz eden deme ilemlerinin yrtlmesine ve mmkn olan durumlarda deme hesabnn almasna ilikin usul ve esaslar belirleyen szleme \n \n \n \n \n EPK \n Elektronik Para Kuruluu \n Kanun kapsamnda elektronik para ihra etme yetkisi verilen tzel kii \n Electronic Money Institution \n EMI \n \n \n FAST \n Fonlarn Anlk ve Srekli Transferi \n TCMB tarafndan iletilen Fonlarn Anlk ve Srekli Transferi Sistemi \n \n \n \n \n FAST TR-Karekod \n FAST-TR Karekod Teknik lke ve Kurallar Rehberi \n TR Karekodun FAST Sistemi araclyla gerekleecek ilemlerde kullanlmasna ilikin detayl teknik ilke ve kurallarn ieren dokman \n \n \n \n \n GET \n BKM API Geidi \n Bankalararas Kart Merkezi (BKM) tarafndan gelitirilen ve taraflara standart Ak Bankaclk ilemleri sunulmasn salayan API Geidi uygulamas \n \n \n \n \n GKD \n Gl Kimlik Dorulama \n Kimlik dorulamada kullanlan ve bir bileenin ele geirilmesinin dier bileenin gvenliini tehlikeye atmayaca en az iki bileenden oluan, bu iki bileenin de mterinin bildii, sahip olduu veya biyometrik bir karakteristii olan bileen snflarndan farkl ikisine ait olacak ekilde seildii yntem \n Strong Customer Authentication \n SCA \n \n \n B \n lem Bilgisi \n Gerekletirilen ileme ilikin ilem zamann, ilemin niteliini ve deme ilemi iin deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve demenin gndereni ile alcsn veya toplu deme emrinin masraf, komisyon ve cretler de dahil hesabn borlandrlaca toplam tutarn ve gndereni ile alclarn ieren bilgi \n \n \n \n \n DK \n lem Dorulama Kodu \n Kimlik dorulama yntemlerinden biriyle kendisini sisteme tantan bir mterinin gerekletirmek istedii ileme zg olmak ve belirli bir geerlilik sresi iinde ilem onaynda kullanlmak zere oluturulan, finansal sonu dorunan ilemlerde kiiye onay annda ilgili ilem bilgisi (B) ile birlikte gsterilen, alc veya tutarn deimesiyle geersiz hale gelen bilgi \n Authentication Code \n AC \n \n \n KOLAS \n Kolay Adresleme Servisi \n Fon transferlerinde hesap numaras ile ad soyad yerine kullanlan ve belirli bir hesap ile eletirilmi telefon numaras, e-posta adresi, T.C. Kimlik Numaras (TCKN), Vergi Kimlik Numaras (VKN), Yabanc Kimlik Numaras veya Pasaport Numaras gibi Kolay Adres bilgilerinin kaydedilmesini, gncellenmesini ve sorgulamasn salayan katman servis \n \n \n \n \n HBHS \n Hesap Bilgisi Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (g) bendinde tanmlanan deme hizmetini (hesap bilgisi hizmetini) sunan tzel kii \n Account Information Service Provider \n AISP \n \n \n HHS \n Hesap Hizmeti Salaycs \n Nezdinde deme hesab bulunan deme hizmeti salaycs \n Account Servicing Payment Service Provider \n ASPSP \n \n \n BHS \n deme Emri Balatma Hizmeti Salaycs \n Kanunun 12 inci maddesinin birinci fkrasnn (f) bendinde tanmlanan deme hizmetini (deme emri balatma hizmetini) sunan tzel kii \n Payment Initiation Service Provider \n PISP \n \n \n DK \n deme Kuruluu \n deme hizmeti salamak ve gerekletirmek iin Kanun kapsamnda yetkilendirilmi tzel kii \n Payment Institution \n PI \n \n \n H \n deme Hesab \n deme hizmeti kullancs adna alan ve deme ileminin yrtlmesinde kullanlan hesap \n Payment Account \n PA \n \n \n HK \n deme Hizmeti Kullancs (Mteri) \n Gnderen, alc veya her ikisi sfatyla belirli bir deme hizmetinden faydalanan gerek veya tzel kii \n Payment Service User \n PSU \n \n \n HS \n deme Hizmeti Salaycs \n 5411 sayl Kanun kapsamndaki bankalar, EPK, DK ve Posta ve Telgraf Tekilat Anonim irketi(PTT) \n Payment Service Provider \n PSP \n \n \n HVPS \n deme Hizmetleri Veri Paylam Servisleri \n Kanunun 12nci maddesinin birinci fkrasnn (f) veya (g) bentlerinde yer alan deme hizmetlerinde kullanlan veri paylam servisleri \n \n \n \n \n PS \n Perakende deme Sistemi \n TCMB tarafndan iletilen, ilemlerin Trk Liras zerinden gerekletii Mteriler Aras Trk Liras Aktarm Sistemi \n \n \n \n \n TR-Karekod \n TR-Karekod lke ve Kurallar \n Ulusal karekod (TR Karekod) ilke ve kurallarnn belirlendii belge \n \n \n \n \n YS \n Yetkili deme Hizmeti Salaycs \n deme emri balatma hizmeti ve/veya hesap bilgisi hizmeti sunan tzel kii \n Third Party Payment Service Providers \n TPP \n \n \n \n"},{title:"3. Temel Prensipler",frontmatter:{},regularPath:"/v2.0.0/contents/temel-prensipler.html",relativePath:"v2.0.0/contents/temel-prensipler.md",key:"v-9f53f9d6",path:"/v2.0.0/contents/temel-prensipler.html",headers:[{level:2,title:"3.1 Genel",slug:"_3-1-genel"},{level:2,title:"3.2.\tstem (ar) ve Oturum",slug:"_3-2-istem-cagr-ve-oturum"},{level:2,title:"3.3.\tRESTful API",slug:"_3-3-restful-api"},{level:2,title:"3.4.\tSrm Ynetimi",slug:"_3-4-surum-yonetimi"},{level:2,title:"3.5.\tKaynak URI Yol Yaps",slug:"_3-5-kaynak-uri-yol-yaps"},{level:2,title:"3.6.\tKarakter Kodlama",slug:"_3-6-karakter-kodlama"},{level:2,title:"3.7.\tVeri Format",slug:"_3-7-veri-format"},{level:2,title:"3.8.\tstemci Sertifika Ynetimi",slug:"_3-8-istemci-sertifika-yonetimi"},{level:2,title:"3.9.\tYetkilendirme Trleri",slug:"_3-9-yetkilendirme-turleri"},{level:2,title:"3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar",slug:"_3-10-istek-cevap-mesajlarnda-kullanlan-nesne-yaplar"},{level:2,title:"3.11. Sayfalandrma ve Filtreleme",slug:"_3-11-sayfalandrma-ve-filtreleme"},{level:2,title:"3.12. Mesaj mzalama",slug:"_3-12-mesaj-imzalama"},{level:2,title:"3.13. Durum Kodu",slug:"_3-13-durum-kodu"},{level:2,title:"3.14. Gereksinimlerinin Snflandrlmas",slug:"_3-14-gereksinimlerinin-snflandrlmas"},{level:2,title:"3.15. stek Bal",slug:"_3-15-istek-baslg"},{level:2,title:"3.16. Yant Bal",slug:"_3-16-yant-baslg"},{level:2,title:"3.17. Idempotency Kurallar",slug:"_3-17-idempotency-kurallar"},{level:2,title:"3.18. HTTP Durum Kodlar",slug:"_3-18-http-durum-kodlar"},{level:2,title:"3.19. Maskeleme Kurallar",slug:"_3-19-maskeleme-kurallar"},{level:2,title:"3.20. Fonksiyonel Olmayan Gereksinimler",slug:"_3-20-fonksiyonel-olmayan-gereksinimler"},{level:2,title:"3.21. Otomatik Sorgular",slug:"_3-21-otomatik-sorgular"}],content:' 3. Temel Prensipler  \n Bu blmde deme Hizmetleri Veri Paylam Servisleri (Hesap Bilgisi Hizmeti, deme Emri Balatma Hizmeti) iin tanmlanan temel prensipler aklanmaktadr. \n 3.1 Genel \n \n \n HHSler Ynetmeliin 59. maddesinin beinci fkras ve deme ve Elektronik Para Kurulularnn Bilgi Sistemleri ile deme Hizmeti Salayclarnn deme Hizmetleri Alanndaki Veri Paylam Servislerine likin Tebliin (Tebli) 23. maddesinin birinci fkras uyarnca, deme hizmetleri veri paylam servislerini GET araclyla HBHS ve BHSye sunmakla ykmldr. \n \n \n Tebliin 23. maddesinin ikinci fkras uyarnca deme emri balatma hizmetinde ak iletiim servisinin taraflar BHS ile HHSdir. \n \n \n Tebliin 23. maddesinin nc fkras uyarnca hesap bilgisi hizmetinde ak iletiim servisinin taraflar HBHS ile HHSdir. \n \n \n Ynetmeliin 60. maddesinin birinci fkras uyarnca mteri, deme emri balatma hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Ynetmeliin 61. maddesinin birinci fkras uyarnca mteri, hesap bilgisi hizmetini  deme hesabnn evrim ii olarak eriilebilir olduu durumlarda , kullanmay tercih edebilir. \n \n \n Tebliin 25. maddesi uyarnca HHS ve YS (BHS ve HBHS) arasnda balant utan uca gvenli bir ekilde salanr. Bu amala iletim katmannda TLS (asgari 1.2 srm) ile ifreli iletiim salanr. \n \n \n Tebliin 23. maddesinin drdnc fkras uyarnca HHS tarafndan sunulan deme hizmetleri veri paylam servislerini kullanan yetkilendirilmi deme hizmeti salayclarnn TCMB tarafndan ilgili deme hizmeti iin yetkilendirilmi olduu kontrol edilir. \n \n \n Tebliin 25. maddesinin beinci fkras uyarnca zaman damgas, 15/1/2004 tarihli 5070 sayl Elektronik mza Kanunu kapsamnda tanmlanan zaman damgasna dayanr. \n \n \n API alan isimleri Trke olarak tanmlanmtr. Ancak API bal (header) alanndaki alan isimleri zelinde, API Geitleri tarafndan otomatik olarak tannabilmesi gzetilerek, ngilizce isimlendirme tercih edilmitir. \n \n \n HK halihazrda deme hesaplarna, evrim ii (mobil bankaclk, internet bankacl vb.) eriebilir durumda ise, HHS\'nin varsa Ak Bankaclk kanal veya yetki tanmn varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. HHSnin, Bireysel/Kurumsal/Ticari mteri ayrm yapmakszn tm mterileri iin, evrim ii kanallarda hesap hareketlerine eriim ve deme yapabilme yetkisi bulunmas durumunda, yine ayn ekilde Ak Bankaclk kanal veya yetki tanmn da varsaylan deeri AIK olacak ekilde sunmas gerekmektedir. HHS Ak Bankaclk hizmetini kanal/yetki tanm ile ynetmesi durumunda hizmeti verdii ilgili kanallar(web,mobil) zerinden mterisine Ama/Kapama olana eklinde sunmas gerekmektedir. \n \n \n 5411 Sayl Kanun kapsamndaki bankalar, HHS API ierisinde Aktif durumda listelenmemiken, YS API ierisinde listelenemezler. \n 3.2.\tstem (ar) ve Oturum \n \n \n Her istek tekil istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Birden fazla istek ieren ilem YS tarafndan belirlenen arya zg talep kimlii (istek numaras: X-Request-ID) ve rza srecine zg talep kimlii (ilem grup numaras: X-Group-ID) deerleri kullanlmaldr. Ayn rza noya ait tm isteklerde ayn X-Group-ID bilgisi deeri gnderilmelidir. \n \n \n Oturum takibi ise PSU-Session-ID ile yaplr. Oturum numaras (PSU-Session-ID) HKl ilemler iin zaman damgas (PSU-Timestamp) ile birlikte ilgili tm ilem verilerini ierecek ekilde kayt altna alnr. \n \n \n rnein, bir deme emri balatma ilemi birden fazla istekten oluur. Her istek yukarda belirtildii gibi biricik istek numaras ve HKl ilemler iin zaman damgas (PSU-Timestamp) ierir. Ancak ilemin oturum btnl PSU-Session-ID ile salanr. \n \n \n Taraflar atklar oturumu ilem btnln salayacak sre ierisinde ak tutar ve ilem biter bitmez kapatr. \n 3.3.\tRESTful API \n APIler, dnya leinde yaygn bir ekilde kullanlan Temsili Durum Transferi (Representational State Transfer, REST) mimari tarz ve JavaScript Nesne Notasyonu (JavaScript Object Notation, JSON) veri formatlarna uygun olarak gelitirilir. En st seviye Veri Tanmlama Dili (Data Description Language) ve en iyi uygulama rnekleri iin  ^JSON emas  temel alnr. \n stek ve yant mesajlarnda, istee bal veya koullu bir alan, deer iermiyorsa, bu alan JSON payloadunda yer almamaldr. \n rnek kod blou. \n "rzBlg":{\n         "rizaNo":"aa9bd7e7-0ccd-4edc-9639-5a358dbf2335",\n         "olusZmn":"2022-11-28T12:00:21+03:00",\n         "gnclZmn":null,    --\x3e hatal\n         "rizaDrm":"K",\n         "rizaIptDtyKod":"" --\x3e hatal \n      },\n \n rnek kod blou: \n \n         "alc":{\n            "hspNo": "TR800800004162387689546019",\n            "unv": "AHMET YILMAZ", \n            "kolas":{}  --\x3e nesne gnderimi hatal\n         },\n 3.4.\tSrm Ynetimi \n API sonraki aamalarda doabilecek gereksinimleri ve daha karmak kullanm durumlarn karlamak iin srmler halinde gelitirilir ve bu durum tasarm srasnda gz nnde bulundurulur. \n API v1.0.2 srmnde ; \n \n Kapsamdaki deme hesaplar : Vadesiz TL, yabanc para hesaplar (gerek ve tzel kiilere ait deme hesaplar), Kredili Mevduat Hesab \n Tekil deme (Virman/Havale/FAST/Mterileraras TL Aktarm Sistemi)\n \n Virman ve havale ilemleri kapsamnda yabanc para transferi yaplabilir. \n \n \n Hesap bilgisi hizmetleri\n \n Temel veya ayrntl hesap bilgisi \n Bakiye \n Gerekleen ilemler iin Hesap hareketleri \n \n \n Karekodlu demelerdeki 01, 02 ve 03 ak trleri\nyer almaktadr. \n \n API v1.1.0 srmnde ; \n \n \n API v1.0.2 srmne ek Olay Bildirim ve Ayrk GKD zellikleri eklenmitir. Srelerin daha iyi ilemesi iin eitli gncellemeler yaplmtr. \n \n \n API v2.0 srmnde ileri tarihli deme emri, dzenli deme emri, hesap bilgisi hizmeti ierisinde kart hizmetleri, YS zerinden rza gncelleme hizmetine dair gncellemeler eklenmitir. \n \n \n Her srm deiikliinde bir nceki srm belirli bir sre desteklenecektir. Dier bir ifadeyle, sadece belirli bir sre iin mevcut ve bir nceki srm ayn anda eriilebilir olacaktr. \n 3.5.\tKaynak URI Yol Yaps \n YSlerin balatt arlarda URI yolu aadaki yapy takip eder: \n [hhs-yol-n-eki]/ohvps/ [kaynak-grubu]/ [srm]/ [kaynak]/[kaynak-no]/[alt-kaynak] \n Bu, aadaki unsurlardan oluur: \n \n [hhs-yol-n-eki] \nstee bal, HHS\'ye zg yol n ekini ifade eder. \nGET zerinden yaplan arlarda BKM tarafndan belirlenen sistem ad ve yol n eki kullanlr. \n ohvps \nSabit metin ohvps (deme Hizmetleri Veri Paylam Servisleri ksaltmas) \n [kaynak-grubu] \nKaynak grubu, APIye erimek iin kullanlan deme hizmetine (HBH, BH) gre eriim adresi (end point) grubunu tanmlar (hbh veya obh). \n [srm] \nAPI srmn ifade eder (/s[ana-srm].[alt-srm]/). \n [kaynak]/[kaynak-no] \nKaynak detaylarn ifade eder. \n [alt-kaynak] \nAlt kaynak detaylarn ifade eder. \n \n HHS, tm kaynaklar iin ayn katlmc yolu n ekini ve sistem adn kullanmaldr. \n BKM APIlerine erimek isteyen uygulamalarn yetkilerine gre aadaki APIlere abone olmalar gerekmektedir: \n OBH: \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s2.0/odeme-emri-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s2.0/odeme-emri \nHBH: \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesap-bilgisi-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesaplar \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesaplar/1234/islemler \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesaplar/1234/bakiye \nGKD \n https://gecit-api.bkmtest.com.tr/ohvps/gkd/s2.0/erisim-belirteci \nHHS  YS API \n https://gecit-api.bkmtest.com.tr/hhs-api/s2.0/hhs \n https://gecit-api.bkmtest.com.tr/hhs-api/s2.0/hhs/1234 \n https://gecit-api.bkmtest.com.tr/yos-api/s2.0/yos \n https://gecit-api.bkmtest.com.tr/yos-api/s2.0/yos/1234 \n HHSlerin salayacaklar APIlerdeki URI evrimi rnekleri aadaki gibidir. \n \n https://xbank.com.tr/api-portal/ohvps/obh/s2.0/odeme-emri \n https://gecit-api.bkmtest.com.tr/ohvps/obh/s2.0/odeme-emri  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s2.0/hesap-bilgisi-rizasi \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesap-bilgisi-rizasi  (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s2.0/hesaplar \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesaplar   (BKM API) \n https://xbank.com.tr/api-portal/ohvps/hbh/s2.0/hesaplar/1234 \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesaplar/1234  (BKM API) \n \n GET zerinden yaplan arlarda, istek balnda bulunan x-aspsp-code (istein iletildii Hesap Hizmeti Salaycsnn kodu) deerine gre HHS APIde standart olarak tanmlanm olan basePath bilgisine servis uzants eklenerek HHSye ynlendirme yaplr. \n rnein, istek balnda  xbank n kodu varsa, YS tarafndan yaplan \n https://gecit-api.bkmtest.com.tr/ohvps/hbh/s2.0/hesap-bilgisi-rizasi \nars GET tarafndan karlanarak \n https://xbank.com.tr/api-portal/ohvps/hbh/s2.0/hesap-bilgisi-rizasi \nadresine ynlendirilir. \n Bu rnekte,  https://xbank.com.tr/api-portal  basePath bilgisi HHS tarafndan HHS APIye girilen deerdir. \n NEML :  URI Query parametreleri GET ile iletilirken deerlerde url-encode yaplmaldr. rnek bir API istei; \nGET /ohvps/hbh/s2.0/hesaplar/xxx/islemler?hesapIslemBslTrh=2023-02-07T16:42:38%2B03:00&hesapIslemBtsTrh=2023-02-07T17:09:18%2B03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfKytSayi=10&syfNo=1 \n Burada \'+\' karakterinin boluk olarak alglanmamas iin %2B deeri ile iletilmitir. \n 3.6.\tKarakter Kodlama \n API istekleri ve yantlarnn  Balk  parametrelerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr.  3.15. stek Bal  blmnde detaylandrlmtr. \n API istekleri ve yantlarnda  Gvde  parametrelerinde UTF-8 karakter kodlamas kullanlr. Bu, JSON iin varsaylan karakter kodlamasdr. \n Ancak, bir HHS\'nin kendi uygulamalar ve deme balatt deme sistemi (Havale vb.) baz UTF-8 karakterlerini kabul etmeyebilir. HHS, UTF-8 kodlamas ieren bir mesaj ileyemez ve reddederse, HTTP 400 (Hatal stek) durum kodu ile yant vermelidir. \n HVPS kapsamnda iletilen deerler ierisinde ilenemeyecek karakterler var ise  "TR.OHVPS.Business.InvalidCharacter"  hatas verilir. \n Gvde parametrelerinde desteklenen UTF-8 karakter kmesi aada listelenmitir. \n \n \n \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n Karakter \n UTF 8   Hex. \n \n \n \n \n \n 20 \n = \n 3d \n X \n 58 \n r \n 72 \n \n \n ! \n 21 \n ? \n 3f \n Y \n 59 \n s \n 73 \n\n 23 \n @ \n 40 \n Z \n 5a \n t \n 74 \n \n \n % \n 25 \n A \n 41 \n [ \n 5b \n u \n 75 \n \n \n & \n 26 \n B \n 42 \n \\ \n 5c \n v \n 76 \n \n \n \' \n 27 \n C \n 43 \n ] \n 5d \n w \n 77 \n \n \n ( \n 28 \n D \n 44 \n ^ \n 5e \n x \n 78 \n \n \n ) \n 29 \n E \n 45 \n _ \n 5f \n y \n 79 \n \n \n * \n 2a \n F \n 46 \n a \n 61 \n z \n 7a \n \n \n + \n 2b \n G \n 47 \n b \n 62 \n { \n 7b \n \n \n , \n 2c \n H \n 48 \n c \n 63 \n } \n 7d \n \n \n - \n 2d \n I \n 49 \n d \n 64 \n  \n c3 87 \n \n \n . \n 2e \n J \n 4a \n e \n 65 \n  \n c3 96 \n \n \n / \n 2f \n K \n 4b \n f \n 66 \n  \n c3 9c \n \n \n 0 \n 30 \n L \n 4c \n g \n 67 \n  \n c3 a7 \n \n \n 1 \n 31 \n M \n 4d \n h \n 68 \n  \n c3 b6 \n \n \n 2 \n 32 \n N \n 4e \n i \n 69 \n  \n c3 bc \n \n \n 3 \n 33 \n O \n 4f \n j \n 6a \n  \n c4 9e \n \n \n 4 \n 34 \n P \n 50 \n k \n 6b \n  \n c4 9f \n \n \n 5 \n 35 \n Q \n 51 \n l \n 6c \n  \n c4 b0 \n \n \n 6 \n 36 \n R \n 52 \n m \n 6d \n  \n c4 b1 \n \n \n 7 \n 37 \n S \n 53 \n n \n 6e \n  \n c5 9e \n \n \n 8 \n 38 \n T \n 54 \n o \n 6f \n  \n c5 9f \n \n \n 9 \n 39 \n U \n 55 \n p \n 70 \n \n \n \n \n : \n 3a \n V \n 56 \n q \n 71 \n \n \n \n \n ; \n 3b \n W \n 57 \n \n \n \n \n \n \n \n Ancak  Eriim belirteci, Yenileme belirteci ve Authorization  parametreleri daha dar bir karakter kmesi ile doldurulmaldr. \n Bearer HTTP Authorization emas RFC 6750\'de tanmlanmtr.  https://www.rfc-editor.org/rfc/rfc6750#section-2.1  blmnde izin verilen karakterlerin gnderilmesi beklenmektedir. Buradaki standartn her 3 parametre iin de uygulanmasna karar verilmitir. \n RFC 6750 ierisinde bearer token format u ekildedir : 1*( ALPHA / DIGIT / "-" / "." / "_" / "~" / "+" / "/" ) *"=" \nAugmented BNF for Syntax Specifications (ABNF) ile ifade edilen bu formatta token en az 1 adet alfanumerik karakter veya zel karakter ("-", "." , "_" , "~" , "+" , "/")  iermeli ve 0 ya da daha ok sayda "=" karakteri ile bitmelidir. \n ALPHA = A-Z / a-z aralndaki harflerdir. \nDIGIT = 0-9 aralndaki rakamlardr. \n 3.7.\tVeri Format \n \n Ak bankaclk kapsamndaki zaman damgas, ISO 8601 standartna uygun olarak yerel saat bilgisini ve timezone bilgisini de ierecek ekilde " yyyy-MM-ddTHH:mm:ssXXX " formattaki haliyle hazrlanmaldr. \n \n rnek:  "timestamp": "2021-05-30T20:34:15+03:00" \nyyyy : 4 hane yl \nMM : Baa 0 eklenmi, toplam 2 hane ay \ndd    : Baa 0 eklenmi, toplam 2 hane gn \nHH    : Baa 0 eklenmi, toplam 2 hane saat (0-23 aras deer alabilir.) \nmm : Baa 0 eklenmi, toplam 2 hane dakika \nss    : Baa 0 eklenmi, toplam 2 hane saniye \nXXX : ISO 8601 Time zone \n \n \n Zaman damgas hesaplamalarnda, yeni gnn balang saatinin 00:00:00 olduu kabul edilmitir. \n \n \n JWT veri paketlerinde kullanlan zaman damgalar, 1 Ocak 1970 Saat 00:00:00 (UTC) anndan itibaren geen saniye says deerini (Unix Time) kullanmaldr. \n \n \n Bir HHS, tarihi yanl biimlendirilmi bir istek aldnda, 400 (Hatal stek) durum kodu ve ilgili hata kodu ile yant vermelidir. \n \n \n ISO 4217 Standartnda para birimleri ve ka basamak ondalk deer ierebilecekleri belirlenmitir. \n https://www.iso.org/iso-4217-currency-codes.html   adresinden cretsiz olarak listeye eriilebilir.  \nAPI Standartlarnda da para birimleri  ISO 4217de tanmlanm olan 3 harfli kodlarla iletilir.   Tm tutar alanlar ISO 4217\'de tanmlanm para birimlerinin ondalk basamak deerleri de gz nnde bulundurularak iletilmelidir. Tutar alanlar art ya da eksi deer alabilecei iin API deseninde tanmlanm regular expressionlar dikkate alnmaldr. \nrnein; Bakiye API\'sindeki "Kredili Mevduat Hesab Bakiyesi" alan "-100.25" ve "Para Birimi" alan "TRY" olarak iletildiinde 25 deerinin kuru olduu anlalmaldr. \ndeme Emri Rzas API\'sinde yer alan "lem Tutar" alan "104.75" TRY olarak iletildiinde "75" deerinin kuru olduu anlalmaldr. \n"12000" Japon Yeni iin, ISO 4217de JPY para biriminin ondalk ksm olmadndan "lem Tutar" alannda "12000" ve "Para Birimi" alannda "JPY" deeri  iletilmelidir. \n \n \n Altn para birimi zelinde ISO 4217ye uygun olarak "XAU" cinsinde ve 2 basamak ondalk rakam ierecek ekilde iletilmelidir. rnein ierisinde "13,50 gr" altn olan hesap iin bakiye "13.50", para birimi "XAU" olarak gnderilmelidir. \n \n \n Dier madenlerde ondalk basamak ISO 4217 standartnda tanmland gibi olmaldr. \n \n \n Sral veri tipleri byk kk harfe duyarl olmaldr. \n 3.8.\tstemci Sertifika Ynetimi \n HVPS kapsamnda YS ve HHSlerin gvenli bir ekilde tanmlanmas amacyla elektronik sertifikalar kullanlr. \n HVPS kapsamnda taraflarn gvenli bir ekilde tanmlamas, utan uca gvenli iletiim, mesaj ifreleme ve mesaj imzalama ilevleri 15/1/2004 tarihli ve 5070 sayl Elektronik mza Kanununda aklanan elektronik sertifikalar kullanlarak salanr. Elektronik sertifikada Trkiye Cumhuriyet Merkez Bankas tarafndan verilen kurulu kodu ve kuruluun trne dair bilgiler bulunur. \n GET zerinden yaplan eriimlerde YS ve HHSlere nceden datlm olan istemci sertifikalar kullanlarak taraflarn (sunucu) kimliklerinin dorulanmas salanacaktr. stemci sertifikalar hem test hem de retim ortamnda kullanlacaktr. Sertifikalarn ilevsellii ve geerlilii sertifikasyon srecinde de snanacaktr. Sz konusu sertifikalarn datm prosedrleri ve kullanmlara ynelik aklamalar EK-3te yer verilmitir. \n 3.9.\tYetkilendirme Trleri \n GET zerinden yaplan arlarda iki temel yetkilendirme tr kullanlr: \n 1.\tstemci Kimlik Bilgileri:  Mteri onaynn gerekmedii, sadece YSn tanmlanp doruland API arlarnda kullanlr. YSn yetkilendirilmi olduu ve faaliyet izninin yapt hizmet arsna uygun olduu kontrol edilir.  Bu amala, YSlere clientId ve clientSecret tahsis edilecektir. YSler ilgili clientId ve clientSecret ile sadece yetkilendirilmi olduklar servislere eriebileceklerdir. YSler kendilerine BKM tarafndan sunulacak APIyi, kendi clientID ve clientSecret deerleri ile sorgulayarak stemci Kimlik Bilgileri belirtecini (access token) elde edeceklerdir.\nHHSler de GET zerindeki YS APIsini sorgulama maksad ile GET\'e geldiklerinde, kendilerine atanm olan clientID ve clientSecret bilgileri ile yetki kontrolleri yaplr.\nHHS ve YSler ; ilettikleri client id ve secret deerleri kullanlarak oluturulacak bearer authentication metodu ile servislerini sunacaklardr. \n 2.\tYetkilendirme Kodu:  YSn dorulanmasnn yansra mterinin GKD ile dorulanmas gereken API arlarnda kullanlr. Mteri dorulanarak yetkilendirme kodu oluturulmas HHSnin yetkilendirme arayzne ynlendirilir. GKDnin baaryla tamamlanmas sonrasnda yetkilendirme kodu YSe dnlr. YS daha sonra HHSnin  eriim belirteci  (access token) eriim adresini (EK-3: POST /erisim-belirteci) armak suretiyle yetkilendirme kodunu bir eriim belirteci (access token) ile deitirerek ilgili kaynaklar kullanabilir. \n deme emri balatma ve hesap bilgisi hizmetlerinde hangi yetkilendirme trlerinin kullanlaca bilgisi, ilgili balklardaki eriim adresleri (endpoints) tablolarnda yer almaktadr. \n erisim-belirteci  erisim noktasndan elde edilen  erisimBelirteci  ilikilendirildii nesne veya ilem iin gnderilen POST istei balnda  x-access-token  alannda iletilir.\nBelirli bir sre iin tanmlanan eriim belirteci (access token) deerinin yenileme belirteci (refresh token) ile yenilenmesi gerekir. \n Eriim adreslerinde kullanlan yetkilendirme tr ilgili eriim adresi tablolarnda belirtilmitir. \n 3.10. stek/Cevap Mesajlarnda Kullanlan Nesne Yaplar \n stek ve Cevap mesajlarnda kullanlacak olan nesneler tm elemanlarn kapsayacak ekilde Ek-1 de listelenmitir. Tm listelenen elemanlar asndan (U nokta mesaj yaplarnn belirtildii tablolarda belirtildii zere) alann Zorunlu (z) veya stee Bal () olma durumlarna gre baz alanlar gnderilebilir veya gnderilmeyebilir. \n 3.11. Sayfalandrma ve Filtreleme \n Sayfalandrma \n arya dnlen kaynak nesnesi ierisindeki kaytlar bir sayfalandrma yaps ile arlacak ekilde istek oluturulur. \n Oluturulacak istein ierisinde parametreler ile filtreleme, sayfa bana gsterilecek kayt says ve hangi sayfann nyzde gsterilecei bilgileri eriim noktasna iletilir ve ilgili kaytlar cevap olarak alnr. \n Filtreleme \n HHS, birden ok kayt dnlmesi gereken GET arlarnda snrl filtreleme destei salamaldr. Filtre parametreleri her zaman kaynak nesnesinin belirli alanlarna zgdr ve nesne iin tanmlanan kurallara uymaldr. \n 3.12. Mesaj mzalama \n Elektronik imzalar, HVPS APIde gerekletirilen ilemlerin ve tanan verilerin btnlk ve inkr edilemezliini destekler. mzalarn kaynak baznda hangi istek ve yantlara uyguland belirlidir. \n API yalnzca TLS\'ye dayanrsa, dijital kaytlar ve inkr edilemezlik kantlarn tutmak zor olur. Bu nedenle, TLS\'ye dayanmayan bir inkr edilemezlik zm olarak API isteinin HTTP balnda bir JWS kullanlarak salanabilir. \n HTTP isteinin gvdesinin hash fonksiyonu (SHA256) ile zeti alnacaktr. Elde edilen zet, asimetrik anahtarlar destekleyen bir algoritma kullanlarak imzalanacak ve JWS elde edilecektir. stein kendinize geldii durumda body zerinde hi bir deiiklie tabi tutmadan (serialize/deserialize, minify, trim, vb yapmadan) dorulama yapmanz gerekmektedir. Ayn ekilde istein kendinizden kt aamada da response body zerinde hi bir deiiklie tabi tutmadan (serialize/deserialize, minify, trim, vb yapmadan) mesaj imzalama yaplmaldr. \n Bir istek, YS\'nin zel anahtar ile imzalanacak ve bu istee karlk gelen yant, HHS\'nin zel anahtar tarafndan imzalanacaktr. \n Tm API istekleri ve yantlar imzalanmaz. Mesaj imzalamann zorunlu olup olmad, desteklenip desteklenmedii her API zelinde belirlenir. \n Anahtar Deposu \n HHS\'ler ve YS\'ler tarafndan gvenilen bir Gven Otoritesi (Trust Anchor), taraflar iin bir genel anahtar deposu salamaktan sorumludur. \n Gven Otoritesi, taraflardan herhangi birisinin oluturduu bir anahtar iftinin ak blmn saklayan merkezi bir dizin (BKM tarafndan tutulan merkezi kayt sistemi vb.) olacaktr. \n Mesajlar dorulamak iin taraflarn genel anahtarlarnn paylalmas iin BKM bir servis salayacaktr. HHS API olarak adlandrlm olan bu servis ile HHS ve YS listelerine ulalabildii gibi dorulama ilemi iin ihtiya duyulacak olan genel anahtarlara da bu servis zerinden eriilebilinecektir. \n lgili Mesaj ifreleme iin genel ak, Ek-5 blmnde detaylaryla paylalmaktadr. \n 3.13. Durum Kodu \n APIler, iki farkl amaca hizmet eden iki durum kodu kullanr: \n \n HTTP Durum Kodu, API arsnn (kaynaktaki HTTP ilemi) sonucunu yanstr. \n Baz kaynak payloadlarndaki Durum alan, kaynaklarn durumunu yanstr. \n 3.14. Gereksinimlerinin Snflandrlmas \n Eriim adreslerinin ve alanlarn kullanm Zorunlu(Z), stee Bal() veya Koullu(K) olabilir. Kullanmlara ilikin durumlar ve kullanmn (K) koullu olduu duruma ilikin aklamalar ilgili tablolarda belirtilmitir. \n HVPS API\'lerinin (HBH,BH,GKD) istek ve yantta kullanlacak balk isimleri, ilgili RFC dokmanlarnda ve aadaki tabloda yer ald ekilde kullanlacaktr.  Uygulamaya zellemi balklar "X-" ile balayacaktr. Balk isimlerinde yer alacak ksaltmalar (rn. PSU, ASPSP gibi) tamam byk harfle yazlacak ekilde tanmlanacaktr. Balk isimleri byk  kk harfe duyarl olmamaldr. rnein x-request-id ya da X-Request-ID olarak gnderilmi olan bir istek bal deikeni, sunucu tarafnda hata vermeyecek ekilde ilenebilmelidir. \n 3.15. stek Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "PSU-Device-Data" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n stek balnda aadaki tabloda belirtilen alanlar dnda gnderim yaplmamaldr. \n stek balnda bo deer ieren bir balk ismiyle gnderim yaplmamaldr. rnek; "PSU-Initiated":"" \n stek ve Yant balnda yer alan alanlarn; POST GET DELETE methodlarnda, OBH,HBH,GKD,OAS,ODS API\'leri baznda Zorunlu/Koullu/stee Bal kullanm durumlar aadaki tabloda listelenmitir. \n \n Tablo 2: stek Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n POST \n GET \n DELETE \n POST \n GET \n DELETE \n \n \n \n \n \n \n \n OBH HBH GKD \n OBH HBH GKD \n OBH HBH GKD \n OAS ODS \n OAS ODS \n OAS ODS \n \n \n X-Request-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen arya zg talep kimlii. stek numaras.   rnek: deme emri balatma i aknn her admda farkl x-request-id deeri kullanlr.   arlarn ayn yant dnmesinin beklendii durumlarda (idempotent ilemlerde) ayn deer ile ar yaplr. \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras.  Ayn rza noya ait tm isteklerde ayn x-group-id bilgisi deeri gnderilmelidir. rnek: deme emri balatma/hesap bilgisi i aknn her admnda ayn x-group-id deeri kullanlr. \n Z \n Z \n Z \n - \n - \n - \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder. Bu deerin application/json olarak gnderilmesi gerekmektedir. Hata durumlarnda application/problem+json da iletilebilir.  (Baka bir deere ayarlanrsa, HHS, 415 Desteklenmeyen Ortam Tr (Unsupported Media Type) ile yant vermelidir) \n Z \n - \n - \n Z \n - \n - \n \n \n X-ASPSP-Code \n AN4 \n Hesap Hizmeti Salaycsnn (HHS) kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n PSU-Auth-Date \n ISODateTime \n HKnn YS zerinde en son oturum at saat. [RFC7231] rnein:  auth-date: Tue, 11 Sep 2012 19:43:31 GMT \n  \n  \n  \n - \n - \n - \n \n \n PSU-IP-Address \n AN7..15 \n HK YS zerinde oturum amsa, ilemi balatt cihazn IP adresi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-IP-Port \n AN1..5 \n HK YS zerinde oturum amsa, ilemi balatt cihazn Port adresi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-GEO-Location \n AN1..36 \n HKnn ilemi balatt cihazn konum bilgisi. RFC2426 standartna uygun olarak paylalmaldr. rnein  GEO:"<enlem >, <boylam>GEO:52.506931,13.144558 \n  \n  \n  \n - \n - \n - \n \n \n PSU-User-Agent \n AN 1.. 255 \n HKnn ilemi balatt cihazn salad user-agent bilgisi. (Tarayc, versiyon, iletim sistemi bilgileri) \n  \n  \n  \n - \n - \n - \n \n \n PSU-Timestamp \n ISODateTime \n HKnn ilemi balatt cihazn tarih saat ieren zaman bilgisi. \n  \n  \n  \n - \n - \n - \n \n \n PSU-Device-ID \n AN5..40 \n HK ilemi mobil uygulama araclyla balattysa, kullanlan mobil uygulama ilk yklendiinde oluturulan tekil cihaz veya uygulama belirteci. HK cihaznn UUID deeri kullanlabilir. \n  \n  \n  \n - \n - \n - \n \n \n PSU-Device-Data \n AN1..1024 \n HKnn ilemi balatt mobil cihaza ait veriler.  rnek alanlar:   - Platform - (Android, iOS, Windows 10 Mobile)  - Device Model   - OS Name   - OS Version - Locale - Time zone \n  \n  \n  \n - \n - \n - \n \n \n PSU-Initiated \n AN1 \n lemin HK tarafndan balatlmas durumunda E , sistem tarafndan balatld durumda H deerini, olay bildirimine istinaden yaplacak isteklerde O deerini almas beklenir. lemler servisinde yaplacak sistemsel sorgulardaki ilem limitlerini kontrol amacyla kullanlr. O deerinin gnderilebilecei API\'ler  Asl Verinin Elde Edilecei API  olarak ilgili sayfada yer alan Olay Tipleri ve Kaynak Tipleri likisi tablosunda yer almaktadr. Asl verinin elde edilecei API\'ler zelinde O gnderimi yaplabilir. O olarak yaplan her istee HHS\'nin yant vermesi gereklidir. Otomatik sorgularda uygulanan st limitler, O gnderimi durumunda geerli deildir. \n Z \n Z \n Z \n - \n - \n - \n \n \n PSU-Fraud-Check \n AN1..4096 \n YS\'lerin eitli gvenlik kontrollerini gerekletirerek, nemli grlen aadaki bilgileri HHS\'ler ile paylamalar gerekmektedir. Bu bilgiler nda mterinin profili oluturulmasna katk salanacaktr.   HKl ilemlerde (PSU-Initiated = E gnderildii durumlarda) gnderilmesi zorunludur.  Sistemsel yaplan API armlarmda, Olay Bildirim Servis armlarnda ve HHS-YS API armlarnda gnderilmesine gerek bulunmamaktadr.  Paylalacak bilgiler u ekildedir.   FirstLoginFlag  : HK\'nn, mterilik mrnde ilgili YS sistemine (mobil ya da web uygulamas) ilk login olma sresini ifade eden deer. HK\'nn ilk yapt HBH ya da BH ilemi deil, YS sisteminde kendini aktifletirme tarih aral bilgisidir.   YS, kullancnn ilk login bilgisini tutarak sonraki ilemlerinde bu bilgiyi belirlenen format ile HHS\'ye aktaracaktr. rnein; YS\'n 7 aydr mterisi olan bir kullanc iin bu alan "5" olarak YS tarafndan beslenecektir. Burada ama; ilgili kullancnn YS\'n eski bir mterisi mi, yoksa yeni bir mterisi mi olup olmadn anlamaktr.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   DeviceFirstLoginFlag  : HK\'nn, mterilik mrnde ilem annda kulland cihazla YS uygulamasna (web ya da uygulama tabanl) ilk login olma sresini ifade eden deer. HK cihaz deiiklii yaparsa FirstLoginFlag deeri sabit kalmal  ancak DeviceFirstLoginFlag deeri deimelidir.  FirstloginFlag deeri ile HKnn YS uygulamasna ilk login tarih bilgisi ile ilgili bilgi verilirken, DeviceFirstLoginFlag ile de HKnn YS uygulamasna farkl bir cihaz aracl ile ilk login tarihinin bilgisi verilmektedir.  rnein; HK 7 aydr YS\'n mterisi olabilir, byle bir durumda FirstLoginFlag deeri "5" olacaktr. Ancak son ilemini daha nce hi kullanmad bir cihazdan yapmtr. Yeni cihazdaki login sre aral 0-2 saat aralnda  olduu iin DeviceFirstLoginFlag deeri "1" olacaktr.FirstLoginFlag deeri yine "5" olarak kalmaya devam edecektir.Bu bilgi ile YS, ilgili HHS\'ye ilk kez geliyor olsa bile; HHS, mterinin YS\' uzun sredir kullandn ama yeni bir cihazla ilemlerine devam ettiini anlayabilecektir. Bir HK, farkl cihazlar veya platformlar zerinden YS ile etkileime girebilir.  Kullanc ve YS arasnda bir oturum balatlm ise YSn tutarl ve kalc bir kimlik (device id) atamas beklenmektedir.  Device ID: Web sitesi veya mobil uygulama kullanclar iin retilen, tarayc ya da mobil uygulama tabanl benzersiz (tekil) tanmlayc deer. Mobil uygulamalar iin HKnn ilk defa ilgili cihaza aktivasyon yapt tarih bilgisi alnmaldr.   Device ID bilgileri YS uygulama ortam (web ya da uygulama tabanl) ve HK cihaz baznda tutulmaldr. YSten balatlan ilem hangi uygulama ortamna ait ise ilgili ortamala ilikili tutulan Device IDnin ilk login tarihine baklarak gncel flag deeri hesaplanmaldr.  Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   LastPasswordChangeFlag  : HK\'nn, YS (cihaz bamsz)  uygulamasna login olduu ifre bilgisinin en son deitirildii sreyi ifade eden deer. Mterinin en son ne zaman ifre deiiklii yaptn anlamak iin kullanlan alandr. Yeni mteri ve hi ifre deiiklii yapmam olabilir, byle bir durumda ilgili alan "0" olarak beslenecektir.   Gnderilmesi Zorunlu alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   BlacklistFlag  : HK\'nn herhangi bir sebeple YS\'n sakncal mteriler listesinde bulunup bulunmadn ifade eden deer.   Burada ama herhangi bir sebeple YS tarafnda yasakl olarak kaytl olan HK bilgisinin, dolandrcl nceden tespit etmek amal HHS\'ye aktarlmas olarak aklanabilir. rnein, YS tarafndan tespit edilen dolandrc kullanclara ait device id bilgisi, bu kara listede tutulur daha sonra ayn cihazla baka bir HK ilem yapacak olsa bile bu alanda ilgili bilgi "1" deeri ile HHS\'ye aktarlr. HHS\'de olmayp YS tarafnda olan bu rnekteki sakncal mteri/cihaz bilgisinin, dolayl yoldan HHS\'ye aktarlmas amalanmaktadr.  Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   MalwareFlag  : YS uygulamasnn alt cihaz zerindeki son 21 gne ait zararl yazlm tespit bilgisini ifade eden deer. rnein HK\'nn cihaznda zararl yazlm olduu ayn 1\'inde YS tarafndan tespit edildi. Zararl yazlm tespitinden 2 saat sonra YS zerinden login olan HK\'nn durumu,  "1" olarak iletilecektir. Bir gn sonra ayn 2\'sinde, yeni bir zararl yazlm tespiti yok ancak mevcut zararl yazlm aktifse alan "2" deeri ile iletilecektir. Sreler artarak 21 gne kadar TR.OHVPS.DataCode.ZmnAralik deerlerine gre iletilecektir.Son 21 gn iinde yeni bir tespit yoksa ayn 22\'sinden itibaren ilgili alan  "0" deeri ile beslenecektir. Not: Zararl yazlm, bankaclk ilemlerinin yapld uygulamalara girite kullanlan bilgilerin (ifre, kullanc kodu gibi) ele geirilmesi amacyla kullanlan bir uygulama ya da kod parac olabilir. Bu amalar dnda kullanlan (bankacla ynelik bir zararl yazlm olmayan) yazlm tespitleri iletilmemelidir. YS kanallarna her bir loginde, kullanlan cihazda bir zararl yazlm var m yok mu kontrol yaplmaldr.   Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.   AnomalyFlag  : Dier pheli durumlarn varln ifade eden deer. Gnderilmesi Opsiyonel alandr. TR.OHVPS.DataCode.VarYok sral veri tipinin alabilecei deerleri alabilir.   UnsafeAccountFlag : HHS tarafndan aktarlan bilgi ile son 21 gn iinde HK\'nn dolandrclk maduru olmas durumunu ifade eden deer. rnein; HHS 1, ayn 1\'inde sphe veya sahtekarlk nedeniyle bir deme ilemine izin vermedii durumda, bu bilgiyi rza iptal detay kodu ile YS\'e aktarm olur. Bu bilgiyi tutan YS, ilgili mterinin 15 dakika sonra HHS 2\'de yapt ilem iin ilgili alan "1" deeri ile besler. Bylece HHS 2, HK\'nn farkl bir HHS\'de son 15 dakika iinde pheli veya sahte bir ilemi olduunu anlayabilecektir. Ayn 22\'sinde yeni bir tespit/kayt yoksa bu alan YS tarafndan "0" olarak beslenecektir. Gnderilmesi Opsiyonel alandr.TR.OHVPS.DataCode.ZmnAralik sral veri tipinin alabilecei deerleri alabilir.     Flaglar JWT claims iine key value eklinde eklenerek gnderilecektir. EK-5: Mesaj mzalama Ak\'nda belirtilen yntemle imzalanarak oluturulan JWT PSU-Fraud-Check alanna konularak YS\'ler tarafndan HHS\'ye iletilmelidir. \n K \n K \n Z \n - \n - \n - \n \n \n PSU-Session-ID \n AN1..100 \n stei balatan YS tarafndan belirlenen oturuma zg talep kimlii. HK\'nn YS uygulamas zerinden kimlik dorulama mekanizmas ile bilgi sistemlerine dhil olmalarndan ilemlerini tamamlayp sistemden ayrlmalarna kadar geecek tm sreci kapsayacak ekilde ayn deeri almaldr. Tek seferlik deme gibi HKnn tannmadan balatld ilemlerde bu deer bo olarak iletilmelidir. \n  \n  \n  \n - \n - \n - \n \n \n Authorization \n AN1..4096 \n Katlmc ile GET arasndaki otorizasyon iin kullanlan token bilgisidir.  Yekilendirme trlerinden stemci Kimlik Bilgilerini adresler.    Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. \n Z \n Z \n Z \n Z \n Z \n Z \n \n \n X-Access-Token \n AN1..4096 \n HKnn GKD srecinde dorulanmas sonrasnda kullanlan eriim simgesi. Yetkilendirme trlerinden Yetkilendirme Kodu (GKD)nu adresler.  Blm 3.6 Karakter Kodlama  blmnde aklanan karakter formatnda gnderilmesi beklenmektedir. \n  \n  \n  \n - \n - \n - \n \n \n X-JWS-Signature \n AN1..4096 \n Payload gvdesinin ayrlm bir JWS imzasn ieren stbilgi.  Bu baln ne zaman belirtilmesi gerektii hususu ilgili endpoint iin belirtilmitir.  Mesaj imzalama kullanlan API ve methoda gre gnderimi zorunludur. \n K \n K \n K \n K \n - \n - \n 3.16. Yant Bal \n \n "Balk isimleri" yorumlanrken kk byk harfe duyarl olmamaldr. rnein "x-ReQuEsT-Id" geerli bir balk ismidir. \n "Balk deerleri" yorumlanrken ise kk byk harf duyarll olmaldr. rnein "xyz123" ile "XYZ123" deerleri farkldr. \n Balk deerlerinde ISO-8859-1 standartnda yer alan karakter kmesi kullanlmaldr. rnein "Link" deerinde "OS12" yazmak, byk "" harfinin ISO-8859-1 ierisinde yer almamasndan dolay, hataya yol aacaktr. \n Yant balnda aadaki tabloda belirtilen alanlar dnda gnderim yaplmamaldr. \n Yant balnda bo deer ieren bir balk ismiyle gnderim yaplmamaldr. rnek; "PSU-Initiated":"" \n \n Tablo 3: Yant Balnda Yer Alan Veriler \n \n \n \n Balk simleri \n Format \n Notlar \n Kullanm Durumu  OBH HBH GKD \n Kullanm Durumu  OAS ODS \n \n \n \n \n X-Request-ID \n AN1..36 \n YS tarafndan belirlenen arya zg talep kimlii. stek numaras    lgili istek balndaki bilgi geri dnlr. \n Z \n Z \n \n \n X-Group-ID \n AN1..36 \n stei balatan YS tarafndan belirlenen ilem akna zg talep kimlii. lem grup numaras. lgili istek balndaki bu deer geri dnlr. \n Z \n - \n \n \n X-ASPSP-Code \n AN4 \n Hesap Hizmeti Salaycsnn (HHS) kodudur. (Nezdinde H bulunduran kurulu kodu. rnein, Banka, Elektronik Para Kuruluu ve deme Kuruluu) \n Z \n Z \n \n \n X-TPP-Code \n AN4 \n Yetkili deme Hizmeti Salaycs (YS) kodudur \n Z \n Z \n \n \n Content-Type \n AN1..20 \n Standart HTTP Bal; Talepte salanan payloadn biimini temsil eder:  application/json \n Z \n Z \n \n \n X-JWS-Signature \n AN1..4096 \n JWS imzasn ieren stbilgi. Bu baln hangi yantlar iin kullanlmas gerektii ilgili endpoint iin belirtilmitir.  Hata durumlarnda, yant gvdesi deeri dnlyor ise imzalanmal ve imza bilgisi x-jws-signature alannda iletilmelidir.  Ancak uygulama katman tarafndan yakalanamayan dolays ile imzalanamayan hata durumlarnda x-jws-signature alan HHS\'ler tarafndan bo gnderilebilir.  Hatal yant alnd durumlarda ise X-JWS-Signature balk deeri dolu ise dorulama yaplmaldr. (4**, 5**) \n K \n K \n \n \n X-RateLimit-Limit \n N 1..18 \n stek kst uygulanan servislerde en fazla ka adet istek yaplabileceini gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n - \n \n \n X-RateLimit-Remaining \n N 1..18 \n stek kst uygulanan servislerde ka adet istek hakk kaldn gsterir. Kst uygulanan servislerde bu baln dnmesi zorunludur. \n K \n - \n \n \n X-RateLimit-Reset \n AN 1..255 \n stek kst uygulanan servislerde arm hakk bittikten sonra yeniden denemeden nce beklemesi gereken sreyi (saniye cinsinden) gsterir. HTTP 429 durum kodu (Too Many Requests) ile dnlen yantlarn balnda dnlmesi zorunludur.  YS olarak yaptnz sistemsel sorgularda; HTTP 429 durum kodu (Too Many Requests) ile dnlen yant aldnzda tekrar sorgu yapmadan nce X-RateLimit-Reset yant baln kontrol ederek, bu balktaki sre kadar bekledikten sonra yeniden sorgulama yaplmas gerekmektedir. \n K \n - \n \n \n x-total-count \n N 1..18 \n Hesaplar, lemler, Bakiye, letilemeyen Olaylar servislerinde sayfalama kullanld durumda, sorgu sonucu dnecek toplam kayt says bilgisi, bu alanda HHS isteine bal olarak gnderilebilir.   Kayt says 0 olduu durumda gnderimi zorunludur. \n K \n K \n \n \n Link \n 1..4096 \n Link alannn  Hesap Bilgisi Hizmeti iin Eriim Adresleri    tablosundaki parametre  = Sayfalama olan APIlerde ve letilemeyen Olaylar API\'sinde gnderim yaplmas zorunludur.  Sayfalama yaps kullanldnda gelen yantta birden fazla sayfa var ise; nceki, sonraki, ilk, son sayfalara gitmek iin gerekli referanslar link headernda aadaki rnekteki gibi doldurulabilir.  x-total-count alannn gnderimi kayt says 0 olduu durum dnda istee bal olduu iin; Link ierisindeki son sayfa bilgisi  (last) istee bal hale getirilmitir. nceki( prev) ve Sonraki (next) admlarnn uygun olan her durumda yer almas zorunludur. lk sayfada nceki seenei olmamal, son sayfada ise Sonraki seenei olmamaldr.    </ohvps/hbh/s2.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=6&syfKytSayi=100>; rel="next",  </ohvps/hbh/s2.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=4&syfKytSayi=100>; rel="prev",  </ohvps/hbh/s2.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=14&syfKytSayi=100>; rel="last",  </ohvps/hbh/s2.0/hesaplar/hspref/islemler?hesapIslemBslTrh=2022-01-01T00:00:00+03:00&hesapIslemBtsTrh=2023-12-12T23:59:59+03:00&srlmKrtr=islGrckZaman&srlmYon=Y&syfNo=0&syfKytSayi=100>; rel="first"    Hi hesap hareketinin olmad durumda dnen yant balnzn u ekilde olmas beklenmektedir.  Response body: [] Response header: Link: </ohvps/hbh/s2.0/hesaplar?srlmKrtr=hspRef&srlmYon=A&syfNo=1&syfKytSayi=100>; rel="last",</ohvps/hbh/s2.0/hesaplar?srlmKrtr=hspRef&srlmYon=A&syfNo=1&syfKytSayi=100>; rel="first"  x-total-count alan da 0 olarak iletilmelidir. \n K \n K \n 3.17. Idempotency Kurallar \n YSn aadaki durumlarda ayn istek numaras (x-request-id) ve ayn veri gvdesiyle ary tekrarlamas; HHSnin de bu durumlarda ayn yant dnmesi gereklidir. \n \n HHSnin yant kesinti/arza nedeniyle YSe ulamaz ve zaman am sz konusu olmas, \n HK, YS uygulamas zerinden ift tklama ile mkerrer defa HHS APIlerini arlmas,\n(API kontrollerinden nce YS uygulamasnn, ift tklama kontrol yapmas nerilmektedir.) \n YS, yant almasna ramen ileyemeden kaybedilmesi, \n \n durumlarnda HHS aadaki kurallar iletir: \n \n HHS gelen istek numarasn ve veri gvdesini birletirerek checksum deeri retir. \nchesksum deeri x-request-id|request.body nin hash algoritmalarndan (CRC32,MD5 vb)  geirilerek retilebilir. \n HHS bu checksum deeri ile YSe dnm olduu yant 5 dk boyunca saklar.  Saklama yntemi olarak veri taban veya nbellek aralar kullanlabilir. \n YS ayn istek numaras ve ayn veri gvdesi ile yeni bir ar yaptnda, ayn checksum deeri retilecei iin 5dk boyunca bu deere karlk gelen yant dner. \n 5 dk sonrasnda istek numaras veya veri gvdesi deimemi olsa dahi bu HHS tarafndan yeni istek olarak kabul edilir. \n \n Aadaki Public Post ilemleri iin bu kural setinin iletilmesi gerekmektedir: \n 1- deme emri rzas oluturma \n2- Eriim belirteci oluturma \n3- deme emri \n4- Hesap bilgisi rzas oluturma \n5- leri Tarihli deme Emri Rzas oluturma \n6- leri Tarihli deme Emri \n7- Dzenli Tekrarl deme Emri Rzas oluturma \n8- Dzenli Tekrarl deme Emri \n 3.18. HTTP Durum Kodlar \n RFC 2616\'da belirlenmi olan durum kodlar (status code) gnderilen istein durumunu YSa standart bir ekilde ifade eder. Eer bir hata varsa hatay, gnderilen istek baarl bir ekilde ilem grdyse ona ilikin durumu aktarr. Durum kodlar genel olarak 5 kategoridedir. \n \n 1xx Bilgi \n 2xx Baarl \n 3xx Ynlendirme \n 4xx stemci Hatas \n 5xx Sunucu Hatas \n \n errorCode Alannda Kullanlabilecek Sral Hata Tipleri : \n \n TR.OHVPS.Resource \n \n \tInvalidFormat \n \tConsentMismatch \n \tNotFound \n \tInvalidSignature \n \tMissingSignature \n \tMethodNotAllowed \n \tNotAcceptable \n \tUnsupportedMediaType \n \tConsentRevoked \n \n \n \n TR.OHVPS.Business \n \n \tInvalidContent \n \tInvalidAccount \n \n \n \n TR.OHVPS.Connection \n \n \tInvalidCertificate \n \tExceededRate \n \tInvalidTPP \n \tInvalidASPSP \n \tInvalidToken \n \tInvalidTPPRole \n \n \n \n TR.OHVPS.Server \n \n \tInternalError \n \tServiceUnavailable \n \n \n TR.OHVPS.Resource.InvalidFormat hatas alnd durumda; fieldErrors nesnesi ierisinde verilecek hata kodlar : \n \n TR.OHVPS.Field \n \n \tMissing \n \tInvalid \n \n \n Veri Tipi rnei: \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "d8bd4e5f-f094-48a6-aee1-3a800e2709d9" , \n     "timestamp" :   "2022-12-22T10:33:15+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.prBrm" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.kmlk.kmlkVrs" , \n             "messageTr" :   "boyut \'1\' ile \'30\' arasnda olmal" , \n             "message" :   "size must be between 1 and 30" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n \n Tablo 4: HTTP Durum Kodlar \n \n \n \n HTTP Durum \n stek Sonucu ve Aklamalar \n POST \n GET \n DELETE \n \n \n \n \n 200 OK \n stek Baaryla Tamamland. Kaynak gncellemek iin yaplan (rnein, GET) ve baaryla tamamlanan isteklerinde kullanlr. \n H \n E \n H \n \n \n 201 Created \n stek Baarl Oldu. Kaynak yaratma istei (rnein, POST /deme-emri-rizasi) baaryla sonuland. \n E \n H \n H \n \n \n 204 No Content \n Silme ilemi baaryla tamamland. Kaynak silme istei (rnein,  DELETE /hesap-rizasi/{RizaNo} ) baaryla sonuland. \n H \n H \n E \n \n \n 400 Bad Request \n stekte bozuk, eksik veya uyumlu olmayan JSON gvdesi, URL parametreleri veya balk alanlar var.  stekle balatlan ilem yapsal bozukluk, eksik veya tutarsz veri veya HHS tarafndaki kontrollerin hatal sonulanmas nedeniyle hata ile sonulanr ve hataya ilikin veriler hata nesnesi ierisinde dnlr. \n E \n E \n E \n \n \n 401 Unauthorized \n Yetkilendirme bal eksik, hatal veya geersiz olduundan istek yetkilendirilmediinde ve eriim reddedildiinde http 401 kodu dnlmelidir. \n E \n E \n E \n \n \n 403 Forbidden \n Eriim belirtecinin veya rzann kapsam uyumuyor. YS bir hesaba/ilem kaynana erimeye alr ve YS, istenen kaynaa erimek iin geerli izinlere sahip bir rzas yoktur.  rnein; hesap bilgisi rzas bakiye izni almamtr ancak /bakiyeler adresinden istekte bulunmutur. \n \n \n \n \n \n 404 Not Found \n **HHS geerli bir API eriim adresini salamyorsa, o URL\'ye gelen istekler iin 404 (Bulunamad) ile yant vermelidir.**YS, uygulama esaslarnda tanmlanmayan bir kaynak iin bir URL\'ye erimeye alrsa (rnein, GET /yurtdisi-odeme), HHS, 404 (Bulunamad) ile yant vermeyi seebilir. \n E \n E \n E \n \n \n 405 Method Not Allowed \n YS, desteklenmeyen bir yntemle kaynaa erimeye alt. \n E \n E \n E \n \n \n 406 Not Acceptable \n stek, geersiz bir karakter kmesi ieriyor. \n E \n E \n E \n \n \n 415 Unsupported Media Type \n stek gvdesi hedef kaynakta bu yntem tarafndan desteklenmeyen bir biimde oluturulduu iin ilem reddedildi \n E \n H \n H \n \n \n 429 Too Many Requests \n Belirli bir sre iinde ok fazla talepte bulunulduu iin ilem reddedildi.  HHSler adil kullanm politikalarn aan talepleri kstlayabilir. \n E \n E \n E \n \n \n 500 Internal Server Error \n API sunucu / servis katmannda sorun olutu. lem baarsz.  5XX hata durumlarnda yant gvde deeri olmad iin mesaj imzalama yaplamaz ve x-jws-signature alan bo olarak iletilir.  Bu durumda x-jws-signature kontrol yaplmamaldr. \n E \n E \n E \n \n \n 503 Service Unavailable \n Hizmet srm kullanmdan kaldrld.  Bir API\'nin kullanmdan kaldrld ve artk bir HHS tarafndan operasyonel olarak desteklenmedii durumlarda, URI yolu hala etkin olabilir ve API isteklerini kabul edebilir.  Bu durumda, YS\'n API srmnn evrimd olduunun farknda olmas iin 503 Hizmet Kullanlamyor dnmesi nerilir. \n E \n E \n E \n \n \n \n  kurallar nezdinde ilgili hata kodlar zelletirilmi olup HHS tarafndan verilecek olan hata kodlar HVPS API lke ve Kurallar dokmannda ilgili alanlarda paylalmtr. Bu almaya ek olarak, HHS\'lerin YS\'lere; YS\'lerin de HK\'lara iletecekleri hata mesaj ieriklerinde standartlamaya gidilmitir. Bu almaya Trkiye\'nin letiim Platformu altnda yer alan HVPS > Dokmanlar alanndan ulaabilirsiniz. HHS\'lerin ve YS\'lerin ilgili dokman referans alarak mesaj ieriklerini, kurumlarn kendi mteri iletiim dili kapsamnda dzenleyerek HK\'lara gsterebilir olmas beklenmektedir. \n Hata rnekleri: \n 400 Bad Request \n TR.OHVPS.Resource.InvalidFormat  hatas ema validasyonu, alan uzunluk ve varlk kontrollerinin baarsz olduu durumda verilmelidir. \n \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "7f115b9c-d7c2-4a2a-bc45-5a9891c79072" , \n     "timestamp" :   "2022-12-22T10:47:57+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "fieldErrors" :   [ \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.alc.unv" , \n             "messageTr" :   "boyut \'3\' ile \'140\' arasnda olmal" , \n             "message" :   "size must be between 3 and 140" , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } , \n         { \n             "objectName" :   "odemeEmriRizasiIstegi" , \n             "field" :   "odmBsltm.islTtr.ttr" , \n             "messageTr" :   "bo deer olamaz" , \n             "message" :   "must not be null" , \n             "code" :   "TR.OHVPS.Field.Missing" \n         } \n     ] , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" \n }  \n\n \n Zorunlu header alanlarndan biri ya da birka eksik olarak gnderilirse aadaki gibi bir hata dn gerekleebilir. \n HHS uygulamas tarafndan dnlebilecek hata rnekleri: \n \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "2005515d-f0e6-4a07-a439-0ef3b0f56011" , \n     "timestamp" :   "2022-12-22T10:39:26+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Validation error" , \n     "moreInformationTr" :   "ema kontrolleri baarsz" , \n     "errorCode" :   "TR.OHVPS.Resource.InvalidFormat" , \n     "fieldErrors" :   [ \n         {          \n             "field" :   "X-Request-ID" , \n             "messageTr" :   "X-Request-ID deeri bo olamaz." , \n             "message" :   "X-Request-ID cannot be null." , \n             "code" :   "TR.OHVPS.Field.Invalid" \n         } \n     ] \n }  \n\n \n Business hata rnei - 1: \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "677cfd9d-77c1-4ea3-8bdf-74a6e9887177" , \n     "timestamp" :   "2022-12-22T11:05:59+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "gonUnvan wrong" , \n     "moreInformationTr" :   "Gnderen nvan hatal" , \n     "errorCode" :   "TR.OHVPS.Business.IncorrectSenderTitle" \n }  \n \n Business hata rnei - 2: \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "5df3b402-3aca-4305-a35b-5af0f3184b40" , \n     "timestamp" :   "2022-12-22T11:06:47+03:00" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" , \n     "moreInformation" :   "Sender account is disabled or not found." , \n     "moreInformationTr" :   "Gonderen hesap aktif deil veya bulunamad." , \n     "errorCode" :   "TR.OHVPS.Business.InvalidAccount" \n }  \n \n GET\'te yaplan zorunlu header kontrollerinde aadaki hatalar dnebilir: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidASPSP" , \n     "moreInformation" :   "Invalid ASPSP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n GET tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T10:40:28+03:00" , \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "d4375748-6fc7-4f7e-94f3-6411cab1d59f" , \n     "moreInformationTr" :   "Geersiz HHS kodu." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPP" , \n     "moreInformation" :   "Invalid TPP Code" , \n     "httpCode" :   400 , \n     "httpMessage" :   "Bad Request" \n }  \n \n GET tarafndan dnlecek hata rnei: \n \n { \n     "timestamp" :   "2022-12-22T11:14:05+03:00" , \n     "path" :   "/ohvps/hbh/s2.0/hesap-bilgisi-rizasi" , \n     "id" :   "ee1e3ea7-a5e5-468b-bb02-314148f84e6a" , \n     "moreInformationTr" :   "Geersiz ys rol. lgili api ars iin yetkisi yok." , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidTPPRole" , \n     "moreInformation" :   "Invalid TPP Role" , \n     "httpCode" :   403 , \n     "httpMessage" :   "Forbidden" \n }  \n\n \n 401 Unauthorized \n YS, sresi dolmu bir eriim belirteci kullandnda, HHS 401 (Yetkisiz) http kodu ile aadaki hata kodunu dnmelidir.  Aadaki nedenlerden herhangi biri nedeniyle bir Eriim Belirtecinin sresi dolduunda bu durum ortaya kabilir: \n \n Rzann sresi doldu (Son Kullanma Tarihi geti) \n Eriim Belirtecinin pheli kullanm veya sahtekarlk phesi \n Rzada belirlenen gn saysnn am\nBu hata, mteriden doru izinlerle yeniden kimlik dorulamas isteyerek zlebilir. \n \n \n { \n     "path" :   "/ohvps/gkd/s2.0/erisim-belirteci" , \n     "id" :   "ed3fd667-fc58-40ad-a982-e8937faccd15" , \n     "timestamp" :   "2022-12-22T11:17:33+03:00" , \n     "httpCode" :   401 , \n     "httpMessage" :   "Unauthorized" , \n     "moreInformation" :   "Refresh token expired or not found in database" , \n     "moreInformationTr" :   "Yenileme belirteci zaman amna uram veya veri tabannda yok" , \n     "errorCode" :   "TR.OHVPS.Connection.InvalidToken" \n }  \n \n\n \n 403 Forbidden \n rn; YS yetkisi olmayan rol(BH/HBH) ile ilem yapmaya alt durumda 403 hatas alarak ileme devam edemez. \n { \n   "path" :   "/ohvps/hbh/s2.0/bakiye" , \n   "id" :   "3e48ea98-f889-48b9-aa6e-28aabc6cfb14" , \n   "timestamp" :   "2022-12-22T11:20:05+03:00" , \n   "httpCode" :   403 , \n   "httpMessage" :   "Forbidden" , \n   "moreInformation" :   "Forbidden" , \n   "moreInformationTr" :   "Bakiye Bilgileri iin HK izni bulunmamaktadr." , \n   "errorCode" :   "TR.OHVPS.Resource.Forbidden" \n }  \n \n 404 Not Found \n rn; GET /odeme-emri-rizasi/123456 ars durumunda 123456 geerli bir deme kayna deilse, HHS, 404 koduyla cevap vermelidir. \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi/123456" , \n     "id" :   "22f52b2d-d442-4a6a-8f39-d23eba45a34b" , \n     "timestamp" :   "2022-12-22T10:53:53+03:00" , \n     "httpCode" :   404 , \n     "httpMessage" :   "Not Found" , \n     "moreInformation" :   "Resource not found" , \n     "errorCode" :   "TR.OHVPS.Resource.NotFound" , \n     "moreInformationTr" :   "Kaynak bulunamad" \n }  \n\n \n 405 Method Not Allowed \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   405 , \n     "httpMessage" :   "Method Not Allowed" , \n     "moreInformation" :   "Method not allowed" , \n     "errorCode" :   "TR.OHVPS.Resource.MethodNotAllowed" , \n     "moreInformationTr" :   "stek yaplan URL iin izin verilmeyen metot" \n }  \n \n 406 Not Acceptable \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "3e5c6b28-7ee4-4469-b541-843fb4a94eec" , \n     "timestamp" :   "2022-12-22T11:35:10+03:00" , \n     "httpCode" :   406 , \n     "httpMessage" :   "Not Acceptable" , \n     "moreInformation" :   "Not Acceptable" , \n     "errorCode" :   "TR.OHVPS.Resource.NotAcceptable" , \n     "moreInformationTr" :   "Kabul edilmedi" \n }  \n \n 415 Unsupported Media Type \n stek balnda content-type, JSON dnda bir veri iletilirse bu hata verilebilir. \n \n { \n     "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n     "id" :   "63cc94b6-1b51-4648-9671-95e6e2e7e03d" , \n     "timestamp" :   "2022-12-22T11:37:12+03:00" , \n     "httpCode" :   415 , \n     "httpMessage" :   "Unsupported Media Type" , \n     "moreInformation" :   "Content type not supported" , \n     "errorCode" :   "TR.OHVPS.Resource.UnsupportedMediaType" , \n     "moreInformationTr" :   "Desteklenmeyen ierik tipi" \n }  \n \n 429 Too Many Requests \n { \n   "path" :   "/ohvps/hbh/s2.0/hesaplar/aef6061f-2978-4bb4-980d-b4c634c8055b/islemler" , \n   "id" :   "20473c5f-2f4f-4b2e-8b66-7978aec442f7" , \n   "timestamp" :   "2022-12-22T00:21:07+03:00" , \n   "httpCode" :   429 , \n   "httpMessage" :   "Too Many Requests" , \n   "moreInformation" :   "Exceeded rate" , \n   "moreInformationTr" :   "Eriim skl limiti am" , \n   "errorCode" :   "TR.OHVPS.Connection.ExceededRate" \n }  \n \n 500 Internal Server Error \n { \n   "id" :   "1b90c6dc-0277-4755-8b05-9297ddfab743" , \n   "path" :   "/ohvps/obh/s2.0/odeme-emri-rizasi" , \n   "timestamp" :   "2022-12-22T11:41:34+03:00" , \n   "httpCode" :   500 , \n   "httpMessage" :   "Internal Server Error" , \n   "moreInformation" :   "Unexpected condition was encountered." , \n   "moreInformationTr" :   "Beklenmeyen bir durumla karlald." , \n   "errorCode" :   "TR.OHVPS.Server.InternalError" \n }  \n\n \n 503 Service Unavailable \n \n   "timestamp" :   "2022-12-20T23:18:56+03:00" , \n   "path" :   "/ohvps/hbh/s2.0/hesap-bilgisi-rizasi/2a72678ee3d24de2be47887e4903a8c6" , \n   "id" :   "e76315b7-09f4-4295-b6d8-1f7fec632159" , \n   "moreInformationTr" :   "HHS u anda hizmet veremiyor." , \n   "errorCode" :   "TR.OHVPS.Server.ServiceUnavailable" , \n   "moreInformation" :   "HHS is currently unavailable" , \n   "httpCode" :   503 , \n   "httpMessage" :   "Service Unavailable" \n 3.19. Maskeleme Kurallar \n Maskeli olarak iletilmesi gereken verilerin maskeleme kurallar u ekildedir: \n \n IBAN verileri Hesap Numaras : lk 4 ve son 4 karakteri ak, dier karakterler maskeli olmaldr. rnek: TR54******************4812 \n Ad-Soyad / Ticari Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet   karakteri konumlandrlmaldr.\nrnein: FATH SERKAN EREN ifadesi FA *** SE**** ER**** eklinde gsterilmelidir. \n Tabela Unvan : Her kelimenin ilk 2 karakteri ak, sonraki karakterler yerine 4 adet \' \' karakteri konumlandrlmaldr. rnein BANKALARARASI KART MERKEZ ANONM RKET ifadesi BA *** KA**** ME**** AN**** **** eklinde gsterilmelidir. \n YSten girilen alc unvan ve IBAN bilgileri deme emri rzas ve deme emri yantnda ak dnlr, Kolas aknda deme emri rzas yant ve deme emri istek ve yantnda maskeli tanr. \n 3.20. Fonksiyonel Olmayan Gereksinimler \n \n \n HHSlerin sunuyor olduklar servisleri en fazla 6000 ms iinde yant dnecek ekilde tasarlamaldr. \n \n \n HHS\'ler mevcut online ilem kanallarndan sunduklar eriilebilirlik ve performans kriterlerinden daha dk bir hizmet kalitesi sunmamaldr. \n \n \n HHSlerin sunuyor olduklar servislere sistemin gvenlik ve srekliliini salamak adna rate limit koyma ihtiyalar olur ise, standartlar ve ihtiyalara uygun ekilde bir konfigrasyon yapabilirler.  \n \n \n HHS rate limit tanm uyguluyor ise; YS\'ler arasnda ayrm yapmadan, adil ve makul snrlar dahilinde uygulamaldr.    \n \n \n YS tarafndan kullancnn balatmad otomatik sorgu limitleri  3.21 Otomatik Sorgular  blmnde detaylandrlmtr. HHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. Dier taraftan kullancnn balatt istekler iin uygulanacak limitler, HHS\'nin online ilem kanallarndan sunulan sorgu limitlerinden daha az olmamaldr. \n \n \n HHS\'ler, arm limitlerini aan istekler iin HTTP 429 - Too Many Request hatasn dnmelidir. rnek hata mesaj  3.18 HTTP Durum Kodlar  blmnde bulunmaktadr. Rate Limit zelinde tanmlanm parametreler olan X-RateLimit-Limit, X-RateLimit-Remaining ve X-RateLimit-Reset alanlar da   3.16 Yant Bal  blmnde aklanmtr. YS\'ler de HHS\'nin belirledii rate limit kurallarna uymakla ykmldr. \n 3.21. Otomatik Sorgular \n YS uygulamas, HK\'nn balatt ilemler neticesinde API arm yapabilecei gibi, sistemsel bir ekilde otomatik API arm da yapabilir. \nHHS, API armnn HK\'l ya da HK\'sz olduunu istek parametreleri ierisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre E ise HKl, H ise sistemsel yaplm bir sorgu anlamna gelmektedir. \n HK YS uygulamasna giri yapt andan k yapt ana kadar yani HK oturumu boyunca yaplan API armlarnda, PSU-Initiated  deerinin "E" olmas gerekmektedir.  YS uygulamasnda HK oturumu boyunca,  HK\'nn bilgilerinden minimumda "bakiye" bilgisinin, uygulama arayzlerinde gncel deeri ile online sorgularla gsterimi YS\'n insiyatifindedir. \n HKnn balatt sorgular iin HHS tarafndan belirlenen st rate limitler dahilinde arm yaplabilir. \n YS, aadaki API\'leri sistemsel bir ekilde arabilir. \nHHS\'lerin bu servisler iin minimumda cevap vermesi gereken sorgu saylar belirlenmitir. Bu saylarn zerinde yaplan servis arsna yant dnmek HHS inisiyatifindedir. \nHHS tarafndan izin verilen sorgu saysnn zerinde yaplan bir sorgu iin HTTP 429 durum kodu (Too Many Requests) hatas dnlmelidir. Yant gvdesinde tekrar hata nesnesinin oluturulmas HHS inisiyatifindedir.  HHS yant header alannda iletilecek X-RateLimit-Reset (saniye cinsinden) deeri kadar sre sonunda\nYS\'n tekrar sorgulama yapmas beklenmektedir. \n \n \n \n No \n Kaynak \n HTTP ilemi \n Eriim Adresi \n Otomatik Sorgu Says \n \n \n \n \n 1 \n erisim-belirteci \n POST \n /erisim-belirteci \n --- \n \n \n 2 \n odeme-emri-rizasi \n GET \n /odeme-emri-rizasi/{rizaNo} \n Rza baznda gnde 4 \n \n \n 3 \n odeme-emri \n GET \n /odeme-emri/{odemeEmriNo} \n Rza baznda gnde 24 \n \n \n 4 \n ileri-tarihli-odeme-emri-rizasi \n GET \n /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n Rza baznda gnde 4 \n \n \n 5 \n ileri-tarihli-odeme-emri \n GET \n /ileri-tarihli-odeme-emri/{odemeEmriNo} \n Rza baznda gnde 24 \n \n \n 6 \n ileri-tarihli-odeme-emri-rizasi \n DELETE \n /ileri-tarihli-odeme-emri-rizasi/{rizaNo} \n --- \n \n \n 7 \n duzenli-odeme-emri-rizasi \n GET \n /duzenli-odeme-emri-rizasi/{rizaNo} \n Rza baznda gnde 4 \n \n \n 8 \n duzenli-odeme-emri \n GET \n /duzenli-odeme-emri/{talimatNo} \n Rza baznda gnde 24 \n \n \n 9 \n duzenli-odeme-emri-rizasi \n DELETE \n /duzenli-odeme-emri-rizasi/{rizaNo}} \n --- \n \n \n 10 \n hesap-bilgisi-rizasi \n GET \n /hesap-bilgisi-rizasi/{RizaNo} \n Rza baznda gnde 4 \n \n \n 11 \n duzenli-odeme-talimat-plani \n GET \n /duzenli-odeme-emri/{talimatNo}/odeme-plani \n Rza baznda gnde 24 \n \n \n 12 \n hesap-bilgisi-rizasi \n DELETE \n /hesap-bilgisi-rizasi/{RizaNo} \n --- \n \n \n 13 \n hesaplar \n GET \n /hesaplar \n Bireysel gnde 4  Kurumsal gnde 4 \n \n \n 14 \n hesaplar \n GET \n /hesaplar/{hspRef} \n Bireysel gnde 4 Kurumsal gnde 4 \n \n \n 15 \n bakiye \n GET \n /hesaplar/{hspRef}/bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 16 \n bakiye \n GET \n /bakiye \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 17 \n islemler \n GET \n /hesaplar/{hspRef}/ilemler \n Bireysel gnde 4 Kurumsal HK - saatte 12 \n \n \n 18 \n kartlar \n GET \n /kartlar \n Bireysel gnde 4  Kurumsal gnde 4 \n \n \n 19 \n kartlar \n GET \n /kartlar/{kartRef} \n Bireysel gnde 4 Kurumsal gnde 4 \n \n \n 20 \n kart-detay \n GET \n /kartlar/{kartRef}/kart-detay \n Bireysel gnde 24 Kurumsal HK - gnde 24 \n \n \n 21 \n kart-hareketleri \n GET \n /kartlar/{kartRef}/kart-hareketleri \n Bireysel gnde 32 Kurumsal HK - gnde 32 \n \n \n \n YS ve HHS son 24 saat ierisindeki sorgu saylarn toplayarak elde ettii sonularla limit kontrol yapmaldr (Pencere yntemi). \n lemler servisinin arm detaylarna  ^Blm 7.8  zerinden ulalabilir. \n Hesap bilgisi rzasnn YS tarafndan otomatik bir ekilde iptal edilmesi durumu  ^Blm 9\'da  aklanmtr. \n Kart hareketleri iin sistemsel sorgu yapld durumda ayn ekstre tr iin dnem deeri deitike limit dmeyecektir. Sayfalama yapld durumlarda ise deien sayfa numaralar zelinde de limit dmeyecektir. Ayn sayfa ve ayn dnem zelinde tekrar sorgu yaplmas halinde limit dm gerekleecektir. \n Ekstre tr deimesi durumunda da limit dm olmaldr. \n'},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/duzenli-odeme-emri-api.html",relativePath:"v2.0.0/deneyalani/duzenli-odeme-emri-api.md",key:"v-e73a02ea",path:"/v2.0.0/deneyalani/duzenli-odeme-emri-api.html",content:" \n   \n "},{title:"4. Rza Durumlar",frontmatter:{},regularPath:"/v2.0.0/contents/riza-durumlari.html",relativePath:"v2.0.0/contents/riza-durumlari.md",key:"v-64fc905e",path:"/v2.0.0/contents/riza-durumlari.html",headers:[{level:2,title:"4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri",slug:"_4-1-hesap-bilgisi-hizmeti-rza-durum-degisiklikleri"},{level:2,title:"4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri",slug:"_4-2-odeme-bilgisi-hizmeti-rza-durum-degisiklikleri"}],content:" 4. Rza Durumlar \n HK, deme Emri Balatma Hizmetine ya da Hesap Bilgisi Hizmetine mteri rzasnn tesisi ile balar. HKnn YS uygulamas zerinden yapt ilemler neticesinde rza durumlar deiebilir.\nRzann alabilecei durum kodlar u ekilde belirlenmitir. \n B: Yetki Bekleniyor   lk rza talebinde \n Y: Yetkilendirildi   Baarl GKD sonras yetKod retildiinde \n K: Yetki Kullanld   Eriim Belirteci alndnda \n E: Yetki deme emrine dnt   BHS iin \n S: Yetki Sonlandrld \nHBHS iin : Eriimin Geerli Olduu Son Tarih geldiinde \nBHS iin : Yenileme belirteci Son Tarihi geldiinde \n I :Yetki ptal \nRza iptal durumu ise gerek raporlama gerekse mteri deneyimi perspektifinden doru   bilgilendirmeler yaplabilmesi asndan aadaki gibi detay kodlar ile zenginletirilmitir: \n \n Rza ptal Detay Kodu: \n \n \n \n 01 :\tYeni Rza Talebi ile ptal \n 02 :\tKullanc stei ile HHS zerinden ptal \n 03 :\tKullanc stei ile YS zerinden ptal \n 04 :\tSre Am : Yetki Bekleniyor \n 05 :\tSre Am : Yetkilendirildi \n 06 :\tSre Am : Yetki demeye Dnmedi \n 07 :\tGKD iptali : Ayn rza no ile mkerrer arm \n 08 :\tGKD iptali : Rzano ile kimlik bilgileri uyumamas \n 09 :\tGKD iptali : Uygun rn bulunmuyor \n 10 :\tGKD iptali : HHS Ak Bankaclk kanal ileme kapal \n 11 :\tGKD iptali : Hesap Yetki Sorunu \n 12 :\tGKD iptali : HK HHS kontrollerini aamad \n 13 :\tGKD iptali : HK istei ile GKDden vazgeildi \n 14 :\tGKD iptali : Fraud phesi \n 15 :\tHesap Rza Gncelleme Talebi ile ptal \n 99 :\tGKD iptali : Dier \n \n \n 4.1 ve 4.2 blmlerinde detaylandrlan rza durum deiikliklerinde rza iptal detay kodlar kullanlmtr. \n rnein B I/01 denildiinde Yetki Bekleniyor rza durumundan Yetki ptal rza durumuna Rza ptal Detay Kodu da 01 yani Yeni Rza Talebi ile ptal olarak gncellenmelidir ifade edilmitir. \n HK verdii rza srasnda setii hesaplarndan/kartlarndan biri kapatlrsa, dier hesaplara/kartlara ait bilgileri grmeye devam eder. Ancak HKnn hesabna/kartna ait bilgilerinin YS'e iletilmesini istemedii durumda, rzasn tamamen iptal ederek yeni hesap/kart listesi ile yeni rza vermesi gerekmektedir. Yani hesap/kart kapanmas nedeniyle rza geerliliini yitirmez. HK'nn proaktif olarak bu hesab/kart rzadan karmas durumunda rza iptali olur. \n Rza iptal edilmedii ve geerli olduu srece kapal hesaplar/kartlar iin dier evrimii kanallarda uygulanan yntem izlenmelidir. Dier evrimii kanallarda kapal hesaplara/kartlara ilikin bilgi dnlmyor ise HVPS'den de dn yaplmaz. HKnn rza onay verdii ak hesaplarnn/kartlarnn tm HHS tarafnda kapatld durumda, yine ayn ekilde HHS evrimii kanallarnda koyduu kurallara gre bu hesaplarnn/kartlarnn YS uygulamasnda gsterilmesine karar verir. \n Hesap/kart kapama ve ticari kullanclarn hesaplar/kartlar zerindeki yetki deiiklikleri HHS'nin i sistemleri tarafndan yaplan kontrollerle ynetilir. Buradaki deiiklikler ile HHS sistemsel olarak rza iptali gerekletiremez. HK izni ve onay dahilinde rza iptal gerekletirilmesi gerekmektedir. \n HHS'ler sunmu olduklar Rza ptal ekrann (sadece Hesap Bilgisi Rzas iin), hangi ortamlardan GKD yaplmasna izin veriliyorsa (web/mobil) ayn ortamdan HK'ya sunmaldr.  rnein bir HHS bireysel mterileri iin web ve mobil, kurumsal mteriler iin web zerinden GKD imkan sunuyor ise, minimumda bireysel mteriler iin web ve mobil ortamlarndan, kurumsal mteriler iin web ortamndan Rza ptal ekran aracl ile rza iptaline izin vermelidir. Bunun dnda ar merkezi ya da ube gibi ortamlardan sunaca Rza ptal imkan HHS inisiyatifindedir. Bahsi geen zorunluluk deme Emri Rza ptal ekran iin geerli deildir. \n Benzer ekilde YS'ler hangi ortamlardan (web/mobil) hizmet veriyorsa, ayn ortam zerinden Rza ptal ekrann sunmaldr. \n 4.1.\tHesap Bilgisi Hizmeti Rza durum deiiklikleri \n Kural : Bir HK'nn, bir YS iin, bir HHS'de aktif tek bir rzas olabilir.\nBir HK hem kiisel olarak hem de bir kurumun kullancs olabilir. Bu durumda kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n Hesap Bilgisi Rzas istei HHSye iletilir. \na.\tHHS HK'ya ait ieride rza var m kontrol eder. Eer yoksa  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \nb.\tEer ieride rza varsa ; \n \n Yeni hesap bilgisi rzas talebi balatlmsa (oncekiRizaNo alannn hi gnderilmedii durum):  \ni. Rza durumu Yetki Bekleniyor - B ise; \n    HHS, sistemde Yetki Bekleniyor - B rza durumuna sahip kayt olduu iin, ncelikle eski kayd Yetki ptal - I durumuna getirir.  Rza ptal Detay Kodu Yeni Rza Talebi ile iptal olmaldr.  B  I / 01  Sonrasnda,  Yetki Bekleniyor - B  rza durumu ile yeni rza oluturur. \n \n  ii. Rza durumu Yetkilendirildi - Y veya Yetki Kullanld - K ise; \nHK'nn halihazrda verilmi bir rzas vardr. HHS, nce mevcut rzann iptalinin yaplmas gerektiine dair   TR.OHVPS.Business.ConsentAlreadyExists  hatasn dner. YS, HHS ya da YS uygulamas zerinden bu rzann iptal edilmesi gerektiine dair HK'ya bilgilendirme yapar. \n  iii.\tRza durumu Yetki Sonlandrld - S  ise Yetki Bekleniyor - B durumunda yeni rza no oluturur. \n  iv.\tRza durumu Yetki ptal - I ise  Yetki Bekleniyor - B  durumunda yeni rza no oluturur. \n \n \n Balatlan rza istei gncelleme ak ile balatlmas durumunda oncekiRizaNo deeri rza isteinde bulunan HKya ait olmaldr. HKya ait olmamas durumunda  TR.OHVPS.Business.CustomerNotFound  hatas dnlr. Ayn HK olmas durumunda ; \n i. nceki Rza durumu B: Yetki Bekleniyor , Y: Yetkilendirildi ya da I :Yetki ptal  ise;  TR.OHVPS.Business.ConsentStatusNotforUpdate  hatas verilecektir. \n ii. Yetki Kullanld - K ise; hesap rzas baarl gerekletiriliyor olup Yetki Bekleniyor - B durumunda yeni bir rza oluturulur. nceki hesap bilgisi rzas durumunda bir gncelleme yaplmaz. \n iii. Yetki Sonlandrld - S ise; Rza Gncelleme Zaman kontrol edilir. \n \tSonlandrld statsne gemesiyle birlikte rza gncelleme zaman zerinden 30 gn gemi ise  TR.OHVPS.Business.ConsentStatusNotforUpdate  hatas verilir. \n\t30 gn gememi ise; hesap rzas baarl gerekletiriliyor olup Yetki Bekleniyor - B durumunda yeni bir rza oluturulur. nceki hesap bilgisi rzas durumunda bir gncelleme yaplmaz. \n \n \n \n \n GKD baarl bir ekilde tamamlandnda Rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.  B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Taraycy kapatm olabilir) Rza Yetki Bekleniyor - B rza durumunda kalr.  5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B rza durumundaki kaytlar Yetki ptal  : Yetki Bekleniyor Sre Am olarak gncellenir.   B  I / 04  Bkz. 9. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine  rizaIptDtyKod  deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda/kartlarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n Eriim Belirteci API \n a. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B ya da Yetki Kullanld - K  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n   Hesap Rzas Gncelleme ak ile hesap bilgi rzas gncelleniyor ise yeni hesap bilgisi rzas K durumuna gncellendiinde nceki rza no durumu I  15 (Hesap Rza Gncelleme ile ptal) ile iptale ekilir. \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n Sorgulama: HBHS, rza alma akna balamadan nce, daha nce oluturulmu bir hesap bilgisi-rizasi kaynann durumunu, istee bal olarak alabilir. Rza numaras ile sorgulama yaplr. \n \n \n Hesap Bilgisi Rzasnn ptali: HBHS zerinden ya da HHS zerinden yaplan rza iptallerinde Rza durumu  Yetki ptal - I olarak gncellenir. Rza numaras ile iptal salanr. \n a. HHS zerinden rza iptali yapm olabilir.  Rza durumu sorgulanr. \n Rza numaras Yetki Bekleniyor - B ve Yetkilendirildi - Y ve Yetki Kullanld - K durumlarnda ise Yetki ptal durumuna getirilir. Rza gnclzmn timestamp ile gncellenir.\nHHS, Rza iptalinde ayn zamanda eriim belirtecini de invalid hale getirmelidir. \n B  I / 02 \n Y  I / 02 \n K  I / 02 \n b.\tYS zerinden yaplacak iptal ileminde yine Y ve B ve K rza durumlarnda ise iptal edilebilir. \n B  I / 03 \n Y  I / 03 \n K  I / 03 \n Rza durumu Yetki Sonlandrld - S  ise iptal gereklemez. Rza durumunuz iptal etmeye uygun deildir. hatas HK'ya yanstlr.  TR.OHVPS.Resource.ConsentRevoked \n \n \n HKnn verdii rza sresi dolmu olabilir.\nEriimin Geerli Olduu Son Tarih geldiinde Rza durumu Yetki Kullanlddan Yetki Sonlandrld durumuna ekilmelidir.   K  S \n \n \n Hesaplar, Bakiye ve lemler servislerinde eriim belirteci kontrol ve sonrasnda rza kontrol yaplmaldr.\nGeerli bir eriim belirteci yok ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n YS'n; Rza ptal - I ya da Yetki Sonlandrld - S rza durumlarnda Hesaplar, Bakiye ve lemler servislerini armamas beklenir. HHS'nin bu rza durumlar ile yaplm arlar olduunda  TR.OHVPS.Resource.ConsentRevoked  hatasn dnmesi gereklidir. \n Rza durumu Yetki Kullanld - K dnda ise  TR.OHVPS.Resource.ConsentMismatch  hatas verilmelidir. \n Rza durumu Yetki Kullanld - K ise servis aklarna devam edilir. \n Rza sorgulama API'sinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound hatas  verilmelidir. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor durumunda kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor   Rza ptal  / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi durumunda kalan kaytlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am: Yetkilendirildi  B  I / 05 \nYukarda bahsedilen, YS Sre Am nedeniyle rza iptal durum gncellemelerini yapmadan nce HHSyi sorgulayarak rza durumunu renmeli ve sre am dnda bir kodu varsa ayn kodla kendi sistemini gncellemelidir. \nEriimin Geerli Olduu Son Tarih geldiinde rza durumu Yetki Kullanlddan Yetki Sonlandrldya gncellenir.  K  S \n 4.2.\tdeme Bilgisi Hizmeti Rza Durum Deiiklikleri \n Kural : Bir HK'nn bir YS iin bir HHS'de istedii kadar rzas olabilir. \n Kurum ve kiisel rza ayn anda mevcut olabilmelidir. Rza nesneleri, HHS tarafndan uygun ekilde ynetilmelidir. \n \n \n deme Emri Rzas istei HHSye iletilir. eride rza olup olmamasna baklmakszn  Yetki Bekleniyor - B  rza durumu ile yeni rza no oluturur. \n \n \n GKD baarl bir ekilde tamamlandnda rza durumu Yetki Bekleniyordan Yetkilendirildiye gncellenir.   B  Y \n \n \n GKD'nin gereklemedii durumlardan HHS haberdar olmayabilir. \n HK GKD yapmadan ayrlm olabilir. (R: Browser kapatm olabilir)\nRza durumu Yetki Bekleniyor'dur. 5 dakika ierisinde sistem tarafndan Yetki Bekleniyor - B durumundaki kaytlar Rza ptal : Yetki Bekleniyor Sre Am olarak gncellenir. Bkz. 8. Madde. \n \n \n GKD'nin gereklemedii durumlardan HHS haberdardr. HHS yonlendirme adresinin query parametrelerine rizaIptDtyKod deerini ekleyerek bu durumu YSe bildirmek zorundadr. \n \n \n Rza durumunun  Yetkilendirildi\" , Yetki Kullanld olduu durum.  Yetki Bekleniyor  Yetki ptal   B   I / 07 \n \n \n Rzano ile kimlik bilgileri uyumazl.  Yetki Bekleniyor  Yetki ptal  B  I / 08 \n \n \n HK'nn HHS'de ilgili rnnn olmad durum (hesap/kart) Yetki Bekleniyor  Yetki ptal   B  I / 09 \n \n \n Ak bankaclk kanalnz ileme kapaldr.Yetki Bekleniyor  Yetki ptal  B  I / 10 \n \n \n Kullancnn HHS'deki hesaplarnda yeterli yetkisinin olmama durumu  Yetki Bekleniyor  Yetki ptal  B  I / 11 \n \n \n HHSnin HK iin yapt kontrollerin baarsz olduu durum Yetki Bekleniyor  Yetki ptal   B  I / 12 \n \n \n HK istei ile GKDden vazgeildii durum Yetki Bekleniyor  Yetki ptal  B  I / 13 \n \n \n Fraud phesi Yetki Bekleniyor  Yetki ptal  B  I / 14 \n \n \n Dier Yetki Bekleniyor   Yetki ptal   B   I / 99 \n \n \n \n \n \n \n GKD muafiyeti olduunda YS HHSden arka planda onay alr. Bu onay srasnda rza durumu  Yetkilendirildi  yaplr.  B  Y \n \n \n Eriim Belirteci API \na. Eriim Belirteci'nin yetkilendirme kodu ile arm yapldnda; \n  i. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise   TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n ii. Rza durumu Yetki Bekleniyor - B , Yetki Kullanld - K  ya da Yetki deme emrine dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iii. Rza durumu Yetkilendirildi - Y olduunda eriim belirteci tahsis edilir.\nEriim belirteci alndnda rza durumu K: Yetki Kullanld yaplr.  Y K \n b. Yenileme belirteci karl eriim belirteci alnmas srasnda; yenileme belirteci kontrol ve sonrasnda rza kontrol yaplmaldr. \n  i. ncelikle Yenileme Belirteci Geerlik Sresi kontrol yaplmaldr. Geerli bir Yenileme Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n ii. Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n iii. Rza durumu Yetki Bekleniyor - B ya da Yetkilendirildi - Y  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n iv. Rza durumu Yetki Kullanld - K veya Yetki deme Emrine Dnt  E olduunda, yenileme belirteci karl eriim belirteci tahsis edilir. \n \n \n deme Balatma API nce eriim belirteci ve sonrasnda rza kontol yaplarak gerekletirilmelidir \n \n ncelikle Eriim Belirteci kontrol yaplmaldr. Geerli bir Eriim Belirteci olmad grlr ise  TR.OHVPS.Connection.InvalidToken  hatas dnlmelidir. \n Rza durumu Yetki ptal - I  ya da Yetki Sonlandrld - S ise  TR.OHVPS.Resource.ConsentRevoked  hatas dnlmelidir. \n Rza durumu Yetki Bekleniyor - B , Yetkilendirildi - Y, Yetki deme Emrine Dnt - E  ise  TR.OHVPS.Resource.ConsentMismatch  hatas dnlmelidir. \n Rza durumu Yetki Kullanld - K olduunda deme emri gerekletirilir.  Rza durumu Yetki Kullanld - K'dan Yetki deme Emrine Dnt  E yaplmaldr.   K E \n \n \n \n Sorgulama: GKD ileminin baaryla tamamlanp deme Emri Rzasnn yetkilendirilmesi esnasnda, gnderen hesap seiminin HHS ekrannda yapld durumlarda, deme emri isteinde gnderen hesap bilgileri alannn zorunlu olmas nedeniyle, demeEmriRizasi nesnesi sorgulanarak gnderen hesap bilgileri (hesap numaras ve/veya hesap referans) alnmaldr.\nRza sorgulama, deme Emri Sorgulama API'lerinde ilgili rza kayd bulunamaz veya sorgulayan kurumun yetkisi yoksa (rn : YSn farkl bir YSe ait rza noyu sorgulamas) \n TR.OHVPS.Resource.NotFound  hatas verilmelidir. \n \n \n deme Emri Rzasnn ptali bulunmamaktadr. \n \n \n HHS/YS tarafnda rza bilgileri belirli aralklarla sistem kullancs tarafndan taranr:\n5 dakikadan uzun sredir Yetki Bekleniyor'da kalan kaytlarn durumlar gncellenir.\nYetki Bekleniyor  Rza ptal / Sre Am : Yetki Bekleniyor  B  I / 04 \n 5 dakikadan uzun sredir Yetkilendirildi'de kalan kaytlar durumlar gncellenir.\nYetkilendirildi      Rza ptal / Sre Am : Yetkilendirildi  B  I / 05 \n 5 dakikadan uzun sredir Yetki kullanld'da kalan kaytlar durumlar gncellenir.\nYetki kullanld  Rza ptal / Sre Am : Yetki demeye Dnmedi  B  I / 06 \n Yenileme belirteci Son Tarih geldiinde rza durumu Yetki deme emrine dntden Yetki Sonlandrld'ya gncellenir. \n E  S \n \n \n GKD muafiyeti sadece deme balatma servislerinde bulunmaktadr. \n \n \n"},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/hesap-bilgisi-api.html",relativePath:"v2.0.0/deneyalani/hesap-bilgisi-api.md",key:"v-7b0a82c6",path:"/v2.0.0/deneyalani/hesap-bilgisi-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/genel-bilgiler.html",relativePath:"v2.0.0/deneyalani/genel-bilgiler.md",key:"v-48365a59",path:"/v2.0.0/deneyalani/genel-bilgiler.html",content:" GENEL BiLGLER: \n HVPS API lke ve Kurallar dokmanna istinaden gelitirmelerini yapan/yapacak olan katlmclar gelitirdikleri srme ait APIlerin nasl altklarn grmek istediklerinde Deney Alan zerinden gzlem yapabilirler. Bu kapsamda, Deney Alan katlmclara tarayc zerinden statik verilerle ilem balatarak, dnen yant inceleme imkan sunar. \n Deney Alan ile sunulan imkanlar u ekildedir: \n \n Servisler durum bilgisi iermeyecek ekilde (stateless) olarak sunulmaktadr. \n Gl Kimlik Dorulama aklarnda kurum zelinde oluturulan yetkilendirme kimlik bilgilerine ihtiya duyulmamaktadr. \n Yant veri kmesi statiktir. Servislere yaplan istekler, her zaman ayn yant dnmektedir. \n Yeni oluturma, gncelleme, silme ilemleri kaynak veri zerinde deiiklik yapmamaktadr. \n Deney alan genelin kullanmna aktr. yelik kayd olmakszn Deney Alan zerinden API incelemeleri gerekletirilebilmektedir. \n API dokmannda yaplacak minor deiiklikler deney alanna yanstlmayacaktr. \n \n Not: Deney Alannn kapsam geniletilmi versiyonu  BKM HVPS Simlatr uygulamas hem HHS hem de YS katlmclarnn; test uygulamalarn utan uca test edebilebilecei bir ortamdr. Simlatr uygulamas zerinden dinamik veri girii yaparak, gelitirilen servisler ile zorunlu senaryolarn tmnn simlasyonu gerekletirilebilir. Simlatr ortamndaki APIler, retim ortamnn bir kopyas olacak ekilde oluturulmutur ve kurumlarn retim ortamna hazr hale gelmelerine araclk eder. Bu uygulama, przsz bir retim ortam geii imkan salar ve HVPS BKM Teknik Sertifikasyonu gemek iin koulmas gereken sertifikasyon senaryolar BKM HVPS Simlatr zerinden sunulmaktadr. BKM Simlatr kullanm iin ayr bir sre iletilmekte olup daha fazla detayl bilgi almak iin ohvps@bkm.com.tr adresine taleplerinizi iletmeniz gerekmektedir. \n deme Emri Balatma API Deney Alan \n"},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/hhs-yos-api.html",relativePath:"v2.0.0/deneyalani/hhs-yos-api.md",key:"v-d8bdee46",path:"/v2.0.0/deneyalani/hhs-yos-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/ileri-tarihli-odeme-emri-api.html",relativePath:"v2.0.0/deneyalani/ileri-tarihli-odeme-emri-api.md",key:"v-b537e5f2",path:"/v2.0.0/deneyalani/ileri-tarihli-odeme-emri-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/odeme-emri-api.html",relativePath:"v2.0.0/deneyalani/odeme-emri-api.md",key:"v-35eaf572",path:"/v2.0.0/deneyalani/odeme-emri-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/olay-bildirim-api.html",relativePath:"v2.0.0/deneyalani/olay-bildirim-api.md",key:"v-5a2e0d7d",path:"/v2.0.0/deneyalani/olay-bildirim-api.html",content:" \n   \n "},{frontmatter:{},regularPath:"/v2.0.0/deneyalani/test.html",relativePath:"v2.0.0/deneyalani/test.md",key:"v-aa99c1f6",path:"/v2.0.0/deneyalani/test.html",content:" \n   \n "}],themeConfig:{searchMaxSuggestions:20,footer:'\n      &copy; <a href="https://github.com/Renovamen" target="_blank">Renovamen</a> 2018-2021\n      <br>\n      Powered by <a href="https://vuepress.vuejs.org" target="_blank">VuePress</a> &\n      <a href="https://github.com/Renovamen/vuepress-theme-gungnir" target="_blank">Gungnir</a>\n    ',sidebar:[{title:"SRM 2.0.0 - Aktif Srm",path:"/v2.0.0/contents/tanim-ve-kisitlamalar",children:[{title:"1. Tanmlar ve Kstlamalar",path:"/v2.0.0/contents/tanim-ve-kisitlamalar"},{title:"2. Kapsam ve Dayanak",path:"/v2.0.0/contents/kapsam-ve-dayanak"},{title:"3. Temel Prensipler",path:"/v2.0.0/contents/temel-prensipler"},{title:"4. Rza Durumlar",path:"/v2.0.0/contents/riza-durumlari"},{title:"5. Gl Kimlik Dorulama",path:"/v2.0.0/contents/gkd"},{title:"6. deme Emri Balatma Hizmeti",path:"/v2.0.0/contents/odeme-emri-baslatma-hizmeti"},{title:"7. leri Tarihli deme Emri Balatma Hizmeti",path:"/v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti"},{title:"8. Dzenli deme Emri Balatma Hizmeti",path:"/v2.0.0/contents/duzenli-odeme-emri-hizmeti"},{title:"9. Hesap Bilgisi Hizmeti",path:"/v2.0.0/contents/hesap-bilgisi-hizmeti"},{title:"10. HHS ve YS API",path:"/v2.0.0/contents/hhs-yos-api"},{title:"11. Gl Kimlik Dorulama API",path:"/v2.0.0/contents/erisim-belirteci"},{title:"12. Olay Bildirim",path:"/v2.0.0/contents/olay-bildirim"},{title:"13. Ekler",path:"/v2.0.0/contents/ekler"},{title:"14. Deney Alan",path:"/v2.0.0/deneyalani/genel-bilgiler",children:[{title:"1. deme Emri Balatma API",path:"/v2.0.0/deneyalani/odeme-emri-api"},{title:"2. leri Tarihli deme Emri Balatma API",path:"/v2.0.0/deneyalani/ileri-tarihli-odeme-emri-api"},{title:"3. Dzenli deme Emri Balatma API",path:"/v2.0.0/deneyalani/duzenli-odeme-emri-api"},{title:"4. Hesap Bilgisi API",path:"/v2.0.0/deneyalani/hesap-bilgisi-api"},{title:"5. HHS - YS API",path:"/v2.0.0/deneyalani/hhs-yos-api"},{title:"6. Olay Bildirim",path:"/v2.0.0/deneyalani/olay-bildirim-api"}]}]},{title:"Dijital Czdanlardan TR Karekod ile deme",path:"/dijital-cuzdan"},{title:"Srm Ynetimi",path:"/surum-yonetimi"},{title:"SRM 1.0.1",path:"/v1.0.1/contents/tanim-ve-kisitlamalar",children:[{title:"1. Tanmlar ve Kstlamalar",path:"/v1.0.1/contents/tanim-ve-kisitlamalar"},{title:"2. Kapsam ve Dayanak",path:"/v1.0.1/contents/kapsam-ve-dayanak"},{title:"3. Temel Prensipler",path:"/v1.0.1/contents/temel-prensipler"},{title:"4. Rza Durumlar",path:"/v1.0.1/contents/riza-durumlari"},{title:"5. Gl Kimlik Dorulama",path:"/v1.0.1/contents/gkd"},{title:"6. deme Emri Balatma Hizmeti",path:"/v1.0.1/contents/odeme-emri-baslatma-hizmeti"},{title:"7. Hesap Bilgisi Hizmeti",path:"/v1.0.1/contents/hesap-bilgisi-hizmeti"},{title:"8. HHS ve YS API",path:"/v1.0.1/contents/hhs-yos-api"},{title:"9. Eriim Belirteci API",path:"/v1.0.1/contents/erisim-belirteci"},{title:"10. Ekler",path:"/v1.0.1/contents/ekler"}]},{title:"SRM 1.0.2",path:"/v1.0.2/contents/tanim-ve-kisitlamalar",children:[{title:"1. Tanmlar ve Kstlamalar",path:"/v1.0.2/contents/tanim-ve-kisitlamalar"},{title:"2. Kapsam ve Dayanak",path:"/v1.0.2/contents/kapsam-ve-dayanak"},{title:"3. Temel Prensipler",path:"/v1.0.2/contents/temel-prensipler"},{title:"4. Rza Durumlar",path:"/v1.0.2/contents/riza-durumlari"},{title:"5. Gl Kimlik Dorulama",path:"/v1.0.2/contents/gkd"},{title:"6. deme Emri Balatma Hizmeti",path:"/v1.0.2/contents/odeme-emri-baslatma-hizmeti"},{title:"7. Hesap Bilgisi Hizmeti",path:"/v1.0.2/contents/hesap-bilgisi-hizmeti"},{title:"8. HHS ve YS API",path:"/v1.0.2/contents/hhs-yos-api"},{title:"9. Eriim Belirteci API",path:"/v1.0.2/contents/erisim-belirteci"},{title:"10. Ekler",path:"/v1.0.2/contents/ekler"}]},{title:"SRM 1.1.0",path:"/v1.1.0/contents/tanim-ve-kisitlamalar",children:[{title:"1. Tanmlar ve Kstlamalar",path:"/v1.1.0/contents/tanim-ve-kisitlamalar"},{title:"2. Kapsam ve Dayanak",path:"/v1.1.0/contents/kapsam-ve-dayanak"},{title:"3. Temel Prensipler",path:"/v1.1.0/contents/temel-prensipler"},{title:"4. Rza Durumlar",path:"/v1.1.0/contents/riza-durumlari"},{title:"5. Gl Kimlik Dorulama",path:"/v1.1.0/contents/gkd"},{title:"6. deme Emri Balatma Hizmeti",path:"/v1.1.0/contents/odeme-emri-baslatma-hizmeti"},{title:"7. Hesap Bilgisi Hizmeti",path:"/v1.1.0/contents/hesap-bilgisi-hizmeti"},{title:"8. HHS ve YS API",path:"/v1.1.0/contents/hhs-yos-api"},{title:"9. Gl Kimlik Dorulama API",path:"/v1.1.0/contents/erisim-belirteci"},{title:"10. Olay Bildirim",path:"/v1.1.0/contents/olay-bildirim"},{title:"11. Ekler",path:"/v1.1.0/contents/ekler"},{title:"12. Deney Alan",path:"/v1.1.0/deneyalani/genel-bilgiler",children:[{title:"1. deme Emri Balatma API",path:"/v1.1.0/deneyalani/odeme-emri-api"},{title:"2. Hesap Bilgisi API",path:"/v1.1.0/deneyalani/hesap-bilgisi-api"},{title:"3. HHS - YS API",path:"/v1.1.0/deneyalani/hhs-yos-api"},{title:"4. Olay Bildirim",path:"/v1.1.0/deneyalani/olay-bildirim-api"}]}]},{title:"HVPS Ska Sorulan Sorular",path:"/sorulan-sorular"},{title:"HVPS Uyum Tarihleri",path:"/uyum-tarihleri"}],logo:"/assets/TCMB_logo.svg.png"}};i(273);a.default.component("DeleteBox",()=>Promise.all([i.e(0),i.e(48)]).then(i.bind(null,753))),a.default.component("BodyBox",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(6),i.e(38)]).then(i.bind(null,754))),a.default.component("DuzenliOdemeEmriAPIv20",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(19)]).then(i.bind(null,741))),a.default.component("GetBox",()=>Promise.all([i.e(0),i.e(49)]).then(i.bind(null,755))),a.default.component("Gkd",()=>Promise.all([i.e(0),i.e(42)]).then(i.bind(null,756))),a.default.component("HesapBilgisiV11",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(17)]).then(i.bind(null,742))),a.default.component("HesapBilgisiV20",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(20)]).then(i.bind(null,743))),a.default.component("HhsYosAPIV11",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(15)]).then(i.bind(null,744))),a.default.component("KeyValueGrid",()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(6),i.e(39)]).then(i.bind(null,757))),a.default.component("OdemeEmriAPIv11",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(18)]).then(i.bind(null,745))),a.default.component("OlayDinlemeAPIV11",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(16)]).then(i.bind(null,746))),a.default.component("PostBox",()=>Promise.all([i.e(0),i.e(50)]).then(i.bind(null,758))),a.default.component("ProcessButton",()=>Promise.all([i.e(1),i.e(58)]).then(i.bind(null,759))),a.default.component("ProcessTitle",()=>Promise.all([i.e(0),i.e(51)]).then(i.bind(null,760))),a.default.component("PutBox",()=>Promise.all([i.e(0),i.e(52)]).then(i.bind(null,761))),a.default.component("Request",()=>i.e(68).then(i.bind(null,396))),a.default.component("Response",()=>Promise.all([i.e(1),i.e(2),i.e(3),i.e(59)]).then(i.bind(null,762))),a.default.component("RizaOnay",()=>Promise.all([i.e(0),i.e(53)]).then(i.bind(null,763))),a.default.component("RizaOnayHesapBilgisi",()=>Promise.all([i.e(0),i.e(54)]).then(i.bind(null,764))),a.default.component("TitleBox",()=>Promise.all([i.e(0),i.e(55)]).then(i.bind(null,765))),a.default.component("ileriTarihliOdemeEmriAPIv20",()=>Promise.all([i.e(0),i.e(1),i.e(2),i.e(3),i.e(21)]).then(i.bind(null,747))),a.default.component("Badge",()=>Promise.all([i.e(0),i.e(9)]).then(i.bind(null,766))),a.default.component("CodeBlock",()=>Promise.all([i.e(0),i.e(10)]).then(i.bind(null,749))),a.default.component("CodeGroup",()=>Promise.all([i.e(0),i.e(11)]).then(i.bind(null,750)));i(274);var In=[({Vue:e,options:n,router:i,siteData:a})=>{a.pages=a.pages.reverse().map(e=>(e.regularPath.includes("content")?e.title=`${e.title} -> ${e.regularPath.split("/")[1]}`:e.title=""+e.title,e))},{},({Vue:e})=>{e.mixin({computed:{$dataBlock(){return this.$options.__data__block__}}})},{},{}],En=[];class Zn extends class{constructor(){this.store=new a.default({data:{state:{}}})}$get(e){return this.store.state[e]}$set(e,n){a.default.set(this.store.state,e,n)}$emit(...e){this.store.$emit(...e)}$on(...e){this.store.$on(...e)}}{}Object.assign(Zn.prototype,{getPageAsyncComponent:mn,getLayoutAsyncComponent:un,getAsyncComponent:on,getVueComponent:kn});var Gn={install(e){const n=new Zn;e.$vuepress=n,e.prototype.$vuepress=n}};function Cn(e,n){const i=n.toLowerCase();return e.options.routes.some(e=>e.path.toLowerCase()===i)}var Vn={props:{pageKey:String,slotKey:{type:String,default:"default"}},render(e){const n=this.pageKey||this.$parent.$page.key;return bn("pageKey",n),a.default.component(n)||a.default.component(n,mn(n)),a.default.component(n)?e(n):e("")}},Mn={functional:!0,props:{slotKey:String,required:!0},render:(e,{props:n,slots:i})=>e("div",{class:["content__"+n.slotKey]},i()[n.slotKey])},_n={computed:{openInNewWindowTitle(){return this.$themeLocaleConfig.openNewWindowText||"(opens new window)"}}},Fn=(i(275),i(276),Object(Pn.a)(_n,(function(){var e=this._self._c;return e("span",[e("svg",{staticClass:"icon outbound",attrs:{xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",x:"0px",y:"0px",viewBox:"0 0 100 100",width:"15",height:"15"}},[e("path",{attrs:{fill:"currentColor",d:"M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"}}),this._v(" "),e("polygon",{attrs:{fill:"currentColor",points:"45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"}})]),this._v(" "),e("span",{staticClass:"sr-only"},[this._v(this._s(this.openInNewWindowTitle))])])}),[],!1,null,null,null).exports),xn={functional:!0,render(e,{parent:n,children:i}){if(n._isMounted)return i;n.$once("hook:mounted",()=>{n.$forceUpdate()})}};a.default.config.productionTip=!1,a.default.use(je),a.default.use(Gn),a.default.mixin(function(e,n,i=a.default){!function(e){e.locales&&Object.keys(e.locales).forEach(n=>{e.locales[n].path=n});Object.freeze(e)}(n),i.$vuepress.$set("siteData",n);const r=new(e(i.$vuepress.$get("siteData"))),l=Object.getOwnPropertyDescriptors(Object.getPrototypeOf(r)),t={};return Object.keys(l).reduce((e,n)=>(n.startsWith("$")&&(e[n]=l[n].get),e),t),{computed:t}}(e=>class{setPage(e){this.__page=e}get $site(){return e}get $themeConfig(){return this.$site.themeConfig}get $frontmatter(){return this.$page.frontmatter}get $localeConfig(){const{locales:e={}}=this.$site;let n,i;for(const a in e)"/"===a?i=e[a]:0===this.$page.path.indexOf(a)&&(n=e[a]);return n||i||{}}get $siteTitle(){return this.$localeConfig.title||this.$site.title||""}get $canonicalUrl(){const{canonicalUrl:e}=this.$page.frontmatter;return"string"==typeof e&&e}get $title(){const e=this.$page,{metaTitle:n}=this.$page.frontmatter;if("string"==typeof n)return n;const i=this.$siteTitle,a=e.frontmatter.home?null:e.frontmatter.title||e.title;return i?a?a+" | "+i:i:a||"VuePress"}get $description(){const e=function(e){if(e){const n=e.filter(e=>"description"===e.name)[0];if(n)return n.content}}(this.$page.frontmatter.meta);return e||(this.$page.frontmatter.description||this.$localeConfig.description||this.$site.description||"")}get $lang(){return this.$page.frontmatter.lang||this.$localeConfig.lang||"en-US"}get $localePath(){return this.$localeConfig.path||"/"}get $themeLocaleConfig(){return(this.$site.themeConfig.locales||{})[this.$localePath]||{}}get $page(){return this.__page?this.__page:function(e,n){for(let i=0;i<e.length;i++){const a=e[i];if(a.path.toLowerCase()===n.toLowerCase())return a}return{path:"",frontmatter:{}}}(this.$site.pages,this.$route.path)}},Dn)),a.default.component("Content",Vn),a.default.component("ContentSlotsDistributor",Mn),a.default.component("OutboundLink",Fn),a.default.component("ClientOnly",xn),a.default.component("Layout",un("Layout")),a.default.component("NotFound",un("NotFound")),a.default.prototype.$withBase=function(e){const n=this.$site.base;return"/"===e.charAt(0)?n+e.slice(1):e},window.__VUEPRESS__={version:"1.9.10",hash:"c4eea4e"},async function(e){const n="undefined"!=typeof window&&window.__VUEPRESS_ROUTER_BASE__?window.__VUEPRESS_ROUTER_BASE__:Dn.routerBase||Dn.base,i=new je({base:n,mode:"history",fallback:!1,routes:On,scrollBehavior:(e,n,i)=>i||(e.hash?!a.default.$vuepress.$get("disableScrollBehavior")&&{selector:decodeURIComponent(e.hash)}:{x:0,y:0})});!function(e){e.beforeEach((n,i,a)=>{if(Cn(e,n.path))a();else if(/(\/|\.html)$/.test(n.path))if(/\/$/.test(n.path)){const i=n.path.replace(/\/$/,"")+".html";Cn(e,i)?a(i):a()}else a();else{const i=n.path+"/",r=n.path+".html";Cn(e,r)?a(r):Cn(e,i)?a(i):a()}})}(i);const r={};try{await Promise.all(In.filter(e=>"function"==typeof e).map(n=>n({Vue:a.default,options:r,router:i,siteData:Dn,isServer:e})))}catch(e){console.error(e)}return{app:new a.default(Object.assign(r,{router:i,render:e=>e("div",{attrs:{id:"app"}},[e("RouterView",{ref:"layout"}),e("div",{class:"global-ui"},En.map(n=>e(n)))])})),router:i}}(!1).then(({app:e,router:n})=>{n.onReady(()=>{e.$mount("#app")})})}]);