<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>9.	Hesap Bilgisi Hizmeti -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 -&gt; v2.0.0 | (ÖHVPS) API İLKE VE KURALLARI</title>
    <meta name="generator" content="VuePress 1.9.10">
    
    <meta name="description" content=" ">
    
    <link rel="preload" href="/assets/css/0.styles.eea653da.css" as="style"><link rel="preload" href="/assets/js/app.326e02a8.js" as="script"><link rel="preload" href="/assets/js/8.9be4df52.js" as="script"><link rel="preload" href="/assets/js/5.15938fdf.js" as="script"><link rel="preload" href="/assets/js/4.251ecbb8.js" as="script"><link rel="preload" href="/assets/js/31.de85b863.js" as="script"><link rel="prefetch" href="/assets/js/1.d37393f1.js"><link rel="prefetch" href="/assets/js/10.0013b1ca.js"><link rel="prefetch" href="/assets/js/100.dba863f9.js"><link rel="prefetch" href="/assets/js/101.1cf45b77.js"><link rel="prefetch" href="/assets/js/102.d5aaf076.js"><link rel="prefetch" href="/assets/js/103.7d128a6a.js"><link rel="prefetch" href="/assets/js/104.c169d65e.js"><link rel="prefetch" href="/assets/js/105.0cd95c7e.js"><link rel="prefetch" href="/assets/js/106.781f2cdf.js"><link rel="prefetch" href="/assets/js/107.320e6ac1.js"><link rel="prefetch" href="/assets/js/108.bccfa910.js"><link rel="prefetch" href="/assets/js/109.db7c7fc1.js"><link rel="prefetch" href="/assets/js/11.a3070fdc.js"><link rel="prefetch" href="/assets/js/110.932844af.js"><link rel="prefetch" href="/assets/js/111.e0e213cf.js"><link rel="prefetch" href="/assets/js/12.566a3746.js"><link rel="prefetch" href="/assets/js/15.d1b7b5ca.js"><link rel="prefetch" href="/assets/js/16.fa3faba3.js"><link rel="prefetch" href="/assets/js/17.1a0c8e92.js"><link rel="prefetch" href="/assets/js/18.f1a32fb9.js"><link rel="prefetch" href="/assets/js/19.db50cfa3.js"><link rel="prefetch" href="/assets/js/2.489d4464.js"><link rel="prefetch" href="/assets/js/20.08e89fa0.js"><link rel="prefetch" href="/assets/js/21.83e734ab.js"><link rel="prefetch" href="/assets/js/22.ddb88fe1.js"><link rel="prefetch" href="/assets/js/23.e7f73ff9.js"><link rel="prefetch" href="/assets/js/24.bd8dbdc4.js"><link rel="prefetch" href="/assets/js/25.d3c8b620.js"><link rel="prefetch" href="/assets/js/26.6488c006.js"><link rel="prefetch" href="/assets/js/27.ff1d9e6b.js"><link rel="prefetch" href="/assets/js/28.3e562957.js"><link rel="prefetch" href="/assets/js/29.7b2fef87.js"><link rel="prefetch" href="/assets/js/3.972778d6.js"><link rel="prefetch" href="/assets/js/30.e8340684.js"><link rel="prefetch" href="/assets/js/32.3a00f403.js"><link rel="prefetch" href="/assets/js/33.0a13a7bf.js"><link rel="prefetch" href="/assets/js/34.7c089a6b.js"><link rel="prefetch" href="/assets/js/35.384f732f.js"><link rel="prefetch" href="/assets/js/36.49559611.js"><link rel="prefetch" href="/assets/js/37.12a3b273.js"><link rel="prefetch" href="/assets/js/38.0937fed2.js"><link rel="prefetch" href="/assets/js/39.5675569f.js"><link rel="prefetch" href="/assets/js/40.1672db31.js"><link rel="prefetch" href="/assets/js/41.7b8afaf4.js"><link rel="prefetch" href="/assets/js/42.a57930f8.js"><link rel="prefetch" href="/assets/js/43.08b78d5f.js"><link rel="prefetch" href="/assets/js/44.afbd95bd.js"><link rel="prefetch" href="/assets/js/45.a8463416.js"><link rel="prefetch" href="/assets/js/46.9b1bb3df.js"><link rel="prefetch" href="/assets/js/47.b38fa65c.js"><link rel="prefetch" href="/assets/js/48.6739b207.js"><link rel="prefetch" href="/assets/js/49.64c6d819.js"><link rel="prefetch" href="/assets/js/50.9823450c.js"><link rel="prefetch" href="/assets/js/51.b82cae03.js"><link rel="prefetch" href="/assets/js/52.d1db42cd.js"><link rel="prefetch" href="/assets/js/53.6e7eefae.js"><link rel="prefetch" href="/assets/js/54.76e88dfe.js"><link rel="prefetch" href="/assets/js/55.f0875cb9.js"><link rel="prefetch" href="/assets/js/56.58f71397.js"><link rel="prefetch" href="/assets/js/57.eb78941b.js"><link rel="prefetch" href="/assets/js/58.40bf9850.js"><link rel="prefetch" href="/assets/js/59.501b2319.js"><link rel="prefetch" href="/assets/js/6.212096e3.js"><link rel="prefetch" href="/assets/js/60.3cc60006.js"><link rel="prefetch" href="/assets/js/61.1fe88ee1.js"><link rel="prefetch" href="/assets/js/62.450445cc.js"><link rel="prefetch" href="/assets/js/63.9862a296.js"><link rel="prefetch" href="/assets/js/64.f1e7ad33.js"><link rel="prefetch" href="/assets/js/65.0abe6f4e.js"><link rel="prefetch" href="/assets/js/66.60a0e238.js"><link rel="prefetch" href="/assets/js/67.feca7be4.js"><link rel="prefetch" href="/assets/js/68.b7d9e107.js"><link rel="prefetch" href="/assets/js/69.b1a09e5f.js"><link rel="prefetch" href="/assets/js/7.ba226371.js"><link rel="prefetch" href="/assets/js/70.b3527401.js"><link rel="prefetch" href="/assets/js/71.0744564b.js"><link rel="prefetch" href="/assets/js/72.5e540fea.js"><link rel="prefetch" href="/assets/js/73.9f75d65a.js"><link rel="prefetch" href="/assets/js/74.5a79b7f0.js"><link rel="prefetch" href="/assets/js/75.f262b7f9.js"><link rel="prefetch" href="/assets/js/76.5cd4030f.js"><link rel="prefetch" href="/assets/js/77.9ecd8906.js"><link rel="prefetch" href="/assets/js/78.e2a62c01.js"><link rel="prefetch" href="/assets/js/79.e74d2f85.js"><link rel="prefetch" href="/assets/js/80.ac72ceb5.js"><link rel="prefetch" href="/assets/js/81.72a03af0.js"><link rel="prefetch" href="/assets/js/82.1c394b07.js"><link rel="prefetch" href="/assets/js/83.7cc9e801.js"><link rel="prefetch" href="/assets/js/84.279042ec.js"><link rel="prefetch" href="/assets/js/85.8a7e0ce8.js"><link rel="prefetch" href="/assets/js/86.e3c24a03.js"><link rel="prefetch" href="/assets/js/87.6520c62e.js"><link rel="prefetch" href="/assets/js/88.13d05603.js"><link rel="prefetch" href="/assets/js/89.8b7a37aa.js"><link rel="prefetch" href="/assets/js/9.e8c984ba.js"><link rel="prefetch" href="/assets/js/90.56e4e08d.js"><link rel="prefetch" href="/assets/js/91.c6bd03ab.js"><link rel="prefetch" href="/assets/js/92.333ee7e0.js"><link rel="prefetch" href="/assets/js/93.756ec610.js"><link rel="prefetch" href="/assets/js/94.0569f129.js"><link rel="prefetch" href="/assets/js/95.55fc8bd3.js"><link rel="prefetch" href="/assets/js/96.655eb5a1.js"><link rel="prefetch" href="/assets/js/97.b75970f7.js"><link rel="prefetch" href="/assets/js/98.b825bc21.js"><link rel="prefetch" href="/assets/js/99.46c91b39.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.5a984fc5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.eea653da.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/TCMB_logo.svg.png" alt="(ÖHVPS) API İLKE VE KURALLARI" class="logo"> <span class="site-name can-hide">(ÖHVPS) API İLKE VE KURALLARI</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/v2.0.0/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable open"><span>SÜRÜM 2.0.0 - Aktif Sürüm</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/v2.0.0/contents/tanim-ve-kisitlamalar.html" class="sidebar-link">1. Tanımlar ve Kısıtlamalar</a></li><li><a href="/v2.0.0/contents/kapsam-ve-dayanak.html" class="sidebar-link">2. Kapsam ve Dayanak</a></li><li><a href="/v2.0.0/contents/temel-prensipler.html" class="sidebar-link">3. Temel Prensipler</a></li><li><a href="/v2.0.0/contents/riza-durumlari.html" class="sidebar-link">4. Rıza Durumları</a></li><li><a href="/v2.0.0/contents/gkd.html" class="sidebar-link">5. Güçlü Kimlik Doğrulama</a></li><li><a href="/v2.0.0/contents/odeme-emri-baslatma-hizmeti.html" class="sidebar-link">6. Ödeme Emri Başlatma Hizmeti</a></li><li><a href="/v2.0.0/contents/ileri-tarihli-odeme-emri-hizmeti.html" class="sidebar-link">7. İleri Tarihli Ödeme Emri Başlatma Hizmeti</a></li><li><a href="/v2.0.0/contents/duzenli-odeme-emri-hizmeti.html" class="sidebar-link">8. Düzenli Ödeme Emri Başlatma Hizmeti</a></li><li><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html" aria-current="page" class="active sidebar-link">9. Hesap Bilgisi Hizmeti</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#genel-bilgiler" class="sidebar-link">Genel Bilgiler</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#hesap-bilgisi-hizmeti-icin-erisim-adresleri" class="sidebar-link">Hesap Bilgisi Hizmeti İçin Erişim Adresleri</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#adim-0-ohk-nın-hesap-kart-bilgilerine-erisim-icin-talepte-bulunması" class="sidebar-link">ADIM 0: ÖHK'nın hesap/kart bilgilerine erişim için talepte bulunması:</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-1-adim-1-hesap-bilgisi-rızasının-hazırlanması" class="sidebar-link">9.1 ADIM 1: Hesap Bilgisi Rızasının Hazırlanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#izinler" class="sidebar-link">İzinler</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-2-adim-2-hesap-bilgisi-hizmeti-rızasının-tesisi" class="sidebar-link">9.2 ADIM 2: Hesap Bilgisi Hizmeti Rızasının Tesisi</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-3-adim-2-1-hesap-bilgisi-rızasının-sorgulanması" class="sidebar-link">9.3 ADIM 2.1: Hesap Bilgisi Rızasının Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-4-adim-2-2-hesap-bilgisi-rızasının-iptali" class="sidebar-link">9.4 ADIM 2.2: Hesap Bilgisi Rızasının İptali</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-5-adim-3-hesap-bilgilerinin-alınması" class="sidebar-link">9.5 ADIM 3: Hesap Bilgilerinin Alınması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanması" class="sidebar-link">9.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanması" class="sidebar-link">9.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-8-adim-3-5-ve-3-6-islemlerin-sorgulanması" class="sidebar-link">9.8 ADIM 3.5 ve 3.6: İşlemlerin Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-9-adim-4-kart-bilgilerinin-sorgulanması" class="sidebar-link">9.9 ADIM 4: Kart Bilgilerinin Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-10-adim-4-1-kart-detay-bilgilerinin-sorgulanması" class="sidebar-link">9.10 ADIM 4.1: Kart Detay Bilgilerinin Sorgulanması</a></li><li class="sidebar-sub-header"><a href="/v2.0.0/contents/hesap-bilgisi-hizmeti.html#_9-11-adim-4-2-kart-hareket-bilgilerinin-sorgulanması" class="sidebar-link">9.11 ADIM 4.2: Kart Hareket Bilgilerinin Sorgulanması</a></li></ul></li><li><a href="/v2.0.0/contents/hhs-yos-api.html" class="sidebar-link">10. HHS ve YÖS API</a></li><li><a href="/v2.0.0/contents/erisim-belirteci.html" class="sidebar-link">11. Güçlü Kimlik Doğrulama API</a></li><li><a href="/v2.0.0/contents/olay-bildirim.html" class="sidebar-link">12. Olay Bildirim</a></li><li><a href="/v2.0.0/contents/ekler.html" class="sidebar-link">13. Ekler</a></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><a href="/v2.0.0/deneyalani/genel-bilgiler" class="sidebar-heading clickable"><span>14. Deney Alanı</span> <span class="arrow right"></span></a> <!----></section></li></ul></section></li><li><a href="/dijital-cuzdan.html" class="sidebar-link">Dijital Cüzdanlardan TR Karekod ile Ödeme</a></li><li><a href="/surum-yonetimi.html" class="sidebar-link">Sürüm Yönetimi</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.1/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.1</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.0.2/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.0.2</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/v1.1.0/contents/tanim-ve-kisitlamalar" class="sidebar-heading clickable"><span>SÜRÜM 1.1.0</span> <span class="arrow right"></span></a> <!----></section></li><li><a href="/sorulan-sorular.html" class="sidebar-link">ÖHVPS Sıkça Sorulan Sorular</a></li><li><a href="/uyum-tarihleri.html" class="sidebar-link">ÖHVPS Uyum Tarihleri</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_9-hesap-bilgisi-hizmeti"><a href="#_9-hesap-bilgisi-hizmeti" class="header-anchor">#</a> 9.	Hesap Bilgisi Hizmeti </h1> <h2 id="genel-bilgiler"><a href="#genel-bilgiler" class="header-anchor">#</a> Genel Bilgiler</h2> <p><a href=""><strong>Bu dokümanda belirtilen &quot;Hesap Bilgisi Hizmeti&quot; ibaresi hem hesap hem de kart rıza süreçlerini kapsamaktadır.</strong></a></p> <p>Hesap bilgisi sorgulama için HBHS tarafından müşteri rızası tesisinin HHS tamamlanmış olması gerekir. Müşteri rızası tesisi tamamlandıktan sonra, HBHS sorgulamak istediği hesaba ait verileri ilgili erişim adresi üzerinden sorgular.</p> <img src="/assets/img/HesapBilgisiHizmetiUstDuzeyAkisiv2.9f7bf7b2.png" width="50%"> <p>Şekil 10: Hesap Bilgisi Hizmeti Üst Düzey Akışı</p> <p>Şekil-10’da sunulan hesap bilgisi hizmeti 5 temel akıştan oluşur:</p> <p><strong>0.	Müşterinin hesap bilgilerine erişim için talepte bulunması:</strong> ÖHK ÖBHS mobil uygulama ya da web sitesinden hesap bilgilerine erişim işlemini başlatır.</p> <p><strong>1.	Hesap Bilgisi müşteri rızasının hazırlanması:</strong></p> <p>HBHS, “hesap/kart bilgilerine erişim” için müşteri rızası tesisi amacıyla HHS’deki hesap bilgisi rızası erişim adresine bir POST isteğinde bulunur ve bir hesap bilgisi rızası nesnesi oluşturur. HHS hesap bilgisi rızası nesnesi için biricik tanımlayacı döner (RızaNo). Hesap bilgisi rızası, müşterinin HBHS’nin hesap/kart bilgilerine erişim izin verdiği alanları için 9.1 ADIM 1: Hesap Bilgisi Rızasının Hazırlanması başlığında incelenebilir.</p> <p><strong>2.	Hesap bilgisi hizmeti müşteri rızasının tesisi:</strong></p> <p>HHS, Hesap Bilgisi Rızası servisi ile ÖHK özelinde “Yetki bekleniyor” statüsünde bir rıza nesnesi hazırlar. HHS, GKD’nin başarıyla tamamlanması sonrasında hesap bilgisi rızası nesnesinin yetkilendirildiğini belirtmek için Rıza Durumunu “Rıza Yetkilendirildi” olarak günceller. Nesne yetkilendirildikten sonra HHS nesne ile bir erişim belirteci (access token) ilişkilendirir, Rıza Durumunu “Yetki Kullanıldı” yapar ve bu belirteci HBHS’ye geri döner.  Böylece müşteri rıza tesisi sağlanmış olur.</p> <p>Hesap bilgisi rızasına ilişkin temel ilkeler şunlardır:</p> <ul><li>1 ÖHK'nın 1 YÖS için 1HHS'de Yetki Bekleniyor, Yetkilendirildi, Yetki Kullanıldı statüsünde 1 rızası olabilir.</li> <li>Müşteri rızasının ayrıntıları ÖHK ile HBHS arasında belirlenir. Bu nedenle müşteri rızasının ayrıntıları HHS ekranında değiştirilmemelidir.</li> <li>ÖHK, hesap ve kart erişim izni ayrıntılarını yalnızca bir bütün olarak yetkilendirebilir veya geri alabilir.</li> <li>Müşteri rızası tesisi esnasında, müşteri HHS arayüzünde erişim için yetkilendirecek hesapları ve kartları seçer.</li> <li>Ödeme Sistemine doğrudan katılımcı olmayan HHS'ler, müşterilerine IBAN hizmeti sunmayabildikleri için hesap referansı ile akışlarını kurgulayabilirler. YÖS önyüzlerinde yapılan bilgilendirmelerde, IBAN harici hesap referansı ile işlem yapılabilmesine dikkat edilmelidir.</li></ul> <p><strong>2.1	Hesap bilgisi rızasının sorgulanması:</strong> Müşteri rızası <strong>GET/hesap-bilgisi-rizasi/{RizaNo}</strong> çağrısı yapılarak sorgulanır.</p> <p><strong>2.2	Hesap bilgisi müşteri rızasının iptali:</strong> Müşteri rızası <strong>DELETE/hesap-bilgisi-rizasi/{RizaNo}</strong> çağrısı yapılarak iptal edilir.</p> <p><strong>3.1	Hesap bilgilerinin alınması:</strong> Hesap bilgileri ilgili kaynağa (hesaplar, bakiye, işlemler) GET isteği yapılarak gerçekleştirilir. HBHS, müşteri rızasının tesisinden sonrasında (geçerli bir erişim belirticine sahip olduğunda) öncelikle <strong>GET/hesaplar</strong> çağrısı yapacaktır.</p> <p>Nezdinde ödeme hesabı bulunduran hesap hizmeti sağlayıcılar(Banka, EPK, Ödeme Kuruluşları) müşterilerine ait hesapları hesap referansı ya da hesap numarası üzerinden takip etmektedir. YÖS'lerin HBH servisleri için hesap referansı veya hesap numarası üzerinden işlem yapılabileceğini bilmeleri, sistemlerini API dokümanında belirtilen akışlara göre uyumlandırmaları ve müşteri bilgilendirmesini (önyüzlerinde hesap no ve hesap referansı ayrımını gözeterek) buna paralel yapmaları beklenmektedir.</p> <p><strong>4.	Kart bilgilerinin alınması:</strong>  Kart bilgileri ilgili kaynağa (kartlar, kart detayı, kart hareketleri) GET isteği yapılarak gerçekleştirilir. HBHS, müşteri rızasının tesisinden sonrasında (geçerli bir erişim belirticine sahip olduğunda) öncelikle <strong>GET/kartlar</strong> çağrısı yapacaktır.</p> <h2 id="hesap-bilgisi-hizmeti-icin-erisim-adresleri"><a href="#hesap-bilgisi-hizmeti-icin-erisim-adresleri" class="header-anchor">#</a> Hesap Bilgisi Hizmeti İçin Erişim Adresleri</h2> <p><strong>Etki Alanı (Scope) =“hesap_bilgisi”</strong></p> <table><thead><tr><th>No</th> <th>Kaynak</th> <th>HTTP işlemi</th> <th>Erişim Adresi</th> <th>Zorunlu / İsteğe Bağlı</th> <th>Yetkilendirme Türü</th> <th>İmzalama</th> <th>Parametre</th> <th>İstem Nesnesi</th> <th>Yanıt Nesnesi</th></tr></thead> <tbody><tr><td>1</td> <td>hesap-bilgisi-rizasi</td> <td>POST</td> <td>/hesap-bilgisi-rizasi</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı İstek ve Yanıt</td> <td></td> <td>HesapBilgisiRizasiIstegi</td> <td>HesapBilgisiRizasi</td></tr> <tr><td>2</td> <td>erisim-belirteci  (GKD için)</td> <td>POST</td> <td>/erisim-belirteci</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı İstek ve Yanıt</td> <td></td> <td>ErisimBelirteciIstegi</td> <td>ErisimBelirteci</td></tr> <tr><td>2.1</td> <td>hesap-bilgisi-rizasi</td> <td>GET</td> <td>/hesap-bilgisi-rizasi/{RizaNo}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri</td> <td>İmzalı Yanıt</td> <td></td> <td></td> <td>HesapBilgisiRizasi</td></tr> <tr><td>2.2</td> <td>hesap-bilgisi-rizasi</td> <td>DELETE</td> <td>/hesap-bilgisi-rizasi/{RizaNo}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD-Koşullu)</td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>3.1</td> <td>hesaplar</td> <td>GET</td> <td>/hesaplar</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama</td> <td></td> <td>HesapBilgileri(birden çok hesap)</td></tr> <tr><td>3.2</td> <td>hesaplar</td> <td>GET</td> <td>/hesaplar/{hspRef}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td></td> <td></td> <td>HesapBilgileri(tek  hesap)</td></tr> <tr><td>3.3</td> <td>bakiye</td> <td>GET</td> <td>/hesaplar/{hspRef}/bakiye</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td></td> <td></td> <td>BakiyeBilgileri(tek  hesap)</td></tr> <tr><td>3.4</td> <td>bakiye</td> <td>GET</td> <td>/bakiye</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama</td> <td></td> <td>BakiyeBilgileri(birden çok hesap)</td></tr> <tr><td>3.5</td> <td>islemler</td> <td>GET</td> <td>/hesaplar/{hspRef}/işlemler</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama Filtreleme</td> <td></td> <td>IslemBilgileri (tek hesap)</td></tr> <tr><td>4</td> <td>kartlar</td> <td>GET</td> <td>/kartlar</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama Filtreleme</td> <td></td> <td>KartBilgileri(birden çok kart)</td></tr> <tr><td>4.1</td> <td>kartlar</td> <td>GET</td> <td>/kartlar/{kartRef}</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama Filtreleme</td> <td></td> <td>KartBilgileri(tek kart)</td></tr> <tr><td>4.2</td> <td>kart-detay</td> <td>GET</td> <td>/kartlar/{kartRef}/kart-detay</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Filtreleme</td> <td></td> <td>KartDetayBilgileri</td></tr> <tr><td>4.3</td> <td>kart-hareketleri</td> <td>GET</td> <td>/kartlar/{kartRef}/kart-hareketleri</td> <td>Z</td> <td>İstemci Kimlik Bilgileri ve Yetkilendirme Kodu (GKD)</td> <td></td> <td>Sayfalama Filtreleme</td> <td></td> <td>KartHareketleri</td></tr></tbody></table> <p><strong>Tablo 11: Hesap/Kart Bilgisi Hizmeti İçin Erişim Adresleri</strong></p> <h2 id="adim-0-ohk-nın-hesap-kart-bilgilerine-erisim-icin-talepte-bulunması"><a href="#adim-0-ohk-nın-hesap-kart-bilgilerine-erisim-icin-talepte-bulunması" class="header-anchor">#</a> ADIM 0: ÖHK'nın hesap/kart bilgilerine erişim için talepte bulunması:</h2> <p>ÖHK, HBHS uygulamasında (web arayüzü/mobil uygulama) hesap/kart bilgilerine erişim için talepte bulunur.</p> <h2 id="_9-1-adim-1-hesap-bilgisi-rızasının-hazırlanması"><a href="#_9-1-adim-1-hesap-bilgisi-rızasının-hazırlanması" class="header-anchor">#</a> 9.1 ADIM 1: Hesap Bilgisi Rızasının Hazırlanması</h2> <p><strong>Bu dokümanda belirtilen hesap bilgisi hizmeti ibaresi hem hesap hem de kart rıza süreçlerini kapsamaktadır.</strong></p> <p>Bu API çağrısı HBHS'nin HHS'de yeni bir “HesapBilgisiRizasi” nesnesi oluşturmasını ve nesneye erişmek için benzersiz bir rıza numarası ({rizaNo}) dönülmesini sağlar.</p> <p>API çağrısının başarıyla sonuçlanması için HBHS'nin istemci kimlik bilgileri yetkisi kullanması yeterlidir.
Başarıyla oluşturulan hesap bilgisi rıza kaynağının rıza durumu “Yetki Bekleniyor” olarak düzenlenir.
ÖHK daha önce aldığı rızaya ilişkin erişim tarihleri, izin türlerini ve hesap bilgilerini güncellemek isterse, HBHS önce HHS nezdindeki rızayı iptal etmeli ve sonrasında yeni bir rıza talebinde bulunmalıdır.
 <img src="/assets/img/HesapBilgisiMusteriRizasininHazirlanmasiv2.99202638.png" width="80%"></p> <p><strong>Şekil 11: Hesap/Kart Bilgisi Müşteri Rızasının Hazırlanması</strong></p> <ul><li>POST /hesap-bilgisi-rizasi isteğinin (REQUEST) gövdesinde (BODY)  “HesapBilgisiRizasıIstegi” nesnesi (Tablo-12) kullanılır. İstek başarıyla sonuçlanırsa HHS kaynak sunucusunda “HesapBilgisiRizasi” (Tablo-13) nesnesi oluşturulur.</li></ul> <h3 id="post-hesap-bilgisi-rizasi"><a href="#post-hesap-bilgisi-rizasi" class="header-anchor">#</a> <strong>POST /hesap-bilgisi-rizasi</strong><br></h3> <p><br><strong>Bu dokümanda belirtilen hesap bilgisi rızası ibaresi hem hesap hem de kart rıza süreçlerini kapsamaktadır.</strong></p> <h3 id="basarılı-istek"><a href="#basarılı-istek" class="header-anchor">#</a> Başarılı İstek:</h3> <p>İSTEK:</p> <p>HBHS, bu API erişim adresinden HHS’ye yeni bir HesapBilgisiRizasi oluşturulması için istekte bulunur:</p> <ul><li>HBHS, ÖHK’nın hesap/kart bilgilerine yönelik rıza başlatma isteği olduğunu HHS’ye bildirir. YÖS'ler sürüm 2.0 için Hesap Bilgisi Rızası isteği gönderdiğinde HHS'nin ÖHK'yı yönlendireceği mobil uygulama içerisinde sürüm 2.0 değişikliklerini içeren, kart bilgilerinin seçimini yapacakları sürümün yüklü olmaması durumunda HHS'ler tarafından <strong>TR.OHVPS.Business.CustomerMobileApplicationHasOlderVersion</strong> hatası verilebilir.</li> <li>HBHS, ÖHK’nın, HBHS arayüzünden verdiği rızanın (“Ön Onay”) bir kopyasının HHS nezdinde müşteri tarafından onaylanması için HHS’ye gönderilmesini sağlar.</li> <li>HHS; istek mesajında yer alan alanların API dökümanında belirtilen şartları sağlayacak şekilde zorunluluk ve uzunluk kontrollerini yapar.(Zorunlu) Kontrollere istinaden hata oluşması durumunda <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hata kodu iletilmeli ve fieldErrors dolu olacak şekilde hatalı alanı belirten detaylı açıklama gönderilmelidir. InvalidFormat hata kodlarında fieldErrors içeriği gönderilmeli ve anlaşılır açıklama ile message, messageTr alanları doldurulması zorunludur.</li> <li>HHS, hhsKod’un kendisine ait olduğunu ve istek başlığındaki x-aspsp-code değeri ile aynı olduğunu kontrol eder. Farklı olması durumunda <strong>”TR.OHVPS.Connection.InvalidASPSP”</strong> hatası dönülür.</li> <li>HHS, yosKod’un geçerli bir Ödeme Hizmeti Sağlayıcısı Kodu olduğunu ve istek başlığındaki x-tpp-code değeri ile aynı olduğunu kontrol eder. Farklı olması durumunda <strong>”TR.OHVPS.Connection.InvalidTPP”</strong> hatası dönülür.</li> <li>HHS; YÖS API ile alınan temel adres bilgilerinde yer alan yönlendirme adresleri ile hesap bilgisi rızası nesnesi içerisinde yer alan YÖS  adreslerin uyumlu olup olmadığının kontrollerini yapar. (Zorunlu) Kontrollere istinaden hata oluşması durumunda <strong>”TR.OHVPS.Business.TPPRedirectionAddressMismatch”</strong> hatası dönülür.</li> <li>HHS; kimlik bilgileri nesnesinde iletilen kimlik bilgileri ile ÖHK’nın HHS müşterisi olup olmadığının kontrollerini yapar. Bu kontrol hem bireysel hem de kurumsal ÖHK’lar için yapılmalıdır.(Zorunlu) Kontrollere istinaden hata oluşması durumunda <strong>”TR.OHVPS.Business.CustomerNotFound”</strong> hatası dönülür. Kurumsal müşteri ile başlatılan rızada yer alan müşteri bilgisinin karşı kurumda Kurumsal müşteri değil; bireysel müşteri olduğu durumda “TR.OHVPS.Business.BusinessCustomerMismatch” hatası dönülür.</li> <li>Bir ÖHK'nın 1 YÖS için aktif tek bir rızası olabilir. ÖHK’nın  “Yetkilendirildi” ve “Yetki Kullanıldı” statüsünde rızası varken yeni bir rıza isteği gönderdiğinde HHS tarafından <strong>TR.OHVPS.Business.ConsentAlreadyExists</strong> hatası dönülür. <strong>Güncelleme isteği göndermesi durumunda ise işletilmesi gereken akışlar “Rıza Durumları” başlığından kontrol edilmelidir.</strong></li> <li>Hesap bilgi hizmeti rıza isteğinde bulunan ÖHK’nın “Açık Bankacılık Kanal Yetki” tanımı yok ise <strong>”TR.OHVPS.Business.OpenBankingChannelClosed”</strong> hatası dönülür. HHS insiyatifinde olup HHS bu kontrolü GKD sonrası gerçekleştirebilir.</li> <li>Hesap bilgi hizmeti rıza isteğinde 01 ya da 07 izin türü olmak zorundadır. HHS tarafından izin türü içerisinde 01 ya da 07 varlık durumu kontrol edilir. Olmaması durumunda <strong>&quot;TR.OHVPS.Business.IncorrectPermissionType”</strong> hatası dönülür.</li> <li>Hesap bilgi hizmeti rıza isteğinde 01 izin türü bulunmuyor ise 02, 03, 04, 05 ya da 06 izin türü olmamalıdır. 01 izin türü bulunmadığında 02, 03, 04, 05 ya da 06 izin türlerinden biri ya da birkaçı gönderildiğinde <strong>&quot;TR.OHVPS.Business.IncorrectPermissionType”</strong> hatası dönülür.</li> <li>Hesap bilgi hizmeti rıza isteğinde 07 izin türü bulunmuyor ise 08 ya da 09 izin türü olmamalıdır. 07 izin türü bulunmadığında 08 ya da 09 izin türlerinden biri ya da ikisi gönderildiğinde <strong>&quot;TR.OHVPS.Business.IncorrectPermissionType”</strong> hatası dönülür.</li> <li>ÖHK, HHS'de olacak bakiye değişikliklerinden anlık haberdar olmak istiyor ise 06-Anlık Bakiye Bildirimi izin türü seçimi ile rıza başlatması gereklidir. 03-Bakiye Bilgisi izin türü ile birlikte seçilmesi gereklidir. 06 izin türü seçilip 03 izin türü seçilmediği durumda <strong>”TR.OHVPS.Business.IncorrectPermissionType”</strong> hatası dönülür.</li> <li>İzin türü “06: Anlık Bakiye Bildirimi” seçilmiş ise HHS, YÖS'ün KAYNAK_GUNCELLENDI olay tipinde olay aboneliğinin varlığını kontrol eder. Olay abonelik kaydı bulunmuyor ise <strong>”TR.OHVPS.Business.EventSubscriptionNotFound”</strong> hatası dönülür.</li> <li>Hesap bilgi hizmeti rıza isteğinde bulunan ÖHK’nın izin verecek hesap ya da kartı yok ise <strong>”TR.OHVPS.Business.ProductNotSuitable”</strong> hatası dönülür. İki üründen biri var ise başarılı yanıt dönülür. HHS insiyatifinde olup HHS bu kontrolü GKD sonrası gerçekleştirebilir.</li> <li>Erişimin Geçerli Olduğu Son Tarih bilgisi müşteri bağımsız alabileceği minimum değer : Rıza tarihi + 1 gündür. Maksimum rıza süresi bireysel müşteriler için 6 ay, Kurumsal/Tüzel müşteriler için 12 ay olacaktır. Bireysel müşteriler için 6 aydan fazla, kurumsal müşteriler için ise 12 aydan fazla iletildiği durumda <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür.</li> <li>İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmiş ise; İşlem Sorgulama Başlangıç Zamanı, hesap bilgisi rızası verilmesinden <strong>geçmişe</strong> dönük en fazla 12 ay olabilmektedir. 12 aydan fazla gönderilmesi durumunda <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür.</li> <li>İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmiş ise; İşlem Sorgulama Başlangıç Zamanı, hesap bilgisi rızası verilmesinden <strong>geleceğe</strong> dönük en fazla 12 ay sonrası olabilmektedir. 12 aydan fazla gönderilmesi durumunda <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür.</li> <li>Ayrık GKD desteklemeyen HHS'ye Ayrık GKD yöntemiyle rıza başlatma isteği yapılması durumunda HHS tarafından <strong>”TR.OHVPS.Business.DecoupledAuthenticationNotSupported”</strong> hatası dönülür. YÖS ilgili işlemi “Yönlendirmeli” akışa çekip süreci ilerletebilir.</li> <li>HHS &quot;gkd&quot; nesnesi için alan kontrollerini gerçekleştirir. &quot;yetYntm&quot; = &quot;A&quot; gönderilmiş ise &quot;ayrikGkd&quot; nesnesinin dolu gönderilmesi zorunludur. Gönderilmemesi durumunda HHS tarafından <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür.</li> <li>Ayrık GKD ile başlatılan hesap bilgi hizmeti rıza isteğinde HHS, YÖS’ün AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri için olay aboneliğinin varlığını kontrol eder. YÖS iki olay tipine de abone olmak zorundadır. Eğer olay aboneliği yoksa HHS tarafından <strong>”TR.OHVPS.Business.EventSubscriptionNotFound”</strong> hatası dönülür.</li> <li>ÖHK'ya ait kimlik verisi(kmlk.kmlkVrs) ile ayrık GKD içerisinde yer alan OHK Tanım Değer alanı (ayrikGkd.ohkTanimDeger) birebir aynı olmalıdır. Aynı olmadığı durumda HHS tarafından <strong>”TR.OHVPS.Business.CustomerInfoMismatch”</strong> hatası dönülür.</li> <li>HHS tarafında ÖHK'nın mobil uygulaması bulunmaması durumu tespit edilebildiği durumda Ayrık GKD ile başlatılan rıza akışlarında hata mesajı vermelidir. HHS tarafından <strong>”TR.OHVPS.Business.CustomerMobileApplicationNotFound”</strong> hatası dönülür. YÖS ilgili işlemi “Yönlendirmeli” akışa çekip süreci ilerletebilir.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS, benzersiz “RizaNo” ile “HesapBilgisiRizasi” nesnesi oluşturur ve HBHS’ye döner.</p> <p>HHS, HesapBilgisiRizasi oluşturduğu anda durumunu “Yetki Bekleniyor” olarak düzenler.</p> <p><strong>Tablo 12: “HesapBilgisiRizasiIstegi” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Önceki Rıza No</td> <td>oncekiRizaNo</td> <td>AN1..128</td> <td>K</td> <td>HesapBilgisiRızasiIstegi nesnesinin güncelleme sebebiyle oluşturulması esnasında ÖHK'nın güncelleme yapmak istediği mevcut rıza no bilgisi. Rıza güncelleme yapılmak istendiğinde gönderilmesi zorunludur.</td> <td></td></tr> <tr><td>Katılımcı Bilgisi</td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td> <td></td></tr> <tr><td>&gt;Hesap Hizmeti Sağlayıcısı Kodu</td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td> <td>HHS, hhsKod’un kendisine ait olduğunu ve istek başlığındaki x-aspsp-code değeri ile aynı olduğunu kontrol eder. Hata durumunda TR.OHVPS.Connection.InvalidASPSP hata kodunu döner.</td></tr> <tr><td>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur</td> <td>HHS, yosKod’un geçerli bir Ödeme Hizmeti Sağlayıcısı Kodu olduğunu ve istek başlığındaki x-tpp-code değeri ile aynı olduğunu kontrol eder.  Hata durumunda TR.OHVPS.Connection.InvalidTPP hata kodunu döner.</td></tr> <tr><td>GKD</td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td> <td></td></tr> <tr><td>&gt;Yetkilendirme Yöntemi</td> <td>yetYntm</td> <td>AN1</td> <td>İ</td> <td>TR.OHVPS.DataCode.GkdTur sıralı veri türü değerlerinden birini alır.  <br>Yetkilendirme yöntemi, HBHS tarafından belirtilmeyebilir.</td> <td>HHS, HBHS’nin belirlediği yöntemi dikkate alarak süreci ilgili akışa uygun olarak devam ettirir. Desteklemediği yöntem için (örn: Ayrık GKD) ayrıca hata mesajı verilmelidir.</td></tr> <tr><td>&gt; Yönlenme Adresi</td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli güçlü kimlik doğrulama için zorunlu.<br> YÖS’ün ileteceği adrestir.<br>  Durum kodu(drmKod), yönlendirme adresine parametre olarak eklenmelidir.</td> <td>HHS, müşteri uygulama / tarayıcısını bu alanda belirtilen adrese yönlendirir.</td></tr> <tr><td>&gt; Ayrık GKD</td> <td>ayrikGkd</td> <td>Kompleks:AyrikGkd</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu.</td> <td>yetYntm = A gönderilmiş ise ayrikGkd nesnesinin dolu gönderilmesi zorunludur. <br><br> HHS, YÖS'ün AYRIK_GKD_BASARILI ve AYRIK_GKD_BASARISIZ olay tipleri için olay aboneliğinin varlığını kontrol eder. <a href="/v2.0.0/contents/gkd.html#_5-2-ayrık-guclu-kimlik-dogrulama">Bknz: Ayrık GKD</a></td></tr> <tr><td>&gt;&gt; OHK Tanım Tip</td> <td>ohkTanimTip</td> <td>AN8</td> <td>K</td> <td>ÖHK'nın HHS uygulaması tarafından tanınmasını sağlayacak tanım tipleridir. <strong>TR.OHVPS.DataCode.OHKTanimTip</strong> sıralı veri tiplerinden birini alır.</td> <td></td></tr> <tr><td>&gt;&gt; OHK Tanım Değer</td> <td>ohkTanimDeger</td> <td>AN1..30</td> <td>K</td> <td>ÖHK'nın HHS uygulaması tarafından tanınmasını sağlayacak tanım değeridir. ohkTanimTip'i ile uyumlu değerdir.</td> <td></td></tr> <tr><td>Kimlik</td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td> <td></td></tr> <tr><td>&gt; Kimlik Türü</td> <td>kmlkTur</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.KimlikTur sıralı veri türü değerlerinden birini alır. <br> Kurum adına yapılan(ticari) işlemlerde kurum kullanıcısının bilgisi iletilmelidir.</td> <td></td></tr> <tr><td>&gt; Kimlik Verisi</td> <td>kmlkVrs</td> <td>AN1..30</td> <td>Z</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır. <br> TR.OHVPS.DataCode.KimlikTur değerine göre uzunluk ve formatı değişir. <br> Kurum adına yapılan(ticari) işlemlerde kurum kullanıcısının bilgisi iletilmelidir.</td> <td></td></tr> <tr><td>&gt; Kurum Kimlik Türü</td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür. <br>TR.OHVPS.DataCode.KurumKimlikTur sıralı veri türü değerlerinden birini alır.</td> <td></td></tr> <tr><td>&gt; Kurum Kimlik Verisi</td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir. <br>TR.OHVPS.DataCode.KurumKimlikTur değerine göre uzunluk ve formatı değişir.</td> <td></td></tr> <tr><td>&gt; Ödeme Hizmeti Kullanıcısı Türü</td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.OhkTur sıralı veri türü değerlerinden birini alır (B: Bireysel, K:Kurumsal)</td> <td></td></tr> <tr><td>Hesap/Kart Bilgisi</td> <td>hspBlg</td> <td>Kompleks: HesapBilgisi</td> <td>Z</td> <td></td> <td></td></tr> <tr><td>&gt;İzin Bilgisi</td> <td>iznBlg</td> <td>Kompleks: IzinBilgisi</td> <td>Z</td> <td></td> <td></td></tr> <tr><td>&gt;&gt; İzin Türü</td> <td>iznTur</td> <td>Array[AN2]</td> <td>Z</td> <td>ÖHK tarafından HHS önyüzünde belirlenen izin tipleridir. Bir istekte birden fazla değer bulunabilir, TR.OHVPS.DataCode.IzinTur sıralı veri türü değerlerinden birini alır.</td> <td></td></tr> <tr><td>&gt;&gt; Erişimin Geçerli Olduğu Son Tarih</td> <td>erisimIzniSonTrh</td> <td>ISODateTime</td> <td>Z</td> <td>Hesap bilgisi rızasının geçerli olduğu son tarih. <br> Müşteri YÖS ekranından bu değeri belirleyebilir. Bireysel müşteriler için rıza süresi 6 ay, Kurumsal/Tüzel müşteriler için 12 ay olacaktır.<br> <br> Bireysel Müşteriler için varsayılan değer : Rıza verilen tarih + 6 ay <br> Kurumsal Müşteriler için varsayılan değer : Rıza verilen tarih + 12 ay<br> Bireysel Müşteriler için alabileceği maksimum değer : Rıza tarihi + 6 ay <br>Kurumsal Müşteriler için alabileceği maksimum değer : Rıza tarihi + 12 ay <br>  Müşteri bağımsız alabileceği minimum değer : Rıza tarihi + 1 gün <br><br> <strong>Örneğin</strong> 04/02/2023’de minimum 05/02/2023 seçilebilir. Bu durumda yeni günün başlangıç saati 00:00:00 olduğu kabul edildiği için; erisimIzniSonTrh değeri 2023-02-06T00:00:00+03:00 olmalıdır. <strong>HHS rıza onay ekranlarında YÖS'ten iletilen erişim izni son tarihi yeni günün başlangıç saati olarak iletildiğinden ÖHK'ya gösterilecek tarih erişim izninin biteceği gün olarak gösterilmelidir.</strong> Örneğe istinaden; ÖHK YÖS’de 05/02/2023 seçmiş ise HHS rıza onay ekranında 06/02/2023 görmemeli, bu iki tarihin aynı, yani 05/02/2023 olacak şekilde gösterilmesi gerekmektedir.   <br><br> <strong>Örnek rıza oluş zamanı</strong> : 2023-02-04T21:20:20+03:00 <br> <strong>1 günlük rıza verildiğinde erisimIzniSonTrh değeri:</strong>   2023-02-06T00:00:00+03:00 (26 saat 40 sakikalık rıza vermiş oluyor.) <br> <strong>7 günlük rıza verildiğinde erisimIzniSonTrh değeri:</strong> 2023-02-12T00:00:00+03:00 <br> <strong>1 aylık rıza verildiğinde erisimIzniSonTrh değeri :</strong>  2023-03-05-T00:00:00+03:00</td> <td>Bu alanda bir değer bulunmadığı durumda HHS hata dönmelidir.</td></tr> <tr><td>&gt;&gt; İşlem Sorgulama Başlangıç Zamanı</td> <td>hesapIslemBslZmn</td> <td>ISODateTime</td> <td>K</td> <td>Hesap bilgisi rızası verilmesinden geçmişe dönük en fazla 12 ay olabilir, daha eski olmaması gerekir. <br> Varsayılan değeri rıza verilen tarih (işlem zamanı) – 12 aydır. <br> ÖHK bu alana bir değer girişi sağlamış ise zaman bilgisi üretilirken ekrandan girilen tarihe 00:00:00 zaman bilgisi eklenmelidir. ÖHK değer girişi sağlamamış ise ÖBHS varsayılan değerlerle bu alanı doldurarak, HHS’ye iletir. <br> Minimum tarihi : Rızanın veriliş tarihi  - 12 ay  <br> Maksimum tarih: Rızanın veriliş tarihi +  12 ay  <br> İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçildiğinde bu alanların doldurulması zorunludur.<br> İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmemiş ise gönderilmemelidir.</td> <td>ÖHK tarafından izin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmemiş ve  İşlem Sorgulama Başlangıç Zamanı ÖBHS tarafından dolu olarak gönderilmiş ise HHS tarafından işlemin devamına izin verilmez.<br>İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmiş ise; HHS bu alanın alabileceği minimum ve maksimum değerlerin sınırlar içerisinde olduğunu kontrol eder.</td></tr> <tr><td>&gt;&gt; İşlem Sorgulama Bitiş Zamanı</td> <td>hesapIslemBtsZmn</td> <td>ISODateTime</td> <td>K</td> <td>Hesap bilgisi rızası verilmesinden geleceğe dönük en fazla 12 ay sonrası olabilir, daha ileri bir tarih olmaması gerekir. <br> Varsayılan değeri: Rıza verilen tarih + 12 aydır.<br>ÖHK bu alana bir değer girişi sağlamış ise girdiği tarihe 1 gün eklenir ve yeni günün ilk saati kabul edilen 00:00:00 saat bilgisini ekler.<br> ÖHK bu alana bir değer girişi sağlamamış ise ÖBHS varsayılan değerlerle bu alanı doldurarak, HHS’ye iletir.<br> Minimum tarihi : Rızanın veriliş tarihi  – 12 ay<br> Maksimum tarihi :  Rızanın veriliş tarihi + 12 ay <br> İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçildiğinde bu alanların doldurulması zorunludur.<br> İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmemiş ise gönderilmemelidir. Eğer dolu gönderilirse HHS tarafından uygun hata mesajı iletilmelidir.</td> <td>ÖHK tarafından izin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmemiş ve İşlem Sorgulama Bitiş Zamanı ÖBHS tarafından dolu olarak gönderilmiş ise HHS tarafından işlemin devamına izin verilmez. <br> İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçilmiş ise; HHS bu alanın alabileceği minimum ve maksimum değerlerin sınırlar içerisinde olduğunu kontrol eder.</td></tr></tbody></table> <h3 id="basarılı-yanıt"><a href="#basarılı-yanıt" class="header-anchor">#</a> Başarılı Yanıt:</h3> <p><strong>Tablo 13: HesapBilgisiRizasi nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>Önceki Rıza No</td> <td>oncekiRizaNo</td> <td>AN1..128</td> <td>K</td> <td>HesapBilgisiRızasiIstegi nesnesinin güncelleme sebebiyle oluşturulması esnasında ÖHK'nın güncelleme yapmak istediği mevcut rıza no bilgisi. Rıza güncelleme yapılmak istendiğinde gönderilmesi zorunludur. İstekte gönderilen değer aynı şekilde yanıtta dönülmelidir.</td></tr> <tr><td>Riza Bilgileri</td> <td>rzBlg</td> <td>Kompleks: RizaBilgileri</td> <td>Z</td> <td></td></tr> <tr><td>&gt; Rıza No</td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>HesapBilgisiRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td></tr> <tr><td>&gt; Oluşturma Zamanı</td> <td>olusZmn</td> <td>ISODateTime</td> <td>Z</td> <td>HesapBilgisiRızası nesnesinin oluşturulma zamanı</td></tr> <tr><td>&gt; Güncellenme Zamanı</td> <td>gnclZmn</td> <td>ISODateTime</td> <td>Z</td> <td>HesapBilgisiRızası nesnesinin güncellenme zamanı</td></tr> <tr><td>&gt; Rıza Durumu</td> <td>rizaDrm</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.RizaDurumu sıralı veri tipini değerlerinden birini alır. Örn; hesap bilgi rızasının tesisine dair ilk istek mesajına dönüşte “B: Yetki Bekleniyor” değerini alması beklenir.</td></tr> <tr><td>&gt; Rıza Iptal Detay Kodu</td> <td>rizaIptDtyKod</td> <td>AN2</td> <td>K</td> <td>Rıza durumunun iptal olduğu durumda zorunludur.</td></tr> <tr><td>Kimlik</td> <td>kmlk</td> <td>Kompleks:Kimlik</td> <td>Z</td> <td></td></tr> <tr><td>&gt; Kimlik Türü</td> <td>kmlkTur</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.KimlikTur sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt; Kimlik Verisi</td> <td>kmlkVrs</td> <td>AN1..30</td> <td>Z</td> <td>HHS nezdinde kullanıcı doğrulamasında kullanılan tanımlayıcıdır. TR.OHVPS.DataCode.KimlikTur değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td>&gt; Kurum Kimlik Türü</td> <td>krmKmlkTur</td> <td>AN1</td> <td>K</td> <td>ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik türüdür.<br> TR.OHVPS.DataCode.KurumKimlikTur sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt; Kurum Kimlik Verisi</td> <td>krmKmlkVrs</td> <td>AN1..30</td> <td>K</td> <td>ÖHK’nın altında tanımlı olduğu tüzel kişilik için kullanılan kurum kimlik verisidir.<br> TR.OHVPS.DataCode.KurumKimlikTur değerine göre uzunluk ve formatı değişir.</td></tr> <tr><td>&gt; Ödeme Hizmeti Kullanıcısı Türü</td> <td>ohkTur</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.OhkTur sıralı veri türü değerlerinden birini alır (B: Bireysel, K:Kurumsal)</td></tr> <tr><td>Katılımcı Bilgisi</td> <td>katilimciBlg</td> <td>Kompleks:KatilimciBilgisi</td> <td>Z</td> <td>Katılımcılara atanmış kod bilgileridir.</td></tr> <tr><td>&gt;Hesap Hizmeti Sağlayıcısı Kodu</td> <td>hhsKod</td> <td>AN4</td> <td>Z</td> <td>İsteğin iletildiği Hesap Hizmeti Sağlayıcısının kodudur. (Nezdinde ÖH bulunduran kuruluş kodu. Örneğin, Banka, Elektronik Para Kuruluşu ve Ödeme Kuruluşu)</td></tr> <tr><td>&gt; Yetkili Ödeme Hizmeti Sağlayıcısı Kodu</td> <td>yosKod</td> <td>AN4</td> <td>Z</td> <td>İsteği gönderen Yetkili Ödeme Hizmeti Sağlayıcısı (YÖS) kodudur.</td></tr> <tr><td>GKD</td> <td>gkd</td> <td>Kompleks:Gkd</td> <td>Z</td> <td></td></tr> <tr><td>&gt; Yetkilendirme Yöntemi</td> <td>yetYntm</td> <td>AN1</td> <td>Z</td> <td>HHS, HBHS’nin belirlediği yöntemi dikkate alarak süreci ilgili akışa uygun olarak devam ettirir. Desteklemediği yöntem için (örn: Ayrık GKD) ayrıca hata mesajı verilmelidir.<br> TR.OHVPS.DataCode.GkdTur sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt; Yönlenme Adresi</td> <td>yonAdr</td> <td>AN1..1024</td> <td>K</td> <td>HHS, müşteri uygulama / tarayıcısını yönlendirmeli akışta bu alanda belirtilen YÖS adresine yönlendirir.</td></tr> <tr><td>&gt; Ayrık GKD</td> <td>ayrikGkd</td> <td>Kompleks:AyrikGkd</td> <td>K</td> <td>Ayrık güçlü kimlik doğrulama için zorunlu.</td></tr> <tr><td>&gt;&gt; OHK Tanım Tip</td> <td>ohkTanimTip</td> <td>AN8</td> <td>K</td> <td>ÖHK'nın HHS uygulaması tarafından tanınmasını sağlayacak tanım tipleridir. İstek içerisindeki veri değiştirilmeden iletilir.</td></tr> <tr><td>&gt;&gt; OHK Tanım Değer</td> <td>ohkTanimDeger</td> <td>AN1..30</td> <td>K</td> <td>ÖHK'nın HHS uygulaması tarafından tanınmasını sağlayacak tanım değeridir. ohkTanimTip'i ile uyumlu değerdir.  İstek içerisindeki veri değiştirilmeden iletilir.</td></tr> <tr><td>&gt; HHS Yönlenme Adresi</td> <td>hhsYonAdr</td> <td>AN1..1024</td> <td>K</td> <td>Yönlendirmeli akış türünde	GKD doğrulama bilgilerinin girilebilmesi için uygulamadan açılacak yönlendirme sayfasının adresi. Ayrık GKD akışında bu alan dönülmemelidir.</td></tr> <tr><td>&gt; Yetkilendirme Tamamlanma Zamanı</td> <td>yetTmmZmn</td> <td>ISODateTime</td> <td>Z</td> <td>Yetkilendirme akışının tamamlanması gereken son zamanı gösterir.  HHS tarafından maksimum 5 dk içinde işlem tamamlanacak şekil zaman damgası oluşturulur. Zaman aşımı olduğunda HHS’nin GKD’ye izin vermeyecek şekilde hata mesajı vermesi gerekmektedir.<br>Rıza durumu Yetkilendirildi statüsüne geçene kadarki süredir.</td></tr> <tr><td>Hesap/Kart Bilgisi</td> <td>hspBlg</td> <td>Kompleks: HesapBilgisi</td> <td>Z</td> <td></td></tr> <tr><td>&gt; İzin Bilgisi</td> <td>iznBlg</td> <td>Kompleks: IzinBilgisi</td> <td>Z</td> <td></td></tr> <tr><td>&gt;&gt; İzin Türü</td> <td>iznTur</td> <td>Array[AN2]</td> <td>Z</td> <td>ÖHK tarafından HBHS önyüzünde belirlenen izin tipleridir. Bir istekte birden fazla değer bulunabilir, TR.OHVPS.DataCode.IzinTur sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt;&gt; Erişimin Geçerli Olduğu Son Tarih</td> <td>erisimIzniSonTrh</td> <td>ISODateTime</td> <td>Z</td> <td>Hesap bilgisi rızasının geçerli olduğu son tarih</td></tr> <tr><td>&gt;&gt; İşlem Sorgulama Başlangıç Zamanı</td> <td>hesapIslemBslZmn</td> <td>ISODateTime</td> <td>K</td> <td>Hesap hareketlerinin sorgunabileceği başlangıç zamanı. İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçildiğinde bu alanların doldurulması zorunludur.</td></tr> <tr><td>&gt;&gt; İşlem Sorgulama Bitiş Zamanı</td> <td>hesapIslemBtsZmn</td> <td>ISODateTime</td> <td>K</td> <td>Hesap hareketlerinin sorgunabileceği bitiş zamanı. İzin türü “Temel işlem Bilgisi” ve/veya “Ayrıntılı İşlem Bilgisi” seçildiğinde bu alanların doldurulması zorunludur.</td></tr> <tr><td>&gt; Ayrıntı Bilgi</td> <td>ayrBlg</td> <td>Kompleks: AyrintiBilgi</td> <td>İ</td> <td></td></tr> <tr><td>&gt; ÖHK Mesaj Alanı</td> <td>ohkMsj</td> <td>AN1..200</td> <td>İ</td> <td>HHS’nin ÖHK’ya göstermek üzere ilettiği mesaj.</td></tr></tbody></table> <h2 id="izinler"><a href="#izinler" class="header-anchor">#</a> İzinler</h2> <p>Bir hesap bilgisi rızası kaynağı çağrısına yanıt olarak döndürülen verileri sınırlamak için izin kodları kullanılır.</p> <p><strong>Hesap ve karta dair tüm bilgiler hesap bilgisi rızası altında alınacaktır. İzin türleri hesap ve karta göre ayrışmaktadır.</strong></p> <ul><li>Temel Hesap Bilgisi</li> <li>Ayrıntılı Hesap Bilgisi</li> <li>Bakiye Bilgisi</li> <li>Temel İşlem (Hesap Hareketleri) Bilgisi</li> <li>Ayrıntılı İşlem Bilgisi</li> <li>Anlık Bakiye Bildirimi</li> <li>Temel Kart Bilgisi</li> <li>Detaylı Kart Bilgisi</li> <li>Ayrıntılı Kart İşlem Bilgisi</li></ul> <p>ÖHK’ya sunulacak seçimler ve kuralları aşağıdaki gibi olmalıdır.</p> <table><thead><tr><th>Seçim</th> <th>Kural</th></tr></thead> <tbody><tr><td>Temel Hesap Bilgisi</td> <td>ÖHK seçim yapabilir. Temel Kart Bilgisi seçilmediyse bu izin türünün seçimi zorunludur.</td></tr> <tr><td>Ayrıntılı Hesap Bilgisi</td> <td>ÖHK seçim yapabilir.</td></tr> <tr><td>Bakiye Bilgisi</td> <td>ÖHK seçim yapabilir.</td></tr> <tr><td>Temel İşlem (Hesap Hareketleri)  Bilgisi</td> <td>ÖHK seçim yapabilir.</td></tr> <tr><td>Ayrıntılı İşlem Bilgisi</td> <td>ÖHK seçim yapabilir. Ayrıntılı İşlem Bilgisi seçimi Temel İşlem Bilgisi seçimini kapsar. (Ayrıntılı İşlem bilgisi seçildiğinde Temel İşlem Bilgisi de seçili olmalıdır.)</td></tr> <tr><td>Anlık Bakiye Bildirimi</td> <td>Bakiye Bilgisi izin türü ile birlikte seçilmesi gereklidir. ÖHK, HHS'de olacak bakiye değişikliklerinden anlık haberdar olmak istiyor ise bu izin türü seçimi ile rıza başlatması gereklidir.</td></tr> <tr><td>Temel Kart Bilgisi</td> <td>ÖHK seçim yapabilir. Temel Hesap Bilgisi seçilmediyse bu izin türünün seçimi zorunludur.</td></tr> <tr><td>Detaylı Kart Bilgisi</td> <td>ÖHK seçim yapabilir.</td></tr> <tr><td>Ayrıntılı Kart İşlem Bilgisi</td> <td>ÖHK seçim yapabilir.</td></tr></tbody></table> <p>Aşağıdaki durumlarda, izin kombinasyonlarına izin verilmez. HHS, bu hesap erişim onaylarını 400 (Hatalı İstek) yanıt koduyla reddetmelidir:</p> <ul><li>İzin dizisinin herhangi bir izin türü içermemesi durumu,</li> <li>İzin dizisinde HHS tarafından desteklenmeyen bir izin kodunun yer alması durumu</li></ul> <h2 id="_9-2-adim-2-hesap-bilgisi-hizmeti-rızasının-tesisi"><a href="#_9-2-adim-2-hesap-bilgisi-hizmeti-rızasının-tesisi" class="header-anchor">#</a> 9.2 ADIM 2: Hesap Bilgisi Hizmeti Rızasının Tesisi</h2> <img src="/assets/img/HesapBilgisiMusteriRizasininTesisiv2.c9fd6dac.png" width="80%"> <p><strong>Şekil 12: Hesap Bilgisi ÖHK Rızasının Tesisi</strong></p> <p>Rıza tesisinin başarıyla sonuçlanması için HBHS'nin istemci kimlik bilgileri yetkisi kullanması ve ardından müşterinin HHS tarafından yönlendirmeli veya ayrık GKD ile doğrulanması gerekir. HHS'de oluşturulan ve rıza durumu “Yetki Bekleniyor” olan bir hesap bilgisi rızası, GKD sonrası “Yetkilendirildi” statüsüne güncellenir. HBHS, erişim sağlayacağı hesapları ve kartları hesap bilgisi rızasının tesisinden önce seçer.</p> <ul><li><p>Yönlendirmeli doğrulama akışında, HBHS ÖHK’yı HHS’ye yönlendirir.</p> <ul><li><p>HBHS tarafından yönlendirme, bir önceki adımdaki RizaNo’yu içerir.</p></li> <li><p>HHS, ÖHK için GKD sürecini işletir.</p> <p>ÖHK’yı doğrularsa,</p> <ul><li><p>ÖHK HBHS üzerinden işlem yapılmasına izin vereceği hesap/kart seçimini yapar. HBHS üzerinden ÖHK’nın verdiği izin bilgilerini ve erişim izninin başlangıç/bitiş tarihi bilgilerini, HHS'ler bilgilendirme amaçlı ÖHK’ya gösterir.</p></li> <li><p>Rıza güncelleme akışı ile başlatılan rıza isteklerinde mevcut rıza içerisinde seçili olan hesap/kart bilgileri ÖHK'ya HHS ekranlarında aynı şekilde seçili olarak getirilmelidir. ÖHK'lar mevcut rıza içerisinde izin vermiş olduğu hesap/kart bilgilerini seçili olarak görüntüleyip yeni rıza için izin vermek istediği hesap/kartların seçimini güncelleyebilmelidir.</p> <p>Rıza güncelleme sürecinde;  ÖHK’nın HHS’deki mevcut rızası kapsamında YÖS’ten gelen rıza izin türlerine göre listeleme yapılmalıdır. 01,02,03,04,05,06 seçildiyse hesapların; 07,08,09 seçildiyse kartların HHS’de listelenmesi gerekmektedir. Örneğin: ÖHK’nın mevcut rızasında hesaplar (01,02,03 rıza türlerinin seçili olsun) için hesap bilgisi rızası verilmiş olsun eğer YÖS’ten rıza güncelleme kapsamında 01,02, 07,08 rıza türleri geldiği durumda HHS’nin mevcut hesap rızasını ve doğal olarak hesapları listelemesi ek olarak da karta ait rıza türleri seçildiğinde kartların listelenmesi gerekecektir. Ancak, ÖHK’nın mevcut rızasında hesaplar (01,02,03 rıza türlerinin seçili olsun) için hesap bilgisi rızası verilmiş olsun eğer YÖS’ten rıza güncelleme kapsamında  07,08, 09 rıza türleri geldiği farz edildiğinde HHS’nin mevcut hesap rızasını göstermemesi ve sadece karta ait rıza türleri seçildiği için kartları listelemesi gerekecektir.</p></li> <li><p>HHS hesap bilgisi rıza kaynağının durumunu “Yetkilendirildi” olarak günceller.</p></li> <li><p>HHS, ÖHK’yı “olumlu yönlendirme akışı” ile HBHS tarafından tanımlanan yönlendirme adresine yönlendirir:</p> <div class="language- extra-class"><pre><code>yonAdr?rizaDrm=Y&amp;yetKod=xx&amp;rizaNo=yy&amp;rizaTip=H&amp;drmKod=zzz
</code></pre></div></li></ul> <p>ÖHK’yı doğrulayamazsa,</p> <ul><li><p>HHS, hesap bilgisi rıza kaynağının durumunu “Yetki İptal” olarak günceller.</p></li> <li><p>HHS, ÖHK’yı “olumsuz yönlendirme akışı” ile HBHS tarafından tanımlanan yönlendirme adresine yönlendirir:</p> <div class="language- extra-class"><pre><code>yonAdr?rizaDrm=I &amp;rizaNo=yy&amp;rizaTip=H&amp;rizaIptDtyKod=11&amp;drmKod=zzz
</code></pre></div></li></ul></li></ul></li> <li><p>Ayrık doğrulama akışında, HHS, ÖHK’nın hesap bilgisi hizmetini başlattığı uygulamadan farklı olabilecek bir “doğrulama” uygulamasında işlemi doğrulamasını ister.</p> <ul><li>Ayrık akış HBHS’nin farklı bir kanal kullanarak yetkilendirme isteği göndermesiyle başlatılır.</li> <li>Bu yetkilendirme isteği, yetkilendirilecek hesap bilgisi rızasının eşleştirileceği ÖHK’nın bulunması için ilgili veriyi taşır.</li> <li>HHS, ödeme hizmeti kullanıcısını doğrular.</li> <li>ÖHK verdiği izin tipi dahilinde bilgileri paylaşılacak olan hesapları seçer. Rıza güncelleme akışı ile başlatılan isteklerde ÖHK mevcutta vermiş olduğu hesap ve kartları seçili olarak görüntüler. İlgili seçimler üzerinde güncelleme sağlayarak onay verir.</li> <li>HHS, hesap bilgisi rıza kaynağının durumunu “Yetkilendirildi” olarak günceller.</li></ul></li></ul> <p>Başarılı GKD sonrasında (rizaDrm=’Y’) ilgili rıza nesnesi için (belirli bir rizaNo) yetkilendirme kodunun (yetKod) alınmasının ardından erişim belirteci erişim adresine POST çağrısı yapılarak yetkilendirme kodu karşılığında erişim belirteci ve yenileme belirteci alınır. POST /erişim-belirteci erişim noktası EK-3’te açıklanmıştır.</p> <p>Erişim belirteci alındıktan sonra; HHS,  hesap bilgisi rızasının durumunu “Yetki Kullanıldı” olarak günceller. Rıza tesisi sağlanmış olur.</p> <h2 id="_9-3-adim-2-1-hesap-bilgisi-rızasının-sorgulanması"><a href="#_9-3-adim-2-1-hesap-bilgisi-rızasının-sorgulanması" class="header-anchor">#</a> 9.3 ADIM 2.1: Hesap Bilgisi Rızasının Sorgulanması</h2> <p><strong>GET /hesap-bilgisi-rizasi/{rizaNo}</strong></p> <p>ÖHK, HHS üzerinden rıza iptali yapmış olabilir veya ÖHK’nın verdiği rıza süresi dolmuş olabilir.  Bu durumlarda HBHS, rıza alma akışına başlamadan önce, daha önce oluşturulmuş bir HesapBilgisiRizasi kaynağının durumunu, isteğe bağlı olarak alabilir.</p> <ul><li>YÖS sadece kendi uygulaması üzerinden verilmiş hesap bilgi rızasını sorgulayabilir. YÖS'e ait olmayan bir rıza ile sorgulama yapıldığında HHS tarafından <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>YÖS'e ait rıza sorgulama yapılırken ilgili rıza kaydı bulunamaz ise <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li></ul> <p>Servis başarılı yanıtında Tablo 13’de belirtilen “HesapBilgisiRizasi” nesnesini dönmektedir.</p> <p>Durum<br>
HesapBilgisiRizasi kaynağı için kullanılabilecek durum göstergeleri şu şekildedir:</p> <ul><li><p>Yetki Bekleniyor</p></li> <li><p>Yetkilendirildi</p></li> <li><p>Yetki Kullanıldı</p></li> <li><p>Yetki Sonlandırıldı</p></li> <li><p>Yetki İptal</p></li> <li><p>Hesap bilgisi rızası sonlandırıldı ve iptal statüsünde olan rıza'ların güncellenme zamanından(gnclZmn) 6 ay sonrasına kadar sorgulanabilir olması beklenmektedir. HHS'ler ilgili süre sonrasında yapılacak rıza sorgularına <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> uyarısı verebilir. YÖS'ler tarafından iptal ve sonlandırıldı statüsünde olan rızalar için sorgulama yapmamalıdır.</p></li></ul> <h2 id="_9-4-adim-2-2-hesap-bilgisi-rızasının-iptali"><a href="#_9-4-adim-2-2-hesap-bilgisi-rızasının-iptali" class="header-anchor">#</a> 9.4 ADIM 2.2: Hesap Bilgisi Rızasının İptali</h2> <br> <img src="/assets/img/HesapBilgisiMusteriRizasininGeriAlinmasiv2.4af20892.png" width="80%"> <br> <p><strong>Şekil 13: Hesap Bilgisi Müşteri Rızasının Geri Alınması</strong></p> <p><strong>DELETE /hesap-bilgisi-rizasi/{RizaNo}</strong></p> <p>DELETE /hesap-bilgisi-rizasi çağrısı, bir HBHS'nin önceden oluşturulmuş bir hesap erişim rızasını (yetkili olsun veya olmasın) silmesine izin verir. Müşteri, rızasını HHS üzerinden iptal etmek yerine, HBHS üzerinden bu rızasını kaldırmak isteyebilir.<br>
Bu API çağrısı, müşterinin HBHS üzerinden hesap bilgisi rızasını iptal etmesine ve HHS nezdindeki hesap bilgisi rızası nesnesinin silinmesini sağlar.</p> <ul><li>Rıza durumunun K olduğu durumlarda erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>İstek başlığında yer alan X-Access-Token ile ilişkili rıza, silinen rizaNo bilgisi ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>Rıza İptali API'sinde ilgili rıza kaydı bulunamaz ise <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li> <li>Rıza durumu Yetki Sonlandırıldı - S veya Yetki İptal - I ise <strong>&quot;TR.OHVPS.Resource.ConsentRevoked&quot;</strong> hatası dönülür.</li></ul> <p>Müşterinin HBHS’nin veri erişim iznini iptal etmesi durumunda HBHS, HHS’de mevcut olan HesapBilgisiRizasi kaynağını pratik olarak mümkün olan en kısa sürede silmelidir. Bu ise, ilgili kaynağa<br> <strong>DELETE /hesap-bilgisi-rizasi/{RizaNo}</strong><br>
çağrısı aracılığı ile yerine getirilir. HBHS ayrıca, sisteminden Hesap/Kart Erişim İzni kaynaklarını da temizlemelidir.<br>
Söz konusu silme işlemi, kayıtların statüsünün pasife çekilmesi ile gerçekleştirilmelidir. Söz konusu kayıtlar, denetim izlerinin oluşturulması ve saklanmasına ilişkin ikincil düzenleme hükümleri kapsamında güvenli şekilde tutulmalıdır.<br>
Servis istek parametresi olarak sadece path’de iletilen Rıza No bilgisine ihtiyaç duymaktadır.<br>
ÖHK rızası başarı ile silindiğinde HTTP 204 response kodu ile işlem sonucu iletilir. Rıza tipi “I” yani “Yetki İptal” olarak güncellenir ve gnclZmn zaman damgası vurularak güncellenir.<br>
ÖHK ile rıza iptali sırasında kurulacak iletişimde (e-posta, sms gibi) aşağıdaki alanların iletilmesi tavsiye edilmektedir:<br>
YÖS Adı, HHS adı, Rıza Oluşturma Zamanı, Servis Tipi Bilgisi (HBHS)<br></p> <h2 id="_9-5-adim-3-hesap-bilgilerinin-alınması"><a href="#_9-5-adim-3-hesap-bilgilerinin-alınması" class="header-anchor">#</a> 9.5 ADIM 3: Hesap Bilgilerinin Alınması</h2> <br> <img src="/assets/img/HesapBilgilerininAlinmasi.163a75f5.png" width="80%"> <p><strong>Şekil 14: Hesap Bilgilerinin Alınması</strong></p> <p>İSTEK:<br>
Müşteri rızası tesis edilmiş kullanıcı için HBHS API erişim adresinden HHS’ye erişilebilir hesap bilgilerini GET isteği ile sorgular:</p> <ul><li>Parametrede yer alan değerlerin doğru gönderildiği kontrol edilir. Hatalı gönderilmesi durumunda HHS tarafından <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür. Parametrede yer alan değerler gönderilmediği durumda parametredeki varsayılan değerler ile hesap bilgileri dönülür. Varsayılan değerler Tablo 14'de belirtilmiştir.</li> <li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>/hesaplar/{hspRef} ile yapılan istekte;
<ul><li>İstek başlığında yer alan X-Access-Token ile ilişkili rızada, izin verilen hspRef'ler için, hesap bilgisi sorgulanan hspRefe ait rıza ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>İlgili hspRef bulunamaz <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li></ul></li> <li>Rıza durumu kontrol edilir.
<ul><li>RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>YÖS'ün; Rıza İptal - I ya da Yetki Sonlandırıldı - S rıza durumlarında hesap bilgileri servisini çağırmaması beklenir. Bu rıza durumları ile yapılmış çağrılar olduğunda HHS tarafından <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>HHS tarafından ÖHK’nın “01: Temel Hesap Bilgisi” izin türüne sahipliği kontrol edilir. 01 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported”</strong> hatası dönülür.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS, &quot;HesapBilgileri&quot; nesnesini oluşturur ve HBHS’ye döner.</p> <ul><li>Hesap bilgisi rızası alınmış ve erişim izni devam eden hesaplar içerisinden herhangi bir hesabın kapatılması ya da pasife alınması durumunda YÖS tarafından yapılan hesap isteğine HHS tarafından hesap bilgisi dönülmelidir. Rıza içerisinde tek bir hesap olması halinde ilgili hesabın kapatılması durumunda rıza 09 iptal detay kodu ile iptal edilmelidir.
Kapalı hesap için TR.OHVPS.DataCode.HspDrm veri türünden KAPALI değeri ile, pasif hesap için TR.OHVPS.DataCode.HspDrm veri türünden PASIF değeri ile dönülmelidir.</li></ul> <h2 id="_9-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanması"><a href="#_9-6-adim-3-1-ve-3-2-hesap-bilgilerinin-sorgulanması" class="header-anchor">#</a> 9.6 ADIM 3.1 ve 3.2: Hesap Bilgilerinin Sorgulanması</h2> <p><strong>GET /hesaplar ve GET /hesaplar/{hspRef}</strong></p> <p>Bu erişim noktalarından tüm hesapların veya belirli bir hesabın bilgileri sorgulanır. Hesap bilgisi için daha önce tanımlanmış izin türüne göre (Temel Hesap Bilgisi veya Detaylı Hesap Bilgisi) yanıtında dönülen HesapBilgileri nesnesinin içeriği değişir. Tablo 15’te HesapBilgileri nesnesinin içeriği verilmiştir.</p> <p>Hesap Bilgisi Sorgu Örneği (Tüm Hesaplar) =  /hesaplar<br>
Hesap Bilgisi Sorgu Örneği (Belirli Bir Hesap) =  /hesaplar/{hspRef}<br>
İşlem Sorgu Örneği (Belirli Bir Hesap) =  /hesaplar?
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= hspRef &amp;
srlmYon=A</p> <p><strong>Tablo 14: Hesap Bilgileri Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Sayfa Başına İstenen Kayıt Sayısı</td> <td>syfKytSayi</td> <td>N3</td> <td>İ</td> <td>Sayfa başına istenen kayıt sayısı. Bu alanda iletilen değer 100’den büyük olamaz.</td> <td>Bu veri gönderildiği durumda, HHS listesini bu sayı kadar gruplandırarak gönderir. Bu veri gönderilmediğinde sayfadaki kayıt sayısı 100 olarak kullanılır.</td></tr> <tr><td>İstenen Sayfa Numarası</td> <td>syfNo</td> <td>N3</td> <td>İ</td> <td>Cevapta dönecek sayfa numarası 1’den başlayarak artan değerlerle iletilmelidir.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayfadaki kayıtları gönderir. Gönderilmediğinde, HHS ilk sayfadaki kayıtları gönderir.</td></tr> <tr><td>Sıralama Kriteri</td> <td>srlmKrtr</td> <td>AN3..50</td> <td>İ</td> <td>Cevapta dönülecek kayıtların sıralama kriterini belirtir. Alabileceği değerler: { “hspRef”}</td> <td>Bu veri gönderildiği durumda, HHS listesini bu kritere göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama kriterini hspRef olarak belirler.</td></tr> <tr><td>Sıralama Yönü</td> <td>srlmYon</td> <td>AN1</td> <td>İ</td> <td>Cevapta dönülecek işlemlerin sıralama yönünü belirtir. Alabileceği değerler:  A: Azalan değerle sıralama Y: Artan değerle sıralama {“A”,”Y”}</td> <td>Bu veri gönderildiği durumda, HHS listesini bu yöne göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama yönünü Azalan olarak belirler.</td></tr></tbody></table> <p><strong>Tablo 15: “HesapBilgileri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>Rıza No</td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>HesapBilgisiRızası nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td></tr> <tr><td>Hesap Temel</td> <td>hspTml</td> <td>Kompleks: HesapTemel</td> <td>Z</td> <td>Temel Hesap Bilgileri (Temel Hesap Bilgisi varsayılan izin türü olduğundan Hesap Temel nesnesi zorunlu olarak yanıtta bulunur)</td></tr> <tr><td>&gt; Hesap Referansı</td> <td>hspRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid). YÖS bazında farklılaşması gerekmez. Bir hesap (IBAN) tek bir hspRef'e karşılık gelmelidir, benzer şekilde bir hspRef tek bir IBAN'a karşılık gelmelidir. Aynı hesap için alınan tüm rızalarda hesap referans bilgisinin değişmemesi gerekmektedir.</td></tr> <tr><td>&gt; Hesap Numarası</td> <td>hspNo</td> <td>AN26</td> <td>K</td> <td>Eğer varsa ödeme hesabına ait IBAN bilgisi</td></tr> <tr><td>&gt; Hesap Sahibi Ünvanı</td> <td>hspShb</td> <td>AN3..140</td> <td>Z</td> <td>Hesap sahibi ya da hesap sahiplerinin ad-soyadı, ticari ünvanı</td></tr> <tr><td>&gt; Şube Adı</td> <td>subeAdi</td> <td>AN3..50</td> <td>K</td> <td>Eğer varsa ödeme hesabının bağlı olduğu şubenin adı</td></tr> <tr><td>&gt; Kısa Ad</td> <td>kisaAd</td> <td>AN3..50</td> <td>K</td> <td>Eğer hesap sahibi hesaba ait bir ad tanımladıysa, tanımlanan hesap adı</td></tr> <tr><td>&gt; Para Birimi</td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para Birimi.</td></tr> <tr><td>&gt; Hesap Türü</td> <td>hspTur</td> <td>AN1</td> <td>Z</td> <td>Hesabın türü (bireysel veya ticari). TR.OHVPS.DataCode.HspTur sırali veri değerlerinden birini alır.</td></tr> <tr><td>&gt; Hesap Tipi</td> <td>hspTip</td> <td>AN1..32</td> <td>Z</td> <td>Hesabın tipi (VADESİZ, KREDİLİ vb.).TR.OHVPS.DataCode.HspTip sıralı veri değerlerinden birini alır.</td></tr> <tr><td>&gt;Hesap Ürün Adı</td> <td>hspUrunAdi</td> <td>AN1..140</td> <td>İ</td> <td>HHS tarafından atanmış olan ürün adı bilgisidir. HBHS tarafından ÖHK’ya gösterilmesi kullanım kolaylığı sağlayacaktır.</td></tr> <tr><td>&gt; Hesap Durumu</td> <td>hspDrm</td> <td>AN5..50</td> <td>Z</td> <td>Hesabın durumunu belirtir. TR.OHVPS.DataCode.HspDrm sıralı veri türlerinden birini alır.</td></tr> <tr><td>Hesap Detay</td> <td>hspDty</td> <td>Kompleks: HesapDetay</td> <td>K</td> <td>Detay Hesap Bilgileri (Temel Hesap Bilgisine ek olarak Detay Hesap Bilgisi izin türü de seçilmişse Hesap Detay nesnesi koşullu olarak yanıtta bulunur)</td></tr> <tr><td>&gt; Açılış Tarihi</td> <td>hspAclsTrh</td> <td>ISODateTime</td> <td>Z</td> <td>Belirtilen hesabın açılış tarihi.</td></tr></tbody></table> <h2 id="_9-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanması"><a href="#_9-7-adim-3-3-ve-3-4-hesap-bakiyesinin-sorgulanması" class="header-anchor">#</a> 9.7 ADIM 3.3 ve 3.4: Hesap Bakiyesinin Sorgulanması</h2> <p><strong>GET /bakiye ve GET /hesaplar/{hspRef}/bakiye</strong><br>
Bu erişim noktalarından tüm hesapların veya belirli bir hesabın bakiyesi sorgulanır.   İstek çağrısına dönülen “BakiyeBilgileri” nesnesi Tablo 17’de verilmiştir.</p> <ul><li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>/hesaplar/{hspRef}/bakiye ile yapılan istekte;
<ul><li>İstek başlığında yer alan X-Access-Token ile ilişkili rızada, izin verilen hspRef'ler için, bakiye sorgusundaki hspRefe ait rıza ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>İlgili hspRef bulunamaz <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li></ul></li> <li>Rıza durumu kontrol edilir.
<ul><li>RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>YÖS'ün; Rıza İptal - I ya da Yetki Sonlandırıldı - S rıza durumlarında hesap bakiye servisini çağırmaması beklenir. Bu rıza durumları ile yapılmış çağrılar olduğunda HHS tarafından <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>Hesap Bakiye Sorgulanması yapılırken HHS tarafından ÖHK’nın “03: Bakiye Bilgisi” izin türü sahipliği kontrol edilir. 03 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported”</strong> hatası dönülür.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS, &quot;BakiyeBilgileri&quot; nesnesini oluşturur ve HBHS’ye döner.</p> <ul><li>Hesap Bilgisi Rızası alınmış ve erişim izni devam eden hesaplar içerisinde yer alan hesaplardan kapatılmış ya da pasif duruma alınmış olan hesaplar için bakiye isteği yapıldığında HHS tarafından bakiye bilgisi dönülmelidir.</li></ul> <p>Hesap bakiyelerinin gösterilmesi sırasında aşağıda verilen örnekler gözönünde bulundurulmalıdır.</p> <p>Örnek 1 : ÖHK <strong>Hesap Bakiye Tutarı</strong> 0 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL. ÖHK 1000 TL para çıkışı gerçekleştirdi. Bakiye API'si yanıtı içerisinde iletilen <strong>Kredi Dahil Göstergesi</strong> 0 değerini içeriyorsa, <strong>Hesap Bakiye Tutarı</strong> -1000 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL olmalıdır.</p> <p>Örnek 2 : ÖHK <strong>Hesap Bakiye Tutarı</strong> 0 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL. ÖHK 1000 TL para çıkışı gerçekleştirdi. Bakiye API'si yanıtı içerisinde iletilen <strong>Kredi Dahil Göstergesi</strong> 1 değerini içeriyorsa, <strong>Hesap Bakiye Tutarı</strong> 2000 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL olmalıdır.</p> <p>Örnek 3 : ÖHK <strong>Hesap Bakiye Tutarı</strong> 1000 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL. ÖHK 1000 TL para çıkışı gerçekleştirdi. Bakiye API'si yanıtı içerisinde iletilen <strong>Kredi Dahil Göstergesi</strong> 0 değerini içeriyorsa, <strong>Hesap Bakiye Tutarı</strong> 0 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL olmalıdır.</p> <p>Örnek 4 : ÖHK <strong>Hesap Bakiye Tutarı</strong> 1000 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL. ÖHK 1000 TL para çıkışı gerçekleştirdi. Bakiye API'si yanıtı içerisinde iletilen <strong>Kredi Dahil Göstergesi</strong> 1 değerini içeriyorsa, <strong>Hesap Bakiye Tutarı</strong> 3000 TL, <strong>Kredili Mevduat Hesabı Bakiyesi</strong> 3000 TL olmalıdır.</p> <p>İşlem Sorgu Örneği (Belirli Bir Hesap)=  /bakiye?
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= hspRef &amp;
srlmYon=A</p> <p><strong>Tablo 16: “BakiyeBilgileri” Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Sayfa Başına İstenen Kayıt Sayısı</td> <td>syfKytSayi</td> <td>N3</td> <td>İ</td> <td>Sayfa başına istenen kayıt sayısı. Bu alanda iletilen değer 100’den büyük olamaz.</td> <td>Bu veri gönderildiği durumda, HHS listesini bu sayı kadar gruplandırarak gönderir. Bu veri gönderilmediğinde sayfadaki kayıt sayısı 100 olarak kullanılır.</td></tr> <tr><td>İstenen Sayfa Numarasi</td> <td>syfNo</td> <td>N3</td> <td>İ</td> <td>Cevapta dönecek sayfa numarası 1’den başlayarak artan değerlerle iletilmelidir.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayfadaki kayıtları gönderir. Gönderilmediğinde, HHS ilk sayfadaki kayıtları gönderir.</td></tr> <tr><td>Sıralama Kriteri</td> <td>srlmKrtr</td> <td>AN3..50</td> <td>İ</td> <td>Cevapta dönülecek kayıtların sıralama kriterini belirtir. Alabileceği değerler: { “hspRef”}</td> <td>Bu veri gönderildiği durumda, HHS listesini bu kritere göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama kriterini hspRef olarak belirler.</td></tr> <tr><td>Sıralama Yönü</td> <td>srlmYon</td> <td>AN1</td> <td>İ</td> <td>Cevapta dönülecek işlemlerin sıralama yönünü belirtir. Alabileceği değerler:  A: Azalan değerle sıralama Y: Artan değerle sıralama {“A”,”Y”}</td> <td>Bu veri gönderildiği durumda, HHS listesini bu yöne göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama yönünü Azalan olarak belirler.</td></tr></tbody></table> <p><strong>Tablo 17: “BakiyeBilgileri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>Hesap Referansı</td> <td>hspRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid). YÖS bazında farklılaşması gerekmez. Bir hesap (IBAN) tek bir hspRef'e karşılık gelmelidir, benzer şekilde bir hspRef tek bir IBAN'a karşılık gelmelidir. Aynı hesap için alınan tüm rızalarda hesap referans bilgisinin değişmemesi gerekmektedir.</td></tr> <tr><td>Bakiye</td> <td>bky</td> <td>Kompleks:Bakiye</td> <td>Z</td> <td></td></tr> <tr><td>&gt; Hesap Bakiye Tutarı</td> <td>bkyTtr</td> <td>AN1..25</td> <td>Z</td> <td>Hesabın bakiyesi. Bloke tutar düşülmeden iletilmelidir. <br> Tutar alanı regex patterni şu şekildedir:  '^-?\d{1,18}$|^-?\d{1,18}\.\d{1,5}$'</td></tr> <tr><td>&gt; Blokeli Tutar</td> <td>blkTtr</td> <td>AN1..24</td> <td>K</td> <td>Varsa hesapta blokeli tutar bilgisi.   <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td>&gt; Para Birimi</td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi.</td></tr> <tr><td>&gt; Bakiye İletilme Zamanı</td> <td>bkyZmn</td> <td>ISODateTime</td> <td>Z</td> <td>Bakiyenin iletildiği zaman bilgisi.</td></tr> <tr><td>&gt; KrediliHesap</td> <td>krdHsp</td> <td>Kompleks: KrediliHesap</td> <td>K</td> <td></td></tr> <tr><td>&gt;&gt; Kredili Mevduat Hesabı Bakiyesi</td> <td>kulKrdTtr</td> <td>AN1..24</td> <td>Z</td> <td>Kredili mevduat tutarı. Kredili bir hesap ise zorunlu. <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td>&gt;&gt; Kredi Dahil Göstergesi</td> <td>krdDhlGstr</td> <td>AN1</td> <td>Z</td> <td>Kredili bir hesap ise zorunlu. Bakiye tutarının kredi tutarı dahil edilerek ya da edilmeden iletildiğini gösterir. <br> 0: Kredi tutarı dahil edilmeden bakiye bilgisi iletilmesi durumu <br> 1: Kredi tutarı dahil edilerek bakiye bilgisi iletilmesi durumu</td></tr></tbody></table> <h2 id="_9-8-adim-3-5-ve-3-6-islemlerin-sorgulanması"><a href="#_9-8-adim-3-5-ve-3-6-islemlerin-sorgulanması" class="header-anchor">#</a> 9.8 ADIM 3.5 ve 3.6: İşlemlerin Sorgulanması</h2> <p><strong>GET /hesaplar/{hspRef}/islemler</strong></p> <p>Servis başarılı yanıtında Tablo 19’da belirtilen &quot;IslemBilgileri&quot; nesnesini dönmektedir.</p> <ul><li>Belirli bir hesaba ilişkin işlem bilgileri Tablo 18’deki istek parametrelerine göre sorgulanır. Parametrede yer alan değerlerin doğru gönderildiği kontrol edilir. Hatalı gönderilmesi durumunda <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür.</li> <li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>İstek başlığında yer alan X-Access-Token ile ilişkili rızada, izin verilen hspRef'ler için, işlemler sorgusundaki hspRefe ait rıza ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>İlgili hspRef bulunamaz <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li> <li>Rıza durumu kontrol edilir.
<ul><li>RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>YÖS'ün; Rıza İptal - I ya da Yetki Sonlandırıldı - S rıza durumlarında işlemler servisini çağırmaması beklenir. Bu rıza durumları ile yapılmış çağrılar olduğunda HHS tarafından <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>HHS tarafından ÖHK’nın “04: Temel İşlem (Hesap Hareketleri) Bilgisi” veya &quot;05: Ayrıntılı İşlem Bilgisi&quot; izin türüne sahipliği kontrol edilir. 04 veya 05 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported”</strong>  hatası dönülür.</li></ul> <p>Hesap Bilgisi Rızası alınmış ve erişim izni devam eden hesaplar içerisinde yer alan hesaplardan kapatılmış ya da pasif duruma alınmış olan hesaplar için işlemler isteği yapıldığında HHS tarafından işlemler bilgisi dönülmelidir.<br>
İşlem bilgisi için daha önce tanımlanmış izin türüne göre yanıtta dönen IslemBilgileri nesnesinin (Temel İşlem Bilgisi veya Temel İşlem Bilgisi ve Detaylı İşlem Bilgisi) içeriği değişir.<br>
İşlemler servisi hem ÖHK’nın talebi ile YÖS uygulaması üzerinden çağrılabileceği gibi, YÖS’ün ÖHK’sız başlatabileceği otomatik çağrıları ile de yanıt dönebilmektedir.<br>
HHS, işlemin sistemsel yapılıp yapılmadığını, istek parametreleri içerisinde yer alan PSU-Initiated parametresi ile anlar. Bu parametre “E” ise ÖHK’lı, “H” ise sistemsel yapılmış bir sorgu anlamına gelmektedir.
ÖHK’nın başlattığı sorgular için HHS tarafından belirlenen üst rate limitler dahilinde çağrım yapılabilir.<br>
YÖS, otomatik yapacağı sorgularda;</p> <ul><li>Bireysel ÖHK’lar için hesap bazında günde en fazla 4 adet başarı ile sonuçlanan sorgulama yapabilir. 4 adetten fazla yapılması durumunda <strong>”TR.OHVPS.Connection.ExceededRate”</strong> hatası dönülür.</li> <li>Kurumsal ÖHK’lar için hesap bazında saatte en fazla 12 adet başarı ile sonuçlanan sorgulama yapabilir. 12 adetten fazla yapılması durumunda <strong>”TR.OHVPS.Connection.ExceededRate”</strong> hatası dönülür.</li></ul> <p>HHS, tutacağı sayaç bilgisi ile bu sayıları kontrol ederek daha fazla sorgulama yapılmasına izin vermeyebilir.</p> <p>Aynı istek parametreleri ile yapılan sorgu sonucunda dönecek toplam kayıt sayısı 100’ü aştığında, sayfalama yöntemi ile HHS’nin cevap dönmesi beklenmektedir.  Her bir sayfa için işlemler servisi tekrar çağrılsa da, bu çağrım HHS’nin tuttuğu sayaç değerini arttırmaz. HHS’nin tutacağı sayaçın kontrol parametreleri YÖS kodu, hesap numarası ya da referansı olmalıdır. Sayfa no parametresi varsa ve 1'den büyük ise işlem sayacını arttırmamalıdır.</p> <p>ÖHK’nın YÖS uygulaması üzerinden tetiklediği işlemlerde ise;
bireysel ÖHK’lar  için en fazla 1 aylık,
kurumsal ÖHK’lar için ise en fazla 1 haftalık bir pencere aralığında sorgulama yapılabilir. Belirtilen tarih aralığından farklı değer ile sorgulama yapıldığında <strong>”TR.OHVPS.Business.InvalidStartEndTime”</strong> hatası dönülür.</p> <p>YÖS, otomatik yapacağı sorgularda hem bireysel hem de kurumsal ÖHK’lar için 24 saatlik bir pencere aralığında sorgulama yapabilir. Belirtilen tarih aralığından farklı değer ile sorgulama yapıldığında <strong>”TR.OHVPS.Business.InvalidStartEndTime”</strong> hatası dönülür.</p> <p>Yeni günün başlangıç saatinin 00:00:00 olduğu kabul edilmiştir.</p> <p><strong>Sorgu örnekleri aşağıdaki gibidir: <br></strong></p> <p><strong>1 günlük İşlem Sorgu Örneği (Belirli Bir Hesap)</strong>=  /hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-06-01T00:00:00+03:00&amp;
hesapIslemBtsTrh=2020-06-02T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br> <br> <strong>1 haftalık İşlem Sorgu Örneği (Belirli Bir Hesap)</strong>=  /hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-06-01T00:00:00+03:00&amp;
hesapIslemBtsTrh=2020-06-08T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br> <br> <strong>1 Aylık İşlem Sorgu Örneği (Belirli Bir Hesap)</strong>=  /hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-02-01T00:00:00+03:00&amp;
hesapIslemBtsTrh=2020-03-01T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br><br> <strong>1 Aylık İşlem Sorgu Örneği (Belirli Bir Hesap)</strong>=  /hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-01-31T00:00:00+03:00&amp;
hesapIslemBtsTrh=2020-02-28T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br><br> <strong>1 Aylık İşlem Sorgu Örneği (Belirli Bir Hesap)</strong>=  /hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-02-28T00:00:00+03:00&amp;
hesapIslemBtsTrh=2020-03-28T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br><br> <strong>24 saatlik pencerede yapacağı sistemsel sorgu örneği (Son sorgusunun üzerine 24 saat eklenmesi)</strong> =
/hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2020-06-01T14:10:08+03:00&amp;
hesapIslemBtsTrh=2020-06-02T14:10:08+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br><br> <strong>Önyüzden alınan sorgu parametreleri ile oluşturulan sorgu örneği (Örnek sorgu tarih aralığı 20.02.2023- 25.02.2023 arasındadır)</strong> =
/hesaplar/{hspRef}/islemler?
hesapIslemBslTrh=2023-02-20T00:00:00+03:00&amp;
hesapIslemBtsTrh=2023-02-26T00:00:00+03:00&amp;
minIslTtr=0&amp;
mksIslTtr=100000&amp;
brcAlc=A&amp;
syfKytSayi=25&amp;
syfNo=1&amp;
srlmKrtr= islGrckZaman &amp;
srlmYon=A
<br><br> <strong>Tablo 18: İşlem Listesi Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>İşlem Sorgulama Başlangıç Zamanı</td> <td>hesapIslemBslTrh</td> <td>ISODateTime</td> <td>Z</td> <td>Sorgulanacak işlemlerin başlangıç tarihi.</td> <td>HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.<br><br>ÖHK tarafından tetiklenen sorgularda;hesapIslemBslTrh ve hesapIslemBtsTrh arası fark bireysel ÖHK’lar için en fazla 1 ay,kurumsal ÖHK’lar için ise en fazla 1 hafta olabilir.<br><br>YÖS tarafından sistemsel yapılan sorgulamalarda hem bireysel, hem de kurumsal ÖHK’lar için;son 24 saat sorgulanabilir. Bu yüzden hesapIslemBtsTrh-24 saat’ten daha uzun bir aralık sorgulanamaz olmalıdır.<br><br>İstek başlığında yer alan PSU-Initiated alanı “E” ise ÖHK’lı, “H” ise sistemsel yapılmış bir sorgu anlamına gelmektedir.</td></tr> <tr><td>İşlem Sorgulama Bitiş Zamanı</td> <td>hesapIslemBtsTrh</td> <td>ISODateTime</td> <td>Z</td> <td>Sorgulanacak işlemlerin bitiş tarihi.</td> <td>HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.<br>YÖS tarafından sistemsel yapılan sorgulamalarda hem bireysel, hem de kurumsal ÖHK’lar için;İleri vadeli işlem emirleri dahil olmadığı için (Sürüm 1.0.2 kapsamında); İşlem Sorgulama Bitiş Zamanı, her zaman, sorgulama zaman damgasını iletecek şekilde (datetime (now)) iletilebilir.</td></tr> <tr><td>En Düşük İşlem Tutarı</td> <td>minIslTtr</td> <td>AN1..24</td> <td>İ</td> <td>Sorgulanacak işlemlerin alabileceği en düşük işlem tutarı. <br> <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td>Bu veri gönderildiği durumda HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.</td></tr> <tr><td>En Yüksek İşlem Tutarı</td> <td>mksIslTtr</td> <td>AN1..24</td> <td>İ</td> <td>Sorgulanacak işlemlerin alabileceği en yüksek işlem tutarı.  <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td> <td>Bu veri gönderildiği durumda HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.</td></tr> <tr><td>Borç Alacak Göstergesi</td> <td>brcAlc</td> <td>AN1</td> <td>İ</td> <td>TR.OHVPS.DataCode.BrcAlc sıralı veri tipi değerlerinden birini alır. Sorgulanacak işlemlerin borç / alacak kriteri B: Hesaba borç yaratan işlem.A: Hesaba alacak yaratan işlem.{“B”,”A”}</td> <td>Bu veri gönderildiği durumda HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.</td></tr> <tr><td>Sayfa Başına İstenen Kayıt Sayısı</td> <td>syfKytSayi</td> <td>N3</td> <td>İ</td> <td>Sayfa başına istenen kayıt sayısı. Bu alanda iletilen değer 100’den büyük olamaz.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayı kadar gruplandırarak gönderir. Bu veri gönderilmediğinde sayfadaki kayıt sayısı 100 olarak kullanılır.</td></tr> <tr><td>İstenen Sayfa Numarasi</td> <td>syfNo</td> <td>N3</td> <td>İ</td> <td>Cevapta dönecek sayfa numarası 1’den başlayarak artan değerlerle iletilmelidir.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayfadaki kayıtları gönderir. Gönderilmediğinde, HHS ilk sayfadaki kayıtları gönderir.</td></tr> <tr><td>Sıralama Kriteri</td> <td>srlmKrtr</td> <td>AN3..50</td> <td>İ</td> <td>Cevapta dönülecek işlemlerin sıralama kriterini belirtir. Alabileceği değerler: {“islGrckZaman”}</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu kritere göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama kriterini islGrckZaman olarak belirler.</td></tr> <tr><td>Sıralama Yönü</td> <td>srlmYon</td> <td>AN1</td> <td>İ</td> <td>Cevapta dönülecek işlemlerin sıralama yönünü belirtir. Alabileceği değerler: A: Azalan değerle sıralama Y: Artan değerle sıralama {“A”,”Y”}</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu yöne göre sıralayarak gönderir. Gönderilmediğinde, HHS sıralama yönünü Azalan olarak belirler.</td></tr></tbody></table> <p><strong>Tablo 19: “IslemBilgileri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>Hesap Referans Numarası</td> <td>hspRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından hesap için atanan biricik tanımlıyıcıdır (uuid). YÖS bazında farklılaşması gerekmez. Bir hesap (IBAN) tek bir hspRef'e karşılık gelmelidir, benzer şekilde bir hspRef tek bir IBAN'a karşılık gelmelidir. Aynı hesap için alınan tüm rızalarda hesap referans bilgisinin değişmemesi gerekmektedir.</td></tr> <tr><td>Islemler</td> <td>isller</td> <td>Kompleks:Islem[Array]</td> <td>K</td> <td>Hesaba ilişkin hareketler varsa İşlemler nesnesi dizisi olarak dönülür. İşlemler nesnesi Temel İşlem Bilgileri ve Detay İşlem Bilgileri nesnesinden meydana gelir. İzin türü varsayılan olarak Temel İşlem Bilgilerini içerir. Detay İşlem Bilgileri izin türü de seçildi ise Temel İşlem Bilgilerine ek olarak Detay İşlem Bilgileri de gönderilir.</td></tr> <tr><td>&gt; Temel İşlem Bilgileri</td> <td>islTml</td> <td>Kompleks:IslemTemel</td> <td>Z</td> <td>Temel İşlem Bilgileri varsayılan olarak dönülür.</td></tr> <tr><td>&gt;&gt; İşlem Numarası</td> <td>islNo</td> <td>AN3..50</td> <td>Z</td> <td>Hesap hareketinin oluşturulması sırasında atanan ve borç (veya alacak) hareketini tekilleştiren HHS bazında tekil tanımlayıcıdır. Bu değer tek başına tekil olabileceği gibi birden fazla değerin bir araya getirilmesiyle de tekilliği sağlanmış olabilir. Bu değerin en azından hesap numarası (hesNo) bazında tekil olması beklenir. Genellikle kullanılan örnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp,dekont numarası</td></tr> <tr><td>&gt;&gt; İşlem Referans Numarası</td> <td>refNo</td> <td>AN3..50</td> <td>Z</td> <td>İşlemi uçtan uca tanımlayan tekil tanımlayıcıdır. Borç ve alacak hareketinden oluşan bir veya birden fazla işlemler bütünü için atanmış olan ve bu bütünü tekilleştiren (bir biri ile ilişkisini tutan) değerdir.Bu değer hem YÖS’ten gelen değer olabilir (ödeme işlemlerinde kullanılan kkodRef ya da refBlg alanı) hem de HHS içinde takip edilmek için üretilmiş bir değer olabilir. HHS sisteminde 2 değerin de bulunması durumunda;refNo alanını doldurmak için, HHS’nin YÖS’ten gelen değere öncelik vermesi beklenmektedir. YÖS’ten gelen veri örneği: Sipariş Numarası, Fatura Numarası, Karekod Referansı vb. HHS’te üretilen veri örneği: Masraflı havale işleminde hem havale işleminin hem de masraf işleminin aynı referans numarasına sahip olması da örnek olarak gösterilebilir.</td></tr> <tr><td>&gt;&gt; İşlem Tutarı</td> <td>islTtr</td> <td>AN1..24</td> <td>Z</td> <td>İşlem tutarı.  <br> Tutar alanı regex patterni şu şekildedir: '^\d{1,18}$|^\d{1,18}\.\d{1,5}$'</td></tr> <tr><td>&gt;&gt; Güncel Bakiye Tutarı</td> <td>gnclBky</td> <td>AN1..25</td> <td>Z</td> <td>İşlem sonrası güncel bakiye bilgisi tutarı.  <br> Tutar alanı regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td></tr> <tr><td>&gt;&gt; Para Birimi</td> <td>prBrm</td> <td>AN3</td> <td>Z</td> <td>Para birimi.</td></tr> <tr><td>&gt;&gt; İşlem Gerçekleşme Zamanı</td> <td>islGrckZaman</td> <td>ISODateTime</td> <td>Z</td> <td>İşlemin gerçekleşme zamanı.</td></tr> <tr><td>&gt;&gt; İşlem Kanalı</td> <td>kanal</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.OdemeKaynak sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt;&gt; Borçlandırma Alacaklandırma Göstergesi</td> <td>brcAlc</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.BrcAlc sıralı veri türü değerlerinden birini alır. İşlemin hesabı borç ya da alacaklandırdığı bilgisidir.</td></tr> <tr><td>&gt;&gt; İşlem Türü</td> <td>islTur</td> <td>AN3..50</td> <td>Z</td> <td>HHS’nin işleme ait ilişkilendirdiği işlem türü değeri. TR.OHVPS.DataCode.IslemTuru sıralı veri türü değerlerinden birini alır.</td></tr> <tr><td>&gt;&gt; İşlem Amacı</td> <td>islAmc</td> <td>AN2</td> <td>Z</td> <td>TR.OHVPS.DataCode.IslemAmaci sırali veri değerlerinden birini alır.<br><br>Karekod akışında, FAST Karekod Veri Organizasyonundaki 62-08: alanında tanımlı Ödeme Amacı verisi kullanılır.</td></tr> <tr><td>&gt;&gt; Ödeme Sistemi No</td> <td>odmStmNo</td> <td>AN10..50</td> <td>K</td> <td>Ödeme başarılı başlatıldıysa, ödemenin başlatıldığı sistemdeki referans numarası. Gerektiğinde ilgili ödeme sisteminde/HHS’de söz konusu ödemeye karşılık gelen mesajla bağlantı kurmada kullanılır. <br> Ödeme Hizmeti kullanıcısına işlemin takibi için gösterilebilir. <br>İşlemin yönlendirildiği ödeme sistemi FAST ya da PÖS ise sistemdeki ilgili mesajın Tarih, GönderenKatilimKodu ve SorguNumarasi değerlerinin birleşiminden oluşur. Bu 3 alan mevcutta kullanıldığı formatta aralarına dikey çizgi (Unicode U+2223) işareti koyularak, birleştirmeli ve iletilmelidir. Örn : Tarih|GönderenKatilimKodu|SorguNumarasi  <br>Ödeme Havale/Virman işlemi ise HHS’nin üretmiş olduğu havale/virman numarasını içerir. Buradaki format da Tarih|GönderenKatilimKodu|Havale-virman numarası şeklinde olmalıdır.<br>Havale/FAST/PÖS  ödeme yöntemleri için tarih alanı yyyy-aa-gg formatında 10 karakter olarak iletilmelidir.</td></tr> <tr><td>&gt; Detay İşlem Bilgileri</td> <td>islDty</td> <td>Kompleks: IslemDetay</td> <td>K</td> <td>Detay İşlem Bilgileri dizi olarak gönderilmelidir.</td></tr> <tr><td>&gt;&gt; İşlem Açıklaması</td> <td>islAcklm</td> <td>AN1..200</td> <td>Z</td> <td>HHS tarafından atanan işlem açıklaması. HHS kendi işlem hareketlerine yansıttığı açıklamayı buraya yansıtmalıdır.  HHS'ler tüm hesap hareketlerini YÖS'ler ile paylaşmakla yükümlü olup, hassas veri içeren(örn: faiz, komisyon bilgisi içeren vb.) işlem hareketleri de bu kapsamda değerlendirilerek işlem açıklamasının maskeli olarak iletilmesi sağlanır. Kelimelerin ilk 3 hanesi maskeli olacak şekilde, ancak sakıncalı bulunan kelimeler varsa; (örn: faiz, komiyon vb.) kelimelerin tamamı maskeli olacak şekilde gösterilebilir.</td></tr> <tr><td>&gt;&gt; Karşı Taraf</td> <td>krsTrf</td> <td>Kompleks:  KarsiTaraf</td> <td>K</td> <td>Kullanımı işlem bazında değişmektedir. Örnek: FAST işleminde karşı taraf alıcının bilgileridir. Vergi ödemesinde kurum IBAN bilgisi müşteriye gösterilemeyebileceğinden bu alanın boş gelmesi HHS insiyatifindedir.</td></tr> <tr><td>&gt;&gt;&gt; Karşı Maskeli IBAN</td> <td>krsMskIBAN</td> <td>AN26</td> <td>K</td> <td>İlgili hesap hareketinin karşı tarafının maskeli IBAN bilgisi.</td></tr> <tr><td>&gt;&gt;&gt; Karşı Ünvan</td> <td>krsUnvan</td> <td>AN3..140</td> <td>K</td> <td>İlgili hesap hareketinin karşı tarafının ad-soyad ya da ticari ünvan bilgisi. Ünvan bilgisi maskelenmeden iletilmelidir.</td></tr> <tr><td>&gt;&gt;&gt; Karşı Taraf Kimlik Bilgisi</td> <td>krsKimlikVrs</td> <td>AN1..11</td> <td>İ</td> <td>HHS sorumluluğunda YÖS ile paylaşılan Karşı Taraf Kimlik Bilgisi(Kimlik/Kurum Kimlik - TCKN/VKN)</td></tr></tbody></table> <h2 id="_9-9-adim-4-kart-bilgilerinin-sorgulanması"><a href="#_9-9-adim-4-kart-bilgilerinin-sorgulanması" class="header-anchor">#</a> 9.9 ADIM 4: Kart Bilgilerinin Sorgulanması</h2> <img src="/assets/img/KartBilgilerininAlinmasiv2.2b7771ac.png" width="80%"> <p><strong>GET /kartlar ve GET /kartlar/{kartRef}</strong></p> <p>Bu erişim noktalarından tüm kartların veya belirli bir kartın bilgileri sorgulanır ve kart listesi elde edilir. İlgili sorgu için 07 izin türünün verilmesi yeterlidir. HHS ekranlarında kart seçimi yapılırken sadece aktif/açık statüde olan kartlar listelenecek ve ÖHK'ya seçtirilecektir. Kartın ilgili kanalda listelenme yetkisi bulunmuyorsa ÖHVPS kapsamında listelenmeyebilir. Listelendiği durumda; asıl kart sahibi ile sanal/ek kart sahiplerinin aynı kişi olduğu düşünüldüğünde HHS ekranlarında kart seçimi yapılarak rıza verilirken asıl kart seçilmeden ilgili asıl karta bağlı sanal ve ek kartların ayrıca seçilerek rıza verilmesine izin verilmemelidir. HHS mevcut kanallarında ek ve sanal kart hareketlerini asıl karttan ayırt etmeden müşterisine gösteriyor ise asıl kart seçimi ile birlikte asıl karta bağlı sanal ve/veya ek kart seçimini zorunlu kılmalıdır. Asıl kart hamili dışında bir kişi için ek kart çıkartıldığı durumda ek kart sahibi HHS'de asıl kartı görmeyecek olduğundan sadece kendisine çıkartılan ek kartı listelenecek ve seçerek rıza vermesi sağlanacaktır. Ek kart hamilinin asıl kart hamilinden farklı olduğu durumda asıl karta ait bir rıza olmasa da ek karta rıza verilebilir.</p> <p>Her durumda onay ekranında rıza verilen tüm kartların listesini ÖHK'ya göstermesi zorunludur. Kapalı devre çalışan kartlar kapsama dahil değildir.</p> <p>YÖS tarafından başlatılan rıza isteklerinde hesap ve kart izin türlerinin seçili olması durumunda HHS ekranlarında hem hesapların hem de kartların listelenmesi sağlanacaktır. Ancak hesap ya da kart bilgilerinden en az birinin seçilmesi yeterlidir. Hem hesap hem kart bilgisi için seçim yapılması zorunluluğu bulunmamaktadır.</p> <ul><li>Parametrede yer alan değerlerin doğru gönderildiği kontrol edilir. Hatalı gönderilmesi durumunda HHS tarafından <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür. Parametrede yer alan değerler gönderilmediği durumda parametredeki varsayılan değerler ile kart bilgileri dönülür. Varsayılan değerler Tablo 20'de belirtilmiştir.</li> <li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>Rıza durumu kontrol edilir.
<ul><li>RizaDurumu B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>YÖS'ün; Rıza İptal - I ya da Yetki Sonlandırıldı - S rıza durumlarında kartlar servisini çağırmaması beklenir. Bu rıza durumları ile yapılmış çağrılar olduğunda HHS tarafından <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>İlgili rıza numarasının “07: Temel Kart Bilgisi” izin türüne sahipliği kontrol edilir. 07 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported”</strong> hatası dönülür.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS tarafından istek başlığında yer alan X-Access-Token ile ilişkili rıza içerisindeki kart bilgileri dönülür. Kart bilgileri için KartBilgileri nesnesinin içeriği Tablo 21'de verilmiştir.</p> <p>Kart Bilgisi Sorgu Örneği (Tüm Kartlar) = /kartlar?syfKytSayi=25&amp;syfNo=1?kartTipi=K
Kart Bilgisi Sorgu Örneği (Belirli Bir Kart) = /kartlar/{kartRef}</p> <p>İptal statüsünde olan banka ve ön ödemeli kart tipleri HHS tarafından kartlar sorgusunda dönülmeyecek olup YÖS'ler tarafından ÖHK'ya da gösterilemeyecektir. İptal statülü kredi kart tipi için borç/taksit bilgisi veya artı bakiye olması durumunda kartlar listesinde HHS'ler tarafından dönüş sağlanacak olup YÖS'ler tarafından ÖHK'ya gösterilecektir. İptal statüsünde olup herhangi bir bakiye ve borç olmaması durumunda ilgili kart bilgisi kartlar listesinde HHS tarafından iletilmeyecektir.</p> <p>HHS'de açık/aktif statüde yer alan kartlar seçilip rıza tahsis edildikten sonra kartın statüsünün pasif olması durumunda HHS tarafından mevcut kanallarında gösterilen bilgiler kart liste, detay ve hareket sorgulamalarında dönülmelidir. HHS'de kart seçimi yapıp rıza tahsis edildikten sonra ilgili kartın gösterimi özelinde HHS'de kısıtlama getirilmesi durumları için örnekler aşağıda detaylandırılmıştır.</p> <ul><li>Rıza içerisinde sadece kart olması durumunda ilgili rızanın 09 iptal detay kodu ile iptal edilmesi sağlanacaktır.</li> <li>Rıza içerisinde ilgili kartın dışında hesap/kart olması durumunda rıza iptal edilmeyecektir. İlgili kart haricinde kart listesinde farklı bir kart yoksa kart listesi, sorgulandığında <strong>TR.OHVPS.Business.RestrictedChannelAccess</strong> hata kodu dönülecektir.</li></ul> <p><strong>Tablo 20: Kart Bilgileri Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Sayfa Başına İstenen Kayıt Sayısı</td> <td>syfKytSayi</td> <td>N3</td> <td>İ</td> <td>Sayfa başına istenen kayıt sayısı. Bu alanda iletilen değer 100’den büyük olamaz.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayı kadar gruplandırarak gönderir. Bu veri gönderilmediğinde sayfadaki kayıt sayısı 100 olarak kullanılır.</td></tr> <tr><td>İstenen Sayfa Numarasi</td> <td>syfNo</td> <td>N3</td> <td>İ</td> <td>Cevapta dönecek sayfa numarası 1’den başlayarak artan değerlerle iletilmelidir.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayfadaki kayıtları gönderir. Gönderilmediğinde, HHS ilk sayfadaki kayıtları gönderir.</td></tr> <tr><td>Kart Tipi</td> <td>kartTipi</td> <td>AN1</td> <td>İ</td> <td>Kart tipleri özelinde Banka, Kredi ve Ön Ödemeli kartların ayrıca soruglanması sağlanır.</td> <td>Bu veri gönderildiği durumda, HHS kart tipine uygun olarak kart bilgilerini döner.</td></tr></tbody></table> <p><strong>Tablo 21: “KartBilgileri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th></tr></thead> <tbody><tr><td>Rıza No</td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>HesapBilgisiRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td></tr> <tr><td>Kart Referans Numarası</td> <td>kartRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından her bir kart için atanan biricik değerdir (uuid). Bir kart tek bir kartRef'e karşılık gelmelidir, benzer şekilde bir kartRef tek bir karta karşılık gelmelidir. Aynı kart için alınan tüm rızalarda kart referans bilgisinin değişmemesi gerekmektedir.</td></tr> <tr><td>Kart Numarası</td> <td>kartNo</td> <td>AN15..16</td> <td>Z</td> <td>Karta ait numara maskeli olarak iletilmelidir. Maskeleme kuralı kart'ın ilk 6 ve son 4 hanesi açık olarak görünecek şekilde maskelenmelidir. Sanal kart bilgisi için de ilgili numara maskeli olarak iletilmelidir. Örn: 123456******5678</td></tr> <tr><td>Asıl Kart Numarası</td> <td>asilKartNo</td> <td>AN15..16</td> <td>K</td> <td>Asıl kartlar için ilgili alan iletilmemelidir. Sanal ve ek kartlar için bağlı oldukları asıl kart numaraları iletilmelidir. Ek karta ait sanal kart için asıl kart numarası olarak ek kart numarası iletilmelidir. Kart numarası maskeli iletilmelidir.</td></tr> <tr><td>Kart Tipi</td> <td>kartTipi</td> <td>AN1</td> <td>Z</td> <td>Kartın tipini belirten değerdir. Kart tipleri olarak alabileceği değerler <strong>TR.OHVPS.DataCode.KartTip</strong> sıralı veri türlerinden biridir.</td></tr> <tr><td>Alt Kart Tipi</td> <td>altKartTipi</td> <td>AN1</td> <td>Z</td> <td>Kart Tipleri altında yer alan alt kart tipleridir. Alt kart tipleri olarak alabileceği değerler <strong>TR.OHVPS.DataCode.AltKartTip</strong> sıralı veri türlerinden biridir.<br> Asıl banka kartı, sanal banka kartı, ek kredi kartı, asıl kredi kartı gibi tüm kart tiplerini ayrıştırmak için asıl ve alt kart tipleri kullanılmaktadır.</td></tr> <tr><td>Kart Formu</td> <td>kartFormu</td> <td>AN1</td> <td>Z</td> <td>Kartın fiziksel ve dijital olduğunu belirten değerdir. Alabileceği değerler <strong>TR.OHVPS.DataCode.KartFormu</strong> sıralı veri türlerinden biridir.</td></tr> <tr><td>Kart Türü</td> <td>kartTuru</td> <td>AN1</td> <td>Z</td> <td>Kartın tipinin bireysel ya da ticari olmasına yönelik olan değerdir. <br><strong>B:Bireysel, T:Ticari</strong></td></tr> <tr><td>Kart Statüsü</td> <td>kartStatu</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KartStatu</strong> sıralı veri türü değerlerinden birini alır.<br> Kart statüsü için güncelleme yapılamayacak durumda ise iptal statüsü olarak değerlendirilmelidir. Kart statüsü güncellenebilir durumda ise açık ve pasif olarak değerlendirilmelidir.</td></tr> <tr><td>Kart Sahibi Ad/Soyad</td> <td>kartSahibi</td> <td>AN3..140</td> <td>Z</td> <td>Kart sahibi ya da kart sahiplerinin ad-soyadı.</td></tr> <tr><td>Kart Ticari Unvan</td> <td>kartTicariUnvan</td> <td>AN3..140</td> <td>K</td> <td>Kart türü ticari ise ilgili alanda ticari unvan iletilmesi zorunludur.</td></tr> <tr><td>Kart Ürün Adı</td> <td>kartUrunAdi</td> <td>AN3..140</td> <td>Z</td> <td>Kart bilgilerinin ürün adı. Örn : TROY Business Kart</td></tr> <tr><td>Ekstre Türleri</td> <td>ekstreTurleri</td> <td>Kompleks:EkstreTurleri[Array]</td> <td>Z</td> <td>Ekstre türleri dizi içerisinde iletilmelidir.</td></tr> <tr><td>&gt; Ekstre Statüsü</td> <td>ekstreStatu</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.EkstreStatu</strong> sıralı veri türü değerlerinden birini alır.Ekstre türünün durumu iletilmelidir. Pasif olan ekstre türleri de iletilmelidir. A: Aktif : ilgili kartın ekstre türünün kullanıma açık olmasıdır. P: Pasif : İlgili kartın esktre türünün eskiden kullanıldığı ancak şu an devre dışı durumda olmasıdır. <br><br>Örnek olarak: İlgili kredi kartının TRY, USD, EUR ekstre türleri açık olduğu durumda üç ekstre türünün de aktif olarak dönmesi beklenmektedir. ÖHK, USD ekstre türünü kapattığı durumda USD pasif ; TRY ve EUR aktif olarak dönmesi beklenmektedir. Böylece ÖHK’nın şu an pasif ama önceden aktif olan esktre türlerinin sorgulanması sağlanabilecektir. Eğer bir ekstre türü için hiç ekstre üretilmemişse, bu durumda HHS’nin ilgili ekstre türünü hiç dönmemesi gerekmektedir.</td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>İlgili karta ait ekstre türleri para birimi.(TRY, USD, EUR, GBP) Yurtdışı ekstre olan kartlar için TRY haricinde de değer dönülmesi gerekmektedir. Banka kartlarında ise karta bağlı olan hesap para birimleri iletilmelidir.</td></tr> <tr><td>Kart Rumuz</td> <td>kartRumuz</td> <td>AN3..140</td> <td>İ</td> <td>Kart için rumuz bilgisi var ise gönderilebilir.</td></tr> <tr><td>Kart Şeması</td> <td>kartSema</td> <td>AN1</td> <td>Z</td> <td><strong>TR.OHVPS.DataCode.KartSema</strong> sıralı veri türü değerlerinden birini alır.</td></tr></tbody></table> <h2 id="_9-10-adim-4-1-kart-detay-bilgilerinin-sorgulanması"><a href="#_9-10-adim-4-1-kart-detay-bilgilerinin-sorgulanması" class="header-anchor">#</a> 9.10 ADIM 4.1: Kart Detay Bilgilerinin Sorgulanması</h2> <p><strong>GET /kartlar/{kartRef}/kart-detay</strong></p> <p>KartBilgileri nesnesi ile elde edilen kart listesinde yer alan kartların detayı sorgulanır. Detay ile birlikte KartDetayBilgileri nesnesinin içeriği Tablo 23'de verilmiştir.</p> <ul><li>Parametrede yer alan ekstreTuru bilgisi Ekstre Türleri haricinde uygun olmayan bir değer gönderildiğinde <strong>”TR.OHVPS.Business.InvalidCurrencyCode”</strong> hatası dönülür. Bu alan gönderilmiyorsa TRY olarak değerlendirilmelidir.</li> <li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>İstek başlığında yer alan X-Access-Token ile ilişkili rızada, izin verilen kartRef'ler için, kart detay bilgileri sorgulanan kartRefe ait rıza ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>İlgili kartRef bulunamaz <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li> <li>Rıza durumu kontrol edilir.
<ul><li>B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>I: Rıza İptal ya da S: Yetki Sonlandırıldı ise <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “K: Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>İlgili rıza numarasının “08: Detaylı Kart Bilgisi” izin türüne sahipliği kontrol edilir. 08 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported&quot;”</strong> hatası dönülür.</li> <li><strong>Alt kart tipi Sanal Kart olanlar için detay bilgisi görüntülenmeyecektir.</strong> Sanal kart özelinde detay bilgi sorgulaması yapılması durumunda HHS tarafından <strong>&quot;TR.OHVPS.Business.CardTypeNotSupported&quot;</strong> hatası dönülür.</li> <li>Kart tipi olarak; iptal statüsünde olan banka ve ön ödemeli kartlar için detay sorgulaması yapılamayacaktır. Kart tipi kredi kartı olup iptal statüsünde olan ve  borcu olmayan bir  kart için de kart detay sorgulaması yapılamayacaktır. Detay sorgulaması yapılamayacak bir kart tipi için HHS'ler tarafından <strong>&quot;TR.OHVPS.Business.InvalidCardStatus&quot;</strong> hatası dönülür.</li> <li>Rıza içerisinde kanal görüntüleme yetkisi kapatılan kart için detay bilgisi sorgulandığında <strong>TR.OHVPS.Business.RestrictedChannelAccess</strong> hata kodu dönülecektir.</li> <li>İlk kredi kartı oluşan ÖHK'lar henüz ekstre oluşmadığı sebebiyle tarih ve borç bilgileri de oluşmamış olabilir. Bu sebeple ilgili tutar bilgileri sıfır olacak şekilde dönülmelidir. Tarih bilgileri ise varsayılan tarih bilgisi olarak dönülebilir.(Örn:01/01/1900) Bu şekilde gelen bir tarih bilgisi YÖS'ler tarafından ÖHK'ya boş olarak gösterilebilir.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS tarafından <strong>“KartDetayBilgileri”</strong> nesnesi dönülür.</p> <p>HHS'ler kart tipi kredi kartı ise ve karta ait borç/taksit tutar bilgisi bulunuyorsa KartDetayBilgileri nesnesi için başarılı yanıt dönmek zorundadır. Borç bilgisi için tutarlar eksi(-) olacak şekilde iletilmesi beklenmektedir.</p> <p>Kart Detay Bilgisi Sorgu Örneği (Tek Bir Kart) = /kartlar/{kartRef}/kart-detay</p> <p>Parametre içeren Kart Detay Bilgisi Sorgu Örneği (Tek Bir Kart) =  /kartlar/{kartRef}/kart-detay?ekstreTuru=USD</p> <p><strong>Tablo 22: Kart Bilgileri Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Ekstre Türü</td> <td>ekstreTuru</td> <td>AN3</td> <td>K</td> <td>Kart bilgileri yanıtında dönülen ekstre türleri değerlerini almaktadır. Para birimine uygun olarak kart detay bilgileri sorgulanmaktadır. Ekstre parametresi TRY,USD,EUR,GBP olarak gönderilebilir. Bu alan gönderilmiyorsa TRY değerlendirilmelidir. İlgili para birimine özel ekstre içindeki harcama değeri dönülecektir.</td> <td>Ekstre türleri haricinde uygun olmayan bir değer gönderildiğinde hata verilmelidir.</td></tr></tbody></table> <p><strong>Tablo 23: “KartDetayBilgileri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>Kart Tiplerine İstinaden Detaylı Açıklama</th></tr></thead> <tbody><tr><td>Rıza No</td> <td>rizaNo</td> <td>AN1..128</td> <td>Z</td> <td>HesapBilgisiRızasi nesnesinin oluşturulması esnasında HHS kaynak sunucusu tarafından atanan biricik tanımlayıcı</td> <td></td></tr> <tr><td>Kart Referans Numarası</td> <td>kartRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından her bir kart için atanan biricik değerdir (uuid). Bir kart tek bir kartRef'e karşılık gelmelidir, benzer şekilde bir kartRef tek bir karta karşılık gelmelidir. Aynı kart için alınan tüm rızalarda kart referans bilgisinin değişmemesi gerekmektedir.</td> <td></td></tr> <tr><td>Ekstre Türü</td> <td>ekstreTuru</td> <td>AN3</td> <td>Z</td> <td>Ekstre türü TRY,USD,EUR,GBP olarak gönderilebilir. İstek paremetresinde iletilen değer ile aynı değer olmalıdır.</td> <td></td></tr> <tr><td>Toplam Kart Limiti</td> <td>toplamLimit</td> <td>Kompleks:ToplamLimit</td> <td>K</td> <td>Karta ait toplam TL limit bilgisi. Toplam kart limiti (+) değerde gönderilmelidir. Negatif değer gönderilmemelidir.</td> <td>Kart tipi kredi kartı ve ön ödemeli kart olanlar için ilgili alanın dönülmesi zorunludur. Kart tipi banka olan kartlar için ilgili alan dönülmemelidir. Ön ödemeli kartlarda, bağlı bulundukları bir hesap olsa bile, sadece üzerlerine yüklenen tutarın gösterilmesi gerekmektedir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Tutar Bilgisi. Limit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Kullanılabilir Kart Limiti</td> <td>kullanilabilirLimit</td> <td>Kompleks:KullanılabilirLimit</td> <td>K</td> <td>Karta ait kullanılabilir TL limit bilgisi. Kullanılabilir kart limiti (+) değerde gönderilmelidir. Herhangi bir sebeple (kart limitinin aşılması vb.)  (-) olması durumunda değerin (-) olarak gönderilmesi beklenmektedir.</td> <td>Kart tipi banka olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Tutar Bilgisi. Limit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Dönem İçi Hareket Toplamı</td> <td>donemIciHareketToplami</td> <td>Kompleks:DonemIciHareketToplami</td> <td>Z</td> <td>Dönem içi hareket toplamı ve kalan ekstre borcunun toplamı dönülmelidir. Müşterinin borcu olduğu durumda (-) değer gönderilmelidir. Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb(+) değer ile tutar bilgisi gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili döneme ait hareketlerin toplam tutar bilgisidir. Kart tipi banka ve ön ödemeli kartlar için ilgili dönem içerisinde ay başından itibaren yapılan hareketlerin toplam tutar bilgisi iletilmelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Tutar Bilgisi.  Tutar için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Ekstre Borcu</td> <td>ekstreBorcu</td> <td>Kompleks:EkstreBorcu</td> <td>K</td> <td>İlgili ekstre türüne uygun olarak ekstre borcu iletilmelidir. Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb(+) değer ile tutar bilgisi gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alanın dönülmesi koşulludur. Ek kredi kartı için ilgili alan varsa dönülmelidir . Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Borç tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Kalan Ekstre Borcu</td> <td>kalanEkstreBorcu</td> <td>Kompleks:KalanEkstreBorcu</td> <td>K</td> <td>İlgili ekstre türüne uygun olarak kalan ekstre borcu iletilmelidir. Müşterinin kalan ekstre borcu olduğu durumda (-) değer gönderilmelidir. Kalan ekstre borcu yoksa veya herhangi bir sebeple ektresinde alacak tutarı varsa 0(sıfır) değeri gönderilmelidir. Pozitif değer gönderilmemelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alanın dönülmesi koşulludur. Alt kart tipi ; Asıl ve Dijital kredi kartı için ilgili alanın dönülmesi zorunludur. Ek kredi kartı için ilgili alan varsa dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Borç tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Asgari Ödeme Tutarı</td> <td>asgariOdemeTutari</td> <td>Kompleks:AsgariOdemeTutari</td> <td>K</td> <td>İlgili ekstre türüne uygun olarak ekstreye ait asgari ödeme tutarı iletilmelidir. Ekstre Borcu (-) ise; asgari ödeme tutarı da (-) değer olarak gönderilmelidir. Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb.)  &quot;0&quot; (sıfır) değeri gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alanın dönülmesi koşulludur. Alt kart tipi ; Asıl ve Dijital kredi kartı için ilgili alanın dönülmesi zorunludur. Ek kredi kartı için ilgili alan varsa dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Ödeme tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Kalan Asgari Ödeme Tutarı</td> <td>kalanAsgariOdemeTutari</td> <td>Kompleks:KalanAsgariOdemeTutari</td> <td>K</td> <td>İlgili ekstre türüne uygun olarak ekstreye ait kalan asgari ödeme tutarı iletilmelidir. Ekstre Borcu (-) ise; asgari ödeme tutarı da (-) değer olarak gönderilmelidir. Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb.)  &quot;0&quot; (sıfır) değeri gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alanın dönülmesi koşulludur. Alt kart tipi ; Asıl ve Dijital kredi kartı için ilgili alanın dönülmesi zorunludur. Ek kredi kartı için ilgili alan varsa dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Ödeme tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Hesap Kesim Tarihi</td> <td>hesapKesimTarihi</td> <td>ISODate</td> <td>Z</td> <td>Karta ait hesap kesim tarihi iletilmelidir. Hesap kesim tarihi olarak son kesilmiş ekstrenin tarihi iletilmelidir. Örneğin; günün tarihi 09/01/2026 olduğu durumda her ayın 23'ünde kesilen ekstre için hesap kesim tarihi 2025-12-23 şeklinde olacaktır.</td> <td>Kart tipi kredi kartı olanlar için hesap kesim tarihi iletilmelidir. Ek kart için asıl kartın hesap kesim tarihi dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için sorgulama yapılan ayın son takvim günü dönülmelidir.</td></tr> <tr><td>Sonraki Hesap Kesim Tarihi</td> <td>sonrakiHesapKesimTarihi</td> <td>ISODate</td> <td>Z</td> <td>Kesilecek olan ekstrenin hesap kesim tarihi tarihi iletilmelidir. Örneğin; günün tarihi 09/01/2026 olduğu durumda her ayın 23'ünde kesilen ekstre için sonraki hesap kesim tarihi 2026-01-23 şeklinde olacaktır.</td> <td>Kart tipi kredi kartı olanlar için sonraki hesap kesim tarihi iletilmelidir. Ek kart için asıl kartın sonraki hesap kesim tarihi dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için sorgulama yapılan aydan bir sonraki ayın son takvim günü dönülmelidir</td></tr> <tr><td>Son Ödeme Tarihi</td> <td>sonOdemeTarihi</td> <td>ISODate</td> <td>K</td> <td>Kesilmiş olan ekstre için kart borcunun ödeneceği son ödeme tarih bilgisi dönülmelidir. Örneğin; kesilmiş olan ekstreye ait  hesap kesim tarihi 2025-12-23 şeklinde olan bir kredi kartı için son ödeme tarihi 2026-01-03 olacaktır.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Ek kart için asıl kartın son ödeme tarih bilgisi dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>Sonraki Son Ödeme Tarihi</td> <td>sonrakiSonOdemeTarihi</td> <td>ISODate</td> <td>K</td> <td>Kesilecek olan ekstre için kart borcunun ödeneceği son ödeme tarih bilgisi dönülmelidir.  Örneğin; kesilecek olan ekstreye ait  hesap kesim tarihi 2026-01-23 şeklinde olan bir kredi kartı için son ödeme tarihi 2026-02-03 olacaktır.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Ek kart için asıl kartın sonraki son ödeme tarih bilgisi dönülmelidir. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>Puan Bilgisi</td> <td>puanBilgisi</td> <td>Kompleks:PuanBilgisi[Array]</td> <td></td> <td>Karta ait puan bilgileri dizi içerisinde iletilmelidir.</td> <td></td></tr> <tr><td>&gt; Puan Değeri</td> <td>puanDegeri</td> <td>AN1..25</td> <td>K</td> <td>Kart için mevcutta yer alan puan değeri varsa iletilmelidir. HHS özelinde puan değeri puan tipine göre birim olarak tutuluyorsa ilgili değer iletilmelidir. Örn: 100 Plus puan bilgisi varsa puan değeri alanında 100 iletilmelidir. Puan değeri eksi değer alabilir.</td> <td>Tüm kart tipleri için puan bilgisi varsa dönülmelidir.</td></tr> <tr><td>&gt; Puan Tipi</td> <td>puanTipi</td> <td>AN1..50</td> <td>K</td> <td>Puan Tipi olarak HHS özelinde bir puanTipi varsa o bilgi iletilmelidir. Örn: 100 Plus puan bilgisi varsa puan tipi alanında Plus değeri iletilmelidir.</td> <td>Tüm kart tipleri için puan bilgisi varsa dönülmelidir.</td></tr> <tr><td>Nakit Çekim Limiti</td> <td>nakitCekimLimiti</td> <td>Kompleks:NakitCekimLimiti</td> <td>K</td> <td>Karta ait nakit çekim limit değeri iletilmelidir. Ekstre türü TRY dışında olan kartlar için de TRY para biriminde geçerli olan limit iletilmelidir. Nakit Çekim Limiti (+) değerde gönderilmelidir. Negatif değer gönderilmemelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Limit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Kullanılabilir Nakit Çekim Limiti</td> <td>kullanilabilirNakitCekimLimiti</td> <td>Kompleks:KullanilabilirNakitCekimLimiti</td> <td>K</td> <td>Karta ait kullanılabilir nakit çekim limit değeri iletilmelidir. Ekstre türü TRY dışında olan kartlar için de TRY para biriminde geçerli olan limit iletilmelidir. Kullanılabilir Nakit Çekim Limiti (+) değerde gönderilmelidir. Herhangi bir sebeple (nakit limitinin aşılması vb.)  (-) olması durumunda değerin (-) olarak gönderilmesi beklenmektedir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Limit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Kalan Toplam Taksit Tutarı</td> <td>kalanToplamTaksitTutari</td> <td>Kompleks:KalanToplamTaksitTutari</td> <td>K</td> <td>Karta ait tüm kalan taksitlerin toplam değeri iletilmelidir.Müşterinin Taksit borcu olduğu durumda (-) değer gönderilmelidir. Taksit iadesi veya benzeri nedenlerle oluşan müşterinin alacaklı olduğu durumda tutar (+) değer gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Taksit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Dönem Taksit Tutar Bilgisi</td> <td>donemTaksitTutarBilgisi</td> <td>Kompleks:DonemTaksitTutarBilgisi[array]</td> <td>K</td> <td>Kart Tipi kredi kartı olanlar için taksit bilgisi varsa taksit içeren dönemlerin dizi halinde iletilmesi zorunludur.</td> <td></td></tr> <tr><td>&gt; Dönem Değeri</td> <td>donemDegeri</td> <td>N3</td> <td>Z</td> <td>Taksitli işlemler dönülmesi sebebiyle dönem değeri minimum 1 olacak şekilde dönülmelidir.</td> <td></td></tr> <tr><td>&gt; Dönem Taksit Tutarı</td> <td>donemTaksitTutari</td> <td>Kompleks:DonemTaksitTutari</td> <td>Z</td> <td>İlgili dönem değeri içerisindeki toplam taksit tutar bilgisi iletilmelidir. Müşterinin Dönem Taksit Tutar borcu olduğu durumda (-) değer gönderilmelidir. Dönem Taksit Tutar iadesi veya benzeri nedenlerle oluşan müşterinin alacaklı olduğu durumda tutar (+) değer gönderilmelidir.</td> <td></td></tr> <tr><td>&gt;&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Taksit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt;&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr></tbody></table> <h2 id="_9-11-adim-4-2-kart-hareket-bilgilerinin-sorgulanması"><a href="#_9-11-adim-4-2-kart-hareket-bilgilerinin-sorgulanması" class="header-anchor">#</a> 9.11 ADIM 4.2: Kart Hareket Bilgilerinin Sorgulanması</h2> <p><strong>GET /kartlar/{kartRef}/kart-hareketleri</strong></p> <p>KartBilgileri nesnesi ile elde edilen kart listesinde yer alan kartların işlem/hareket bilgileri sorgulanır. Kart hareketleri için &quot;KartHareketleri&quot; nesnesinin içeriği Tablo 25'de verilmiştir.</p> <ul><li>Bir karta ilişkin işlem bilgileri Tablo 24’deki istek parametrelerine göre sorgulanır. Parametrede yer alan değerlerin doğru gönderildiği kontrol edilir. Hatalı gönderilmesi durumunda HHS tarafından <strong>”TR.OHVPS.Resource.InvalidFormat”</strong> hatası dönülür. Parametrede yer alan isteğe bağlı alanlar gönderilmediği durumda parametredeki varsayılan değerler ile kart hareketleri dönülür.</li> <li>Parametrede yer alan ekstreTuru bilgisi Ekstre Türleri haricinde uygun olmayan bir değer gönderildiğinde <strong>”TR.OHVPS.Business.InvalidCurrencyCode”</strong> hatası dönülür. Bu alan gönderilmiyorsa TRY olarak değerlendirilmelidir.</li> <li>Erişim belirteci kontrolü yapılır. Geçerli bir erişim belirteci yok ise HHS tarafından <strong>”TR.OHVPS.Connection.InvalidToken”</strong> hatası dönülür.</li> <li>İstek başlığında yer alan X-Access-Token ile ilişkili rızada, izin verilen kartRef'ler için, kart hareket bilgileri sorgusunda yer alan kartRefe ait rıza ile aynı olup olmadığı kontrol edilir. Farklı olması durumunda <strong>&quot;TR.OHVPS.Resource.NotFound&quot;</strong> hatası dönülür.</li> <li>İlgili kartRef bulunamaz ise <strong>”TR.OHVPS.Resource.NotFound”</strong> hatası dönülür.</li> <li>Rıza durumu kontrol edilir.
<ul><li>B: Yetki Bekleniyor ya da Y: Yetkilendirildi ise <strong>“TR.OHVPS.Resource.ConsentMismatch”</strong> hatası dönülür.</li> <li>I: Rıza İptal ya da S: Yetki Sonlandırıldı ise <strong>”TR.OHVPS.Resource.ConsentRevoked”</strong> hatası dönülür.</li> <li>RizaDurumu “K: Yetki Kullanıldı” ise kontrollere devam edilir.</li></ul></li> <li>Kart Hareket Bilgilerinin Sorgulanması yapılırken HHS tarafından ÖHK’nın “09:  Ayrıntılı Kart İşlem Bilgisi” izin türüne sahipliği kontrol edilir. 09 izin türüne sahip değil ise <strong>”TR.OHVPS.Business.PermissionTypeNotSupported”</strong> hatası dönülür.</li> <li>Kart tipi olarak; iptal statüsünde olan banka ve ön ödemeli kartlar için hareket sorgulaması yapılamayacaktır. Kart tipi kredi kartı olup iptal statüsünde olan ve borcu olmayan bir kart için de kart hareket sorgulaması yapılamayacaktır. Hareket sorgulaması yapılamayacak bir kart tipi için HHS'ler tarafından <strong>&quot;TR.OHVPS.Business.InvalidCardStatus&quot;</strong> hatası dönülmelidir.</li> <li>-Rıza içerisinde kanal görüntüleme yetkisi kapatılan kart için hareket bilgisi sorgulandığında <strong>TR.OHVPS.Business.RestrictedChannelAccess</strong> hata kodu dönülecektir.</li> <li>İptal statüsünde olan kart tipleri için geçmişe dönük hareket sorgulaması yapılamayacaktır. Örneğin; Kredi Kartı için -12 ile 18 arası olan dönem değeri iptal statüsünde olan kredi kartı için 0 ile 18 arasında yapılabilecektir. Tüm kart tipleri için belirtilen parametrede yer alan dönem değerinin uygun gönderilmediği durumda <strong>”TR.OHVPS.Business.InvalidPeriodValue”</strong> hatası dönülür.</li> <li>Ekstre bilgisi bulunmayan sanal ve ek kredi kart bilgileri için ekstre dönemlerine özgü kart hareketleri sorgulandığında HHS'ler tarafından <strong>TR.OHVPS.Business.NoStatementForCard</strong> hatası dönülmelidir.</li> <li>Kartın yeni oluşması/aktif edilmesi gibi süreçlerler sonucunda ekstre bilgisi hiç oluşmamış dönem değerleri için kart hareketleri sorgulandığında HHS'ler tarafından <strong>TR.OHVPS.Business.StatementNotCreated</strong> hatası dönülmelidir.</li></ul> <p>Yukarıdaki kontroller tamamlandıktan sonra HHS tarafından &quot;KartHareketleri&quot; nesnesi dönülür.</p> <ul><li>HHS'ler kart tipi kredi kartı ise ve karta ait borç/taksit tutar bilgisi bulunuyorsa KartHareketleri nesnesi için başarılı yanıt dönmek zorundadır.</li> <li>Kart tipi Banka Kartı olanlarda dönem içi olarak sorgulama yapılan aya ait ilgili banka kartı ile yapılan kart hareketleri görüntülenecektir. (Banka kartı ile yapılan Para Çekme/Yatırma, banka kartı ile yapılan POS'tan Alışveriş vb.). Banka kartında dönem değerinin &quot;-1&quot; gönderilmesi durumunda bir önceki aya ait kart hareketleri görüntülenecektir.</li> <li>Kart hareketleri yanıtında hareket bilgileri işlem tarihinine göre sıralı olarak iletilmelidir. İşlem tarihi en güncel tarihten geriye dönük olacak şekilde listelenmelidir.</li> <li>Kart hareketlerinde ekstre türleri dışında yapılan bir işlem varsa hangi ekstre türüne dahil edilerek gösteriliyorsa gönderilmelidir.
<ul><li>Örn: 100 JPY'lik bir harcama işlemi TRY biriminde çevirilip 23 TRY olarak TRY ekstre türünde gösteriliyorsa ilgili işlem için işlem tutarı 23 TRY, orijinal işlem tutarı ise 100 JPY olarak değerlendirilmelidir.</li></ul></li></ul> <p><strong>Tablo 24: Kart Hareket Bilgileri Sorgulama İsteği Sorgu Parametreleri</strong></p> <table><thead><tr><th>Alan Adı</th> <th>Parametre Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>HHS tarafından yapılması gereken kontrol ve işlemler</th></tr></thead> <tbody><tr><td>Dönem Değeri</td> <td>donemDegeri</td> <td>N3</td> <td>Z</td> <td>Kart hareketlerinin sorgulanacağı döneme ait değerdir.<br><br> Dönem içi : 0<br>Geçmiş Ay/Ekstre : -1 ile -12 arası<br>Taksit : 1 ile 18 arası <br>Provizyon : 99<br><br> Kart tipine göre alabileceği dönem değerleri ise ;<br><br> Banka Kartı : 0 ve -1<br>Kredi Kartı : -12 ile 18 arası ve 99 (Sanal alt kart tipi hariç diğer tüm alt kart tiplerinde bu değerler geçerlidir.) <br>Alt kart tipi sanal kart tipinde ise alabileceği değerler 0 ve 99'dur.<br>Ön Ödemeli Kart : 0 ve -1</td> <td>İptal statüsünde olan kart tipleri için geçmişe dönük hareket sorgulaması yapılamayacaktır. Örneğin; Kredi Kartı için -12 ile 18 arası olan dönem değeri iptal statüsünde olan kredi kartı için 0 ile 18 arasında yapılabilecektir.<br><br> Tüm kart tipleri için belirtilen dönem değerinin uygun gönderilmediği durumda hata verilmelidir.</td></tr> <tr><td>Ekstre Turu</td> <td>ekstreTuru</td> <td>AN3</td> <td>K</td> <td>Kart bilgileri yanıtında dönülen ekstre türleri değerlerini almaktadır. Para birimine uygun olarak kart detay bilgileri sorgulanmaktadır. Ekstre parametresi TRY,USD,EUR,GBP olarak gönderilebilir. Bu alan gönderilmiyorsa TRY değerlendirilmelidir. İlgili para birimine özel ekstre içindeki harcama değeri dönülecektir.</td> <td>Ekstre türleri haricinde uygun olmayan bir değer gönderildiğinde hata verilmelidir.</td></tr> <tr><td>Sayfa Başına İstenen Kayıt Sayısı</td> <td>syfKytSayi</td> <td>N3</td> <td>İ</td> <td>Sayfa başına istenen kayıt sayısı. Bu alanda iletilen değer 100’den büyük olamaz.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayı kadar gruplandırarak gönderir. Bu veri gönderilmediğinde sayfadaki kayıt sayısı 100 olarak kullanılır.</td></tr> <tr><td>İstenen Sayfa Numarasi</td> <td>syfNo</td> <td>N3</td> <td>İ</td> <td>Cevapta dönecek sayfa numarası 1’den başlayarak artan değerlerle iletilmelidir.</td> <td>Bu veri gönderildiği durumda, HHS işlemler listesini bu sayfadaki kayıtları gönderir. Gönderilmediğinde, HHS ilk sayfadaki kayıtları gönderir.</td></tr> <tr><td>Borç Alacak Göstergesi</td> <td>brcAlc</td> <td>AN1</td> <td>İ</td> <td>TR.OHVPS.DataCode.BrcAlc sıralı veri tipi değerlerinden birini alır. Sorgulanacak işlemlerin borç / alacak kriteri B: Karta borç yaratan işlem.A: Karta alacak yaratan işlem. N: Finansal olmayan işlem {“B”,”A”,”N”}</td> <td>Bu veri gönderildiği durumda HHS işlemler listesi dönüşünü bu kritere göre filtreleyerek iletmek zorundadır.</td></tr> <tr><td>Sıralama Yönü</td> <td>srlmYon</td> <td>AN1</td> <td>İ</td> <td>Cevapta dönülecek işlemlerin sıralama yönünü belirtir. Alabileceği değerler: A: Azalan değerle sıralama Y: Artan değerle sıralama {“A”,”Y”}</td> <td>Bu veri gönderildiği durumda, HHS kart hareketlerini <strong>sıralama kriteri işlem tarihi</strong> olacak şekilde ilgili yöne uygun olarak sıralayarak gönderir. Gönderilmediğinde, HHS sıralama yönünü Azalan olarak belirler.</td></tr></tbody></table> <p><strong>Tablo 25: “KartHareketleri” nesnesi</strong></p> <table><thead><tr><th>Alan Adı</th> <th>JSON Alan Adı</th> <th>Format</th> <th>Zorunlu / Koşullu /  İsteğe bağlı</th> <th>Açıklama</th> <th>Kart Tiplerine İstinaden Detaylı Açıklama</th></tr></thead> <tbody><tr><td>Kart Referans Numarası</td> <td>kartRef</td> <td>AN5..40</td> <td>Z</td> <td>HHS tarafından her bir kart için atanan biricik değerdir (uuid). Bir kart tek bir kartRef'e karşılık gelmelidir, benzer şekilde bir kartRef tek bir karta karşılık gelmelidir. Aynı kart için alınan tüm rızalarda kart referans bilgisinin değişmemesi gerekmektedir.</td> <td></td></tr> <tr><td>Dönem Değeri</td> <td>donemDegeri</td> <td>N3</td> <td>Z</td> <td>Kart hareketlerinin sorgulanacağı döneme ait değerdir.</td> <td></td></tr> <tr><td>Dönem Başlangıç Tarihi</td> <td>donemBaslangicTarihi</td> <td>ISODate</td> <td>Z</td> <td>Sorgulama yapılan ekstre dönemine göre ilgili döneme ait başlangıç tarih bilgisidir. Kart tipi kredi kartı olanlar için ilgili döneme ait başlangıç tarihi iletilmelidir. Kart tipi banka kartı ve ön ödemeli kart olanlar için sorgulama yapılan ayın başlangıç tarihi iletilmelidir.</td> <td></td></tr> <tr><td>Dönem Bitiş Tarihi</td> <td>donemBitisTarihi</td> <td>ISODate</td> <td>Z</td> <td>Sorgulama yapılan ekstre dönemine göre ilgili döneme ait bitiş tarih bilgisidir. Kart tipi kredi kartı olanlar için ilgili döneme ait bitiş tarihi iletilmelidir. Kart tipi banka kartı ve ön ödemeli kart olanlar için sorgulama yapılan ayın bitiş tarihi iletilmelidir.</td> <td></td></tr> <tr><td>Ekstre Türü</td> <td>ekstreTuru</td> <td>AN3</td> <td>Z</td> <td>Ekstre türü TRY,USD,EUR,GBP olarak gönderilebilir. İstek paremetresinde iletilen değer ile aynı değer olmalıdır.</td> <td></td></tr> <tr><td>Ekstre Borcu</td> <td>ekstreBorcu</td> <td>Kompleks:EkstreBorcu</td> <td>K</td> <td>Sorgulama yapılan geçmiş döneme için ekstre türüne uygun olarak ekstre borcu iletilmelidir. Müşterinin borcu olduğu durumda (-) değer gönderilmelidir.  Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb(+) değer ile tutar bilgisi gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için sadece geçmiş dönem değerine istinaden ilgili alan iletilmelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Borç tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Asgari Ödeme Tutarı</td> <td>asgariOdemeTutari</td> <td>Kompleks:AsgariOdemeTutari</td> <td>K</td> <td>İlgili geçmiş dönem için ekstre türüne uygun olarak ekstreye ait asgari ödeme tutarı iletilmelidir. Ekstre Borcu (-) ise; asgari ödeme tutarı da (-) değer olarak gönderilmelidir. Müşterinin alacağı olduğu durumda (iade/fazla ödeme vb.)  &quot;0&quot; (sıfır) değeri gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için sadece geçmiş dönem değerine istinaden ilgili alan iletilmelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Ödeme tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Dönem Taksit Tutarı</td> <td>donemTaksitTutari</td> <td>Kompleks:DonemTaksitTutari</td> <td>K</td> <td>İstek parametresinde iletilen ilgili dönem değeri içerisindeki toplam taksit tutar bilgisi iletilmelidir. Müşterinin Dönem Taksit Tutar borcu olduğu durumda (-) değer gönderilmelidir. Dönem Taksit Tutar iadesi veya benzeri nedenlerle oluşan müşterinin alacaklı olduğu durumda tutar (+) değer gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için taksit bilgisi varsa ilgili alan iletilmelidir.</td></tr> <tr><td>&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Dönem taksit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>Hesap Kesim Tarihi</td> <td>hesapKesimTarihi</td> <td>ISODate</td> <td>K</td> <td>Karta ait sorgulanan döneme ait hesap kesim tarihi iletilmelidir. Tarih formatında iletilmelidir. Örn : 2024-11-23</td> <td>Kart tipi kredi kartı olanlar için sadece geçmiş dönem değerine istinaden ilgili alan iletilmelidir.</td></tr> <tr><td>Son Ödeme Tarihi</td> <td>sonOdemeTarihi</td> <td>ISODate</td> <td>K</td> <td>Karta ait sorgulanan dönem için son ödeme tarih bilgisi dönülmelidir. Örn : 2024-12-02</td> <td>Kart tipi kredi kartı olanlar için sadece geçmiş dönem değerine istinaden ilgili alan iletilmelidir.</td></tr> <tr><td>Hareket Bilgileri</td> <td>hareketBilgileri</td> <td>Kompleks Alan: HareketBilgileri[array]</td> <td>K</td> <td>Dizi halinde liste olacaktır.</td> <td></td></tr> <tr><td>&gt; İşlem Numarası</td> <td>islemNo</td> <td>AN3..50</td> <td>Z</td> <td>Kart hareketinin oluşturulması sırasında atanan ve borç (veya alacak) hareketini tekilleştiren HHS bazında tekil tanımlayıcıdır. Bu değer tek başına tekil olabileceği gibi birden fazla değerin bir araya getirilmesiyle de tekilliği sağlanmış olabilir. Bu değerin en azından kart referans numarası bazında tekil olması beklenir. Genellikle kullanılan örnekleri; Instance_Id, Transaction_Id, Transaction_Num, Transaction_TimeStamp</td> <td></td></tr> <tr><td>&gt; İşlem Tutarı</td> <td>islemTutari</td> <td>Kompleks:IslemTutari</td> <td>Z</td> <td>Yapılan işleme ait tutar bilgisi. Taksitli bir işlem ise ilgili dönemdeki taksit tutarı iletilecektir. ÖHK, HHS'de ilgili dönem sorguladığında hangi tutarı görüntülüyorsa ilgili tutar dönülecektir. İşleme ait sadece puan bilgisiyle kazanım, kullanım, iade veya iptal varsa ve tutar bilgisi yoksa ilgili tutar değeri sıfır gönderilmelidir. Puana dair değerler ise PuanBilgileri alanı içerisinde gönderilmelidir.</td> <td></td></tr> <tr><td>&gt;&gt; Tutar</td> <td>tutar</td> <td>AN1..24</td> <td>Z</td> <td>İşlem tutarı için regex patterni şu şekildedir: '<code>^\d{1,18}$|^\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt;&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi. Ekstre türü ile aynı olması gerekmektedir.</td> <td></td></tr> <tr><td>&gt; Orijinal İşlem Tutarı</td> <td>orijinalIslemTutari</td> <td>Kompleks:OrijinalIslemTutari</td> <td>K</td> <td>Ekstre türü dışında yapılan işleme ait tutar bilgisi. Örneğin; ekstre türü TRY gönderildiği durumda işlem 100 JPY ise işlem tutarı alanında 100 değeri iletilmelidir.</td> <td></td></tr> <tr><td>&gt;&gt; Tutar</td> <td>tutar</td> <td>AN1..24</td> <td>Z</td> <td>İşlem tutarı için regex patterni şu şekildedir: '<code>^\d{1,18}$|^\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt;&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi. Örneğin; 100 JPY ise işlem tutar para birimi alanında JPY değeri iletilmelidir.</td> <td></td></tr> <tr><td>&gt; İşlem Tarihi</td> <td>islemTarihi</td> <td>ISODateTime</td> <td>Z</td> <td>İşlemin gerçekleştiği zaman bilgisi. Taksitli işlemlerde içinde bulunulan dönem özelinde ilgili taksitin yansıyacağı tarih değeri dönülmelidir.</td> <td></td></tr> <tr><td>&gt; Borç Alacak Göstergesi</td> <td>borcAlacak</td> <td>AN1</td> <td>Z</td> <td>TR.OHVPS.DataCode.BrcAlc sıralı veri tipi değerlerinden birini alır. Sorgulanacak işlemlerin borç / alacak kriteri B: Karta borç yaratan işlem.A: Karta alacak yaratan işlem. N: Finansal olmayan işlem {“B”,”A”,”N”}</td> <td></td></tr> <tr><td>&gt; İşlem Açıklaması</td> <td>islemAciklamasi</td> <td>AN1..200</td> <td>Z</td> <td>Alışveriş işlemi olması durumunda sadece işyeri adını içeren açıklama, diğer işlemler için mevcut işlem açıklaması iletilir. HHS'ler tüm kart hareketlerini YÖS'ler ile paylaşmakla yükümlü olup, hassas veri içeren(örn: faiz, komisyon bilgisi içeren vb.) işlem hareketleri de bu kapsamda değerlendirilerek işlem açıklamasının maskeli olarak iletilmesi sağlanır. Kelimelerin ilk 3 hanesi maskeli olacak şekilde, ancak sakıncalı bulunan kelimeler varsa; (örn: faiz, komiyon vb.) kelimelerin tamamı maskeli olacak şekilde gösterilebilir.</td> <td></td></tr> <tr><td>&gt; İşlem Puan Bilgileri</td> <td>islemPuanBilgileri</td> <td>Kompleks: IslemPuanBilgileri[Array]</td> <td>K</td> <td>İlgili işlem sonrası kazanılan veya kullanılan bir puan değeri varsa iletilmesi gerekmektedir. İlgili puan bilgi veya bilgileri dizi içerisinde iletilmelidir.</td> <td>İlgili alanda koşula uygun olarak değer dönülecekse; kart tipi kredi, banka ve ön ödemeli kartı olanlar için dönülmesi zorunludur.</td></tr> <tr><td>&gt;&gt; İşlem Puanı</td> <td>islemPuani</td> <td>AN1..24</td> <td>K</td> <td>İşleme dair kazanılan veya kullanılan puan değeri iletilmelidir. Örn: 100 Plus kazanılmış bir işlem için 100 değeri iletilmelidir.</td> <td></td></tr> <tr><td>&gt;&gt; İşlem Puan Birimi</td> <td>islemPuanBirimi</td> <td>AN1..50</td> <td>K</td> <td>İşleme dair kazanılan veya kullanılan puan birimi iletilmelidir. Örn: 100 Plus kazanılmış bir işlem için Plus değeri iletilmelidir.</td> <td></td></tr> <tr><td>&gt;&gt; İşlem Puan Durumu</td> <td>islemPuanDurumu</td> <td>AN2</td> <td>K</td> <td>İlgili işlem sonucunda puan bilgisinin bir kazanım, kullanım, iade ve iptal durumlarına yönelik değer iletilmelidir. TR.OHVPS.DataCode.IslemPuanDurumu değerlerinden birini alır.<br>01: Puan Kazanımı<br>02: Puan Kullanımı<br>03: Puan İade<br>04: Puan İptal</td> <td></td></tr> <tr><td>&gt; Toplam Taksit Tutarı</td> <td>toplamTaksitTutari</td> <td>Kompleks:ToplamTaksitTutari</td> <td>K</td> <td>İlgili işlem taksitli bir işlem ise o işleme ait toplam taksit tutarı iletilmelidir. İlgili işlem tek çekim bir işlem ise o işlemde ilgili alan iletilmemelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt;&gt; Tutar</td> <td>tutar</td> <td>AN1..25</td> <td>Z</td> <td>Taksit Tutar Bilgisi. Taksit tutarı için regex patterni şu şekildedir: '<code>^[\-\+]?\d{1,18}$|^[\-\+]?\d{1,18}\.\d{1,5}$</code>'</td> <td></td></tr> <tr><td>&gt;&gt; Para Birimi</td> <td>paraBirimi</td> <td>AN3</td> <td>Z</td> <td>Para Birimi</td> <td></td></tr> <tr><td>&gt; Toplam Taksit Sayısı</td> <td>toplamTaksitSayisi</td> <td>N2</td> <td>K</td> <td>İlgili işlem taksitli bir işlem ise o işleme ait toplam taksit sayısı iletilmelidir. İlgili işlem tek çekim bir işlem ise o işlemde ilgili alan iletilmemelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; İlgili Taksit Dönemi</td> <td>taksitDonemi</td> <td>N2</td> <td>K</td> <td>Taksitli işlem olması durumunda işleme ait ilgili taksit dönem bilgisi. Örneğin: 3 taksitli bir işlemde 2. taksit yansımışsa 2 olarak gönderilmelidir.</td> <td>Kart tipi kredi kartı olanlar için ilgili alan dönülmesi zorunludur. Kart tipi banka ve ön ödemeli kart olan kartlar için ilgili alan dönülmemelidir.</td></tr> <tr><td>&gt; Satıcı Kategori Kodu</td> <td>saticiKategoriKodu</td> <td>AN4</td> <td>K</td> <td>Satıcı Kategori Kodu(MCC) varsa iletilmesi zorunludur. Alışveriş işlemlerinde gönderimi zorunludur.</td> <td>İlgili alanda koşula uygun olarak değer dönülecekse; kart tipi kredi ve banka kartı olanlar için dönülmesi zorunludur.</td></tr></tbody></table></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/v2.0.0/contents/duzenli-odeme-emri-hizmeti.html" class="prev">
        8. Düzenli Ödeme Emri Başlatma Hizmeti
      </a></span> <span class="next"><a href="/v2.0.0/contents/hhs-yos-api.html">
        10. HHS ve YÖS API
      </a>
      →
    </span></p></div> <div class="footer-wrapper"><footer class="page-edit footer"><div class="footer-info"><p style="padding-right:15px;">© Tüm hakları saklıdır.</p></div></footer></div></main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.326e02a8.js" defer></script><script src="/assets/js/8.9be4df52.js" defer></script><script src="/assets/js/5.15938fdf.js" defer></script><script src="/assets/js/4.251ecbb8.js" defer></script><script src="/assets/js/31.de85b863.js" defer></script>
  </body>
</html>
